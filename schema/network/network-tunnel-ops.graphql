# -----------------------------------------------------------------------------
# Tunnel Query Extensions
# -----------------------------------------------------------------------------

extend type Query {
  """
  Get all tunnels on a router with optional filtering by type
  """
  tunnels("Router ID to query" routerId: ID!, "Optional: filter by tunnel type" type: TunnelType): [Tunnel!]!
    @capability(requires: ["interface"])

  """
  Get a specific tunnel by ID
  """
  tunnel("Router ID" routerId: ID!, "Tunnel ID" id: ID!): Tunnel @capability(requires: ["interface"])

  """
  Get available IPsec profiles for GRE tunnel encryption
  """
  ipsecProfiles("Router ID to query" routerId: ID!): [IpsecProfile!]! @capability(requires: ["interface"])
}

# -----------------------------------------------------------------------------
# Tunnel Mutation Extensions
# -----------------------------------------------------------------------------

extend type Mutation {
  """
  Create a new tunnel interface
  """
  createTunnel("Router ID" routerId: ID!, "Tunnel configuration" input: TunnelInput!): TunnelMutationResult!
    @capability(requires: ["interface"])

  """
  Update an existing tunnel interface
  """
  updateTunnel(
    "Router ID"
    routerId: ID!
    "Tunnel ID"
    id: ID!
    "Updated tunnel configuration"
    input: TunnelInput!
  ): TunnelMutationResult! @capability(requires: ["interface"])

  """
  Delete a tunnel interface
  """
  deleteTunnel("Router ID" routerId: ID!, "Tunnel ID to delete" id: ID!): TunnelMutationResult!
    @capability(requires: ["interface"])

  """
  Test tunnel connectivity and path MTU
  """
  testTunnel("Router ID" routerId: ID!, "Tunnel ID to test" id: ID!): TunnelTestResult!
    @capability(requires: ["interface"])
}

# -----------------------------------------------------------------------------
# Tunnel Subscription Extensions
# -----------------------------------------------------------------------------

extend type Subscription {
  """
  Subscribe to tunnel status changes (create, update, delete)
  """
  tunnelChanged("Router ID to monitor" routerId: ID!): Tunnel! @capability(requires: ["interface"])
}

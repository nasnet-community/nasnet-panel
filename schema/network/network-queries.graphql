# -----------------------------------------------------------------------------
# Network Query Extensions
# -----------------------------------------------------------------------------

extend type Query {
  """
  Get all IP addresses on a router with optional filtering
  """
  ipAddresses(
    "Router ID to query"
    routerId: ID!
    "Optional: filter by interface ID"
    interfaceId: ID
  ): [IpAddress!]! @capability(requires: ["interface"])

  """
  Get a specific IP address by ID
  """
  ipAddress(
    "Router ID"
    routerId: ID!
    "IP address ID"
    id: ID!
  ): IpAddress @capability(requires: ["interface"])

  """
  Check if an IP address conflicts with existing assignments
  """
  checkIpConflict(
    "Router ID"
    routerId: ID!
    "IP address to check (CIDR notation)"
    address: String!
    "Interface ID (optional, for scoped check)"
    interfaceId: ID
    "Exclude this IP ID from conflict check (for updates)"
    excludeId: ID
  ): IpConflictResult! @capability(requires: ["interface"])

  """
  Get dependencies for an IP address (DHCP servers, routes, etc.)
  """
  ipAddressDependencies(
    "Router ID"
    routerId: ID!
    "IP address ID"
    id: ID!
  ): IpAddressDependencies! @capability(requires: ["interface"])

  """
  Get all VLANs on a router with optional filtering
  """
  vlans(
    "Router ID to query"
    routerId: ID!
    "Optional filters"
    filter: VlanFilter
  ): [Vlan!]! @capability(requires: ["interface"])

  """
  Get a specific VLAN by ID
  """
  vlan(
    "VLAN ID"
    id: ID!
  ): Vlan @capability(requires: ["interface"])

  """
  Check if a VLAN ID is available on a parent interface
  """
  checkVlanIdAvailable(
    "Router ID"
    routerId: ID!
    "Parent interface ID"
    parentInterface: ID!
    "VLAN ID to check"
    vlanId: Int!
  ): Boolean! @capability(requires: ["interface"])

  """
  Get dependencies for a VLAN (IP addresses, DHCP, routes, etc.)
  """
  vlanDependencies(
    "VLAN ID"
    id: ID!
  ): VlanDependencies @capability(requires: ["interface"])

  """
  Get VLAN topology for a bridge
  """
  vlanTopology(
    "Router ID"
    routerId: ID!
    "Bridge ID"
    bridgeId: ID!
  ): VlanTopology @capability(requires: ["interface"])

  """
  Get all routes on a router with optional filtering
  """
  routes(
    "Router ID to query"
    routerId: ID!
    "Filter by routing table name (main, vpn, etc.)"
    table: String
    "Filter by route type (STATIC, CONNECTED, DYNAMIC, etc.)"
    type: RouteType
  ): [Route!]! @capability(requires: ["routing"])

  """
  Get a specific route by ID
  """
  route(
    "Router ID"
    routerId: ID!
    "Route ID"
    id: ID!
  ): Route @capability(requires: ["routing"])

  """
  Check if a gateway address is reachable from the router
  """
  checkGatewayReachability(
    "Router ID"
    routerId: ID!
    "Gateway IP address to check"
    gateway: IPv4!
  ): GatewayReachabilityResult! @capability(requires: ["routing"])

  """
  Get historical interface statistics for bandwidth analysis
  """
  interfaceStatsHistory(
    "Router ID"
    routerId: ID!
    "Interface ID"
    interfaceId: ID!
    "Time range for the query"
    timeRange: StatsTimeRangeInput!
    "Aggregation interval (default: 5m)"
    interval: Duration = "5m"
  ): InterfaceStatsHistory! @capability(requires: ["interface"])
}

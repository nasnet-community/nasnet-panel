# =============================================================================
# Universal State v2 - Resource Interface
# =============================================================================
# The 8-layer Resource Model interface for NasNetConnect.
# Every managed resource implements this interface.
#
# Reference: ADR-012 - Universal State v2
# Reference: Docs/architecture/data-architecture.md
# =============================================================================

# -----------------------------------------------------------------------------
# Resource Interface
# -----------------------------------------------------------------------------

"""
Universal State v2 Resource Interface.
Every managed resource implements this interface with 8 layers:
1. configuration - User's desired config (mutable by user)
2. validation - Pre-flight check results (computed by backend)
3. deployment - What's on router (after Apply-Confirm)
4. runtime - Live operational state (polled/streamed)
5. telemetry - Time-series metrics (historical)
6. metadata - Lifecycle info, tags, ownership
7. relationships - Dependencies (embedded + explicit)
8. platform - Capabilities and field mappings
"""
interface Resource {
  "Globally unique identifier (ULID) - also serves as Node.id for Relay compatibility"
  id: ID!

  "Scoped identifier for readability (e.g., 'vpn.wg.client:usa-vpn:a1b2')"
  scopedId: String!

  "Resource type identifier (e.g., 'vpn.wireguard.client')"
  type: String!

  "Resource category"
  category: ResourceCategory!

  # =========================================================================
  # 8-LAYER MODEL
  # =========================================================================

  """
  Layer 1: CONFIGURATION - User's desired config
  Mutable by user. Validated by Zod on client, GraphQL on server.
  Implementations can provide strongly-typed configs.
  """
  configuration: JSON

  """
  Layer 2: VALIDATION - Pre-flight check results
  Computed by backend. Updated on every configuration change.
  """
  validation: ValidationResult

  """
  Layer 3: DEPLOYMENT - What's actually on router
  Written after Apply-Confirm. Includes router-generated fields.
  Implementations can provide strongly-typed deployment states.
  """
  deployment: DeploymentState

  """
  Layer 4: RUNTIME - Live operational state
  Polled/streamed from router. Read-only.
  Implementations can provide strongly-typed runtime states.
  """
  runtime: RuntimeState

  """
  Layer 5: TELEMETRY - Time-series metrics
  Historical data collected over time. Read-only.
  """
  telemetry: TelemetryData

  """
  Layer 6: METADATA - Resource lifecycle info
  System-managed. Includes tags, version, ownership.
  """
  metadata: ResourceMetadata!

  """
  Layer 7: RELATIONSHIPS - Dependencies
  Embedded in config (user-defined) + explicit table (system-discovered).
  """
  relationships: ResourceRelationships

  """
  Layer 8: PLATFORM - Capabilities and field mappings
  From platform adapter. Router-specific behavior.
  """
  platform: PlatformInfo
}

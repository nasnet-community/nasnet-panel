# =============================================================================
# Resource Layers 4-5: Runtime and Telemetry
# =============================================================================
# Live operational state and time-series metrics types.
#
# Reference: ADR-012 - Universal State v2
# =============================================================================

# -----------------------------------------------------------------------------
# Layer 4: Runtime State
# -----------------------------------------------------------------------------

"""
Layer 4: Live operational state polled/streamed from router.
Updated via polling (5-60s interval) or WebSocket push.
"""
type RuntimeState {
  "Whether the resource is currently running/active"
  isRunning: Boolean!

  "Health status of the resource"
  health: RuntimeHealth!

  "Error message if resource is unhealthy"
  errorMessage: String

  "Resource-specific runtime metrics"
  metrics: RuntimeMetrics

  "Last time runtime was updated"
  lastUpdated: DateTime!

  "Time since last successful operation"
  lastSuccessfulOperation: DateTime

  "Current peers/connections (for VPN, etc.)"
  activeConnections: Int

  "Resource uptime"
  uptime: Duration
}

"""
Runtime health status
"""
enum RuntimeHealth {
  "Resource is healthy and operating normally"
  HEALTHY

  "Resource is running but with warnings"
  WARNING

  "Resource is running but degraded"
  DEGRADED

  "Resource has failed"
  FAILED

  "Health status unknown"
  UNKNOWN
}

"""
Resource-specific runtime metrics
"""
type RuntimeMetrics {
  "Bytes received"
  bytesIn: Size

  "Bytes transmitted"
  bytesOut: Size

  "Packets received"
  packetsIn: Int

  "Packets transmitted"
  packetsOut: Int

  "Error count"
  errors: Int

  "Drops count"
  drops: Int

  "Current throughput in (bytes/sec)"
  throughputIn: Size

  "Current throughput out (bytes/sec)"
  throughputOut: Size

  "Resource-specific custom metrics"
  custom: JSON
}

# -----------------------------------------------------------------------------
# Layer 5: Telemetry Data
# -----------------------------------------------------------------------------

"""
Layer 5: Time-series metrics and historical data.
Collected over time for analytics and trending.
"""
type TelemetryData {
  "Bandwidth history (last 24h)"
  bandwidthHistory: [BandwidthDataPoint!]

  "Uptime history (availability)"
  uptimeHistory: [UptimeDataPoint!]

  "Hourly statistics"
  hourlyStats: [HourlyStats!]

  "Daily statistics"
  dailyStats: [DailyStats!]

  "First data point timestamp"
  dataStartedAt: DateTime

  "Last data point timestamp"
  lastUpdatedAt: DateTime

  "Data retention period"
  retentionDays: Int!
}

"""
A bandwidth data point
"""
type BandwidthDataPoint {
  "Timestamp"
  timestamp: DateTime!

  "Bytes in during this period"
  bytesIn: Size!

  "Bytes out during this period"
  bytesOut: Size!

  "Period duration in seconds"
  periodSeconds: Int!
}

"""
An uptime data point
"""
type UptimeDataPoint {
  "Timestamp"
  timestamp: DateTime!

  "Whether resource was up during this period"
  isUp: Boolean!

  "Period duration in seconds"
  periodSeconds: Int!
}

"""
Hourly statistics
"""
type HourlyStats {
  "Hour start timestamp"
  hour: DateTime!

  "Total bytes in"
  totalBytesIn: Size!

  "Total bytes out"
  totalBytesOut: Size!

  "Uptime percentage (0-100)"
  uptimePercent: Float!

  "Error count"
  errorCount: Int!
}

"""
Daily statistics
"""
type DailyStats {
  "Date (UTC)"
  date: DateTime!

  "Total bytes in"
  totalBytesIn: Size!

  "Total bytes out"
  totalBytesOut: Size!

  "Uptime percentage (0-100)"
  uptimePercent: Float!

  "Error count"
  errorCount: Int!

  "Peak throughput in (bytes/sec)"
  peakThroughputIn: Size!

  "Peak throughput out (bytes/sec)"
  peakThroughputOut: Size!
}

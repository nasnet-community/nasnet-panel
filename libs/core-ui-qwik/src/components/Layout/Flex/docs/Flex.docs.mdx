import { Meta, Primary, Controls, Story } from "@storybook/blocks";
import * as FlexStories from "./Flex.stories";

<Meta of={FlexStories} />

# Flex

The Flex component is an advanced layout primitive that provides comprehensive control over flexbox layouts.

## Overview

The Flex component offers a complete API for creating flexible layouts using CSS Flexbox, including:

- Controlling the direction of flex items
- Managing how items wrap
- Aligning items along both main and cross axes
- Distributing space between items
- Creating responsive flex layouts
- Handling RTL layout adjustments

Paired with the FlexItem component, it provides granular control over individual items within the flex container.

## Usage

```tsx
import { Flex, FlexItem } from '@connect/Core/Layout/Flex';

// Basic row layout
<Flex direction="row" gap="md">
  <div>Item 1</div>
  <div>Item 2</div>
  <div>Item 3</div>
</Flex>

// Column layout with item control
<Flex direction="column" gap="md" align="center">
  <FlexItem alignSelf="start">
    <div>Aligned to start</div>
  </FlexItem>
  <div>Centered item</div>
  <FlexItem order={-1}>
    <div>First item (moved to top)</div>
  </FlexItem>
</Flex>

// Responsive flex layout
<Flex
  direction={{ base: 'column', md: 'row' }}
  justify="between"
  gap="md"
>
  <div>Left content</div>
  <div>Center content</div>
  <div>Right content</div>
</Flex>
```

## Examples

### Basic Row Layout

<Primary />

The default Flex layout arranges items in a row.

### Basic Column Layout

<Story of={FlexStories.BasicColumn} />

Set `direction="column"` to stack items vertically.

### Direction Options

<Story of={FlexStories.DirectionExamples} />

The Flex component supports four direction options:

- `row` (default): Items flow horizontally from left to right
- `column`: Items flow vertically from top to bottom
- `row-reverse`: Items flow horizontally from right to left
- `column-reverse`: Items flow vertically from bottom to top

### Responsive Direction

<Story of={FlexStories.ResponsiveDirection} />

You can specify different directions at different breakpoints:

```tsx
<Flex
  direction={{
    base: "column", // Default (mobile)
    md: "row", // Medium screens and up
  }}
>
  {/* Items */}
</Flex>
```

### Wrapping Behavior

<Story of={FlexStories.WrapExamples} />

Control how items behave when they reach the container edge:

- `nowrap` (default): Items will not wrap and may overflow
- `wrap`: Items will wrap to the next line when needed
- `wrap-reverse`: Items wrap but in reverse order

### Justification

<Story of={FlexStories.JustifyContentExamples} />

Justify controls alignment along the main axis:

- `start` (default): Items are packed toward the start
- `center`: Items are centered along the line
- `end`: Items are packed toward the end
- `between`: Items are evenly distributed with the first item at the start and the last at the end
- `around`: Items are evenly distributed with equal space around them
- `evenly`: Items are evenly distributed with equal space between them

### Alignment

<Story of={FlexStories.AlignItemsExamples} />

Align controls positioning along the cross axis:

- `stretch` (default): Items stretch to fill the container
- `start`: Items are placed at the start of the cross axis
- `center`: Items are centered along the cross axis
- `end`: Items are placed at the end of the cross axis
- `baseline`: Items are aligned by their baselines

### Multi-line Alignment

<Story of={FlexStories.AlignContentExamples} />

For multi-line flex containers, use `alignContent` to control how lines are positioned:

- `start`: Lines are packed toward the start
- `center`: Lines are centered in the container
- `end`: Lines are packed toward the end
- `between`: Lines are evenly distributed with the first line at the start and the last at the end
- `around`: Lines are evenly distributed with equal space around them
- `stretch`: Lines stretch to fill the remaining space

### Spacing

<Story of={FlexStories.GapExamples} />

Control the space between flex items:

- Unified gap with the `gap` prop
- Separate row and column gaps with `rowGap` and `columnGap`

### FlexItem Controls

<Story of={FlexStories.FlexItemExamples} />

The FlexItem component provides granular control over individual items:

- `order`: Controls the order of items, regardless of their source order
- `grow`: Determines how much an item can grow relative to other items
- `shrink`: Determines how much an item can shrink relative to other items
- `basis`: Sets the initial main size of the item
- `alignSelf`: Overrides the parent's align-items value for a specific item

All FlexItem props support responsive values to change behavior at different breakpoints.

### Complex Layout Example

<Story of={FlexStories.ComplexLayout} />

This example demonstrates how to create a complex responsive layout combining Flex and FlexItem components with other layout primitives.

## Flex Props

<Controls />

## FlexItem Props

The `FlexItem` component accepts the following props:

| Prop        | Type                                                      | Default | Description                                    |
| ----------- | --------------------------------------------------------- | ------- | ---------------------------------------------- |
| `order`     | `number \| ResponsiveValue<number>`                       | -       | The order of the flex item                     |
| `grow`      | `number \| boolean \| ResponsiveValue<number \| boolean>` | -       | How the item grows relative to others          |
| `shrink`    | `number \| boolean \| ResponsiveValue<number \| boolean>` | -       | How the item shrinks relative to others        |
| `basis`     | `string \| 'auto' \| ResponsiveValue<string \| 'auto'>`   | -       | The initial main size of the item              |
| `alignSelf` | `FlexAlign \| ResponsiveValue<FlexAlign>`                 | -       | Item alignment overriding parent's align value |
| `as`        | `keyof QwikIntrinsicElements`                             | `'div'` | HTML element to render as                      |
| `children`  | `JSXNode \| string`                                       | -       | Content to render inside the item              |
| `class`     | `string`                                                  | -       | Additional CSS classes                         |

## Accessibility

The Flex component follows accessibility best practices:

- Preserves semantic HTML structure
- Uses appropriate HTML elements via the `as` prop
- Supports RTL layouts through automatic direction flipping
- Maintains proper content order for screen readers

## Best Practices

1. **Choose the right layout primitive**: Use Flex when you need precise control over one-dimensional layouts. For two-dimensional layouts, consider using Grid instead.

2. **Consider the source order**: The visual order can differ from the DOM order, which can affect accessibility. Ensure the content has a logical reading order.

3. **Be mindful of responsive behavior**: Test layouts across different screen sizes to ensure they behave as expected. Use responsive values for flex properties to adapt layouts appropriately.

4. **Use FlexItem sparingly**: Apply FlexItem only when you need to control specific items. For general layouts, the Flex component alone is often sufficient.

5. **Combine with other layout components**: For complex layouts, consider using Flex with other layout primitives:
   - Box for individual content containers
   - Stack for simple one-dimensional layouts
   - Grid for two-dimensional layouts
   - Container for width constraints

## Related Components

- **Box**: A foundational layout component for creating containers with consistent styling
- **Stack**: A simplified one-dimensional layout component (ideal for simpler layouts)
- **Grid**: A two-dimensional layout component for creating grid-based layouts
- **Container**: A component for constraining content width and applying consistent page margins

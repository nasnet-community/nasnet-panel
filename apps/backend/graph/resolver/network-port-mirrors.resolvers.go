package resolver

// This file will be automatically regenerated based on the schema, any resolver
// implementations
// will be copied through when generating and any unknown code will be moved to the end.
// Code generated by github.com/99designs/gqlgen version v0.17.86

import (
	"backend/graph/model"
	"backend/internal/apperrors"
	"context"
)

// CreatePortMirror is the resolver for the createPortMirror field.
func (r *mutationResolver) CreatePortMirror(ctx context.Context, routerID string, input model.CreatePortMirrorInput) (*model.PortMirrorMutationResult, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if len(input.SourceInterfaceIds) == 0 {
		return nil, apperrors.NewValidationError("input", nil, "at least one source interface is required")
	}
	if input.DestinationInterfaceID == "" {
		return nil, apperrors.NewValidationError("input", nil, "destination interface is required")
	}

	// Validate source != destination
	for _, src := range input.SourceInterfaceIds {
		if src == input.DestinationInterfaceID {
			return nil, apperrors.NewValidationError("input", nil, "source interface cannot be the same as destination interface")
		}
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService with validated input
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: CreatePortMirror - createPortMirror", "graphql"))
}

// UpdatePortMirror is the resolver for the updatePortMirror field.
func (r *mutationResolver) UpdatePortMirror(ctx context.Context, routerID string, id string, input model.UpdatePortMirrorInput) (*model.PortMirrorMutationResult, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if id == "" {
		return nil, apperrors.NewValidationError("input", nil, "id is required")
	}
	if dstPtr, ok := input.DestinationInterfaceID.ValueOK(); ok && dstPtr != nil && *dstPtr != "" {
		// Validate source != destination if destination is provided
		if srcIDs, ok2 := input.SourceInterfaceIds.ValueOK(); ok2 && len(srcIDs) > 0 {
			for _, src := range srcIDs {
				if src == *dstPtr {
					return nil, apperrors.NewValidationError("input", nil, "source interface cannot be the same as destination interface")
				}
			}
		}
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService with validated input
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: UpdatePortMirror - updatePortMirror", "graphql"))
}

// DeletePortMirror is the resolver for the deletePortMirror field.
func (r *mutationResolver) DeletePortMirror(ctx context.Context, routerID string, id string) (*model.DeleteResult, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if id == "" {
		return nil, apperrors.NewValidationError("input", nil, "id is required")
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService with validated input
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: DeletePortMirror - deletePortMirror", "graphql"))
}

// EnablePortMirror is the resolver for the enablePortMirror field.
func (r *mutationResolver) EnablePortMirror(ctx context.Context, routerID string, id string) (*model.PortMirrorMutationResult, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if id == "" {
		return nil, apperrors.NewValidationError("input", nil, "id is required")
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService with validated input
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: EnablePortMirror - enablePortMirror", "graphql"))
}

// DisablePortMirror is the resolver for the disablePortMirror field.
func (r *mutationResolver) DisablePortMirror(ctx context.Context, routerID string, id string) (*model.PortMirrorMutationResult, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if id == "" {
		return nil, apperrors.NewValidationError("input", nil, "id is required")
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService with validated input
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: DisablePortMirror - disablePortMirror", "graphql"))
}

// PortMirrors is the resolver for the portMirrors field.
func (r *queryResolver) PortMirrors(ctx context.Context, routerID string) ([]*model.PortMirror, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService to fetch port mirrors
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: PortMirrors - portMirrors", "graphql"))
}

// PortMirror is the resolver for the portMirror field.
func (r *queryResolver) PortMirror(ctx context.Context, routerID string, id string) (*model.PortMirror, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}
	if id == "" {
		return nil, apperrors.NewValidationError("input", nil, "id is required")
	}

	// Service availability check
	if r.InterfaceService == nil {
		return nil, apperrors.NewProtocolError(apperrors.CodeCommandFailed, "interface service not configured", "graphql")
	}

	// TODO: Call r.InterfaceService to fetch port mirror by ID
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: PortMirror - portMirror", "graphql"))
}

// PortMirrorChanged is the resolver for the portMirrorChanged field.
func (r *subscriptionResolver) PortMirrorChanged(ctx context.Context, routerID string) (<-chan *model.PortMirror, error) {
	// Authorization check
	if _, ok := ctx.Value(contextKeyUserID).(string); !ok {
		return nil, apperrors.NewValidationError("input", nil, "unauthorized: authentication required")
	}

	// Input validation
	if routerID == "" {
		return nil, apperrors.NewValidationError("input", nil, "routerID is required")
	}

	// Create channel for port mirror change events
	mirrorChan := make(chan *model.PortMirror, 10)

	// Start goroutine to handle subscription
	go func() {
		defer close(mirrorChan)
		<-ctx.Done()
	}()

	// TODO: Subscribe to port mirror changes and send to mirrorChan
	panic(apperrors.NewProtocolError(apperrors.CodeCommandFailed, "not implemented: PortMirrorChanged - portMirrorChanged", "graphql"))
}

<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-backend docs-version-current docs-doc-page docs-doc-id-config-generation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Config Generation | NasNet Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nasnet.dev/docs/backend/config-generation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-backend-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-backend-current"><meta data-rh="true" property="og:title" content="Config Generation | NasNet Docs"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://nasnet.dev/docs/backend/config-generation"><link data-rh="true" rel="alternate" href="https://nasnet.dev/docs/backend/config-generation" hreflang="en"><link data-rh="true" rel="alternate" href="https://nasnet.dev/docs/backend/config-generation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Config Generation","item":"https://nasnet.dev/docs/backend/config-generation"}]}</script><link rel="stylesheet" href="/assets/css/styles.82d9e831.css">
<script src="/assets/js/runtime~main.ca82720f.js" defer="defer"></script>
<script src="/assets/js/main.ffff147f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/hero-logo.jpg" alt="NasNet Logo" class="themedComponent_DHUr themedComponent--light_DIHH" style="border-radius:6px"><img src="/img/hero-logo.jpg" alt="NasNet Logo" class="themedComponent_DHUr themedComponent--dark_Bv2M" style="border-radius:6px"></div><b class="navbar__title text--truncate">NasNet Docs</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apps</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/frontend/intro">Frontend (Connect)</a></li><li><a class="dropdown__link" href="/docs/backend/intro">Backend (Go)</a></li><li><a class="dropdown__link" href="/docs/testing/intro">E2E Testing</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Libraries</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/ui/intro">UI Components</a></li><li><a class="dropdown__link" href="/docs/features/intro">Feature Modules</a></li><li><a class="dropdown__link" href="/docs/api-client/intro">API Client</a></li><li><a class="dropdown__link" href="/docs/state/intro">State Management</a></li><li><a class="dropdown__link" href="/docs/core/intro">Core Types</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Components</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/storybook/primitives/">UI Primitives</a></li><li><a class="dropdown__link" href="/storybook/patterns/">UI Patterns</a></li><li><a class="dropdown__link" href="/storybook/connect/">Connect App</a></li></ul></div><a class="navbar__item navbar__link" href="/api">API Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/nasnet-community/nasnet-panel/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Changelog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/nx-graph/">Nx Graph</a><a href="https://github.com/nasnet-community/nasnet-panel" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"><div class="navbar__search searchBarContainer_YZIh" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_eCKk" value=""><div class="loadingRing_pJhT searchBarLoadingRing_NsvA"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/intro"><span title="Introduction" class="linkLabel_PuAu">Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/alert-system"><span title="Alert System" class="linkLabel_PuAu">Alert System</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/application-bootstrap"><span title="Application Bootstrap" class="linkLabel_PuAu">Application Bootstrap</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/build-and-deploy"><span title="Build and Deploy" class="linkLabel_PuAu">Build and Deploy</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/backend/config-generation"><span title="Config Generation" class="linkLabel_PuAu">Config Generation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/connection-management"><span title="Connection Management" class="linkLabel_PuAu">Connection Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/data-layer"><span title="Data Layer" class="linkLabel_PuAu">Data Layer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/error-handling"><span title="Error Handling &amp; Structured Logging" class="linkLabel_PuAu">Error Handling &amp; Structured Logging</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/event-system"><span title="Event System" class="linkLabel_PuAu">Event System</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/feature-marketplace"><span title="Feature Marketplace" class="linkLabel_PuAu">Feature Marketplace</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/backend/flows/alert-lifecycle-flow"><span title="flows" class="categoryLinkLabel_Oe72">flows</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/getting-started"><span title="Getting Started" class="linkLabel_PuAu">Getting Started</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/graphql-api"><span title="GraphQL API Layer" class="linkLabel_PuAu">GraphQL API Layer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/"><span title="NasNet Backend — Master Index" class="linkLabel_PuAu">NasNet Backend — Master Index</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/network-services"><span title="Network Services" class="linkLabel_PuAu">Network Services</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/process-isolation"><span title="Process Isolation" class="linkLabel_PuAu">Process Isolation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/provisioning-engine"><span title="Provisioning Engine" class="linkLabel_PuAu">Provisioning Engine</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/router-communication"><span title="Router Communication" class="linkLabel_PuAu">Router Communication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/router-services"><span title="Router Services" class="linkLabel_PuAu">Router Services</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/security"><span title="Security" class="linkLabel_PuAu">Security</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/service-orchestrator"><span title="Service Orchestrator" class="linkLabel_PuAu">Service Orchestrator</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/translator-layer"><span title="Translator Layer" class="linkLabel_PuAu">Translator Layer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/validation-pipeline"><span title="Validation Pipeline" class="linkLabel_PuAu">Validation Pipeline</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend/virtual-interface-factory"><span title="Virtual Interface Factory (VIF)" class="linkLabel_PuAu">Virtual Interface Factory (VIF)</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Config Generation</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Config Generation</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>The config generation subsystem produces service-specific configuration files for each downloadable feature (Tor, sing-box, Xray-core, MTProxy, Psiphon, AdGuard Home). It follows a <strong>strategy pattern</strong>: a common <code>Generator</code> interface, a shared <code>BaseGenerator</code> with template/JSON rendering, and per-service concrete generators that embed <code>BaseGenerator</code> and add service-specific logic.</p>
<p>A thread-safe <code>Registry</code> acts as the central lookup table, mapping service type strings to their generators. The orchestrator&#x27;s lifecycle installer calls <code>Registry.Generate</code> when provisioning a new service instance.</p>
<p>All generators enforce a critical invariant: every service must bind to a specific VLAN IP address — <code>0.0.0.0</code> and loopback addresses are rejected by the shared <code>ValidateBindIP</code> validator.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="architecture">Architecture<a href="#architecture" class="hash-link" aria-label="Direct link to Architecture" title="Direct link to Architecture" translate="no">​</a></h2>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ┌──────────────────────────────────┐</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │          Registry                │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  map[serviceType]Generator       │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  sync.RWMutex (thread-safe)      │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    └───────────────┬──────────────────┘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    │ Get / Generate / Validate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    ▼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ┌──────────────────────────────────┐</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │       Generator (interface)       │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  Generate(id, config, bindIP)     │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  Validate(config, bindIP)         │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  GetSchema() *Schema              │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  GetConfigFileName() string       │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  GetConfigFormat() string         │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    └───────────────┬──────────────────┘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    │ embedded by</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ┌───────────────▼──────────────────┐</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │         BaseGenerator             │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  serviceType, *Schema, *Template  │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  RenderTemplate(data) []byte      │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  RenderJSON(v) []byte             │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    │  ValidateConfig(config, bindIP)   │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    └───┬─────┬──────┬────┬────┬───┬───┘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        │     │      │    │    │   │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ┌───────────┘     │      │    │    │   └──────────────┐</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ▼                 ▼      ▼    ▼    ▼                  ▼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     TorGenerator   SingboxGen XrayGen MTProxy Psiphon     AdguardGen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     (torrc/text)  (json)     (json)  (json)  (json)      (yaml/text)</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">TemplateData (passed to RenderTemplate)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .InstanceID   string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .BindIP       string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .Config       map[string]interface{}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .GetString(key)    → string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .GetInt(key)       → int</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .GetBool(key)      → bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .GetStringSlice(key) → []string  (AdGuard extension)</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ServiceType  string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Version      string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Fields       []Field</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .Name, .Type, .Required, .Default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .Min, .Max (int pointers)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .EnumValues []string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .Sensitive  bool        ← masked in logs/API</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .Placeholder string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  MergeWithDefaults(config) map[string]interface{}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Validate(config, bindIP) error</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="package-reference">Package Reference<a href="#package-reference" class="hash-link" aria-label="Direct link to Package Reference" title="Direct link to Package Reference" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="internalconfig--core-types"><code>internal/config</code> — Core Types<a href="#internalconfig--core-types" class="hash-link" aria-label="Direct link to internalconfig--core-types" title="Direct link to internalconfig--core-types" translate="no">​</a></h3>
<p><strong><code>generator.go</code></strong></p>
<div class="language-go codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-go codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Generator is the strategy interface every service generator implements.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> Generator </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">Generate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">instanceID </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">Validate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">GetSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">Schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">GetConfigFileName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">GetConfigFormat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// &quot;text&quot; | &quot;json&quot; | &quot;yaml&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// BaseGenerator provides shared rendering and validation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> BaseGenerator </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Schema      </span><span class="token operator">*</span><span class="token plain">Schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tmpl        </span><span class="token operator">*</span><span class="token plain">template</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Template  </span><span class="token comment" style="color:rgb(98, 114, 164)">// nil for JSON generators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g </span><span class="token operator">*</span><span class="token plain">BaseGenerator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">RenderTemplate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data </span><span class="token operator">*</span><span class="token plain">TemplateData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g </span><span class="token operator">*</span><span class="token plain">BaseGenerator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">RenderJSON</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">v </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)">// json.MarshalIndent, 2-space</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g </span><span class="token operator">*</span><span class="token plain">BaseGenerator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ValidateConfig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g </span><span class="token operator">*</span><span class="token plain">BaseGenerator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GetSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">Schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// TemplateData is passed into text/template execution.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> TemplateData </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    InstanceID </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    BindIP     </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Config     </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">NewTemplateData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">instanceID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">TemplateData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">d </span><span class="token operator">*</span><span class="token plain">TemplateData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GetString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">key </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">d </span><span class="token operator">*</span><span class="token plain">TemplateData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GetInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">key </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">d </span><span class="token operator">*</span><span class="token plain">TemplateData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GetBool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">key </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><br></span></code></pre></div></div>
<p><strong><code>registry.go</code></strong></p>
<div class="language-go codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-go codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Registry is the central thread-safe store of all registered generators.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> Registry </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mu         sync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">RWMutex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    generators </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">Generator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">NewRegistry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">Registry</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">Register</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> gen Generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">Get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">Has</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">List</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">Generate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> instanceID </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token builtin" style="color:rgb(189, 147, 249)">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">Validate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bindIP </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">*</span><span class="token plain">Registry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GetSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">serviceType </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token plain">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p><strong><code>validators.go</code></strong> — shared field-level validators</p>
<table><thead><tr><th>Function</th><th>Validates</th></tr></thead><tbody><tr><td><code>ValidateBindIP(ip)</code></td><td>Non-empty, parseable, not 0.0.0.0/::, not loopback</td></tr><tr><td><code>ValidatePort(port)</code></td><td>1–65535</td></tr><tr><td><code>ValidatePortString(s)</code></td><td>String form of port, same range</td></tr><tr><td><code>ValidateNonEmpty(name, val)</code></td><td>Non-empty string</td></tr><tr><td><code>ValidateEnum(name, val, allowed)</code></td><td>Value in allowed list</td></tr><tr><td><code>ValidateRange(name, val, min, max)</code></td><td>Numeric within bounds</td></tr><tr><td><code>ValidatePositive(name, val)</code></td><td>val &gt; 0</td></tr><tr><td><code>ValidateDNSName(name)</code></td><td>Non-empty, basic DNS rules</td></tr><tr><td><code>ValidateURL(url)</code></td><td>Must start with <code>http://</code> or <code>https://</code></td></tr><tr><td><code>ValidateEmail(email)</code></td><td>Must contain <code>@</code></td></tr><tr><td><code>ValidateStringLength(name, val, max)</code></td><td>len(val) ≤ max</td></tr><tr><td><code>ValidateIPCIDR(cidr)</code></td><td>Parseable CIDR</td></tr><tr><td><code>ValidateIPRange(start, end)</code></td><td>Both parseable IPs, start ≤ end</td></tr></tbody></table>
<p><code>ValidateBindIP</code> is the <strong>VLAN isolation enforcement gate</strong> — it prevents services from listening on the host network (0.0.0.0) or loopback, ensuring each instance is confined to its allocated VLAN interface.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="internalconfigservices--concrete-generators"><code>internal/config/services</code> — Concrete Generators<a href="#internalconfigservices--concrete-generators" class="hash-link" aria-label="Direct link to internalconfigservices--concrete-generators" title="Direct link to internalconfigservices--concrete-generators" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="tor-torgo">Tor (<code>tor.go</code>)<a href="#tor-torgo" class="hash-link" aria-label="Direct link to tor-torgo" title="Direct link to tor-torgo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>torrc</code></td></tr><tr><td>Format</td><td>text/template</td></tr><tr><td>Constructor</td><td><code>NewTorGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>nickname</code></td><td>string</td><td><code>MyTorRelay</code></td><td>Alphanumeric, ≤19 chars</td></tr><tr><td><code>contact_info</code></td><td>string</td><td><code>admin@example.com</code></td><td>Must be valid email</td></tr><tr><td><code>relay_type</code></td><td>enum</td><td><code>relay</code></td><td><code>relay</code> | <code>bridge</code> | <code>exit</code></td></tr><tr><td><code>socks_port</code></td><td>port</td><td>9050</td><td>SOCKS proxy</td></tr><tr><td><code>control_port</code></td><td>port</td><td>9051</td><td>Controller</td></tr><tr><td><code>or_port</code></td><td>port</td><td>9001</td><td>Onion Router port</td></tr><tr><td><code>dir_port</code></td><td>port</td><td>9030</td><td>Directory (optional)</td></tr><tr><td><code>bandwidth_rate</code></td><td>int</td><td>1000</td><td>KB/s, 100–102400</td></tr><tr><td><code>bandwidth_burst</code></td><td>int</td><td>2000</td><td>KB/s, 100–204800</td></tr><tr><td><code>exit_policy</code></td><td>string</td><td><code>reject *:*</code></td><td>Required when relay_type=exit</td></tr></tbody></table>
<p><strong>Custom validation:</strong></p>
<ul>
<li class=""><code>nickname</code> ≤ 19 characters</li>
<li class=""><code>contact_info</code> passes <code>ValidateEmail</code></li>
<li class=""><code>exit_policy</code> field must be present when <code>relay_type == &quot;exit&quot;</code></li>
</ul>
<p><strong>Template conditional blocks:</strong> <code>{{if eq (.GetString &quot;relay_type&quot;) &quot;relay&quot;}}</code> / <code>&quot;bridge&quot;</code> / <code>&quot;exit&quot;</code> — controls which ORPort, DirPort, and ExitPolicy directives appear.</p>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="sing-box-singboxgo">sing-box (<code>singbox.go</code>)<a href="#sing-box-singboxgo" class="hash-link" aria-label="Direct link to sing-box-singboxgo" title="Direct link to sing-box-singboxgo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>config.json</code></td></tr><tr><td>Format</td><td>json (programmatic)</td></tr><tr><td>Constructor</td><td><code>NewSingboxGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>listen_address</code></td><td>ip</td><td>—</td><td>Defaults to <code>bindIP</code> if absent</td></tr><tr><td><code>socks_port</code></td><td>port</td><td>10808</td><td>SOCKS5 inbound</td></tr><tr><td><code>http_port</code></td><td>port</td><td>10809</td><td>HTTP inbound</td></tr><tr><td><code>mixed_port</code></td><td>port</td><td>—</td><td>Optional mixed SOCKS/HTTP</td></tr><tr><td><code>log_level</code></td><td>enum</td><td><code>info</code></td><td>trace/debug/info/warn/error/fatal/panic</td></tr><tr><td><code>dns_server</code></td><td>string</td><td><code>1.1.1.1</code></td><td>DNS resolver</td></tr><tr><td><code>sniff_enabled</code></td><td>bool</td><td>true</td><td>Traffic sniffing</td></tr></tbody></table>
<p><strong>JSON structure produced:</strong></p>
<div class="language-json codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-json codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;log&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;info&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;dns&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;servers&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1.1.1.1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;socks&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;socks-in&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;listen&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;bindIP&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10808</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;sniff&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http-in&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token property">&quot;listen&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;bindIP&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10809</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;sniff&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// + optional mixed inbound if mixed_port &gt; 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;direct&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;direct&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<p><code>getIntValue</code> helper handles both <code>int</code> and <code>float64</code> (JSON unmarshal produces float64).</p>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="xray-core-xraygo">Xray-core (<code>xray.go</code>)<a href="#xray-core-xraygo" class="hash-link" aria-label="Direct link to xray-core-xraygo" title="Direct link to xray-core-xraygo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>config.json</code></td></tr><tr><td>Format</td><td>json (programmatic)</td></tr><tr><td>Constructor</td><td><code>NewXrayGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>protocol</code></td><td>enum</td><td><code>vless</code></td><td>vless/vmess/trojan/shadowsocks</td></tr><tr><td><code>port</code></td><td>port</td><td>10443</td><td>Inbound listen port</td></tr><tr><td><code>uuid</code></td><td>string</td><td>—</td><td>Required, 36-char UUID</td></tr><tr><td><code>tls_enabled</code></td><td>bool</td><td>false</td><td>Enable TLS on inbound</td></tr><tr><td><code>tls_cert_path</code></td><td>string</td><td>—</td><td>Required when tls_enabled=true</td></tr><tr><td><code>tls_key_path</code></td><td>string</td><td>—</td><td>Required when tls_enabled=true</td></tr><tr><td><code>fallback_port</code></td><td>port</td><td>—</td><td>Optional fallback destination</td></tr><tr><td><code>log_level</code></td><td>enum</td><td><code>warning</code></td><td>debug/info/warning/error/none</td></tr></tbody></table>
<p><strong>Custom validation:</strong></p>
<ul>
<li class=""><code>uuid</code> must be exactly 36 characters</li>
<li class="">When <code>tls_enabled=true</code>: both <code>tls_cert_path</code> and <code>tls_key_path</code> must be non-empty</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="mtproxy-mtproxygo">MTProxy (<code>mtproxy.go</code>)<a href="#mtproxy-mtproxygo" class="hash-link" aria-label="Direct link to mtproxy-mtproxygo" title="Direct link to mtproxy-mtproxygo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>config.json</code></td></tr><tr><td>Format</td><td>json (CLI args representation)</td></tr><tr><td>Constructor</td><td><code>NewMTProxyGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>port</code></td><td>port</td><td>8443</td><td>Proxy listen port</td></tr><tr><td><code>secret</code></td><td>string</td><td>—</td><td>Required, 32-char hex (Sensitive)</td></tr><tr><td><code>tag</code></td><td>string</td><td>—</td><td>Optional Telegram proxy tag</td></tr><tr><td><code>workers</code></td><td>int</td><td>2</td><td>Worker goroutines</td></tr><tr><td><code>max_connections</code></td><td>int</td><td>60000</td><td>Max concurrent connections</td></tr><tr><td><code>stats_port</code></td><td>port</td><td>—</td><td>Optional stats HTTP port</td></tr></tbody></table>
<p><strong>Custom validation:</strong></p>
<ul>
<li class=""><code>secret</code> must be exactly 32 characters matching <code>[0-9a-fA-F]</code></li>
</ul>
<p>The JSON output represents CLI arguments (bind_ip, port, secret, workers, etc.) that the MTProxy process reads on startup.</p>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="psiphon-psiphongo">Psiphon (<code>psiphon.go</code>)<a href="#psiphon-psiphongo" class="hash-link" aria-label="Direct link to psiphon-psiphongo" title="Direct link to psiphon-psiphongo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>config.json</code></td></tr><tr><td>Format</td><td>json (programmatic)</td></tr><tr><td>Constructor</td><td><code>NewPsiphonGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>socks_port</code></td><td>port</td><td>1080</td><td>SOCKS proxy port</td></tr><tr><td><code>http_port</code></td><td>port</td><td>8080</td><td>HTTP proxy port</td></tr><tr><td><code>server_entry_signature_public_key</code></td><td>string</td><td>—</td><td>Optional, Sensitive</td></tr><tr><td><code>server_entry_tags</code></td><td>string</td><td><code>&quot;&quot;</code></td><td>Comma-separated tags</td></tr><tr><td><code>sponsor_id</code></td><td>string</td><td><code>00000000...</code></td><td>32-char hex if custom</td></tr><tr><td><code>propagation_channel_id</code></td><td>string</td><td><code>00000000...</code></td><td>32-char hex if custom</td></tr><tr><td><code>enable_split_tunnel</code></td><td>bool</td><td>false</td><td>Split tunneling</td></tr><tr><td><code>upstream_proxy_url</code></td><td>string</td><td>—</td><td>Optional upstream proxy</td></tr><tr><td><code>log_level</code></td><td>enum</td><td><code>info</code></td><td>debug/info/warning/error</td></tr></tbody></table>
<p><strong>Custom validation:</strong></p>
<ul>
<li class="">Custom <code>sponsor_id</code> (non-default): must be exactly 32 chars</li>
<li class="">Custom <code>propagation_channel_id</code>: must be exactly 32 chars</li>
<li class=""><code>upstream_proxy_url</code> if set: must pass <code>ValidateURL</code></li>
</ul>
<p><code>splitCommaSeparated</code> helper converts comma-separated <code>server_entry_tags</code> string to <code>[]string</code> for the Psiphon JSON.</p>
<h4 class="anchor anchorTargetStickyNavbar_SAay" id="adguard-home-adguardgo">AdGuard Home (<code>adguard.go</code>)<a href="#adguard-home-adguardgo" class="hash-link" aria-label="Direct link to adguard-home-adguardgo" title="Direct link to adguard-home-adguardgo" translate="no">​</a></h4>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Output file</td><td><code>AdGuardHome.yaml</code></td></tr><tr><td>Format</td><td>YAML (text/template)</td></tr><tr><td>Constructor</td><td><code>NewAdguardGenerator()</code></td></tr></tbody></table>
<p><strong>Config fields:</strong></p>
<table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td><code>web_port</code></td><td>port</td><td>3000</td><td>Web UI port</td></tr><tr><td><code>dns_port</code></td><td>port</td><td>53</td><td>DNS listen port</td></tr><tr><td><code>admin_user</code></td><td>string</td><td><code>admin</code></td><td>Admin username</td></tr><tr><td><code>admin_password</code></td><td>string</td><td>—</td><td>Required, Sensitive</td></tr><tr><td><code>upstream_dns</code></td><td>string</td><td><code>1.1.1.1,8.8.8.8</code></td><td>CSV of upstream resolvers</td></tr><tr><td><code>bootstrap_dns</code></td><td>string</td><td><code>1.1.1.1,8.8.8.8</code></td><td>CSV for bootstrapping DoH/DoT</td></tr><tr><td><code>protection_enabled</code></td><td>bool</td><td>true</td><td>DNS protection toggle</td></tr><tr><td><code>blocking_mode</code></td><td>enum</td><td><code>default</code></td><td>default/nxdomain/null_ip/refused</td></tr><tr><td><code>querylog_enabled</code></td><td>bool</td><td>true</td><td>Query log toggle</td></tr><tr><td><code>querylog_interval</code></td><td>string</td><td><code>24h</code></td><td>Retention duration</td></tr><tr><td><code>statistics_enabled</code></td><td>bool</td><td>true</td><td>Stats collection</td></tr><tr><td><code>statistics_interval</code></td><td>string</td><td><code>24h</code></td><td>Stats retention</td></tr></tbody></table>
<p><code>AdguardTemplateData</code> extends <code>TemplateData</code> and adds <code>GetStringSlice(key)</code> which splits CSV config values (like <code>upstream_dns</code>) into <code>[]string</code> for YAML list rendering.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="generator-lifecycle-provisioning-flow">Generator Lifecycle (Provisioning Flow)<a href="#generator-lifecycle-provisioning-flow" class="hash-link" aria-label="Direct link to Generator Lifecycle (Provisioning Flow)" title="Direct link to Generator Lifecycle (Provisioning Flow)" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">LifecycleInstaller.Install()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├─ registry.Get(serviceType)          → Generator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├─ generator.Validate(config, bindIP) → error (pre-install check)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├─ generator.Generate(id, config, ip) → []byte (rendered config)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├─ write file to instanceDir/configFileName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    └─ generator.GetConfigFileName()      → used to set file path</span><br></span></code></pre></div></div>
<p>The orchestrator calls <code>Validate</code> before generating to surface config errors early. If <code>Generate</code> succeeds, the output bytes are written directly to the service&#x27;s working directory. The file name is determined by <code>GetConfigFileName()</code> (e.g., <code>torrc</code>, <code>config.json</code>, <code>AdGuardHome.yaml</code>).</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="cross-references">Cross-References<a href="#cross-references" class="hash-link" aria-label="Direct link to Cross-References" title="Direct link to Cross-References" translate="no">​</a></h2>
<ul>
<li class="">[See: network-services.md §Service Lifecycle] — how generators are invoked during install</li>
<li class="">[See: process-isolation.md §Layer 1: IP Binding] — ValidateBindIP enforcement at pre-start</li>
<li class="">[See: feature-marketplace.md §Manifests] — how schema fields are declared in JSON manifests</li>
<li class="">[See: router-services.md §Port Allocation] — port conflict avoidance before generation</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/nasnet-community/nasnet-panel/tree/main/../backend/docs/config-generation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/backend/build-and-deploy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Build and Deploy</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/backend/connection-management"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connection Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#package-reference" class="table-of-contents__link toc-highlight">Package Reference</a><ul><li><a href="#internalconfig--core-types" class="table-of-contents__link toc-highlight"><code>internal/config</code> — Core Types</a></li><li><a href="#internalconfigservices--concrete-generators" class="table-of-contents__link toc-highlight"><code>internal/config/services</code> — Concrete Generators</a></li><li><a href="#generator-lifecycle-provisioning-flow" class="table-of-contents__link toc-highlight">Generator Lifecycle (Provisioning Flow)</a></li></ul></li><li><a href="#cross-references" class="table-of-contents__link toc-highlight">Cross-References</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Apps</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/frontend/intro">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/backend/intro">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/testing/intro">E2E Testing</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Libraries</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/ui/intro">UI Components</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features/intro">Feature Modules</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api-client/intro">API Client</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/state/intro">State Management</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/core/intro">Core Types</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">API</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/api">Schema Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/category/queries">Queries</a></li><li class="footer__item"><a class="footer__link-item" href="/category/mutations">Mutations</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/nasnet-community/nasnet-panel" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/storybook/primitives/">Storybook (Primitives)</a></li><li class="footer__item"><a class="footer__link-item" href="/storybook/patterns/">Storybook (Patterns)</a></li><li class="footer__item"><a class="footer__link-item" href="/nx-graph/">Nx Graph</a></li><li class="footer__item"><a href="https://github.com/nasnet-community/nasnet-panel/tree/main/Docs/architecture" target="_blank" rel="noopener noreferrer" class="footer__link-item">Architecture<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2026 NasNet · Built with Docusaurus</div></div></div></footer></div>
</body>
</html>
"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[17779],{12464:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"performance","title":"Performance","description":"This guide covers selector patterns, memoization strategies, and best practices for preventing unnecessary re-renders when consuming Zustand stores.","source":"@site/../../libs/state/docs/performance.md","sourceDirName":".","slug":"/performance","permalink":"/docs/state/performance","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/state/docs/performance.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Performance"},"sidebar":"sidebar","previous":{"title":"Persistence","permalink":"/docs/state/persistence"},"next":{"title":"Testing Strategy","permalink":"/docs/state/guides/testing"}}');var r=n(31085),i=n(71184);const o={sidebar_position:4,title:"Performance"},c="Performance & Optimization",l={},a=[{value:"The Re-render Problem",id:"the-re-render-problem",level:2},{value:"Selector Patterns: Optimized Re-renders",id:"selector-patterns-optimized-re-renders",level:2},{value:"Pattern 1: Primitive Selector (Single Value)",id:"pattern-1-primitive-selector-single-value",level:3},{value:"Pattern 2: Shallow Comparison (Multiple Fields)",id:"pattern-2-shallow-comparison-multiple-fields",level:3},{value:"Pattern 3: Memoized Selector (Computed Values)",id:"pattern-3-memoized-selector-computed-values",level:3},{value:"Pattern 4: Parameterized Selector (ID-based Lookups)",id:"pattern-4-parameterized-selector-id-based-lookups",level:3},{value:"Pattern 5: Combined Selector (Multiple Unrelated Fields)",id:"pattern-5-combined-selector-multiple-unrelated-fields",level:3},{value:"Pre-built Selectors",id:"pre-built-selectors",level:2},{value:"Auth Store Selectors",id:"auth-store-selectors",level:3},{value:"Theme Store Selectors",id:"theme-store-selectors",level:3},{value:"Sidebar Store Selectors",id:"sidebar-store-selectors",level:3},{value:"Notification Store Selectors",id:"notification-store-selectors",level:3},{value:"Re-render Prevention Strategies",id:"re-render-prevention-strategies",level:2},{value:"Strategy 1: Use Selectors (Primary)",id:"strategy-1-use-selectors-primary",level:3},{value:"Strategy 2: useMemo for Selector Functions",id:"strategy-2-usememo-for-selector-functions",level:3},{value:"Strategy 3: Extract to Component",id:"strategy-3-extract-to-component",level:3},{value:"Strategy 4: useCallback for Handlers",id:"strategy-4-usecallback-for-handlers",level:3},{value:"Anti-patterns to Avoid",id:"anti-patterns-to-avoid",level:2},{value:"Performance Best Practices",id:"performance-best-practices",level:2},{value:"1. Use React DevTools Profiler",id:"1-use-react-devtools-profiler",level:3},{value:"2. Use Zustand DevTools for Store Changes",id:"2-use-zustand-devtools-for-store-changes",level:3},{value:"3. Use shallowEqual for Object Selectors",id:"3-use-shallowequal-for-object-selectors",level:3},{value:"4. Avoid Expensive Computations in Selectors",id:"4-avoid-expensive-computations-in-selectors",level:3},{value:"5. Prefer Primitive Selectors",id:"5-prefer-primitive-selectors",level:3},{value:"Performance Checklist",id:"performance-checklist",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"performance--optimization",children:"Performance & Optimization"})}),"\n",(0,r.jsx)(t.p,{children:"This guide covers selector patterns, memoization strategies, and best practices for preventing unnecessary re-renders when consuming Zustand stores."}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Deep Dive:"})," For complete API documentation on all selector utilities (",(0,r.jsx)(t.code,{children:"createMemoizedSelector"}),", ",(0,r.jsx)(t.code,{children:"createParameterizedSelector"}),", ",(0,r.jsx)(t.code,{children:"createCombinedSelector"}),", ",(0,r.jsx)(t.code,{children:"shallowEqual"}),"), pre-built selector catalog, and advanced patterns, see the ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.a,{href:"/docs/state/stores/selectors-reference",children:"Selectors Reference"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"the-re-render-problem",children:"The Re-render Problem"}),"\n",(0,r.jsxs)(t.p,{children:["Without selectors, ",(0,r.jsx)(t.strong,{children:"every component subscribes to the entire store"})," and re-renders whenever ANY property changes:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u274c BAD: Component re-renders on ANY store mutation\nfunction UserProfile() {\n  // Subscribe to entire store\n  const { user, token, isRefreshing, refreshAttempts } = useAuthStore();\n\n  // Component re-renders if:\n  // - user changes \u2713\n  // - token changes \u2713\n  // - isRefreshing changes \u2713\n  // - refreshAttempts changes \u2713\n  // - ANY mutation to auth store \u2717\u2717\u2717\n\n  return <div>{user?.username}</div>;\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["When auth store updates ",(0,r.jsx)(t.code,{children:"isRefreshing: false"})," \u2192 ",(0,r.jsx)(t.code,{children:"true"}),", this component re-renders ",(0,r.jsxs)(t.strong,{children:["even though ",(0,r.jsx)(t.code,{children:"user"})," didn't change"]}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"selector-patterns-optimized-re-renders",children:"Selector Patterns: Optimized Re-renders"}),"\n",(0,r.jsx)(t.h3,{id:"pattern-1-primitive-selector-single-value",children:"Pattern 1: Primitive Selector (Single Value)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Best for:"})," Simple fields you care about"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u2705 BEST: Only re-renders when isAuthenticated changes\nfunction LoginButton() {\n  const isAuthenticated = useAuthStore(state => state.isAuthenticated);\n  return <button>{isAuthenticated ? 'Logout' : 'Login'}</button>;\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Why it works:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Zustand compares the selected value using strict equality (",(0,r.jsx)(t.code,{children:"==="}),")"]}),"\n",(0,r.jsxs)(t.li,{children:["If ",(0,r.jsx)(t.code,{children:"isAuthenticated"})," doesn't change, selector returns same value"]}),"\n",(0,r.jsx)(t.li,{children:"Component doesn't re-render"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Performance:"})," Nearly zero overhead, Zustand optimizes this internally"]}),"\n",(0,r.jsx)(t.h3,{id:"pattern-2-shallow-comparison-multiple-fields",children:"Pattern 2: Shallow Comparison (Multiple Fields)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Best for:"})," Multiple unrelated fields"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import { shallow } from 'zustand/shallow';\n\n// \u2705 GOOD: Only re-renders when user OR token changes\nfunction UserProfile() {\n  const { user, token } = useAuthStore(\n    state => ({ user: state.user, token: state.token }),\n    shallow  // Shallow comparison\n  );\n\n  return <div>{user?.username}</div>;\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Why it works:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Selector returns a new object ",(0,r.jsx)(t.code,{children:"{ user, token }"})," on every call"]}),"\n",(0,r.jsx)(t.li,{children:"Without shallow comparison, this would cause re-render (new object != old object)"}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"shallow"})," compares properties: ",(0,r.jsx)(t.code,{children:"prev.user === next.user && prev.token === next.token"})]}),"\n",(0,r.jsx)(t.li,{children:"Only re-renders if actual values changed"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"When to use:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Selecting 2-3 fields max"}),"\n",(0,r.jsx)(t.li,{children:"Fields are frequently accessed together"}),"\n",(0,r.jsx)(t.li,{children:"Don't want to create a reusable selector"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"When NOT to use:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["More than 3 fields (use ",(0,r.jsx)(t.code,{children:"createCombinedSelector"})," instead)"]}),"\n",(0,r.jsxs)(t.li,{children:["Same field selection repeated in multiple components (use ",(0,r.jsx)(t.code,{children:"createMemoizedSelector"}),")"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"pattern-3-memoized-selector-computed-values",children:"Pattern 3: Memoized Selector (Computed Values)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Best for:"})," Expensive computations, derived values, repeated selectors"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import { createMemoizedSelector } from '@nasnet/state/stores';\n\n// Create memoized selector (computed once per dependency change)\nconst selectUIPreferencesMemoized = createMemoizedSelector(\n  (state: UIState) => [\n    state.compactMode,\n    state.animationsEnabled,\n    state.defaultNotificationDuration,\n  ] as const,\n  ([compactMode, animationsEnabled, duration]) => ({\n    compactMode,\n    animationsEnabled,\n    duration,\n  })\n);\n\nfunction SettingsPanel() {\n  // Selector only recomputes when deps change\n  const prefs = useUIStore(selectUIPreferencesMemoized);\n\n  return (\n    <div>\n      Compact: {prefs.compactMode}\n      Animations: {prefs.animationsEnabled}\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Implementation detail:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"export function createMemoizedSelector<State, Deps extends unknown[], Result>(\n  getDeps: (state: State) => Deps,\n  compute: (deps: Deps) => Result\n): (state: State) => Result {\n  let cachedDeps: Deps | null = null;\n  let cachedResult: Result;\n\n  return (state: State): Result => {\n    const deps = getDeps(state);\n\n    // Check if deps changed (shallow comparison)\n    const depsChanged =\n      cachedDeps === null ||\n      deps.length !== cachedDeps.length ||\n      deps.some((dep, i) => !Object.is(dep, cachedDeps![i]));\n\n    if (depsChanged) {\n      cachedDeps = deps;\n      cachedResult = compute(deps);  // Recompute only if deps changed\n    }\n\n    return cachedResult;\n  };\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"When to use:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Selector is used in multiple components"}),"\n",(0,r.jsx)(t.li,{children:"Computation is expensive (filtering, sorting, aggregation)"}),"\n",(0,r.jsx)(t.li,{children:"Dependencies change infrequently"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Performance gains:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"First component: Same cost as non-memoized"}),"\n",(0,r.jsx)(t.li,{children:"Second component with same selector: Cache hit, zero computation"}),"\n",(0,r.jsx)(t.li,{children:"Prevents 3 components from redundantly computing the same thing"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Source:"})," ",(0,r.jsx)(t.code,{children:"libs/state/stores/src/ui/selectors.ts:48-71"})]}),"\n",(0,r.jsx)(t.h3,{id:"pattern-4-parameterized-selector-id-based-lookups",children:"Pattern 4: Parameterized Selector (ID-based Lookups)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Best for:"})," Searching by ID/parameter, lookup tables, large lists"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import { createParameterizedSelector } from '@nasnet/state/stores';\n\n// Create factory for parameterized selectors\nconst selectNotificationById = createParameterizedSelector(\n  (state: NotificationState, id: string) =>\n    state.notifications.find(n => n.id === id) ?? null\n);\n\nfunction NotificationBadge() {\n  // Each parameter gets its own cached selector\n  const notif1 = useNotificationStore(selectNotificationById('alert-123'));\n  const notif2 = useNotificationStore(selectNotificationById('warning-456'));\n\n  return (\n    <div>\n      {notif1?.message}\n      {notif2?.message}\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Implementation detail:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"export function createParameterizedSelector<State, Param, Result>(\n  selector: (state: State, param: Param) => Result\n): (param: Param) => (state: State) => Result {\n  const cache = new Map<Param, (state: State) => Result>();\n\n  return (param: Param) => {\n    let cachedSelector = cache.get(param);\n\n    if (!cachedSelector) {\n      // First time with this param: create new selector\n      let lastState: State | null = null;\n      let lastResult: Result;\n\n      cachedSelector = (state: State): Result => {\n        if (state !== lastState) {\n          lastState = state;\n          lastResult = selector(state, param);\n        }\n        return lastResult;\n      };\n\n      cache.set(param, cachedSelector);\n    }\n\n    return cachedSelector;\n  };\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"When to use:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Selecting by dynamic parameter (ID, index, key)"}),"\n",(0,r.jsx)(t.li,{children:"Avoiding redundant array/object lookups"}),"\n",(0,r.jsx)(t.li,{children:"Rendering lists with per-item subscriptions"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Cache behavior:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Each unique ",(0,r.jsx)(t.code,{children:"param"})," gets its own cached selector"]}),"\n",(0,r.jsx)(t.li,{children:"Prevents recreating the same selector function on every render"}),"\n",(0,r.jsx)(t.li,{children:"Perfect for list items, detail panels with dynamic IDs"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Example: List items with per-item selection:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"interface NotificationListProps {\n  notifications: string[];  // Array of notification IDs\n}\n\nfunction NotificationList({ notifications }: NotificationListProps) {\n  return (\n    <ul>\n      {notifications.map(id => (\n        <NotificationItem key={id} notificationId={id} />\n      ))}\n    </ul>\n  );\n}\n\n// Each item selects its own notification by ID\nfunction NotificationItem({ notificationId }: { notificationId: string }) {\n  const selectById = createParameterizedSelector(...);\n  const notif = useNotificationStore(selectById(notificationId));\n\n  return <li>{notif?.message}</li>;\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Source:"})," ",(0,r.jsx)(t.code,{children:"libs/state/stores/src/ui/selectors.ts:87-112"})]}),"\n",(0,r.jsx)(t.h3,{id:"pattern-5-combined-selector-multiple-unrelated-fields",children:"Pattern 5: Combined Selector (Multiple Unrelated Fields)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Best for:"})," Selecting many fields (4+) from different store sections"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import { createCombinedSelector, shallow } from '@nasnet/state/stores';\n\n// Combine multiple selectors elegantly\nconst selectUISnapshot = createCombinedSelector({\n  theme: selectResolvedTheme,\n  sidebar: selectSidebarCollapsed,\n  commandPalette: selectCommandPaletteOpen,\n  notifications: selectNotifications,\n  compact: selectCompactMode,\n});\n\nfunction App() {\n  // Single selector returns all UI state\n  const ui = useUIStore(selectUISnapshot, shallow);\n\n  return (\n    <div className={ui.theme === 'dark' ? 'dark' : ''}>\n      <Sidebar collapsed={ui.sidebar} />\n      <CommandPalette open={ui.commandPalette} />\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Implementation detail:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"export function createCombinedSelector<\n  State,\n  Selectors extends Record<string, (state: State) => unknown>\n>(\n  selectors: Selectors\n): (state: State) => { [K in keyof Selectors]: ReturnType<Selectors[K]> } {\n  const keys = Object.keys(selectors) as (keyof Selectors)[];\n\n  return (state: State) => {\n    const result = {} as { [K in keyof Selectors]: ReturnType<Selectors[typeof key]> };\n    for (const key of keys) {\n      result[key] = selectors[key](state) as ReturnType<Selectors[typeof key]>;\n    }\n    return result;\n  };\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"When to use:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Combining 4+ pre-built selectors"}),"\n",(0,r.jsx)(t.li,{children:"Each selector is used together frequently"}),"\n",(0,r.jsx)(t.li,{children:"Cleaner than inline selector with multiple conditions"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Source:"})," ",(0,r.jsx)(t.code,{children:"libs/state/stores/src/ui/selectors.ts:143-158"})]}),"\n",(0,r.jsx)(t.h2,{id:"pre-built-selectors",children:"Pre-built Selectors"}),"\n",(0,r.jsx)(t.p,{children:"All stores export ready-to-use selectors:"}),"\n",(0,r.jsx)(t.h3,{id:"auth-store-selectors",children:"Auth Store Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import {\n  selectIsAuthenticated,      // boolean\n  selectUser,                  // User | null\n  selectToken,                 // string | null\n  selectIsRefreshing,          // boolean\n  selectRefreshAttempts,       // number\n  selectMaxRefreshExceeded,    // boolean\n  selectPermissions,           // string[]\n  selectHasPermission,         // (permission: string) => boolean\n} from '@nasnet/state/stores';\n\n// Usage\nconst isAuth = useAuthStore(selectIsAuthenticated);\nconst hasAdmin = useAuthStore(selectHasPermission('admin'));\n"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Source:"})," ",(0,r.jsx)(t.code,{children:"libs/state/stores/src/auth/auth.store.ts:390-433"})]}),"\n",(0,r.jsx)(t.h3,{id:"theme-store-selectors",children:"Theme Store Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import {\n  selectResolvedTheme,   // 'light' | 'dark'\n  selectThemeMode,       // 'light' | 'dark' | 'system'\n  selectIsDarkMode,      // boolean\n  selectIsSystemTheme,   // boolean\n} from '@nasnet/state/stores';\n\n// Usage\nconst isDark = useThemeStore(selectResolvedTheme) === 'dark';\n"})}),"\n",(0,r.jsx)(t.h3,{id:"sidebar-store-selectors",children:"Sidebar Store Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import {\n  selectSidebarCollapsed,      // boolean\n  selectSidebarDisplayState,   // 'collapsed' | 'expanded'\n} from '@nasnet/state/stores';\n\n// Usage\nconst sidebarOpen = !useThemeStore(selectSidebarCollapsed);\n"})}),"\n",(0,r.jsx)(t.h3,{id:"notification-store-selectors",children:"Notification Store Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import {\n  selectNotifications,              // Notification[]\n  selectHasNotifications,           // boolean\n  selectNotificationCount,          // number\n  selectErrorNotifications,         // Notification[]\n  selectNotificationsByType,        // (type: NotificationType) => Notification[]\n  selectUrgentNotificationCount,    // number (errors only)\n  selectProgressNotifications,      // Notification[]\n} from '@nasnet/state/stores';\n\n// Usage\nconst allNotifs = useNotificationStore(selectNotifications);\nconst errorCount = useNotificationStore(selectUrgentNotificationCount);\nconst warningNotifs = useNotificationStore(selectNotificationsByType('warning'));\n"})}),"\n",(0,r.jsx)(t.h2,{id:"re-render-prevention-strategies",children:"Re-render Prevention Strategies"}),"\n",(0,r.jsx)(t.h3,{id:"strategy-1-use-selectors-primary",children:"Strategy 1: Use Selectors (Primary)"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u2705 PRIMARY: Always use selectors\nconst isAuth = useAuthStore(state => state.isAuthenticated);\nconst { user, token } = useAuthStore(\n  state => ({ user: state.user, token: state.token }),\n  shallow\n);\n"})}),"\n",(0,r.jsx)(t.h3,{id:"strategy-2-usememo-for-selector-functions",children:"Strategy 2: useMemo for Selector Functions"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// If creating inline selector with closures:\nconst selectUserPermissions = useMemo(\n  () => (state: AuthState) => state.user?.permissions ?? [],\n  []\n);\n\nconst perms = useAuthStore(selectUserPermissions);\n"})}),"\n",(0,r.jsx)(t.h3,{id:"strategy-3-extract-to-component",children:"Strategy 3: Extract to Component"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u274c BAD: Multiple hooks, redundant selectors\nfunction ComplexComponent() {\n  const user = useAuthStore(state => state.user);\n  const theme = useThemeStore(state => state.resolvedTheme);\n  const sidebar = useSidebarStore(state => state.desktopCollapsed);\n\n  return <UserProfile user={user} theme={theme} sidebar={sidebar} />;\n}\n\n// \u2705 GOOD: Extract to sub-component with single selector\nfunction UserProfileContainer() {\n  const user = useAuthStore(state => state.user);\n  return <UserProfile user={user} />;\n}\n\nfunction ThemeContainer() {\n  const theme = useThemeStore(state => state.resolvedTheme);\n  return <div className={theme}><UserProfileContainer /></div>;\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"strategy-4-usecallback-for-handlers",children:"Strategy 4: useCallback for Handlers"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u2705 Memoize handlers to prevent re-renders of child components\nfunction CommandPalette() {\n  const toggleOpen = useCallback(() => {\n    useUIStore.getState().toggleCommandPalette();\n  }, []);\n\n  return <CommandPaletteUI onToggle={toggleOpen} />;\n}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"anti-patterns-to-avoid",children:"Anti-patterns to Avoid"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u274c ANTI-PATTERN 1: Destructuring entire store\nconst store = useAuthStore();  // Subscribes to EVERY change\nconst { user } = store;\n\n// \u2705 CORRECT:\nconst user = useAuthStore(state => state.user);\n\n// \u274c ANTI-PATTERN 2: Selector in conditional\nconst isSub = canSub ? useAuthStore(state => state.isAuthenticated) : false;\n\n// \u2705 CORRECT:\nconst isAuth = useAuthStore(state => state.isAuthenticated);\nconst isSub = canSub ? isAuth : false;\n\n// \u274c ANTI-PATTERN 3: Creating selector in every render\nfunction MyComponent() {\n  // This creates a new selector function EVERY render (bad!)\n  const user = useAuthStore(state => state.user);\n  // ...\n}\n\n// \u2705 CORRECT: (above code is fine - inline selectors are light)\n// But if using closures over props:\nfunction MyComponent({ userId }: { userId: string }) {\n  const user = useAuthStore(\n    useMemo(\n      () => (state) => state.users.find(u => u.id === userId),\n      [userId]\n    )\n  );\n}\n\n// \u274c ANTI-PATTERN 4: Using entire store when only need one field\nconst { isAuthenticated } = useAuthStore();  // Bad!\nconst isAuthFromUnrelatedStore = useThemeStore().resolvedTheme;  // Cascading re-renders\n\n// \u2705 CORRECT:\nconst isAuthenticated = useAuthStore(state => state.isAuthenticated);\nconst theme = useThemeStore(state => state.resolvedTheme);\n"})}),"\n",(0,r.jsx)(t.h2,{id:"performance-best-practices",children:"Performance Best Practices"}),"\n",(0,r.jsx)(t.h3,{id:"1-use-react-devtools-profiler",children:"1. Use React DevTools Profiler"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'// Identify re-renders with React DevTools:\n// 1. Open DevTools \u2192 Profiler tab\n// 2. Record interaction\n// 3. Check which components re-rendered and why\n// 4. Look for "unnecessary" re-renders (component function re-ran, but props didn\'t change)\n'})}),"\n",(0,r.jsx)(t.h3,{id:"2-use-zustand-devtools-for-store-changes",children:"2. Use Zustand DevTools for Store Changes"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// Inspect store mutations:\n// 1. Open Redux DevTools\n// 2. Select store from dropdown\n// 3. Watch state changes as you interact\n// 4. Identify which mutations cause component re-renders\n"})}),"\n",(0,r.jsx)(t.h3,{id:"3-use-shallowequal-for-object-selectors",children:"3. Use shallowEqual for Object Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u2705 GOOD: Shallow compare object properties\nconst { user, token } = useAuthStore(\n  state => ({ user: state.user, token: state.token }),\n  shallow\n);\n\n// \u274c BAD: New object reference every time\nconst { user, token } = useAuthStore(state => ({\n  user: state.user,\n  token: state.token,\n}));  // New object != old object, causes re-render\n"})}),"\n",(0,r.jsx)(t.h3,{id:"4-avoid-expensive-computations-in-selectors",children:"4. Avoid Expensive Computations in Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u274c BAD: Expensive filter on every selector call\nconst selectExpensiveList = (state: State) =>\n  state.items.filter(i => expensiveCheck(i));  // O(n) every time!\n\n// \u2705 GOOD: Use memoized selector for expensive computation\nconst selectExpensiveList = createMemoizedSelector(\n  (state: State) => [state.items] as const,\n  ([items]) => items.filter(i => expensiveCheck(i))  // O(n) only when items change\n);\n"})}),"\n",(0,r.jsx)(t.h3,{id:"5-prefer-primitive-selectors",children:"5. Prefer Primitive Selectors"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u2705 BEST: Primitive selector (zero overhead)\nconst isOpen = useModalStore(state => state.activeModal === 'auth');\n\n// \u2705 GOOD: Shallow compare (minimal overhead)\nconst { activeModal, data } = useModalStore(\n  state => ({ activeModal: state.activeModal, data: state.data }),\n  shallow\n);\n\n// \u26a0\ufe0f OKAY: Memoized (only for expensive computations)\nconst selectFiltered = createMemoizedSelector(...);\n"})}),"\n",(0,r.jsx)(t.h2,{id:"performance-checklist",children:"Performance Checklist"}),"\n",(0,r.jsxs)(t.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Use selectors instead of destructuring full store"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Use primitive selectors for single fields"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Use ",(0,r.jsx)(t.code,{children:"shallow"})," for 2-3 fields together"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Use ",(0,r.jsx)(t.code,{children:"createMemoizedSelector"})," for expensive computations"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Use ",(0,r.jsx)(t.code,{children:"createParameterizedSelector"})," for ID-based lookups"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Avoid creating new selectors in component render"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Avoid expensive computations inside selectors"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Check Redux DevTools for unexpected mutations"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Profile with React DevTools Profiler"]}),"\n",(0,r.jsxs)(t.li,{className:"task-list-item",children:[(0,r.jsx)(t.input,{type:"checkbox",disabled:!0})," ","Consider component extraction for isolated concerns"]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Example: Before & After Optimization"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"// \u274c BEFORE: Unnecessary re-renders on auth store changes\nfunction AuthPanel() {\n  const { user, token, isRefreshing, refreshAttempts, lastActivity } = useAuthStore();\n\n  return (\n    <div>\n      User: {user?.username}\n      {/* Re-renders whenever isRefreshing OR refreshAttempts changes */}\n    </div>\n  );\n}\n\n// \u2705 AFTER: Only re-renders when user changes\nfunction AuthPanel() {\n  const user = useAuthStore(state => state.user);\n\n  return (\n    <div>\n      User: {user?.username}\n      {/* Only re-renders when user object changes */}\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Before optimization:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Component re-renders: 10 times (on every auth store mutation)"}),"\n",(0,r.jsxs)(t.li,{children:["Wasted renders: 9 times (when fields besides ",(0,r.jsx)(t.code,{children:"user"})," changed)"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"After optimization:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Component re-renders: 1 time (only when user actually changes)"}),"\n",(0,r.jsx)(t.li,{children:"Wasted renders: 0"}),"\n",(0,r.jsx)(t.li,{children:"Performance gain: 10x fewer re-renders"}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Next Steps:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Apply selector patterns to your components"}),"\n",(0,r.jsx)(t.li,{children:"Use React DevTools Profiler to measure improvements"}),"\n",(0,r.jsxs)(t.li,{children:["Review ",(0,r.jsx)(t.a,{href:"/docs/state/stores/selectors-reference",children:"Selectors Reference"})," for complete API and pre-built selector catalog"]}),"\n",(0,r.jsxs)(t.li,{children:["Review ",(0,r.jsx)(t.a,{href:"/docs/state/architecture",children:"Architecture"})," for integration patterns"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},71184:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>c});var s=n(14041);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);
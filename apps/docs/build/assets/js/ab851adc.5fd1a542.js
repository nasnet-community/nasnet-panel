"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[94318],{45459:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"feature-modules/services","title":"Services Feature Module","description":"Source: libs/features/services/src/","source":"@site/../connect/docs/feature-modules/services.md","sourceDirName":"feature-modules","slug":"/feature-modules/services","permalink":"/docs/frontend/feature-modules/services","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/feature-modules/services.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Network Feature","permalink":"/docs/frontend/feature-modules/network"},"next":{"title":"VPN Feature","permalink":"/docs/frontend/feature-modules/vpn"}}');var i=n(31085),t=n(71184);const d={},c="Services Feature Module",l={},a=[{value:"Available Services",id:"available-services",level:2},{value:"Route and Tab",id:"route-and-tab",level:2},{value:"PluginStoreTab",id:"pluginstoretab",level:2},{value:"Services Tab",id:"services-tab",level:3},{value:"Templates Tab",id:"templates-tab",level:3},{value:"ServicesPage",id:"servicespage",level:2},{value:"Props",id:"props",level:3},{value:"Data Sources",id:"data-sources",level:3},{value:"UI State (Zustand)",id:"ui-state-zustand",level:3},{value:"Collapsible Sections",id:"collapsible-sections",level:3},{value:"Bulk Operations",id:"bulk-operations",level:3},{value:"Dialogs",id:"dialogs",level:3},{value:"ServiceDetailPage",id:"servicedetailpage",level:2},{value:"Tabs",id:"tabs",level:3},{value:"Data Sources",id:"data-sources-1",level:3},{value:"Status Badges in Header",id:"status-badges-in-header",level:3},{value:"ServiceLogViewer",id:"servicelogviewer",level:2},{value:"DiagnosticsPanel",id:"diagnosticspanel",level:2},{value:"ServiceConfigForm",id:"serviceconfigform",level:2},{value:"Dynamic Field Types",id:"dynamic-field-types",level:3},{value:"ServiceTrafficPanel",id:"servicetrafficpanel",level:2},{value:"StorageSettings",id:"storagesettings",level:2},{value:"Templates System",id:"templates-system",level:2},{value:"TemplatesBrowser",id:"templatesbrowser",level:3},{value:"TemplateInstallWizard",id:"templateinstallwizard",level:3},{value:"Port Registry View",id:"port-registry-view",level:2},{value:"Service Sharing",id:"service-sharing",level:2},{value:"Resource Status Mapping",id:"resource-status-mapping",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"services-feature-module",children:"Services Feature Module"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Source:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/"})]}),"\n",(0,i.jsx)(s.p,{children:"The services feature provides the Feature Marketplace \u2014 a system for installing, configuring, monitoring, and managing downloadable network service instances (Tor, sing-box, Xray-core, MTProxy, Psiphon, AdGuard Home). It also includes storage management, traffic monitoring, quota enforcement, service-level diagnostics, and configuration templates."}),"\n",(0,i.jsx)(s.h2,{id:"available-services",children:"Available Services"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Feature ID"}),(0,i.jsx)(s.th,{children:"Category"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"tor"})}),(0,i.jsx)(s.td,{children:"privacy"}),(0,i.jsx)(s.td,{children:"Anonymous communication via onion routing"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"sing-box"})}),(0,i.jsx)(s.td,{children:"proxy"}),(0,i.jsx)(s.td,{children:"Multi-protocol proxy platform"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"xray-core"})}),(0,i.jsx)(s.td,{children:"proxy"}),(0,i.jsx)(s.td,{children:"Advanced V2Ray-derived proxy"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"mtproxy"})}),(0,i.jsx)(s.td,{children:"proxy"}),(0,i.jsx)(s.td,{children:"Telegram MTProto proxy"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"psiphon"})}),(0,i.jsx)(s.td,{children:"privacy"}),(0,i.jsx)(s.td,{children:"Censorship circumvention"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"adguard-home"})}),(0,i.jsx)(s.td,{children:"dns"}),(0,i.jsx)(s.td,{children:"Network-wide ad and tracker blocking"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["Categories used in the UI: ",(0,i.jsx)(s.code,{children:"privacy"}),", ",(0,i.jsx)(s.code,{children:"proxy"}),", ",(0,i.jsx)(s.code,{children:"dns"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"route-and-tab",children:"Route and Tab"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Route file:"})," ",(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/plugins.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Lazy-loaded with code splitting. Skeleton shows a 3-column plugin card grid while loading:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-tsx",children:"export const Route = createFileRoute('/router/$id/plugins')({\n  component: PluginStoreRoute,\n});\n\nfunction PluginStoreRoute() {\n  const { id: routerId } = Route.useParams();\n  return (\n    <LazyBoundary fallback={<PluginStoreTabSkeleton />}>\n      <LazyPluginStoreTab routerId={routerId} />\n    </LazyBoundary>\n  );\n}\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tab component:"})," ",(0,i.jsx)(s.code,{children:"apps/connect/src/app/routes/router-panel/tabs/PluginStoreTab.tsx"})]}),"\n",(0,i.jsx)(s.h2,{id:"pluginstoretab",children:"PluginStoreTab"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"apps/connect/src/app/routes/router-panel/tabs/PluginStoreTab.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"The plugin store tab renders two sub-tabs:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tab"}),(0,i.jsx)(s.th,{children:"Content"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Services"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"PluginCard"})," grid \u2014 install/uninstall/configure individual services"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Templates"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"TemplatesBrowser"})," \u2014 multi-service configuration templates"]})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"services-tab",children:"Services Tab"}),"\n",(0,i.jsxs)(s.p,{children:["Shows a ",(0,i.jsx)(s.code,{children:"PluginCard"})," (from ",(0,i.jsx)(s.code,{children:"@nasnet/ui/patterns"}),") for each service. Status pills at the top display running count and installed/total counts. A blue info banner explains that services run as containers on the router."]}),"\n",(0,i.jsxs)(s.p,{children:["Plugin card states: ",(0,i.jsx)(s.code,{children:"available"}),", ",(0,i.jsx)(s.code,{children:"installed"}),", ",(0,i.jsx)(s.code,{children:"running"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Actions per card: ",(0,i.jsx)(s.code,{children:"onInstall"}),", ",(0,i.jsx)(s.code,{children:"onUninstall"}),", ",(0,i.jsx)(s.code,{children:"onConfigure"}),"."]}),"\n",(0,i.jsx)(s.h3,{id:"templates-tab",children:"Templates Tab"}),"\n",(0,i.jsxs)(s.p,{children:["Renders ",(0,i.jsx)(s.code,{children:"TemplatesBrowser"})," which fetches available templates from the backend. Clicking a template opens ",(0,i.jsx)(s.code,{children:"TemplateInstallWizard"})," in a modal dialog."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"servicespage",children:"ServicesPage"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/pages/ServicesPage.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"The main service management page for a given router. Accessed when navigating from the plugin store to the instance list."}),"\n",(0,i.jsx)(s.h3,{id:"props",children:"Props"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"interface ServicesPageProps {\n  routerId: string;\n  onInstanceClick?: (instanceId: string) => void;\n  onImportComplete?: (instanceId: string) => void;\n}\n"})}),"\n",(0,i.jsx)(s.h3,{id:"data-sources",children:"Data Sources"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Hook"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useServiceInstances(routerId)"})}),(0,i.jsx)(s.td,{children:"List of installed service instances"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useStorageConfig()"})}),(0,i.jsx)(s.td,{children:"External storage configuration"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useSystemResources(routerId)"})}),(0,i.jsx)(s.td,{children:"Per-instance RAM usage + system totals"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useAvailableUpdates({ routerId })"})}),(0,i.jsx)(s.td,{children:"Available version updates"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useInstanceMutations()"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"startInstance"}),", ",(0,i.jsx)(s.code,{children:"stopInstance"}),", ",(0,i.jsx)(s.code,{children:"restartInstance"}),", ",(0,i.jsx)(s.code,{children:"deleteInstance"})]})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"ui-state-zustand",children:"UI State (Zustand)"}),"\n",(0,i.jsxs)(s.p,{children:["From ",(0,i.jsx)(s.code,{children:"@nasnet/state/stores"})," via ",(0,i.jsx)(s.code,{children:"useServiceUIStore"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"search"})," \u2014 text filter"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"categoryFilter"})," \u2014 filter by category"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"statusFilter"})," \u2014 filter by status"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"viewMode"})," \u2014 ",(0,i.jsx)(s.code,{children:"list"})," or ",(0,i.jsx)(s.code,{children:"grid"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"showResourceMetrics"})," \u2014 toggles metrics column"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"selectedIds"})," \u2014 for bulk operations"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"collapsible-sections",children:"Collapsible Sections"}),"\n",(0,i.jsxs)(s.p,{children:["The page uses Radix ",(0,i.jsx)(s.code,{children:"Collapsible.Root"})," for four expandable sections:"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Section"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Content"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Resource Overview"}),(0,i.jsx)(s.td,{children:"Expanded"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"ResourceBudgetPanel"})," with per-instance RAM bars"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Available Updates"}),(0,i.jsx)(s.td,{children:"Expanded if updates exist"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"UpdateAllPanel"})," listing pending updates"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Storage Management"}),(0,i.jsx)(s.td,{children:"Expanded if configured"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"StorageSettings"})," component"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Port Allocations"}),(0,i.jsx)(s.td,{children:"Collapsed"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"PortRegistryView"})," listing allocated ports"]})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"InstanceManager"})," (from ",(0,i.jsx)(s.code,{children:"@nasnet/ui/patterns"}),") handles selection and bulk actions. Supported bulk operations: ",(0,i.jsx)(s.code,{children:"start"}),", ",(0,i.jsx)(s.code,{children:"stop"}),", ",(0,i.jsx)(s.code,{children:"restart"}),", ",(0,i.jsx)(s.code,{children:"delete"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Each operation calls the corresponding mutation for all selected instance IDs, then clears selection and refetches."}),"\n",(0,i.jsx)(s.h3,{id:"dialogs",children:"Dialogs"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Dialog"}),(0,i.jsx)(s.th,{children:"Trigger"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"InstallDialog"})}),(0,i.jsx)(s.td,{children:'"Install" button'}),(0,i.jsx)(s.td,{children:"Browse and install a new service"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ServiceImportDialog"})}),(0,i.jsx)(s.td,{children:'"Import" button'}),(0,i.jsx)(s.td,{children:"Import exported service config"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"StopDependentsDialog"})}),(0,i.jsx)(s.td,{children:"Stop on dependent instance"}),(0,i.jsx)(s.td,{children:"Confirm stopping with dependents"})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"servicedetailpage",children:"ServiceDetailPage"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/pages/ServiceDetailPage.tsx"})]}),"\n",(0,i.jsxs)(s.p,{children:["Detail page for a specific service instance. Auto-switches to the Diagnostics tab when ",(0,i.jsx)(s.code,{children:"instance.status === 'FAILED'"}),"."]}),"\n",(0,i.jsx)(s.h3,{id:"tabs",children:"Tabs"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tab"}),(0,i.jsx)(s.th,{children:"Component"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Overview"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"ServiceCard"}),", ",(0,i.jsx)(s.code,{children:"VirtualInterfaceBridge"}),", ",(0,i.jsx)(s.code,{children:"ResourceLimitsForm"}),", ",(0,i.jsx)(s.code,{children:"IsolationStatus"}),", ",(0,i.jsx)(s.code,{children:"GatewayStatusCard"})]}),(0,i.jsx)(s.td,{children:"Instance summary, resource limits, isolation config, gateway"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Configuration"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ServiceConfigForm"})}),(0,i.jsx)(s.td,{children:"Edit service-specific settings"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Traffic"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"ServiceTrafficPanel"}),", ",(0,i.jsx)(s.code,{children:"QuotaSettingsForm"})]}),(0,i.jsx)(s.td,{children:"24-hour traffic history + quota management"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Logs"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ServiceLogViewer"})}),(0,i.jsx)(s.td,{children:"Real-time service process logs"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Alerts"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ServiceAlertsTab"})}),(0,i.jsx)(s.td,{children:"Per-instance alert rules"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Diagnostics"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"DiagnosticsPanel"})}),(0,i.jsx)(s.td,{children:"Automated health checks with history"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"data-sources-1",children:"Data Sources"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Hook"}),(0,i.jsx)(s.th,{children:"Used for"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useServiceInstance(routerId, instanceId)"})}),(0,i.jsx)(s.td,{children:"Core instance data"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useGatewayStatus(instanceId)"})}),(0,i.jsx)(s.td,{children:"SOCKS-to-TUN gateway state (poll every 5s)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useInstanceIsolation(routerId, instanceId)"})}),(0,i.jsx)(s.td,{children:"Isolation + resource limits"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useInstanceHealth(routerId, instanceId)"})}),(0,i.jsx)(s.td,{children:"Health badge (poll every 30s when RUNNING)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useFeatureVerification(routerId, instanceId)"})}),(0,i.jsx)(s.td,{children:"Binary GPG verification badge"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"useAvailableUpdates({ routerId })"})}),(0,i.jsx)(s.td,{children:"Checks for an update for this instance"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"status-badges-in-header",children:"Status Badges in Header"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-tsx",children:"// Health badge (RUNNING only)\n<ServiceHealthBadge health={healthData?.instanceHealth} loading={healthLoading} animate />\n\n// Binary verification badge\n<VerificationBadge verification={verificationData?.serviceInstance?.verification} />\n\n// Update indicator (if update available)\n<UpdateIndicator currentVersion={...} latestVersion={...} severity={...} />\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"servicelogviewer",children:"ServiceLogViewer"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/ServiceLogViewer/ServiceLogViewer.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Platform-adaptive log viewer for service process output."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Props:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"interface ServiceLogViewerProps {\n  routerId: string;\n  instanceId: string;\n  maxHistoricalLines?: number;  // Default 100\n  autoScroll?: boolean;\n  onEntryClick?: (entry: LogEntry) => void;\n}\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Platform behavior:"})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Platform"}),(0,i.jsx)(s.th,{children:"Layout"}),(0,i.jsx)(s.th,{children:"Notes"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Mobile"}),(0,i.jsx)(s.td,{children:"Bottom sheet with touch-friendly controls"}),(0,i.jsx)(s.td,{children:"44px touch targets"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Tablet/Desktop"}),(0,i.jsx)(s.td,{children:"Virtual scrolling with dense layout"}),(0,i.jsx)(s.td,{children:"1000-line ring buffer"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Features:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"1000-line ring buffer (oldest entries auto-discarded)"}),"\n",(0,i.jsx)(s.li,{children:"Real-time log streaming"}),"\n",(0,i.jsx)(s.li,{children:"Level filtering: DEBUG, INFO, WARN, ERROR"}),"\n",(0,i.jsx)(s.li,{children:"Text search across messages"}),"\n",(0,i.jsx)(s.li,{children:"Auto-scroll to bottom"}),"\n",(0,i.jsx)(s.li,{children:"Copy to clipboard"}),"\n",(0,i.jsx)(s.li,{children:"JetBrains Mono font"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"useServiceLogViewer"})," hook manages the streaming subscription, ring buffer, and filter state."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"diagnosticspanel",children:"DiagnosticsPanel"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/DiagnosticsPanel/DiagnosticsPanel.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Automated health check panel for a running service instance. Stores up to 10 historical diagnostic runs."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Props:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"interface DiagnosticsPanelProps {\n  routerId: string;\n  instanceId: string;\n  serviceName: string;\n  maxHistory?: number;\n  onDiagnosticsComplete?: (results: DiagnosticResult[]) => void;\n}\n"})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"useDiagnosticsPanel"})," hook fetches diagnostic history and manages running a new diagnostic session."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"serviceconfigform",children:"ServiceConfigForm"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/ServiceConfigForm/ServiceConfigForm.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Dynamic configuration form that renders schema-driven fields for each service type."}),"\n",(0,i.jsx)(s.h3,{id:"dynamic-field-types",children:"Dynamic Field Types"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Component"}),(0,i.jsx)(s.th,{children:"Use case"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"TextField"})}),(0,i.jsx)(s.td,{children:"String inputs"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"TextArea"})}),(0,i.jsx)(s.td,{children:"Multi-line text"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"NumberField"})}),(0,i.jsx)(s.td,{children:"Numeric values"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"PasswordField"})}),(0,i.jsx)(s.td,{children:"Sensitive inputs (masked)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"Select"})}),(0,i.jsx)(s.td,{children:"Enum/options"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"MultiSelect"})}),(0,i.jsx)(s.td,{children:"Multiple selection"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ArrayField"})}),(0,i.jsx)(s.td,{children:"List of values"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"zodSchemaBuilder.ts"})," utility converts a backend-provided field schema into a Zod validation schema at runtime."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.strong,{children:[(0,i.jsx)(s.code,{children:"useServiceConfigForm"})," hook"]})," (",(0,i.jsx)(s.code,{children:"hooks/useServiceConfigForm.ts"}),") handles:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Fetching the current config from the backend"}),"\n",(0,i.jsx)(s.li,{children:"Managing form dirty state"}),"\n",(0,i.jsxs)(s.li,{children:["Submitting updated config with ",(0,i.jsx)(s.code,{children:"applyServiceConfig"})," mutation"]}),"\n",(0,i.jsxs)(s.li,{children:["Invoking ",(0,i.jsx)(s.code,{children:"onSuccess"}),"/",(0,i.jsx)(s.code,{children:"onError"})," callbacks"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Props:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"interface ServiceConfigFormProps {\n  formState: ReturnType<typeof useServiceConfigForm>;\n  title?: string;\n  description?: string;\n  readOnly?: boolean;   // true when instance is not RUNNING or STOPPED\n}\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"servicetrafficpanel",children:"ServiceTrafficPanel"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/service-traffic/ServiceTrafficPanel.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Displays per-service traffic statistics over the specified history window (default: 24 hours)."}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"use-service-traffic-panel.ts"})," hook fetches traffic data and manages the selected history window. ",(0,i.jsx)(s.code,{children:"QuotaSettingsForm"})," allows setting a monthly data quota per instance."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"storagesettings",children:"StorageSettings"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/storage/StorageSettings.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Manages external USB/SD storage configuration for service data."}),"\n",(0,i.jsxs)(s.p,{children:["Sub-components: ",(0,i.jsx)(s.code,{children:"StorageUsageBar"})," (visual usage bar), ",(0,i.jsx)(s.code,{children:"StorageDisconnectBanner"})," (warning when storage disconnected)."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useStorageSettings"})," hook fetches config and provides ",(0,i.jsx)(s.code,{children:"connect"}),", ",(0,i.jsx)(s.code,{children:"disconnect"}),", and ",(0,i.jsx)(s.code,{children:"format"})," mutations."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"templates-system",children:"Templates System"}),"\n",(0,i.jsx)(s.h3,{id:"templatesbrowser",children:"TemplatesBrowser"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/templates/TemplatesBrowser.tsx"})]}),"\n",(0,i.jsxs)(s.p,{children:["Fetches available templates via GraphQL and renders a filterable card grid. ",(0,i.jsx)(s.code,{children:"TemplateFilters"})," provides category and tag filtering. Selecting a template fires ",(0,i.jsx)(s.code,{children:"onInstall(template)"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useTemplatesBrowser"})," hook manages templates list, loading state, and active filters."]}),"\n",(0,i.jsx)(s.h3,{id:"templateinstallwizard",children:"TemplateInstallWizard"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/templates/TemplateInstallWizard.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Multi-step wizard that guides the user through installing a template (which may deploy multiple service instances)."}),"\n",(0,i.jsxs)(s.p,{children:["Backed by ",(0,i.jsx)(s.code,{children:"templateInstallMachine.ts"})," (XState) via ",(0,i.jsx)(s.code,{children:"useTemplateInstallWizard"})," hook."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Wizard steps"})," (from ",(0,i.jsx)(s.code,{children:"wizard-steps/"}),"):"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Review template contents and dependencies"}),"\n",(0,i.jsx)(s.li,{children:"Configure per-service settings (if required)"}),"\n",(0,i.jsx)(s.li,{children:"Confirm and install"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["On completion, calls ",(0,i.jsx)(s.code,{children:"onComplete(instanceIDs[])"})," with the IDs of all created instances."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"port-registry-view",children:"Port Registry View"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/components/PortRegistryView.tsx"})]}),"\n",(0,i.jsx)(s.p,{children:"Displays all ports allocated by the system's port registry for the given router. Lists service instances alongside their allocated port numbers and protocols."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"PortRegistryViewMobile.tsx"})," provides the mobile-optimized version."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"service-sharing",children:"Service Sharing"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"File:"})," ",(0,i.jsx)(s.code,{children:"libs/features/services/src/schemas/service-sharing.schema.ts"})]}),"\n",(0,i.jsxs)(s.p,{children:["Zod schema for importing/exporting service configurations as JSON files. Used by ",(0,i.jsx)(s.code,{children:"ServiceImportDialog"})," and ",(0,i.jsx)(s.code,{children:"ServiceExportDialog"})," (from ",(0,i.jsx)(s.code,{children:"@nasnet/ui/patterns"}),")."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"resource-status-mapping",children:"Resource Status Mapping"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"getInstanceStatus"})," helper maps backend ",(0,i.jsx)(s.code,{children:"ResourceStatus"})," values to frontend display states:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"// ResourceStatus (from backend GraphQL)\n'OK' | 'WARNING' | 'CRITICAL' \u2192 'running'\ndefault \u2192 'stopped'\n"})}),"\n",(0,i.jsx)(s.p,{children:"Resource monitoring only runs for actively running instances, so all non-error resource statuses indicate the instance is running."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"../cross-cutting-features/service-marketplace.md"})," \u2014 Deep dive into the marketplace architecture, manifest format, and install lifecycle"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"../data-fetching/graphql-hooks.md"})," \u2014 Service-related query hooks"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"../ui-system/platform-presenters.md"})," \u2014 Headless + Platform Presenters pattern (ADR-018)"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},71184:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>c});var r=n(14041);const i={},t=r.createContext(i);function d(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);
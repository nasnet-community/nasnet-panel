"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[78463],{39963:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"intro","title":"Introduction","description":"The @nasnet/core library is the shared foundation for the NasNetConnect frontend. It provides type-safe constants, shared TypeScript interfaces, utility functions, and React form/validation infrastructure used by all features.","source":"@site/../../libs/core/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/docs/core/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/core/docs/intro.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Introduction"},"sidebar":"sidebar","previous":{"title":"Core Library Documentation","permalink":"/docs/core/"},"next":{"title":"Error Handling Patterns","permalink":"/docs/core/guides/error-handling-patterns"}}');var r=s(31085),t=s(71184);const l={sidebar_position:1,title:"Introduction"},o="Core Library: Shared Foundation",c={},d=[{value:"Library Structure",id:"library-structure",level:2},{value:"Dependency Rules (Strict)",id:"dependency-rules-strict",level:2},{value:"Import Aliases (Configured)",id:"import-aliases-configured",level:2},{value:"Sub-Library Overview",id:"sub-library-overview",level:2},{value:"types/ \u2014 Type Definitions",id:"types--type-definitions",level:3},{value:"utils/ \u2014 Utility Functions",id:"utils--utility-functions",level:3},{value:"constants/ \u2014 Static Constants",id:"constants--static-constants",level:3},{value:"forms/ \u2014 React Hook Form Integration",id:"forms--react-hook-form-integration",level:3},{value:"i18n/ \u2014 Internationalization",id:"i18n--internationalization",level:3},{value:"Package Configuration (Nx)",id:"package-configuration-nx",level:2},{value:"How to Add New Exports",id:"how-to-add-new-exports",level:2},{value:"Adding to Existing Sub-Library",id:"adding-to-existing-sub-library",level:3},{value:"Adding a New Sub-Library (Advanced)",id:"adding-a-new-sub-library-advanced",level:3},{value:"Testing Conventions",id:"testing-conventions",level:2},{value:"Test Files Location",id:"test-files-location",level:3},{value:"Testing Frameworks",id:"testing-frameworks",level:3},{value:"Example Test",id:"example-test",level:3},{value:"Relationship to Backend (Go)",id:"relationship-to-backend-go",level:2},{value:"Key Design Decisions",id:"key-design-decisions",level:2},{value:"No React in Core Types/Utils/Constants",id:"no-react-in-core-typesutilsconstants",level:3},{value:"Zod for All Validation",id:"zod-for-all-validation",level:3},{value:"Universal State v2 (8-Layer Model)",id:"universal-state-v2-8-layer-model",level:3},{value:"Architectural Boundaries",id:"architectural-boundaries",level:2},{value:"Related Documentation",id:"related-documentation",level:2},{value:"Sub-Library References",id:"sub-library-references",level:3},{value:"Cross-Cutting Guides",id:"cross-cutting-guides",level:3},{value:"System Architecture",id:"system-architecture",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"core-library-shared-foundation",children:"Core Library: Shared Foundation"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"@nasnet/core"})})," library is the shared foundation for the NasNetConnect frontend. It provides type-safe constants, shared TypeScript interfaces, utility functions, and React form/validation infrastructure used by all features."]}),"\n",(0,r.jsx)(n.h2,{id:"library-structure",children:"Library Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"libs/core/\n\u251c\u2500\u2500 types/          # TypeScript interfaces (zero dependencies)\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 firewall/        # FilterRule, MangleRule, NATRule, etc.\n\u2502       \u251c\u2500\u2500 resource/        # Resource model, layers, composites\n\u2502       \u251c\u2500\u2500 api/             # Backend API types\n\u2502       \u251c\u2500\u2500 config/          # Configuration types\n\u2502       \u2514\u2500\u2500 ...\n\u2502\n\u251c\u2500\u2500 utils/          # Pure utility functions (minimal dependencies)\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 validation/      # IP, CIDR, network validators\n\u2502       \u251c\u2500\u2500 device/          # Browser/OS detection utilities\n\u2502       \u251c\u2500\u2500 firewall/        # Firewall utility functions\n\u2502       \u251c\u2500\u2500 network/         # IP/MAC/VLAN utilities\n\u2502       \u251c\u2500\u2500 formatters/      # Data formatting (bytes, duration, IP)\n\u2502       \u251c\u2500\u2500 mac-vendor/      # MAC address vendor lookup\n\u2502       \u251c\u2500\u2500 status/          # Status aggregation logic\n\u2502       \u251c\u2500\u2500 graph/           # GraphQL utilities\n\u2502       \u251c\u2500\u2500 hooks/           # React hooks\n\u2502       \u2514\u2500\u2500 ...\n\u2502\n\u251c\u2500\u2500 constants/      # Static application constants\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 routes.ts        # Navigation routes (ROUTES object)\n\u2502       \u251c\u2500\u2500 api-endpoints.ts # API endpoints (API_ENDPOINTS object)\n\u2502       \u251c\u2500\u2500 socket-events.ts # WebSocket events (EMIT/ON)\n\u2502       \u2514\u2500\u2500 well-known-ports.ts  # Service port database\n\u2502\n\u251c\u2500\u2500 forms/          # React Hook Form integration\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 NasFormProvider.tsx      # Form context provider\n\u2502       \u251c\u2500\u2500 useZodForm.ts            # Form hook with Zod\n\u2502       \u251c\u2500\u2500 useValidationPipeline.ts # Multi-stage validation\n\u2502       \u251c\u2500\u2500 useFormPersistence.ts    # Auto-save to localStorage\n\u2502       \u251c\u2500\u2500 useFormResourceSync.ts   # Sync with resource updates\n\u2502       \u251c\u2500\u2500 network-validators.ts    # Network-specific validators\n\u2502       \u251c\u2500\u2500 network-utils.ts         # Network form utilities\n\u2502       \u251c\u2500\u2500 schema-utils.ts          # Zod schema builders\n\u2502       \u2514\u2500\u2500 error-messages.ts        # Backend error mapping\n\u2502\n\u2514\u2500\u2500 i18n/           # Internationalization (i18next)\n    \u2514\u2500\u2500 src/\n        \u251c\u2500\u2500 I18nProvider.tsx         # i18next provider\n        \u251c\u2500\u2500 DirectionProvider.tsx    # RTL/LTR support\n        \u251c\u2500\u2500 i18n.ts                  # i18next config\n        \u251c\u2500\u2500 hooks/                   # i18n hooks\n        \u2514\u2500\u2500 locales/                 # Translations (.json)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dependency-rules-strict",children:"Dependency Rules (Strict)"}),"\n",(0,r.jsx)(n.p,{children:"The core library enforces strict dependency boundaries:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  apps/connect (React App)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  libs/features/* (Features)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  libs/ui/* (Primitives/Patterns)\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  libs/core/* (Types/Utils)      \u2502 \u25c4\u2500 CANNOT DEPEND ON ANYTHING ABOVE\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Core CAN"})," depend on: External libraries (Zod, i18next, TypeScript)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u274c ",(0,r.jsx)(n.strong,{children:"Core CANNOT"})," depend on: apps/, features/, ui/ libraries"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"All other libraries CAN"})," import from core"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"React dependencies"})," allowed only in forms/ and i18n/"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Why? Core types and utilities should be reusable by:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The Go backend (type definitions)"}),"\n",(0,r.jsx)(n.li,{children:"CLI tools and build scripts"}),"\n",(0,r.jsx)(n.li,{children:"Testing utilities"}),"\n",(0,r.jsx)(n.li,{children:"Code generators"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"import-aliases-configured",children:"Import Aliases (Configured)"}),"\n",(0,r.jsxs)(n.p,{children:["All aliases are defined in ",(0,r.jsx)(n.code,{children:"apps/connect/vite.config.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Import alias \u2192 File path mapping\n{\n  '@nasnet/core/types': 'libs/core/types/src',\n  '@nasnet/core/utils': 'libs/core/utils/src',\n  '@nasnet/core/constants': 'libs/core/constants/src',\n  '@nasnet/core/forms': 'libs/core/forms/src',\n  '@nasnet/core/i18n': 'libs/core/i18n/src',\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import type { FilterRule } from '@nasnet/core/types';\nimport { validateIPv4, formatBytes } from '@nasnet/core/utils';\nimport { ROUTES, API_ENDPOINTS } from '@nasnet/core/constants';\nimport { useZodForm } from '@nasnet/core/forms';\nimport { useTranslation } from '@nasnet/core/i18n';\n"})}),"\n",(0,r.jsx)(n.h2,{id:"sub-library-overview",children:"Sub-Library Overview"}),"\n",(0,r.jsx)(n.h3,{id:"types--type-definitions",children:"types/ \u2014 Type Definitions"}),"\n",(0,r.jsxs)(n.p,{children:["Pure TypeScript interfaces with ",(0,r.jsx)(n.strong,{children:"zero dependencies"}),". These define the data model across the application."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Categories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Firewall"})," (",(0,r.jsx)(n.code,{children:"firewall/"}),") - FilterRule, MangleRule, NATRule, RawRule, PortKnock, RateLimit"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource"})," (",(0,r.jsx)(n.code,{children:"resource/"}),") - Universal State v2 (8-layer resource model)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"API"})," (",(0,r.jsx)(n.code,{children:"api/"}),") - Backend request/response types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Config"})," (",(0,r.jsx)(n.code,{children:"config/"}),") - Configuration schemas"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network"})," - Interface, routing, VLAN, tunnel types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DHCP"})," - Pool, lease, fingerprint types"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"No React"})," - types/ can be used in:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Go type stubs (code generation)"}),"\n",(0,r.jsx)(n.li,{children:"CLI tools"}),"\n",(0,r.jsx)(n.li,{children:"Testing utilities"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"utils--utility-functions",children:"utils/ \u2014 Utility Functions"}),"\n",(0,r.jsxs)(n.p,{children:["Pure functions with ",(0,r.jsx)(n.strong,{children:"minimal external dependencies"}),". Organized by domain:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"validation/"})," - IP, CIDR, port validators (used in forms)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"device/"})," - Browser/OS detection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"firewall/"})," - Rule builders, CIDR operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"network/"})," - IP/MAC/VLAN utilities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"formatters/"})," - Human-readable formatting"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hooks/"})," - React hooks (useQuery, useLocalStorage, etc.)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Most are pure functions"})," - can be tested without React Context."]}),"\n",(0,r.jsx)(n.h3,{id:"constants--static-constants",children:"constants/ \u2014 Static Constants"}),"\n",(0,r.jsx)(n.p,{children:"Organized by domain (routes, API, socket events, ports):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"routes.ts"})," - ROUTES object (navigation)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"api-endpoints.ts"})," - API_ENDPOINTS object"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"socket-events.ts"})," - SOCKET_EVENTS_EMIT, SOCKET_EVENTS_ON"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"well-known-ports.ts"})," - Port database + lookup functions"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/constants",children:"constants.md"})," for complete reference."]}),"\n",(0,r.jsx)(n.h3,{id:"forms--react-hook-form-integration",children:"forms/ \u2014 React Hook Form Integration"}),"\n",(0,r.jsx)(n.p,{children:"Builds on top of React Hook Form + Zod for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multi-stage validation pipelines"}),"\n",(0,r.jsx)(n.li,{children:"Form state persistence"}),"\n",(0,r.jsx)(n.li,{children:"Resource synchronization"}),"\n",(0,r.jsx)(n.li,{children:"Network-specific validators"}),"\n",(0,r.jsx)(n.li,{children:"Backend error mapping"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Requires React"})," - forms/ context and hooks."]}),"\n",(0,r.jsx)(n.h3,{id:"i18n--internationalization",children:"i18n/ \u2014 Internationalization"}),"\n",(0,r.jsx)(n.p,{children:"i18next setup with:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Language detection"}),"\n",(0,r.jsx)(n.li,{children:"RTL/LTR support"}),"\n",(0,r.jsx)(n.li,{children:"Translation providers"}),"\n",(0,r.jsx)(n.li,{children:"Locale files (.json)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Requires React"})," - i18n/ providers and hooks."]}),"\n",(0,r.jsx)(n.h2,{id:"package-configuration-nx",children:"Package Configuration (Nx)"}),"\n",(0,r.jsxs)(n.p,{children:["Each sub-library is a ",(0,r.jsx)(n.strong,{children:"Nx library"})," with:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"SourceRoot:"})," ",(0,r.jsx)(n.code,{children:"libs/core/{name}/src"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Targets (in project.json):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lint"})," - ESLint"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"typecheck"})," - TypeScript checking"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"TypeScript Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "strict": true,\n    "module": "esnext",\n    "target": "es2020"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"No build step"})," - Nx handles bundling via apps/ build."]}),"\n",(0,r.jsx)(n.h2,{id:"how-to-add-new-exports",children:"How to Add New Exports"}),"\n",(0,r.jsx)(n.h3,{id:"adding-to-existing-sub-library",children:"Adding to Existing Sub-Library"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Create the file"})," in ",(0,r.jsx)(n.code,{children:"libs/core/{name}/src/{module}.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// libs/core/types/src/my-feature.ts\nexport interface MyType {\n  id: string;\n  name: string;\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Export from sub-library index"})," in ",(0,r.jsx)(n.code,{children:"libs/core/{name}/src/index.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export type { MyType } from './my-feature';\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Verify alias works"})," - import should auto-resolve:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import type { MyType } from '@nasnet/core/types';\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Update documentation"})," - Add to ",(0,r.jsx)(n.a,{href:"/docs/core/",children:"README.md"})," and respective sub-library doc"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"adding-a-new-sub-library-advanced",children:"Adding a New Sub-Library (Advanced)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create directory structure:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir -p libs/core/newlib/src\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create package.json:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "name": "@nasnet/core-newlib",\n  "version": "0.0.1"\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Create project.json"})," - Copy from existing sub-library"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Create src/index.ts"})," - Main export file"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Add to vite.config.ts"})," alias (if not automatic)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Add to documentation"})," - Update README.md"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"testing-conventions",children:"Testing Conventions"}),"\n",(0,r.jsx)(n.h3,{id:"test-files-location",children:"Test Files Location"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Collocated with source: ",(0,r.jsx)(n.code,{children:"module.test.ts"})," or ",(0,r.jsx)(n.code,{children:"module.spec.ts"})]}),"\n",(0,r.jsxs)(n.li,{children:["Shared fixtures in ",(0,r.jsx)(n.code,{children:"__tests__/"})," folder"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"testing-frameworks",children:"Testing Frameworks"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unit tests:"})," Vitest (4x faster than Jest)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type tests:"})," TypeScript strict mode"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coverage:"})," Aim for 80%+ coverage"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-test",children:"Example Test"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// libs/core/utils/src/validation/ipv4.test.ts\nimport { describe, it, expect } from 'vitest';\nimport { validateIPv4 } from './ipv4';\n\ndescribe('validateIPv4', () => {\n  it('validates correct IPv4', () => {\n    expect(validateIPv4('192.168.1.1')).toBe(true);\n  });\n\n  it('rejects invalid IPv4', () => {\n    expect(validateIPv4('999.999.999.999')).toBe(false);\n  });\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"Run tests:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run test                    # All tests\nnpx nx test @nasnet/core-types # Single sub-library\n"})}),"\n",(0,r.jsx)(n.h2,{id:"relationship-to-backend-go",children:"Relationship to Backend (Go)"}),"\n",(0,r.jsxs)(n.p,{children:["TypeScript types mirror ",(0,r.jsx)(n.strong,{children:"Go structs"})," for consistency:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Backend (Go):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type FilterRule struct {\n  ID       string `db:"id"`\n  Chain    string `db:"chain"`\n  Action   string `db:"action"`\n  Protocol string `db:"protocol"`\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Frontend (TypeScript):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export interface FilterRule {\n  id: string;\n  chain: string;\n  action: string;\n  protocol: string;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Connection:"})," GraphQL schema bridges both (see ",(0,r.jsx)(n.code,{children:"schema/"})," directory)."]}),"\n",(0,r.jsx)(n.p,{children:"Code generation creates:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Go \u2192 GraphQL types"}),"\n",(0,r.jsx)(n.li,{children:"GraphQL \u2192 TypeScript types"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"See Docs/architecture/data-architecture.md for Universal State v2 (8-layer model)."}),"\n",(0,r.jsx)(n.h2,{id:"key-design-decisions",children:"Key Design Decisions"}),"\n",(0,r.jsx)(n.h3,{id:"no-react-in-core-typesutilsconstants",children:"No React in Core Types/Utils/Constants"}),"\n",(0,r.jsx)(n.p,{children:"Keeps these modules tree-shakeable and reusable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Can be used in Node.js scripts"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Can be imported by Go code generators"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Zero runtime dependencies (types/)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Minimal external dependencies (utils/)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"zod-for-all-validation",children:"Zod for All Validation"}),"\n",(0,r.jsxs)(n.p,{children:["All form validation uses ",(0,r.jsx)(n.strong,{children:"Zod schemas"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const schema = z.object({\n  port: z.number().min(1).max(65535),\n  address: z.string().ip('v4'),\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Type-safe runtime validation"}),"\n",(0,r.jsx)(n.li,{children:"Automatic TypeScript inference"}),"\n",(0,r.jsx)(n.li,{children:"Composable validators"}),"\n",(0,r.jsx)(n.li,{children:"Custom error messages"}),"\n",(0,r.jsx)(n.li,{children:"Works in server + client"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"universal-state-v2-8-layer-model",children:"Universal State v2 (8-Layer Model)"}),"\n",(0,r.jsx)(n.p,{children:"Resources follow a sophisticated model defined in types/:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Primitive"})," - Basic scalars"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Aggregate"})," - Business entities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Composite"})," - Related entities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Query"})," - GraphQL queries"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache"})," - Apollo Client cache"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local"})," - localStorage/IndexedDB"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sync"})," - Conflict resolution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"UI"})," - Component state"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.code,{children:"Docs/architecture/data-architecture.md"})," for details."]}),"\n",(0,r.jsx)(n.h2,{id:"architectural-boundaries",children:"Architectural Boundaries"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"libs/core"})," is deliberately ",(0,r.jsx)(n.strong,{children:"headless"})," \u2014 it contains no platform-specific UI logic, no visual components, and no rendering. Understanding what lives in core vs. what lives elsewhere is critical:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Concern"}),(0,r.jsx)(n.th,{children:"Where It Lives"}),(0,r.jsx)(n.th,{children:"NOT in libs/core"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Platform detection (",(0,r.jsx)(n.code,{children:"usePlatform"}),")"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/patterns"})}),(0,r.jsx)(n.td,{children:"Core has no knowledge of mobile/tablet/desktop"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"State machines (XState)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/state/machines"})}),(0,r.jsx)(n.td,{children:"Core provides types consumed by machines"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GraphQL hooks (Apollo)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/api-client/queries"})}),(0,r.jsx)(n.td,{children:"Core provides types, api-client provides hooks"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Visual components"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"libs/ui/primitives"}),", ",(0,r.jsx)(n.code,{children:"libs/ui/patterns"})]}),(0,r.jsx)(n.td,{children:"Core has zero UI components"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auth token handling"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"libs/api-client/core"})," (Apollo links)"]}),(0,r.jsx)(n.td,{children:"Core has no auth state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Router communication"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"apps/backend"})," (Go proxy)"]}),(0,r.jsx)(n.td,{children:"Core is frontend-only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Storybook stories"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/*/stories"})}),(0,r.jsx)(n.td,{children:"Core has no visual components to story"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why this matters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Core can be used in non-React contexts (CLI tools, code generators, test utilities)"}),"\n",(0,r.jsx)(n.li,{children:"Core types and utils are tree-shakeable with zero UI framework dependencies"}),"\n",(0,r.jsxs)(n.li,{children:["Only ",(0,r.jsx)(n.code,{children:"libs/core/forms"})," and ",(0,r.jsx)(n.code,{children:"libs/core/i18n"})," have React dependencies (by design)"]}),"\n",(0,r.jsx)(n.li,{children:"This separation enables sharing types with the Go backend via code generation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Boundary violations to avoid:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Never import from ",(0,r.jsx)(n.code,{children:"@nasnet/ui/*"})," in core (upward dependency)"]}),"\n",(0,r.jsxs)(n.li,{children:["Never import from ",(0,r.jsx)(n.code,{children:"@nasnet/features/*"})," in core (upward dependency)"]}),"\n",(0,r.jsxs)(n.li,{children:["Never import from ",(0,r.jsx)(n.code,{children:"@nasnet/api-client"})," in core (peer dependency)"]}),"\n",(0,r.jsx)(n.li,{children:"Never add platform-specific logic (window size, touch detection) to core"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsx)(n.h3,{id:"sub-library-references",children:"Sub-Library References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/",children:"README.md"})," - Master index with architecture diagram"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/constants",children:"constants.md"})," - Routes, endpoints, socket events, ports"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/types",children:"types.md"})," - Complete type reference"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/utils",children:"utils.md"})," - Utility functions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/forms",children:"forms.md"})," - React Hook Form"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/sub-libraries/i18n",children:"i18n.md"})," - Internationalization"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-cutting-guides",children:"Cross-Cutting Guides"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/error-handling-patterns",children:"error-handling-patterns.md"})," - Error types, backend mapping, i18n messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/graphql-integration-guide",children:"graphql-integration-guide.md"})," - Type flow, codegen, Apollo patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/testing-patterns",children:"testing-patterns.md"})," - Vitest setup, hook testing, mock strategies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/state-machines-guide",children:"state-machines-guide.md"})," - XState machines for complex workflows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/accessibility-patterns",children:"accessibility-patterns.md"})," - A11yProvider, WCAG AAA compliance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/performance-patterns",children:"performance-patterns.md"})," - Auto-scroll, caching, bundle size"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/core/guides/security-patterns",children:"security-patterns.md"})," - Input validation, error safety"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"system-architecture",children:"System Architecture"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"System-wide architecture (see Docs/architecture/index.md)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(14041);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);
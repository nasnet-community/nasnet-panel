"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[55295],{25685:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"stores/hooks-utilities","title":"Hooks & Utility Functions","description":"Comprehensive reference for authentication hooks, route guards, and error recovery utilities.","source":"@site/../../libs/state/docs/stores/hooks-utilities.md","sourceDirName":"stores","slug":"/stores/hooks-utilities","permalink":"/docs/state/stores/hooks-utilities","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/state/docs/stores/hooks-utilities.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Hooks & Utility Functions"},"sidebar":"sidebar","previous":{"title":"Router Store (useRouterStore)","permalink":"/docs/state/stores/router"},"next":{"title":"Selectors Reference","permalink":"/docs/state/stores/selectors-reference"}}');var t=r(31085),i=r(71184);const o={sidebar_position:4,title:"Hooks & Utility Functions"},c="Hooks & Utility Functions",l={},a=[{value:"Route Guard Hooks",id:"route-guard-hooks",level:2},{value:"<code>requireAuth</code> \u2014 TanStack Router Guard",id:"requireauth--tanstack-router-guard",level:3},{value:"<code>requirePermission</code> \u2014 Permission Gate",id:"requirepermission--permission-gate",level:3},{value:"<code>requireGuest</code> \u2014 Guest-Only Guard",id:"requireguest--guest-only-guard",level:3},{value:"Component-Level Auth Hooks",id:"component-level-auth-hooks",level:2},{value:"<code>useRequireAuth</code> \u2014 Component-Level Auth Check",id:"userequireauth--component-level-auth-check",level:3},{value:"<code>useHasPermission</code> \u2014 Permission Check Hook",id:"usehaspermission--permission-check-hook",level:3},{value:"<code>useCurrentUser</code> \u2014 Get User Profile",id:"usecurrentuser--get-user-profile",level:3},{value:"<code>useAuthActions</code> \u2014 Auth Action Functions",id:"useauthactions--auth-action-functions",level:3},{value:"Token Refresh Hook",id:"token-refresh-hook",level:2},{value:"<code>useTokenRefresh</code> \u2014 Automatic Token Refresh",id:"usetokenrefresh--automatic-token-refresh",level:3},{value:"Helper: <code>createMutationRefreshFn</code> \u2014 Apollo Integration",id:"helper-createmutationrefreshfn--apollo-integration",level:3},{value:"Reconnection Utilities",id:"reconnection-utilities",level:2},{value:"<code>calculateBackoff</code> \u2014 Exponential Backoff Calculation",id:"calculatebackoff--exponential-backoff-calculation",level:3},{value:"<code>sleep</code> \u2014 Promise-Based Delay",id:"sleep--promise-based-delay",level:3},{value:"<code>createReconnectionManager</code> \u2014 Reconnection State Machine",id:"createreconnectionmanager--reconnection-state-machine",level:3},{value:"<code>createLatencyUpdater</code> \u2014 Debounced Latency Tracking",id:"createlatencyupdater--debounced-latency-tracking",level:3},{value:"Error Recovery Utilities",id:"error-recovery-utilities",level:2},{value:"<code>withRetry</code> \u2014 Execute with Automatic Retry",id:"withretry--execute-with-automatic-retry",level:3},{value:"<code>createRetryHandler</code> \u2014 Reusable Retry Function",id:"createretryhandler--reusable-retry-function",level:3},{value:"<code>clearAllCache</code> \u2014 Clear All Cache Data",id:"clearallcache--clear-all-cache-data",level:3},{value:"<code>clearCacheAndReload</code> \u2014 Clear Cache and Reload",id:"clearcacheandreload--clear-cache-and-reload",level:3},{value:"<code>generateIssueReport</code> \u2014 Generate Error Report",id:"generateissuereport--generate-error-report",level:3},{value:"<code>copyIssueReport</code> \u2014 Copy Report to Clipboard",id:"copyissuereport--copy-report-to-clipboard",level:3},{value:"<code>openIssueReporter</code> \u2014 Open GitHub Issue Template",id:"openissuereporter--open-github-issue-template",level:3},{value:"<code>createRecoveryActions</code> \u2014 Grouped Recovery Actions",id:"createrecoveryactions--grouped-recovery-actions",level:3},{value:"<code>useRecoveryActions</code> \u2014 Hook for Recovery Actions",id:"userecoveryactions--hook-for-recovery-actions",level:3},{value:"Decision Matrix",id:"decision-matrix",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"hooks--utility-functions",children:"Hooks & Utility Functions"})}),"\n",(0,t.jsx)(n.p,{children:"Comprehensive reference for authentication hooks, route guards, and error recovery utilities."}),"\n",(0,t.jsx)(n.h2,{id:"route-guard-hooks",children:"Route Guard Hooks"}),"\n",(0,t.jsx)(n.p,{children:"Route guards for TanStack Router and component-level authentication checks."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Source:"})," ",(0,t.jsx)(n.code,{children:"libs/state/stores/src/hooks/useRouteGuard.ts"})]}),"\n",(0,t.jsxs)(n.h3,{id:"requireauth--tanstack-router-guard",children:[(0,t.jsx)(n.code,{children:"requireAuth"})," \u2014 TanStack Router Guard"]}),"\n",(0,t.jsx)(n.p,{children:"Protects routes from unauthenticated access. Redirects to login with return URL preservation."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function requireAuth({ location }: { location: RouteLocation }): void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage with TanStack Router:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { createRoute } from '@tanstack/react-router';\nimport { requireAuth } from '@nasnet/state/stores';\n\nexport const dashboardRoute = createRoute({\n  getParentRoute: () => rootRoute,\n  path: '/dashboard',\n  beforeLoad: requireAuth,  // Apply guard here\n  component: Dashboard,\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Checks if ",(0,t.jsx)(n.code,{children:"isAuthenticated"})," is true"]}),"\n",(0,t.jsx)(n.li,{children:"Validates token expiry"}),"\n",(0,t.jsxs)(n.li,{children:["If not authenticated or token expired:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Redirects to ",(0,t.jsx)(n.code,{children:"/login"})]}),"\n",(0,t.jsxs)(n.li,{children:["Preserves current URL in ",(0,t.jsx)(n.code,{children:"redirect"})," search param"]}),"\n",(0,t.jsx)(n.li,{children:"User can be redirected back after login"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Authenticated + valid token \u2192 Allow access"}),"\n",(0,t.jsxs)(n.li,{children:["\u274c Not authenticated OR token expired \u2192 Redirect to ",(0,t.jsx)(n.code,{children:"/login?redirect=/dashboard"})]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"requirepermission--permission-gate",children:[(0,t.jsx)(n.code,{children:"requirePermission"})," \u2014 Permission Gate"]}),"\n",(0,t.jsx)(n.p,{children:"Creates a route guard that checks for specific permissions."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function requirePermission(permission: string): (context: { location: RouteLocation }) => void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"export const adminRoute = createRoute({\n  beforeLoad: requirePermission('admin'),  // Only admins\n  component: AdminPanel,\n});\n\nexport const reportsRoute = createRoute({\n  beforeLoad: requirePermission('reports:read'),\n  component: ReportsPage,\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["First checks authentication (calls ",(0,t.jsx)(n.code,{children:"requireAuth"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Then checks user permissions"}),"\n",(0,t.jsxs)(n.li,{children:["If permission missing:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Redirects to ",(0,t.jsx)(n.code,{children:"/unauthorized"})]}),"\n",(0,t.jsx)(n.li,{children:"Includes required permission in search params"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Authenticated + has permission \u2192 Allow access"}),"\n",(0,t.jsxs)(n.li,{children:["\u274c Authenticated but missing permission \u2192 Redirect to ",(0,t.jsx)(n.code,{children:"/unauthorized?required=admin"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c Not authenticated \u2192 Redirect to ",(0,t.jsx)(n.code,{children:"/login"})]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"requireguest--guest-only-guard",children:[(0,t.jsx)(n.code,{children:"requireGuest"})," \u2014 Guest-Only Guard"]}),"\n",(0,t.jsx)(n.p,{children:"Redirects authenticated users away from guest-only pages (login, register, etc)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function requireGuest({ location }: { location: RouteLocation }): void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"export const loginRoute = createRoute({\n  beforeLoad: requireGuest,\n  component: LoginPage,\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Checks if user is authenticated AND token is valid"}),"\n",(0,t.jsxs)(n.li,{children:["If both true:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Gets redirect URL from ",(0,t.jsx)(n.code,{children:"search.redirect"})," param"]}),"\n",(0,t.jsxs)(n.li,{children:["Redirects to that URL or ",(0,t.jsx)(n.code,{children:"/dashboard"})," if not specified"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Not authenticated \u2192 Allow access to login page"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Authenticated + valid token \u2192 Redirect to dashboard (or redirect param)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"component-level-auth-hooks",children:"Component-Level Auth Hooks"}),"\n",(0,t.jsx)(n.p,{children:"React hooks for checking auth status within components."}),"\n",(0,t.jsxs)(n.h3,{id:"userequireauth--component-level-auth-check",children:[(0,t.jsx)(n.code,{children:"useRequireAuth"})," \u2014 Component-Level Auth Check"]}),"\n",(0,t.jsx)(n.p,{children:"Provides current auth status for conditional rendering."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface AuthStatus {\n  isAuthenticated: boolean;    // User logged in with valid token\n  isExpired: boolean;          // Token has expired\n  isExpiringSoon: boolean;     // Token expires within 5 minutes\n}\n\nfunction useRequireAuth(): AuthStatus\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'function ProtectedContent() {\n  const { isAuthenticated, isExpired, isExpiringSoon } = useRequireAuth();\n\n  if (!isAuthenticated) {\n    return <Navigate to="/login" />;\n  }\n\n  if (isExpiringSoon) {\n    return <SessionExpiringDialog />;\n  }\n\n  return <DashboardContent />;\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to use:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Conditional rendering based on auth status"}),"\n",(0,t.jsx)(n.li,{children:"Showing session expiry warnings"}),"\n",(0,t.jsx)(n.li,{children:"Protecting component-level features"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"usehaspermission--permission-check-hook",children:[(0,t.jsx)(n.code,{children:"useHasPermission"})," \u2014 Permission Check Hook"]}),"\n",(0,t.jsx)(n.p,{children:"Check if user has a specific permission."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function useHasPermission(permission: string): boolean\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function AdminButton() {\n  const hasAdminAccess = useHasPermission('admin');\n\n  if (!hasAdminAccess) return null;  // Don't render button\n\n  return <Button onClick={openAdminPanel}>Admin Panel</Button>;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Permissions example:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'admin'"})," - Full system access"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'reports:read'"})," - Can view reports"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'reports:write'"})," - Can create/edit reports"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'system:backup'"})," - Can create backups"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"usecurrentuser--get-user-profile",children:[(0,t.jsx)(n.code,{children:"useCurrentUser"})," \u2014 Get User Profile"]}),"\n",(0,t.jsx)(n.p,{children:"Get current logged-in user information."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface User {\n  id: string;\n  username: string;\n  email: string | null;\n  permissions: string[];\n}\n\nfunction useCurrentUser(): User | null\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function UserGreeting() {\n  const user = useCurrentUser();\n\n  if (!user) return <LoginPrompt />;\n\n  return <div>Welcome, {user.username}!</div>;\n}\n\nfunction PermissionsList() {\n  const user = useCurrentUser();\n  return (\n    <ul>\n      {user?.permissions.map((p) => (\n        <li key={p}>{p}</li>\n      ))}\n    </ul>\n  );\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"useauthactions--auth-action-functions",children:[(0,t.jsx)(n.code,{children:"useAuthActions"})," \u2014 Auth Action Functions"]}),"\n",(0,t.jsx)(n.p,{children:"Get stable references to auth actions."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface AuthActions {\n  login: (token, user, expiresAt, refreshToken) => void;\n  logout: () => void;\n  updateActivity: () => void;\n}\n\nfunction useAuthActions(): AuthActions\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'function LogoutButton() {\n  const { logout } = useAuthActions();\n\n  return (\n    <Button onClick={logout} variant="destructive">\n      Logout\n    </Button>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"token-refresh-hook",children:"Token Refresh Hook"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Source:"})," ",(0,t.jsx)(n.code,{children:"libs/state/stores/src/hooks/useTokenRefresh.ts"})]}),"\n",(0,t.jsxs)(n.h3,{id:"usetokenrefresh--automatic-token-refresh",children:[(0,t.jsx)(n.code,{children:"useTokenRefresh"})," \u2014 Automatic Token Refresh"]}),"\n",(0,t.jsx)(n.p,{children:"Proactively refreshes JWT tokens before expiry to maintain sessions."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"export interface UseTokenRefreshOptions {\n  refreshTokenFn: () => Promise<TokenRefreshResult>;\n  onReauthRequired?: () => void;\n  showNotifications?: boolean;\n  checkInterval?: number;  // Default: 60000ms (1 minute)\n}\n\nfunction useTokenRefresh(options: UseTokenRefreshOptions): void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Constants:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const REFRESH_CHECK_INTERVAL_MS = 60_000;      // Check every 1 minute\nconst MAX_REFRESH_ATTEMPTS = 3;                 // Max 3 attempts before re-auth\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function AuthProvider({ children }) {\n  const { refresh } = useAuthQuery();\n\n  useTokenRefresh({\n    refreshTokenFn: async () => {\n      const result = await refresh();\n      return {\n        token: result.token,\n        expiresAt: new Date(result.expiresAt),\n        refreshToken: result.refreshToken,\n      };\n    },\n    onReauthRequired: () => {\n      // User needs to log in again\n      navigate('/login');\n    },\n    showNotifications: true,  // Show toast on errors\n  });\n\n  return children;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Checks token expiry every 60 seconds"}),"\n",(0,t.jsxs)(n.li,{children:["If token expires within 5 minutes AND should retry:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Calls ",(0,t.jsx)(n.code,{children:"refreshTokenFn()"})]}),"\n",(0,t.jsx)(n.li,{children:"Updates auth store with new token"}),"\n",(0,t.jsx)(n.li,{children:"Resets refresh attempts on success"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["If refresh fails:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Increments attempt counter"}),"\n",(0,t.jsx)(n.li,{children:"Retries up to 3 times"}),"\n",(0,t.jsxs)(n.li,{children:["After 3 failures: shows notification + calls ",(0,t.jsx)(n.code,{children:"onReauthRequired()"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Refresh flow:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"60s interval check\n  \u2193\nToken expiring within 5 minutes? AND can retry?\n  \u251c\u2500 YES \u2192 Call refreshTokenFn()\n  \u2502        \u251c\u2500 SUCCESS \u2192 setAuth() + resetAttempts()\n  \u2502        \u2514\u2500 FAIL \u2192 incrementAttempts() \u2192 Check if >= 3\n  \u2502                   \u2514\u2500 YES \u2192 Show error + call onReauthRequired()\n  \u2502\n  \u2514\u2500 NO \u2192 Continue waiting\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When refresh fails:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["After 3 failed attempts, user sees notification: ",(0,t.jsx)(n.em,{children:'"Your session is about to expire. Please log in again."'})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"onReauthRequired()"})," callback is triggered"]}),"\n",(0,t.jsx)(n.li,{children:"Typically redirects to login page"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"helper-createmutationrefreshfn--apollo-integration",children:["Helper: ",(0,t.jsx)(n.code,{children:"createMutationRefreshFn"})," \u2014 Apollo Integration"]}),"\n",(0,t.jsx)(n.p,{children:"Create a refresh function from Apollo GraphQL mutation."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function createMutationRefreshFn(\n  mutation: () => Promise<{ token: string; expiresAt: string; refreshToken?: string }>\n): TokenRefreshFn\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { useRefreshTokenMutation } from '@nasnet/api-client/queries';\n\nfunction AuthProvider({ children }) {\n  const [refreshMutation] = useRefreshTokenMutation();\n\n  useTokenRefresh({\n    refreshTokenFn: createMutationRefreshFn(async () => {\n      const result = await refreshMutation();\n      return {\n        token: result.data.refreshToken.token,\n        expiresAt: result.data.refreshToken.expiresAt,\n        refreshToken: result.data.refreshToken.refreshToken,\n      };\n    }),\n  });\n\n  return children;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"reconnection-utilities",children:"Reconnection Utilities"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Source:"})," ",(0,t.jsx)(n.code,{children:"libs/state/stores/src/utils/reconnect.ts"})]}),"\n",(0,t.jsx)(n.p,{children:"WebSocket reconnection with exponential backoff."}),"\n",(0,t.jsxs)(n.h3,{id:"calculatebackoff--exponential-backoff-calculation",children:[(0,t.jsx)(n.code,{children:"calculateBackoff"})," \u2014 Exponential Backoff Calculation"]}),"\n",(0,t.jsx)(n.p,{children:"Calculate delay for retry attempt with jitter."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function calculateBackoff(attempt: number): number\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Formula:"})," ",(0,t.jsx)(n.code,{children:"min(baseDelay * 2^attempt + jitter, maxDelay)"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Delay schedule:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Attempt"}),(0,t.jsx)(n.th,{children:"Delay"}),(0,t.jsx)(n.th,{children:"Total"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"0"}),(0,t.jsx)(n.td,{children:"~1-2s"}),(0,t.jsx)(n.td,{children:"~1-2s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"~2-3s"}),(0,t.jsx)(n.td,{children:"~3-5s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"2"}),(0,t.jsx)(n.td,{children:"~4-5s"}),(0,t.jsx)(n.td,{children:"~7-10s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"3"}),(0,t.jsx)(n.td,{children:"~8-9s"}),(0,t.jsx)(n.td,{children:"~15-19s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"4"}),(0,t.jsx)(n.td,{children:"~16-17s"}),(0,t.jsx)(n.td,{children:"~31-36s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"5+"}),(0,t.jsx)(n.td,{children:"~30s (capped)"}),(0,t.jsx)(n.td,{children:"30+ seconds"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"for (let attempt = 0; attempt < maxAttempts; attempt++) {\n  try {\n    await connect();\n    break; // Success\n  } catch (error) {\n    const delay = calculateBackoff(attempt);\n    console.log(`Retrying in ${delay}ms...`);\n    await sleep(delay);\n  }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why jitter?"})," Prevents thundering herd \u2014 when many clients reconnect simultaneously, they don't all retry at the same time."]}),"\n",(0,t.jsxs)(n.h3,{id:"sleep--promise-based-delay",children:[(0,t.jsx)(n.code,{children:"sleep"})," \u2014 Promise-Based Delay"]}),"\n",(0,t.jsx)(n.p,{children:"Sleep for specified duration."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function sleep(ms: number): Promise<void>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"await sleep(1000);  // Wait 1 second\n// Or in loops\nawait sleep(calculateBackoff(attempt));\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"createreconnectionmanager--reconnection-state-machine",children:[(0,t.jsx)(n.code,{children:"createReconnectionManager"})," \u2014 Reconnection State Machine"]}),"\n",(0,t.jsx)(n.p,{children:"Manages reconnection with exponential backoff and connection store integration."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface ReconnectionManagerConfig {\n  maxAttempts?: number;                        // Default: 10\n  connect: () => Promise<void>;                // Connection function\n  onStatusChange?: (status: WebSocketStatus) => void;\n  showNotifications?: boolean;                 // Default: true\n}\n\ninterface ReconnectionManager {\n  start: () => void;                           // Start reconnection\n  stop: () => void;                            // Stop reconnection\n  reset: () => void;                           // Reset attempt counter\n  getAttempts: () => number;                   // Get current attempt count\n  isActive: () => boolean;                     // Check if reconnecting\n}\n\nfunction createReconnectionManager(config: ReconnectionManagerConfig): ReconnectionManager\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const manager = createReconnectionManager({\n  maxAttempts: 10,\n  connect: async () => {\n    await websocket.connect();\n  },\n  onStatusChange: (status) => {\n    console.log('WebSocket status:', status);\n  },\n  showNotifications: true,\n});\n\n// Start reconnecting\nmanager.start();\n\n// Check status\nif (manager.isActive()) {\n  console.log(`Reconnection attempt ${manager.getAttempts()} of 10`);\n}\n\n// Stop when done\nmanager.stop();\n\n// Reset for new connection attempt\nmanager.reset();\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Automatically updates connection store status"}),"\n",(0,t.jsx)(n.li,{children:"Shows toast notifications on error/success"}),"\n",(0,t.jsx)(n.li,{children:"Stops after max attempts (default 10)"}),"\n",(0,t.jsx)(n.li,{children:"Integrates with notification store"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"createlatencyupdater--debounced-latency-tracking",children:[(0,t.jsx)(n.code,{children:"createLatencyUpdater"})," \u2014 Debounced Latency Tracking"]}),"\n",(0,t.jsx)(n.p,{children:"Create a debounced latency update function."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function createLatencyUpdater(intervalMs?: number): (routerId: string, latencyMs: number) => void\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Default interval:"})," 100ms"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const updateLatency = createLatencyUpdater(100);  // Throttle to max 1 update per 100ms\n\n// In WebSocket ping handler\nwebsocket.on('pong', (latencyMs) => {\n  updateLatency(routerId, latencyMs);\n  // Updates connection store, but max once per 100ms\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why throttle?"})," Without throttling, frequent pings cause excessive store updates and re-renders. Throttling limits updates to reasonable intervals."]}),"\n",(0,t.jsx)(n.h2,{id:"error-recovery-utilities",children:"Error Recovery Utilities"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Source:"})," ",(0,t.jsx)(n.code,{children:"libs/state/stores/src/utils/recovery.ts"})]}),"\n",(0,t.jsx)(n.p,{children:"Retry, cache clearing, and error reporting."}),"\n",(0,t.jsxs)(n.h3,{id:"withretry--execute-with-automatic-retry",children:[(0,t.jsx)(n.code,{children:"withRetry"})," \u2014 Execute with Automatic Retry"]}),"\n",(0,t.jsx)(n.p,{children:"Execute operation with exponential backoff retry."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface RetryConfig {\n  maxRetries?: number;                         // Default: 3\n  initialDelayMs?: number;                     // Default: 1000\n  maxDelayMs?: number;                         // Default: 30000\n  showNotifications?: boolean;                 // Default: true\n  onRetry?: (attempt: number, error: Error) => void;\n  onMaxRetriesExceeded?: (error: Error) => void;\n  shouldRetry?: (error: Error, attempt: number) => boolean;\n}\n\ninterface RetryResult<T> {\n  success: boolean;\n  data?: T;\n  error?: Error;\n  attempts: number;\n}\n\nasync function withRetry<T>(\n  operation: () => Promise<T>,\n  config?: RetryConfig\n): Promise<RetryResult<T>>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const result = await withRetry(\n  () => fetchRouterData(routerId),\n  {\n    maxRetries: 3,\n    onRetry: (attempt, error) => {\n      console.log(`Retry ${attempt}: ${error.message}`);\n    },\n    shouldRetry: (error) => {\n      // Don't retry authentication errors\n      return error.code !== 'AUTH_FAILED';\n    },\n  }\n);\n\nif (result.success) {\n  console.log('Data:', result.data);\n  console.log(`Succeeded on attempt ${result.attempts}`);\n} else {\n  console.error('Failed after', result.attempts, 'attempts');\n  console.error('Error:', result.error?.message);\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"createretryhandler--reusable-retry-function",children:[(0,t.jsx)(n.code,{children:"createRetryHandler"})," \u2014 Reusable Retry Function"]}),"\n",(0,t.jsx)(n.p,{children:"Create a function that can be called to retry an operation."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function createRetryHandler<T>(\n  operation: () => Promise<T>,\n  config?: RetryConfig\n): () => Promise<RetryResult<T>>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function DataComponent() {\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n\n  const retry = createRetryHandler(\n    async () => {\n      const result = await fetchData();\n      setData(result);\n      setError(null);\n    },\n    {\n      onMaxRetriesExceeded: (err) => setError(err),\n    }\n  );\n\n  return error ? (\n    <ErrorCard onRetry={retry} />\n  ) : (\n    <DataDisplay data={data} />\n  );\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"clearallcache--clear-all-cache-data",children:[(0,t.jsx)(n.code,{children:"clearAllCache"})," \u2014 Clear All Cache Data"]}),"\n",(0,t.jsx)(n.p,{children:"Clear Apollo cache and localStorage cache keys."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async function clearAllCache(): Promise<void>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What it clears:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["All localStorage keys starting with ",(0,t.jsx)(n.code,{children:"apollo-"})," or containing ",(0,t.jsx)(n.code,{children:"-cache"})]}),"\n",(0,t.jsx)(n.li,{children:"All sessionStorage cache keys"}),"\n",(0,t.jsx)(n.li,{children:"Shows success notification"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// In error recovery flow\nawait clearAllCache();\n// Wait for notification to show\nawait sleep(500);\n// Reload page\nwindow.location.reload();\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"clearcacheandreload--clear-cache-and-reload",children:[(0,t.jsx)(n.code,{children:"clearCacheAndReload"})," \u2014 Clear Cache and Reload"]}),"\n",(0,t.jsx)(n.p,{children:"Clear cache and reload page in one call."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async function clearCacheAndReload(): Promise<void>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// When user clicks "Clear cache and reload"\nawait clearCacheAndReload();\n// Function handles everything automatically\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"generateissuereport--generate-error-report",children:[(0,t.jsx)(n.code,{children:"generateIssueReport"})," \u2014 Generate Error Report"]}),"\n",(0,t.jsx)(n.p,{children:"Create structured error report for bug reporting."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface IssueReport {\n  message: string;           // Error message\n  code?: string;             // Error code\n  stack?: string;            // Stack trace\n  component?: string;        // Component name\n  url: string;               // Current URL\n  timestamp: string;         // ISO timestamp\n  userAgent: string;         // Browser info\n  context?: Record<string, unknown>;  // Additional context\n}\n\nfunction generateIssueReport(\n  error: Error,\n  context?: Record<string, unknown>\n): IssueReport\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const report = generateIssueReport(error, {\n  routerId: 'router-123',\n  action: 'backup-restore',\n});\n\nconsole.log(JSON.stringify(report, null, 2));\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"copyissuereport--copy-report-to-clipboard",children:[(0,t.jsx)(n.code,{children:"copyIssueReport"})," \u2014 Copy Report to Clipboard"]}),"\n",(0,t.jsx)(n.p,{children:"Generate error report and copy to clipboard."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async function copyIssueReport(\n  error: Error,\n  context?: Record<string, unknown>\n): Promise<void>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"<Button\n  onClick={() =>\n    copyIssueReport(error, { routerId: selectedRouterId })\n  }\n>\n  Copy Error Details\n</Button>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Copies JSON report to clipboard"}),"\n",(0,t.jsx)(n.li,{children:"Shows success notification"}),"\n",(0,t.jsx)(n.li,{children:"Falls back to console log if clipboard unavailable"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"openissuereporter--open-github-issue-template",children:[(0,t.jsx)(n.code,{children:"openIssueReporter"})," \u2014 Open GitHub Issue Template"]}),"\n",(0,t.jsx)(n.p,{children:"Open GitHub issues page with pre-filled error report."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function openIssueReporter(\n  error: Error,\n  context?: Record<string, unknown>\n): void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"<Button\n  onClick={() =>\n    openIssueReporter(error, {\n      feature: 'router-backup',\n    })\n  }\n>\n  Report on GitHub\n</Button>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What it does:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Generates structured issue body"}),"\n",(0,t.jsx)(n.li,{children:"Opens GitHub issues page"}),"\n",(0,t.jsx)(n.li,{children:"Pre-fills title and description"}),"\n",(0,t.jsx)(n.li,{children:"Includes error details, context, and JSON report"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"createrecoveryactions--grouped-recovery-actions",children:[(0,t.jsx)(n.code,{children:"createRecoveryActions"})," \u2014 Grouped Recovery Actions"]}),"\n",(0,t.jsx)(n.p,{children:"Create set of recovery actions for an error."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface RecoveryActions {\n  retry: () => Promise<void>;\n  clearCacheAndRetry: () => Promise<void>;\n  copyReport: () => Promise<void>;\n  reportIssue: () => void;\n  reload: () => void;\n  goHome: () => void;\n  goBack: () => void;\n}\n\nfunction createRecoveryActions(\n  error: Error,\n  retryFn?: () => Promise<void>,\n  context?: Record<string, unknown>\n): RecoveryActions\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function ErrorBoundary({ error, onRetry }) {\n  const actions = createRecoveryActions(error, onRetry, {\n    feature: 'dashboard',\n  });\n\n  return (\n    <ErrorDisplay\n      error={error}\n      onRetry={actions.retry}\n      onClearCache={actions.clearCacheAndRetry}\n      onReport={actions.reportIssue}\n    />\n  );\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"userecoveryactions--hook-for-recovery-actions",children:[(0,t.jsx)(n.code,{children:"useRecoveryActions"})," \u2014 Hook for Recovery Actions"]}),"\n",(0,t.jsx)(n.p,{children:"React hook for creating recovery actions."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Type signature:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function useRecoveryActions(\n  error: Error | null,\n  retryFn?: () => Promise<void>,\n  context?: Record<string, unknown>\n): RecoveryActions | null\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"function DataComponent() {\n  const { data, error, refetch } = useQuery(GET_DATA);\n  const recovery = useRecoveryActions(error, refetch);\n\n  if (error && recovery) {\n    return (\n      <ErrorCard\n        error={error}\n        onRetry={recovery.retry}\n        onReport={recovery.reportIssue}\n      />\n    );\n  }\n\n  return <DataDisplay data={data} />;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"decision-matrix",children:"Decision Matrix"}),"\n",(0,t.jsx)(n.p,{children:"When to use each utility:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Scenario"}),(0,t.jsx)(n.th,{children:"Use"}),(0,t.jsx)(n.th,{children:"Example"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Protect route from unauth"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"requireAuth"})}),(0,t.jsx)(n.td,{children:"Dashboard route"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Require specific permission"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"requirePermission"})}),(0,t.jsx)(n.td,{children:"Admin panel route"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Redirect authenticated users"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"requireGuest"})}),(0,t.jsx)(n.td,{children:"Login page route"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Check auth in component"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useRequireAuth"})}),(0,t.jsx)(n.td,{children:"Conditional rendering"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Check single permission"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useHasPermission"})}),(0,t.jsx)(n.td,{children:"Show/hide button"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Maintain token freshness"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useTokenRefresh"})}),(0,t.jsx)(n.td,{children:"AuthProvider setup"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Auto-reconnect WebSocket"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"createReconnectionManager"})}),(0,t.jsx)(n.td,{children:"Connection loss handling"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Retry failed operations"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"withRetry"})}),(0,t.jsx)(n.td,{children:"Fetch errors"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Report errors to users"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"createRecoveryActions"})}),(0,t.jsx)(n.td,{children:"Error boundary"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Clear corrupted data"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"clearAllCache"})}),(0,t.jsx)(n.td,{children:"Severe errors"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/state/stores/auth",children:"Auth Store"})})," \u2014 Token, user, and session state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/state/stores/router",children:"Router Store"})})," \u2014 Router discovery and selection"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/state/stores/connection",children:"Connection Store"})})," \u2014 WebSocket connection state"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},71184:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var s=r(14041);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);
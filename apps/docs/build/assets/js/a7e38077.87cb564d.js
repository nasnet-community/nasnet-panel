"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[38097],{71184:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var t=s(14041);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},73752:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"cross-cutting-features/alerts-system","title":"Alerts System","description":"The alerts system provides rule-based notifications for router and service events. Users define conditions, choose channels for delivery, configure quiet hours, and receive in-app or external notifications when conditions trigger.","source":"@site/../connect/docs/cross-cutting-features/alerts-system.md","sourceDirName":"cross-cutting-features","slug":"/cross-cutting-features/alerts-system","permalink":"/docs/frontend/cross-cutting-features/alerts-system","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/cross-cutting-features/alerts-system.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Routing \u2014 TanStack Router","permalink":"/docs/frontend/architecture/routing"},"next":{"title":"Change Set System","permalink":"/docs/frontend/cross-cutting-features/change-set-system"}}');var i=s(31085),r=s(71184);const l={},o="Alerts System",c={},d=[{value:"Alert Rules",id:"alert-rules",level:2},{value:"AlertRuleForm Component",id:"alertruleform-component",level:3},{value:"Notification Channels",id:"notification-channels",level:2},{value:"Supported Channels",id:"supported-channels",level:3},{value:"Email Channel Form",id:"email-channel-form",level:3},{value:"Webhook Channel Form",id:"webhook-channel-form",level:3},{value:"Ntfy Channel Form",id:"ntfy-channel-form",level:3},{value:"In-App Notification Store",id:"in-app-notification-store",level:2},{value:"State Structure",id:"state-structure",level:3},{value:"Usage",id:"usage",level:3},{value:"Selector Hooks",id:"selector-hooks",level:3},{value:"Alert List",id:"alert-list",level:2},{value:"Alert Badge",id:"alert-badge",level:2},{value:"QueuedAlertBadge",id:"queuedalertbadge",level:3},{value:"Quiet Hours",id:"quiet-hours",level:2},{value:"QuietHoursConfig Components",id:"quiethoursconfig-components",level:3},{value:"Configuration Structure",id:"configuration-structure",level:3},{value:"Alert Templates",id:"alert-templates",level:2},{value:"Template Application Flow",id:"template-application-flow",level:3},{value:"Template UI Store",id:"template-ui-store",level:3},{value:"Notification Preferences",id:"notification-preferences",level:2},{value:"GraphQL Integration",id:"graphql-integration",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"alerts-system",children:"Alerts System"})}),"\n",(0,i.jsx)(n.p,{children:"The alerts system provides rule-based notifications for router and service events. Users define conditions, choose channels for delivery, configure quiet hours, and receive in-app or external notifications when conditions trigger."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key files:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/"})," \u2014 all UI components"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/alerts/src/hooks/"})," \u2014 alert-specific hooks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/alerts/src/schemas/"})," \u2014 Zod validation schemas"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/state/stores/src/alert-notification.store.ts"})," \u2014 in-app notification queue"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/state/stores/src/alert-rule-template-ui.store.ts"})," \u2014 template browser UI state"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/alerts/"})," \u2014 GraphQL hooks"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cross-references:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.code,{children:"../data-fetching/graphql-hooks.md"})," for subscription patterns"]}),"\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.code,{children:"../state-management/zustand-stores.md"})," for store patterns"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"alert-rules",children:"Alert Rules"}),"\n",(0,i.jsx)(n.p,{children:"An alert rule defines:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Trigger condition"})," \u2014 metric, operator, threshold (e.g., CPU > 80%)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Severity"})," \u2014 CRITICAL, WARNING, or INFO"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Channels"})," \u2014 where notifications are sent"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enabled flag"})," \u2014 pause without deleting"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"alertruleform-component",children:"AlertRuleForm Component"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/AlertRuleForm.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"Used for both create and edit workflows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface AlertRuleFormProps {\n  initialData?: Partial<AlertRuleFormData>;\n  ruleId?: string;       // If provided, edits existing rule\n  onSuccess?: () => void;\n  onCancel?: () => void;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The form uses React Hook Form + Zod (",(0,i.jsx)(n.code,{children:"alertRuleFormSchema"})," from ",(0,i.jsx)(n.code,{children:"schemas/alert-rule.schema.ts"}),"). Fields include:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Condition metric (CPU, memory, link state, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Operator (greater than, less than, equals, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Threshold value"}),"\n",(0,i.jsx)(n.li,{children:"Severity selector (CRITICAL/WARNING/INFO with color indicators)"}),"\n",(0,i.jsx)(n.li,{children:"Channel checkboxes (multi-select)"}),"\n",(0,i.jsx)(n.li,{children:"Enabled toggle"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Mutation hooks used internally:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useCreateAlertRule()"})," for new rules"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useUpdateAlertRule()"})," for edits"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Submit button is disabled when ",(0,i.jsx)(n.code,{children:"!isDirty"})," (no changes from initial data)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notification-channels",children:"Notification Channels"}),"\n",(0,i.jsx)(n.h3,{id:"supported-channels",children:"Supported Channels"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Channel"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Key Files"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"In-App"}),(0,i.jsx)(n.td,{children:"Push (internal)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"InAppNotificationPreferences.tsx"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Email"}),(0,i.jsx)(n.td,{children:"HTTP"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"EmailChannelFormDesktop.tsx"}),", ",(0,i.jsx)(n.code,{children:"EmailChannelFormMobile.tsx"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Webhook"}),(0,i.jsx)(n.td,{children:"HTTP"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"WebhookConfigFormDesktop.tsx"}),", ",(0,i.jsx)(n.code,{children:"WebhookConfigFormMobile.tsx"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Ntfy"}),(0,i.jsx)(n.td,{children:"Push"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"ChannelForms/NtfyChannelFormDesktop.tsx"}),", ",(0,i.jsx)(n.code,{children:"NtfyChannelFormMobile.tsx"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Pushover"}),(0,i.jsx)(n.td,{children:"Push (external)"}),(0,i.jsx)(n.td,{children:"configured via webhook"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Telegram"}),(0,i.jsx)(n.td,{children:"Push (external)"}),(0,i.jsx)(n.td,{children:"configured via webhook"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"All channel forms follow the platform presenter pattern \u2014 Desktop and Mobile variants render from a shared headless hook."}),"\n",(0,i.jsx)(n.h3,{id:"email-channel-form",children:"Email Channel Form"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/EmailChannelFormDesktop.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"SMTP configuration fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Host / Port"}),"\n",(0,i.jsx)(n.li,{children:"Username / Password (sensitive)"}),"\n",(0,i.jsx)(n.li,{children:"TLS mode (none/starttls/tls)"}),"\n",(0,i.jsx)(n.li,{children:"From address"}),"\n",(0,i.jsx)(n.li,{children:"To addresses (comma-separated or multi-value)"}),"\n",(0,i.jsx)(n.li,{children:"Subject template"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"webhook-channel-form",children:"Webhook Channel Form"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/WebhookConfigFormDesktop.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"Fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"URL (required, validated as HTTPS)"}),"\n",(0,i.jsx)(n.li,{children:"HTTP method (POST/GET/PUT)"}),"\n",(0,i.jsx)(n.li,{children:"Custom headers (key-value pairs)"}),"\n",(0,i.jsxs)(n.li,{children:["Payload template (Handlebars-style ",(0,i.jsx)(n.code,{children:"{{severity}}"}),", ",(0,i.jsx)(n.code,{children:"{{message}}"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Secret for HMAC signing (optional)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ntfy-channel-form",children:"Ntfy Channel Form"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/ChannelForms/NtfyChannelFormDesktop.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"Fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Server URL (default: ",(0,i.jsx)(n.code,{children:"https://ntfy.sh"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Topic name"}),"\n",(0,i.jsx)(n.li,{children:"Access token (optional, for private topics)"}),"\n",(0,i.jsx)(n.li,{children:"Priority (min/low/default/high/max)"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"in-app-notification-store",children:"In-App Notification Store"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/state/stores/src/alert-notification.store.ts"})}),"\n",(0,i.jsx)(n.p,{children:"Manages the in-app notification queue with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Real-time notification queue (max 100 items)"}),"\n",(0,i.jsx)(n.li,{children:"2-second deduplication window (prevents duplicate toasts from rapid events)"}),"\n",(0,i.jsx)(n.li,{children:"24-hour automatic expiry"}),"\n",(0,i.jsx)(n.li,{children:"Unread count tracking"}),"\n",(0,i.jsx)(n.li,{children:"User settings persistence (only settings are persisted, not the queue itself)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"state-structure",children:"State Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface AlertNotificationState {\n  notifications: InAppNotification[];  // In-memory, max 100\n  unreadCount: number;                 // Derived\n  settings: NotificationSettings;     // Persisted to localStorage\n}\n\ninterface InAppNotification {\n  id: string;\n  alertId: string;        // Backend alert ID (used for dedup)\n  title: string;\n  message: string;\n  severity: 'CRITICAL' | 'WARNING' | 'INFO';\n  deviceId?: string;\n  ruleId?: string;\n  read: boolean;\n  receivedAt: string;     // ISO timestamp\n}\n\ninterface NotificationSettings {\n  enabled: boolean;\n  soundEnabled: boolean;\n  severityFilter: 'CRITICAL' | 'WARNING' | 'INFO' | 'ALL';\n  autoDismissTiming: number;  // ms, 0 = no auto-dismiss\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import {\n  useAlertNotificationStore,\n  useNotifications,\n  useUnreadCount,\n} from '@nasnet/state/stores';\n\n// Add a new notification (called from GraphQL subscription)\nconst { addNotification } = useAlertNotificationStore();\naddNotification({\n  alertId: 'alert-123',\n  title: 'High CPU',\n  message: 'CPU usage exceeded 90% for 5 minutes',\n  severity: 'WARNING',\n  deviceId: 'router-1',\n});\n\n// Read notifications\nconst notifications = useNotifications();\nconst unreadCount = useUnreadCount();\n\n// Actions\nconst { markAsRead, markAllRead, clearNotification, clearAll, updateSettings } =\n  useAlertNotificationStore();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"selector-hooks",children:"Selector Hooks"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Optimized selectors (avoid re-render unless specific data changes)\nconst notifications = useNotifications();\nconst unread = useUnreadNotifications();\nconst count = useUnreadCount();\nconst settings = useNotificationSettings();\nconst criticals = useNotificationsBySeverity('CRITICAL');\nconst routerNotifs = useNotificationsByDevice('router-1');\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"alert-list",children:"Alert List"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/AlertList.tsx"})}),"\n",(0,i.jsxs)(n.p,{children:["Displays the notification history list. Typically shown in a dropdown or sidebar panel triggered by the bell icon in ",(0,i.jsx)(n.code,{children:"AppHeader"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Features:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Groups notifications by time (Today, Yesterday, Older)"}),"\n",(0,i.jsx)(n.li,{children:"Shows unread indicator dot"}),"\n",(0,i.jsx)(n.li,{children:"Click to mark as read"}),"\n",(0,i.jsx)(n.li,{children:"Clear all button"}),"\n",(0,i.jsx)(n.li,{children:"Empty state illustration"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"alert-badge",children:"Alert Badge"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/AlertBadge.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"Severity badge component used inline next to resource names:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface AlertBadgeProps {\n  severity: 'CRITICAL' | 'WARNING' | 'INFO';\n  count?: number;  // Show a count badge\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Used in resource lists to indicate which resources have active alerts."}),"\n",(0,i.jsx)(n.h3,{id:"queuedalertbadge",children:"QueuedAlertBadge"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/QueuedAlertBadge.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"Shows a count badge for alerts in the quiet-hours queue (alerts that were suppressed and will fire when quiet hours end)."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"quiet-hours",children:"Quiet Hours"}),"\n",(0,i.jsx)(n.p,{children:"The quiet hours system suppresses notifications during configured time windows (e.g., nights/weekends)."}),"\n",(0,i.jsx)(n.h3,{id:"quiethoursconfig-components",children:"QuietHoursConfig Components"}),"\n",(0,i.jsxs)(n.p,{children:["Located in ",(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/QuietHoursConfig/"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"File"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"QuietHoursConfig.tsx"})}),(0,i.jsx)(n.td,{children:"Root component (platform selector)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"QuietHoursConfig.Desktop.tsx"})}),(0,i.jsx)(n.td,{children:"Desktop layout"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"QuietHoursConfig.Mobile.tsx"})}),(0,i.jsx)(n.td,{children:"Mobile layout"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"TimeRangeInput.tsx"})}),(0,i.jsx)(n.td,{children:"Start/end time picker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DayOfWeekSelector.tsx"})}),(0,i.jsx)(n.td,{children:"Day checkboxes (Mon-Sun)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"TimezoneSelector.tsx"})}),(0,i.jsx)(n.td,{children:"IANA timezone picker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"useQuietHoursConfig.ts"})}),(0,i.jsx)(n.td,{children:"Shared headless logic"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"types.ts"})}),(0,i.jsx)(n.td,{children:"QuietHoursConfig type definitions"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"configuration-structure",children:"Configuration Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface QuietHoursConfig {\n  enabled: boolean;\n  startTime: string;    // \"HH:mm\" in 24h format\n  endTime: string;      // \"HH:mm\" in 24h format\n  days: DayOfWeek[];    // ['MON', 'TUE', ...], empty = all days\n  timezone: string;     // IANA tz string, e.g., 'America/New_York'\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When quiet hours are active, the backend queues triggered alerts. When quiet hours end, queued alerts are sent. The ",(0,i.jsx)(n.code,{children:"QueuedAlertBadge"})," shows the count of queued alerts."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"alert-templates",children:"Alert Templates"}),"\n",(0,i.jsx)(n.p,{children:"Alert templates allow saving and sharing pre-configured alert rule sets."}),"\n",(0,i.jsxs)(n.p,{children:["Components in ",(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/alert-templates/"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Component"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateBrowser.tsx"})}),(0,i.jsx)(n.td,{children:"Browse available templates (platform selector)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateBrowserDesktop.tsx"})}),(0,i.jsx)(n.td,{children:"Desktop layout with sidebar"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateBrowserMobile.tsx"})}),(0,i.jsx)(n.td,{children:"Mobile list view"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateBrowserNew.tsx"})}),(0,i.jsx)(n.td,{children:"New template creation flow"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateDetailPanel.tsx"})}),(0,i.jsx)(n.td,{children:"Template detail view"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateApplyDialog.tsx"})}),(0,i.jsx)(n.td,{children:"Confirm before applying template"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AlertTemplateVariableInputForm.tsx"})}),(0,i.jsx)(n.td,{children:"Fill in template variables"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ExportTemplateDialog.tsx"})}),(0,i.jsx)(n.td,{children:"Export current rules as template"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"template-application-flow",children:"Template Application Flow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"User opens template browser"}),"\n",(0,i.jsxs)(n.li,{children:["Selects a template \u2192 ",(0,i.jsx)(n.code,{children:"AlertTemplateDetailPanel"})," shows preview"]}),"\n",(0,i.jsxs)(n.li,{children:['Clicks "Apply" \u2192 ',(0,i.jsx)(n.code,{children:"AlertTemplateApplyDialog"})," shows confirmation"]}),"\n",(0,i.jsxs)(n.li,{children:["If template has variables \u2192 ",(0,i.jsx)(n.code,{children:"AlertTemplateVariableInputForm"})," collects values"]}),"\n",(0,i.jsx)(n.li,{children:"Template applied via GraphQL mutation"}),"\n",(0,i.jsx)(n.li,{children:"New alert rules created with variable values substituted"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"template-ui-store",children:"Template UI Store"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"libs/state/stores/src/alert-rule-template-ui.store.ts"})," manages browser state:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Track which template is selected in the browser\nconst { selectedTemplateId, setSelectedTemplate } = useAlertRuleTemplateUIStore();\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notification-preferences",children:"Notification Preferences"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/components/InAppNotificationPreferences.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"A settings panel for per-user notification preferences:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable/disable in-app notifications"}),"\n",(0,i.jsx)(n.li,{children:"Minimum severity filter (e.g., only CRITICAL)"}),"\n",(0,i.jsx)(n.li,{children:"Auto-dismiss timing"}),"\n",(0,i.jsx)(n.li,{children:"Sound toggle"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Updates the ",(0,i.jsx)(n.code,{children:"settings"})," slice in ",(0,i.jsx)(n.code,{children:"useAlertNotificationStore"})," (persisted to localStorage)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"graphql-integration",children:"GraphQL Integration"}),"\n",(0,i.jsxs)(n.p,{children:["Key query hooks from ",(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/alerts/"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Alert rules\nconst { rules, loading } = useAlertRules(routerId);\nconst { createRule } = useCreateAlertRule();\nconst { updateRule } = useUpdateAlertRule();\nconst { deleteRule } = useDeleteAlertRule();\n\n// Notification history\nconst { notifications, loading } = useAlertNotifications(routerId);\n\n// Real-time alert subscription\nuseAlertSubscription(routerId, {\n  onAlert: (alert) => {\n    addNotification({ ...alert });  // Push to in-app store\n  },\n});\n\n// Channel configuration\nconst { channels } = useAlertChannels(routerId);\nconst { createChannel } = useCreateAlertChannel();\nconst { testChannel } = useTestAlertChannel();  // Send test notification\n\n// Quiet hours\nconst { quietHours } = useQuietHours(routerId);\nconst { updateQuietHours } = useUpdateQuietHours();\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);
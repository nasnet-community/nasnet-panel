"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[3051],{2275:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"testing/overview","title":"Testing Overview","description":"NasNetConnect uses a Testing Trophy approach \u2014 the majority of tests are integration tests that verify real user workflows through the component tree, with a smaller base of unit tests for pure logic and a thin layer of E2E tests for critical user journeys.","source":"@site/../connect/docs/testing/overview.md","sourceDirName":"testing","slug":"/testing/overview","permalink":"/docs/frontend/testing/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/testing/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Mocking Strategy","permalink":"/docs/frontend/testing/mocking"},"next":{"title":"Unit Testing","permalink":"/docs/frontend/testing/unit-testing"}}');var r=n(31085),i=n(71184);const c={},o="Testing Overview",l={},d=[{value:"Testing Trophy",id:"testing-trophy",level:2},{value:"Testing Philosophy",id:"testing-philosophy",level:2},{value:"Test behavior, not implementation",id:"test-behavior-not-implementation",level:3},{value:"User-centric queries",id:"user-centric-queries",level:3},{value:"No test isolation by mocking implementation",id:"no-test-isolation-by-mocking-implementation",level:3},{value:"Test Organization",id:"test-organization",level:2},{value:"Router Testing Tiers",id:"router-testing-tiers",level:2},{value:"Coverage Goals",id:"coverage-goals",level:2},{value:"Running Tests",id:"running-tests",level:2},{value:"Tools Reference",id:"tools-reference",level:2},{value:"See Also",id:"see-also",level:2}];function h(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"testing-overview",children:"Testing Overview"})}),"\n",(0,r.jsxs)(t.p,{children:["NasNetConnect uses a ",(0,r.jsx)(t.strong,{children:"Testing Trophy"})," approach \u2014 the majority of tests are integration tests that verify real user workflows through the component tree, with a smaller base of unit tests for pure logic and a thin layer of E2E tests for critical user journeys."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Reference:"})," ADR-015 (cited in ",(0,r.jsx)(t.code,{children:"apps/connect/src/test/setup.ts"}),")"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"testing-trophy",children:"Testing Trophy"}),"\n",(0,r.jsx)(t.mermaid,{value:'flowchart TD\n    Static["<b>Static (5%)</b><br/>TypeScript<br/>Catches errors before tests run"]\n    Unit["<b>Unit (20%)</b><br/>Vitest<br/>Pure functions, hooks, utilities"]\n    Integration["<b>Integration (60%)</b><br/>React Testing Library + MSW<br/>Component workflows"]\n    E2E["<b>E2E (15%)</b><br/>Playwright<br/>Critical user journeys only"]\n\n    Static --\x3e Unit\n    Unit --\x3e Integration\n    Integration --\x3e E2E\n\n    style Static fill:#e8f5e9\n    style Unit fill:#fff3e0\n    style Integration fill:#fff8e1\n    style E2E fill:#ffebee'}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Layer"}),(0,r.jsx)(t.th,{children:"Percentage"}),(0,r.jsx)(t.th,{children:"Tools"}),(0,r.jsx)(t.th,{children:"Focus"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Static"}),(0,r.jsx)(t.td,{children:"5%"}),(0,r.jsx)(t.td,{children:"TypeScript"}),(0,r.jsx)(t.td,{children:"Type errors before runtime"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Unit"}),(0,r.jsx)(t.td,{children:"20%"}),(0,r.jsx)(t.td,{children:"Vitest"}),(0,r.jsx)(t.td,{children:"Pure functions, utilities, hooks in isolation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Integration"}),(0,r.jsx)(t.td,{children:"60%"}),(0,r.jsx)(t.td,{children:"React Testing Library + MSW"}),(0,r.jsx)(t.td,{children:"Components with real logic and mocked network"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"E2E"}),(0,r.jsx)(t.td,{children:"15%"}),(0,r.jsx)(t.td,{children:"Playwright"}),(0,r.jsx)(t.td,{children:"Critical happy-path and edge-case user flows"})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"testing-philosophy",children:"Testing Philosophy"}),"\n",(0,r.jsx)(t.h3,{id:"test-behavior-not-implementation",children:"Test behavior, not implementation"}),"\n",(0,r.jsx)(t.p,{children:"Tests should describe what a user does and what they observe \u2014 not internal implementation details. This means testing what appears on screen rather than component state or method calls."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:"// Good \u2014 tests the user's perspective\nit('should show an error message when the router is unreachable', async () => {\n  server.use(errorHandler);\n  render(<RouterPanel routerId=\"r1\" />);\n  expect(await screen.findByText(/connection failed/i)).toBeInTheDocument();\n});\n\n// Bad \u2014 tests implementation detail\nit('should set isError to true in state', () => {\n  const { result } = renderHook(() => useRouterQuery('r1'));\n  expect(result.current.isError).toBe(true);\n});\n"})}),"\n",(0,r.jsx)(t.h3,{id:"user-centric-queries",children:"User-centric queries"}),"\n",(0,r.jsx)(t.p,{children:"React Testing Library queries in preference order:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getByRole"})," \u2014 reflects semantic HTML (most accessible, most robust)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getByLabelText"})," \u2014 for form inputs"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getByPlaceholderText"})," \u2014 only when no label exists"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getByText"})," \u2014 for visible text"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getByTestId"})," \u2014 last resort when no semantic query fits"]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:"// Preferred\nscreen.getByRole('button', { name: /save/i });\nscreen.getByLabelText('Interface Name');\n\n// Last resort\nscreen.getByTestId('submit-button');\n"})}),"\n",(0,r.jsx)(t.h3,{id:"no-test-isolation-by-mocking-implementation",children:"No test isolation by mocking implementation"}),"\n",(0,r.jsx)(t.p,{children:"Don't mock modules just to isolate units \u2014 prefer testing with real implementations through integration tests. Only mock:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Network requests (via MSW)"}),"\n",(0,r.jsx)(t.li,{children:"Third-party hooks that call real external APIs"}),"\n",(0,r.jsxs)(t.li,{children:["Browser APIs not available in jsdom (",(0,r.jsx)(t.code,{children:"matchMedia"}),", ",(0,r.jsx)(t.code,{children:"ResizeObserver"}),")"]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"test-organization",children:"Test Organization"}),"\n",(0,r.jsx)(t.p,{children:"Tests live alongside source files, not in a separate directory:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"src/\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 pages/\n\u2502   \u2502   \u251c\u2500\u2500 network/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 components/\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 ARPTable.tsx\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 ARPTable.test.tsx        \u2190 co-located test\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 ARPTable.stories.tsx     \u2190 Storybook story\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 InterfaceCard.tsx\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 InterfaceCard.test.tsx\n\u251c\u2500\u2500 mocks/\n\u2502   \u251c\u2500\u2500 server.ts        \u2190 MSW Node server (Vitest)\n\u2502   \u251c\u2500\u2500 browser.ts       \u2190 MSW service worker (Storybook/dev)\n\u2502   \u2514\u2500\u2500 handlers/\n\u2502       \u251c\u2500\u2500 graphql.ts   \u2190 GraphQL mock handlers\n\u2502       \u251c\u2500\u2500 rest.ts      \u2190 REST mock handlers\n\u2502       \u2514\u2500\u2500 index.ts\n\u2514\u2500\u2500 test/\n    \u251c\u2500\u2500 setup.ts         \u2190 Vitest global setup\n    \u251c\u2500\u2500 test-utils.tsx   \u2190 Custom render with providers\n    \u251c\u2500\u2500 index.ts\n    \u2514\u2500\u2500 chr/\n        \u2514\u2500\u2500 chr-utils.ts \u2190 CHR Docker test utilities\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"router-testing-tiers",children:"Router Testing Tiers"}),"\n",(0,r.jsx)(t.p,{children:"NasNetConnect has a unique three-tier strategy for testing router interactions:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Tier"}),(0,r.jsx)(t.th,{children:"Environment"}),(0,r.jsx)(t.th,{children:"Speed"}),(0,r.jsx)(t.th,{children:"Fidelity"}),(0,r.jsx)(t.th,{children:"Usage"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1 \u2014 Mock"}),(0,r.jsx)(t.td,{children:"MSW handlers"}),(0,r.jsx)(t.td,{children:"Fastest"}),(0,r.jsx)(t.td,{children:"Low"}),(0,r.jsx)(t.td,{children:"Unit + integration tests"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2 \u2014 CHR Docker"}),(0,r.jsx)(t.td,{children:"RouterOS CHR container"}),(0,r.jsx)(t.td,{children:"Moderate"}),(0,r.jsx)(t.td,{children:"High"}),(0,r.jsx)(t.td,{children:"Integration + E2E tests in CI"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"3 \u2014 Physical"}),(0,r.jsx)(t.td,{children:"Real MikroTik hardware"}),(0,r.jsx)(t.td,{children:"Slowest"}),(0,r.jsx)(t.td,{children:"Highest"}),(0,r.jsx)(t.td,{children:"Manual QA only"})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["CHR (Cloud Hosted Router) is the official MikroTik RouterOS virtual machine image. It runs in Docker during CI and provides real RouterOS behavior without physical hardware. See ",(0,r.jsx)(t.code,{children:"apps/connect/src/test/chr/chr-utils.ts"})," and ",(0,r.jsx)(t.code,{children:"apps/connect-e2e/src/chr-integration.spec.ts"}),"."]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"coverage-goals",children:"Coverage Goals"}),"\n",(0,r.jsxs)(t.p,{children:["Coverage thresholds are enforced in CI (configured in ",(0,r.jsx)(t.code,{children:"apps/connect/vitest.config.ts"}),"):"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric"}),(0,r.jsx)(t.th,{children:"Threshold"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Lines"}),(0,r.jsx)(t.td,{children:"80%"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Branches"}),(0,r.jsx)(t.td,{children:"75%"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Functions"}),(0,r.jsx)(t.td,{children:"75%"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Statements"}),(0,r.jsx)(t.td,{children:"80%"})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["Coverage is measured with V8 (native) provider and reports are generated in ",(0,r.jsx)(t.code,{children:"apps/connect/coverage/"}),"."]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"running-tests",children:"Running Tests"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# All tests in the connect app\nnpx nx test connect\n\n# Watch mode (default in vitest.config.ts)\nnpx nx test connect --watch\n\n# With coverage\nnpx nx test connect --coverage\n\n# All tests across the monorepo\nnpx nx run-many -t test\n\n# E2E tests\nnpx nx e2e connect-e2e\n\n# E2E with Playwright UI (for debugging)\nnpx playwright test --ui --project=chromium\n\n# CHR integration tests only\nnpx playwright test --project=chr-integration\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"tools-reference",children:"Tools Reference"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Tool"}),(0,r.jsx)(t.th,{children:"Version"}),(0,r.jsx)(t.th,{children:"Purpose"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Vitest"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"Test runner (4\xd7 faster than Jest, native ESM)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"React Testing Library"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"Component rendering and user-event simulation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"@testing-library/user-event"})}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"Realistic browser event simulation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"@testing-library/jest-dom"})}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsxs)(t.td,{children:["DOM-specific matchers (",(0,r.jsx)(t.code,{children:"toBeInTheDocument"}),", ",(0,r.jsx)(t.code,{children:"toHaveClass"}),")"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"MSW (Mock Service Worker)"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"Network request interception"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Playwright"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"E2E cross-browser testing"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"axe-core"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"Automated accessibility scanning"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Pa11y"}),(0,r.jsx)(t.td,{children:"Latest"}),(0,r.jsx)(t.td,{children:"CI accessibility gate"})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"./unit-testing.md"})," \u2014 Vitest configuration, hooks, store testing"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"./component-testing.md"})," \u2014 React Testing Library patterns"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"./e2e-testing.md"})," \u2014 Playwright configuration and CHR integration"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"./mocking.md"})," \u2014 MSW handler patterns"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"../architecture/provider-stack.md"})," \u2014 Provider hierarchy used in test wrappers"]}),"\n"]})]})}function a(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},71184:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>o});var s=n(14041);const r={},i=s.createContext(r);function c(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);
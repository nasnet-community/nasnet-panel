"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[77122],{38531:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/security-patterns","title":"Security Patterns","description":"Reference: libs/core/forms/src/ | libs/api-client/ | Layered Security Architecture","source":"@site/../../libs/core/docs/guides/security-patterns.md","sourceDirName":"guides","slug":"/guides/security-patterns","permalink":"/docs/core/guides/security-patterns","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/core/docs/guides/security-patterns.md","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"sidebar_position":14,"title":"Security Patterns"},"sidebar":"sidebar","previous":{"title":"Performance Patterns","permalink":"/docs/core/guides/performance-patterns"},"next":{"title":"Change Set Operations: Atomic Multi-Resource Transactions","permalink":"/docs/core/guides/change-set-operations"}}');var r=s(31085),t=s(71184);const a={sidebar_position:14,title:"Security Patterns"},l="Security Patterns in NasNetConnect",o={},c=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Security Architecture Overview",id:"security-architecture-overview",level:2},{value:"Layer 1: Frontend Input Validation (libs/core)",id:"layer-1-frontend-input-validation-libscore",level:3},{value:"Layer 2: Backend Authorization (GraphQL directives)",id:"layer-2-backend-authorization-graphql-directives",level:3},{value:"Layer 3: XSS Prevention (React DOM)",id:"layer-3-xss-prevention-react-dom",level:3},{value:"Input Validation as Trust Boundary",id:"input-validation-as-trust-boundary",level:2},{value:"Zod Schema Validation",id:"zod-schema-validation",level:3},{value:"Network-Specific Validators",id:"network-specific-validators",level:3},{value:"Never Trust Client-Side Validation Alone",id:"never-trust-client-side-validation-alone",level:3},{value:"Error Message Safety",id:"error-message-safety",level:2},{value:"ValidationError Never Contains PII",id:"validationerror-never-contains-pii",level:3},{value:"mapBackendErrors Filters Sensitive Fields",id:"mapbackenderrors-filters-sensitive-fields",level:3},{value:"Error Messages Use i18n Keys",id:"error-messages-use-i18n-keys",level:3},{value:"suggestedFix Provides Safe Remediation",id:"suggestedfix-provides-safe-remediation",level:3},{value:"Why No XSS Vulnerabilities",id:"why-no-xss-vulnerabilities",level:2},{value:"React DOM Auto-Escaping",id:"react-dom-auto-escaping",level:3},{value:"Template Literals with Parameterized Substitution",id:"template-literals-with-parameterized-substitution",level:3},{value:"No eval() or Function() Constructor",id:"no-eval-or-function-constructor",level:3},{value:"Auth Token Handling",id:"auth-token-handling",level:2},{value:"JWT Token Management (libs/api-client)",id:"jwt-token-management-libsapi-client",level:3},{value:"Token Refresh (libs/api-client)",id:"token-refresh-libsapi-client",level:3},{value:"Token Storage",id:"token-storage",level:3},{value:"Security Review Checklist",id:"security-review-checklist",level:2},{value:"Input Validation",id:"input-validation",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"XSS Prevention",id:"xss-prevention",level:3},{value:"Dependencies",id:"dependencies",level:3},{value:"Code Review",id:"code-review",level:3},{value:"Common Vulnerabilities",id:"common-vulnerabilities",level:2},{value:"Injection Attacks",id:"injection-attacks",level:3},{value:"Path Traversal",id:"path-traversal",level:3},{value:"ReDoS (Regular Expression Denial of Service)",id:"redos-regular-expression-denial-of-service",level:3},{value:"CSRF (Cross-Site Request Forgery)",id:"csrf-cross-site-request-forgery",level:3},{value:"Code Examples",id:"code-examples",level:2},{value:"Secure Form with Error Handling",id:"secure-form-with-error-handling",level:3},{value:"Safe Error Display Component",id:"safe-error-display-component",level:3},{value:"Related Guides",id:"related-guides",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"security-patterns-in-nasnetconnect",children:"Security Patterns in NasNetConnect"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Reference:"})," ",(0,r.jsx)(n.code,{children:"libs/core/forms/src/"})," | ",(0,r.jsx)(n.code,{children:"libs/api-client/"})," | Layered Security Architecture"]}),"\n",(0,r.jsxs)(n.p,{children:["NasNetConnect deliberately implements minimal security code in ",(0,r.jsx)(n.code,{children:"libs/core"})," because security is handled at specialized layers. This guide documents the security architecture, trust boundaries, and safe patterns for core library usage."]}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-architecture-overview",children:"Security Architecture Overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#input-validation-as-trust-boundary",children:"Input Validation as Trust Boundary"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#error-message-safety",children:"Error Message Safety"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#why-no-xss-vulnerabilities",children:"Why No XSS Vulnerabilities"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#auth-token-handling",children:"Auth Token Handling"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-review-checklist",children:"Security Review Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#common-vulnerabilities",children:"Common Vulnerabilities"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-architecture-overview",children:"Security Architecture Overview"}),"\n",(0,r.jsx)(n.p,{children:"NasNetConnect separates security concerns across three layers:"}),"\n",(0,r.jsx)(n.h3,{id:"layer-1-frontend-input-validation-libscore",children:"Layer 1: Frontend Input Validation (libs/core)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Responsibility:"})," Validate user input at system edge"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// @nasnet/core/forms - Zod schemas validate at input boundary\nconst ipConfigSchema = z.object({\n  address: z.string().ip(),\n  gateway: z.string().ip(),\n  dnsServers: z.array(z.string().ip()),\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What it does:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Type validation (is it the right shape?)"}),"\n",(0,r.jsx)(n.li,{children:"Format validation (valid IP address?)"}),"\n",(0,r.jsx)(n.li,{children:"Range validation (within allowed values?)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What it does NOT do:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authorization (is this user allowed to change this?)"}),"\n",(0,r.jsx)(n.li,{children:"Resource uniqueness (is this IP already in use?)"}),"\n",(0,r.jsx)(n.li,{children:"Platform compatibility (does this router support this?)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"layer-2-backend-authorization-graphql-directives",children:"Layer 2: Backend Authorization (GraphQL directives)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Responsibility:"})," Enforce who can do what"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'directive @auth(roles: [String!]!) on FIELD_DEFINITION\n\ntype Mutation {\n  createVPN(input: VPNInput!): VPN!\n    @auth(roles: ["admin", "vpn-manager"])\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Backend checks:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Is user authenticated?"}),"\n",(0,r.jsx)(n.li,{children:"Does user have required role?"}),"\n",(0,r.jsx)(n.li,{children:"Can user access this resource (tenant isolation)?"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"layer-3-xss-prevention-react-dom",children:"Layer 3: XSS Prevention (React DOM)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Responsibility:"})," Prevent script injection in output"]}),"\n",(0,r.jsx)(n.p,{children:"React DOM automatically escapes all string content by default:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// This is SAFE - React escapes the value\nconst userInput = \"<script>alert('xss')<\/script>\";\nreturn <div>{userInput}</div>;  // Displayed as text, not executed\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"input-validation-as-trust-boundary",children:"Input Validation as Trust Boundary"}),"\n",(0,r.jsxs)(n.p,{children:["Input validation is the ",(0,r.jsx)(n.strong,{children:"only"})," layer that ",(0,r.jsx)(n.code,{children:"libs/core"})," directly handles. It validates at the system boundary where user data enters the application."]}),"\n",(0,r.jsx)(n.h3,{id:"zod-schema-validation",children:"Zod Schema Validation"}),"\n",(0,r.jsx)(n.p,{children:"All user-facing forms use Zod schemas:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { z } from 'zod';\n\n// Define validation at form definition time\nconst routerConfigSchema = z.object({\n  routerName: z.string()\n    .min(1, 'Name is required')\n    .max(63, 'Name too long')\n    .regex(/^[a-zA-Z0-9-]+$/, 'Only alphanumeric and hyphens'),\n\n  wanPort: z.enum(['ether1', 'ether2', 'sfp1'])\n    .describe('Which port handles WAN traffic'),\n\n  upstreamDNS: z.array(z.string().ip())\n    .min(1, 'At least one DNS server required')\n    .max(3, 'Maximum 3 DNS servers'),\n});\n\ntype RouterConfig = z.infer<typeof routerConfigSchema>;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"network-specific-validators",children:"Network-Specific Validators"}),"\n",(0,r.jsx)(n.p,{children:"NasNetConnect provides domain-specific validators for common network fields:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { isValidIPAddress, isValidCIDR, isValidMAC } from '@nasnet/core/forms';\n\nconst schema = z.object({\n  ipAddress: z.string().refine(isValidIPAddress, 'Invalid IP'),\n  subnet: z.string().refine(isValidCIDR, 'Invalid CIDR notation'),\n  macAddress: z.string().refine(isValidMAC, 'Invalid MAC address'),\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Built-in validators"})," (from ",(0,r.jsx)(n.code,{children:"libs/core/forms/src/network-validators.ts"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"IP address (IPv4/IPv6)"}),"\n",(0,r.jsx)(n.li,{children:"CIDR notation (10.0.0.0/8)"}),"\n",(0,r.jsx)(n.li,{children:"MAC address (00:11:22:33:44:55)"}),"\n",(0,r.jsx)(n.li,{children:"Port number (1-65535)"}),"\n",(0,r.jsx)(n.li,{children:"Domain name"}),"\n",(0,r.jsx)(n.li,{children:"Hostname"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"never-trust-client-side-validation-alone",children:"Never Trust Client-Side Validation Alone"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Client validation prevents user errors\nconst schema = z.object({\n  port: z.number().min(1).max(65535),\n});\n\n// BUT backend MUST also validate!\n// Malicious user can send port=999999 by modifying request\n\n// Backend (Go):\nif port < 1 || port > 65535 {\n  return errors.New("port out of range")\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pattern:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"User Input\n    \u2193\nClient Validation (libs/core) - Quick feedback\n    \u2193\nBackend Validation (Go) - Final verification\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"error-message-safety",children:"Error Message Safety"}),"\n",(0,r.jsx)(n.p,{children:"Errors must never reveal sensitive information. NasNetConnect uses several patterns to ensure error safety:"}),"\n",(0,r.jsx)(n.h3,{id:"validationerror-never-contains-pii",children:"ValidationError Never Contains PII"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Good - generic error message\n{\n  code: 'IP_CONFLICT',\n  message: 'This IP address is already in use',\n  fieldPath: 'address'\n}\n\n// Bad - reveals which router has the conflict\n{\n  code: 'IP_CONFLICT',\n  message: '192.168.1.1 is already assigned to router-123 on WAN interface',\n  // Reveals router ID and interface details!\n}\n\n// Bad - reveals username/ID of other user\n{\n  code: 'NAME_DUPLICATE',\n  message: 'Service name \"proxy\" already used by admin@company.com',\n  // Reveals other user's identity!\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"mapbackenderrors-filters-sensitive-fields",children:"mapBackendErrors Filters Sensitive Fields"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { mapBackendErrors } from '@nasnet/core/forms';\n\n// Backend might return detailed error with sensitive info\nconst backendError = {\n  code: 'ROUTER_OFFLINE',\n  message: 'Router at 192.168.100.50 is offline',  // Reveals IP!\n  details: {\n    routerId: 'abc-123-xyz',\n    lastSeen: '2024-02-26T14:30:00Z',\n    adminEmail: 'admin@company.com',  // Reveals admin email!\n  }\n};\n\n// mapBackendErrors sanitizes before display\nconst safeError = mapBackendErrors(backendError);\n// Result: Only generic message shown to user\n"})}),"\n",(0,r.jsx)(n.h3,{id:"error-messages-use-i18n-keys",children:"Error Messages Use i18n Keys"}),"\n",(0,r.jsx)(n.p,{children:"Errors should never be raw backend messages:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Good - i18n key, backend provides error code\n{\n  code: 'VLAN_CONFLICT',\n  i18nKey: 'errors.vlan_conflict',  // Maps to i18n string\n  // Message shown: \"VLAN is already in use\"\n}\n\n// Bad - raw backend message shown to user\n{\n  message: 'VLAN 100-110 range overlaps with existing allocation 105-115'\n  // Might reveal internal resource details\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"suggestedfix-provides-safe-remediation",children:"suggestedFix Provides Safe Remediation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const error: ValidationError = {\n  code: 'PORT_IN_USE',\n  message: 'Port 22 is already in use',\n  fieldPath: 'port',\n  suggestedFix: 'Use port 2222 or higher for SSH access',  // Safe suggestion\n};\n"})}),"\n",(0,r.jsx)(n.p,{children:"Good suggested fixes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'\u2713 "Try port 2222 instead"'}),"\n",(0,r.jsx)(n.li,{children:'\u2713 "Enable DHCP to auto-assign IP"'}),"\n",(0,r.jsx)(n.li,{children:'\u2713 "Remove the duplicate resource first"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Bad suggested fixes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'\u2717 "SSH service running on router-prod-001 is using port 22"'}),"\n",(0,r.jsx)(n.li,{children:'\u2717 "IP already assigned to admin account"'}),"\n",(0,r.jsxs)(n.li,{children:['\u2717 "Contact user ',(0,r.jsx)(n.a,{href:"mailto:john@company.com",children:"john@company.com"}),' to resolve this"']}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-no-xss-vulnerabilities",children:"Why No XSS Vulnerabilities"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"libs/core"})," doesn't need XSS protection code because React DOM provides it by default."]}),"\n",(0,r.jsx)(n.h3,{id:"react-dom-auto-escaping",children:"React DOM Auto-Escaping"}),"\n",(0,r.jsx)(n.p,{children:"React automatically escapes all text content:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// User input (potentially malicious)\nconst userInput = \"<img src=x onerror='alert(1)'>\";\n\n// This is SAFE - React escapes the input\n<div>{userInput}</div>;\n// Rendered as: &lt;img src=x onerror='alert(1)'&gt;\n// No script execution\n\n// Only dangerouslySetInnerHTML bypasses escaping\n// libs/core NEVER uses dangerouslySetInnerHTML\n"})}),"\n",(0,r.jsx)(n.h3,{id:"template-literals-with-parameterized-substitution",children:"Template Literals with Parameterized Substitution"}),"\n",(0,r.jsx)(n.p,{children:"When building error messages with dynamic content:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Good - parameter substitution\nconst message = `Port ${port} is already in use`;\n// Result: "Port 8080 is already in use"\n\n// Bad - template literal without escaping\nconst message = `Port ${userInput} is already in use`;\n// If userInput = "<script>", could be dangerous\n// BUT React will escape it when rendered\n'})}),"\n",(0,r.jsx)(n.h3,{id:"no-eval-or-function-constructor",children:"No eval() or Function() Constructor"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"libs/core"})," never evaluates string code:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Never done in libs/core\neval(userInput);              // \u274c Never\nnew Function(userInput);       // \u274c Never\nJSON.parse(userInput);         // Safe for JSON\n(new Function(userInput))();   // \u274c Never\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"auth-token-handling",children:"Auth Token Handling"}),"\n",(0,r.jsxs)(n.p,{children:["Authentication is completely handled in ",(0,r.jsx)(n.code,{children:"libs/api-client"}),", NOT in ",(0,r.jsx)(n.code,{children:"libs/core"}),". Core has no access to auth state."]}),"\n",(0,r.jsx)(n.h3,{id:"jwt-token-management-libsapi-client",children:"JWT Token Management (libs/api-client)"}),"\n",(0,r.jsx)(n.p,{children:"Tokens are managed via Apollo Link in the auth layer:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// @nasnet/api-client/core/auth-link.ts\nimport { setContext } from '@apollo/client/link/context';\n\nconst authLink = setContext((_, { headers }) => {\n  // Get token from secure storage (NOT localStorage)\n  const token = getAuthToken();\n\n  return {\n    headers: {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : '',\n    }\n  };\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why NOT in libs/core:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Core has no React dependency (auth link requires Apollo)"}),"\n",(0,r.jsx)(n.li,{children:"Core has no knowledge of HTTP headers"}),"\n",(0,r.jsx)(n.li,{children:"Core is just validation logic"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"token-refresh-libsapi-client",children:"Token Refresh (libs/api-client)"}),"\n",(0,r.jsx)(n.p,{children:"When token expires, the auth link handles refresh:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const onError = (error: GraphQLError) => {\n  if (error.extensions?.code === 'UNAUTHENTICATED') {\n    // Attempt refresh\n    const newToken = await refreshToken(refreshToken);\n    // Retry request with new token\n  }\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"token-storage",children:"Token Storage"}),"\n",(0,r.jsx)(n.p,{children:"Tokens should NEVER be stored in localStorage:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Bad - XSS can steal from localStorage\nlocalStorage.setItem('auth_token', token);\n\n// Good - Secure, HTTPOnly cookie set by backend\n// Cookie is sent automatically by browser\n// JavaScript cannot access it\nSet-Cookie: auth_token=xyz; HttpOnly; Secure; SameSite=Strict\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-review-checklist",children:"Security Review Checklist"}),"\n",(0,r.jsxs)(n.p,{children:["When adding new functionality to ",(0,r.jsx)(n.code,{children:"libs/core"}),", verify:"]}),"\n",(0,r.jsx)(n.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All user inputs validated with Zod schema"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Schema defines allowed values (enum, range, length)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error messages don't reveal system details"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Backend also validates (defense in depth)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error messages are generic and user-friendly"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No PII in error messages (names, IDs, IPs, emails)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No technical details leaked (stack traces, file paths)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","suggestedFix provides safe remediation hints"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"xss-prevention",children:"XSS Prevention"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No dangerouslySetInnerHTML usage"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No eval() or Function() constructor calls"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No direct DOM manipulation (innerHTML, insertAdjacentHTML)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","User input rendered as text, not HTML"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No unsafe dependencies (evaluate dependencies for exploits)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pin dependency versions in package-lock.json"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Regular ",(0,r.jsx)(n.code,{children:"npm audit"})," checks"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Remove unused dependencies"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"code-review",children:"Code Review"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security-focused peer review"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Check for common OWASP vulnerabilities"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Verify error handling is safe"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Ensure no hardcoded secrets or credentials"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-vulnerabilities",children:"Common Vulnerabilities"}),"\n",(0,r.jsx)(n.h3,{id:"injection-attacks",children:"Injection Attacks"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Bad - building validation dynamically\nconst regex = new RegExp(userInput);  // Could be infinite regex\nschema = z.string().regex(regex);\n\n// Good - whitelist allowed patterns\nconst allowedPatterns = {\n  ipv4: /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/,\n  hostname: /^[a-zA-Z0-9-]+$/,\n};\nconst pattern = allowedPatterns[patternName];\nschema = z.string().regex(pattern);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"path-traversal",children:"Path Traversal"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Backend concern, NOT libs/core\n// But validate filename format client-side\nconst schema = z.object({\n  filename: z.string()\n    .regex(/^[a-zA-Z0-9._-]+$/)\n    .refine(f => !f.includes('..'), 'Invalid filename'),\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"redos-regular-expression-denial-of-service",children:"ReDoS (Regular Expression Denial of Service)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Bad - regex can cause exponential backtracking\nconst regex = /^(a+)+$/;\n\n// Good - use simple, tested regex\nconst regex = /^[a-zA-Z0-9]+$/;\n// Or use specific validators from @nasnet/core/forms\n"})}),"\n",(0,r.jsx)(n.h3,{id:"csrf-cross-site-request-forgery",children:"CSRF (Cross-Site Request Forgery)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Handled at backend layer:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CORS headers configured correctly"}),"\n",(0,r.jsx)(n.li,{children:"SameSite cookie attribute set"}),"\n",(0,r.jsx)(n.li,{children:"CSRF tokens validated (if needed)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Not a concern in ",(0,r.jsx)(n.code,{children:"libs/core"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,r.jsx)(n.h3,{id:"secure-form-with-error-handling",children:"Secure Form with Error Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { z } from 'zod';\nimport { useZodForm } from '@nasnet/core/forms';\nimport { mapBackendErrors } from '@nasnet/core/forms';\n\nconst secureSchema = z.object({\n  serviceName: z.string()\n    .min(1, 'Name is required')\n    .max(63)\n    .regex(/^[a-zA-Z0-9-]+$/, 'Only alphanumeric and hyphens allowed'),\n\n  port: z.number()\n    .min(1024, 'Ports below 1024 are reserved')\n    .max(65535, 'Port must be 65535 or less'),\n\n  apiKey: z.string()\n    .min(32, 'API key too short'),  // Don't show full validation\n});\n\nexport function ServiceForm() {\n  const form = useZodForm({ schema: secureSchema });\n  const [backendError, setBackendError] = useState<ValidationError | null>(null);\n\n  const onSubmit = async (data: typeof secureSchema._output) => {\n    try {\n      // Frontend validation passed, now send to backend\n      const result = await createService(data);\n      // Success handling...\n    } catch (error) {\n      // Map backend error to safe format\n      const safeError = mapBackendErrors(error);\n      setBackendError(safeError);\n\n      // Show user-friendly message\n      form.setError('root', {\n        message: safeError.message,  // Generic message\n        type: 'manual',\n      });\n    }\n  };\n\n  return (\n    <form onSubmit={form.handleSubmit(onSubmit)}>\n      {/* Form fields with validation */}\n      {form.formState.errors.root && (\n        <div role=\"alert\" className=\"bg-red-50 text-red-700 p-4\">\n          {form.formState.errors.root.message}\n        </div>\n      )}\n    </form>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"safe-error-display-component",children:"Safe Error Display Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'import { ValidationError } from \'@nasnet/core/forms\';\n\ninterface SafeErrorDisplayProps {\n  error: ValidationError;\n}\n\nexport function SafeErrorDisplay({ error }: SafeErrorDisplayProps) {\n  // Never display the full error object\n  // Only use safe fields: message, code, suggestedFix\n\n  return (\n    <div className="space-y-2">\n      <p className="font-semibold text-red-700">\n        {/* Error code provides context without revealing details */}\n        Error: {error.code}\n      </p>\n\n      <p className="text-gray-700">\n        {/* User-friendly message only */}\n        {error.message}\n      </p>\n\n      {error.suggestedFix && (\n        <p className="text-sm text-blue-600">\n          {/* Safe suggestion */}\n          Hint: {error.suggestedFix}\n        </p>\n      )}\n\n      {/* Never display: */}\n      {/* - error.fieldPath if it reveals structure */}\n      {/* - error.resourceId if it reveals other users\' resources */}\n      {/* - error.details or error.metadata (might be debug info) */}\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"related-guides",children:"Related Guides"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Input Validation:"})," See ",(0,r.jsx)(n.code,{children:"libs/core/docs/guides/validation-pipeline.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling:"})," See ",(0,r.jsx)(n.code,{children:"libs/core/docs/guides/error-handling-patterns.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend Security:"})," See ",(0,r.jsx)(n.code,{children:"Docs/architecture/security-architecture.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication:"})," See ",(0,r.jsx)(n.code,{children:"Docs/architecture/api-contracts.md"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(14041);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);
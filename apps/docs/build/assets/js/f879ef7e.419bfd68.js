"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[21464],{71184:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>d});var t=r(14041);const i={},a=t.createContext(i);function s(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(a.Provider,{value:n},e.children)}},90258:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"machines/resource-lifecycle","title":"Resource Lifecycle Machine (Universal State v2)","description":"The Resource Lifecycle Machine implements the 9-state Universal State v2 lifecycle for managing individual resources (WireGuard clients, VPNs, DNS services, etc.). It handles validation, application, degradation detection, and archival with proper rollback mechanics.","source":"@site/../../libs/state/docs/machines/resource-lifecycle.md","sourceDirName":"machines","slug":"/machines/resource-lifecycle","permalink":"/docs/state/machines/resource-lifecycle","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/state/docs/machines/resource-lifecycle.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"State Persistence API","permalink":"/docs/state/machines/persistence"},"next":{"title":"VPN Connection Machine (Feature Example)","permalink":"/docs/state/machines/vpn-connection"}}');var i=r(31085),a=r(71184);const s={},d="Resource Lifecycle Machine (Universal State v2)",o={},l=[{value:"Complete State Chart",id:"complete-state-chart",level:2},{value:"9 Lifecycle States",id:"9-lifecycle-states",level:2},{value:"Complete State Reference",id:"complete-state-reference",level:2},{value:"Context",id:"context",level:2},{value:"Events",id:"events",level:2},{value:"Guards",id:"guards",level:2},{value:"Actions",id:"actions",level:2},{value:"Actors",id:"actors",level:2},{value:"Integration with Universal State v2",id:"integration-with-universal-state-v2",level:2},{value:"State Predicates",id:"state-predicates",level:2},{value:"Display Info Colors",id:"display-info-colors",level:2},{value:"Usage with <code>useResourceLifecycle</code> Hook",id:"usage-with-useresourcelifecycle-hook",level:2},{value:"Code Examples",id:"code-examples",level:2},{value:"Create Machine",id:"create-machine",level:3},{value:"Degradation Handling",id:"degradation-handling",level:3},{value:"Retry with Exponential Backoff",id:"retry-with-exponential-backoff",level:3},{value:"Comparing States",id:"comparing-states",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"resource-lifecycle-machine-universal-state-v2",children:"Resource Lifecycle Machine (Universal State v2)"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Resource Lifecycle Machine"})," implements the ",(0,i.jsx)(n.strong,{children:"9-state Universal State v2 lifecycle"})," for managing individual resources (WireGuard clients, VPNs, DNS services, etc.). It handles validation, application, degradation detection, and archival with proper rollback mechanics."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Source:"})," ",(0,i.jsx)(n.code,{children:"libs/state/machines/src/resourceLifecycleMachine.ts"}),"\n",(0,i.jsx)(n.strong,{children:"Hook:"})," ",(0,i.jsx)(n.code,{children:"libs/state/machines/src/hooks/useResourceLifecycle.ts"})]}),"\n",(0,i.jsx)(n.h2,{id:"complete-state-chart",children:"Complete State Chart"}),"\n",(0,i.jsx)(n.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e draft: initial\n\n    draft --\x3e validating: VALIDATE (guard: hasUuid)\n    draft --\x3e draft: EDIT\n\n    validating --\x3e error: validation errors\n    validating --\x3e valid: no errors\n\n    error --\x3e draft: EDIT or RESET\n    error --\x3e validating: RETRY\n\n    valid --\x3e draft: EDIT\n    valid --\x3e applying: APPLY\n\n    applying --\x3e error: onError\n    applying --\x3e active: onDone\n\n    active --\x3e draft: EDIT\n    active --\x3e degraded: DEGRADE\n    active --\x3e deprecated: DEPRECATE\n    active --\x3e active: RUNTIME_UPDATE\n\n    degraded --\x3e active: RECOVER\n    degraded --\x3e deprecated: DEPRECATE\n    degraded --\x3e draft: EDIT\n    degraded --\x3e degraded: RUNTIME_UPDATE\n\n    deprecated --\x3e active: RESTORE\n    deprecated --\x3e archived: ARCHIVE\n\n    archived --\x3e [*]\n\n    note right of draft\n        Resource not yet validated\n        User can EDIT configuration\n        Entry: (initial state)\n    end note\n\n    note right of validating\n        Running 7-stage validation\n        Cannot skip validation\n        Async operation in progress\n        Entry: recordTransition\n    end note\n\n    note right of valid\n        Validation passed\n        Ready to apply\n        Can EDIT or APPLY\n        Entry: (state change)\n    end note\n\n    note right of applying\n        Sending config to router\n        Capturing rollback data\n        Async operation in progress\n        Entry: recordTransition\n    end note\n\n    note right of active\n        Resource running on router\n        Can receive RUNTIME_UPDATE\n        Healthy state, normal operation\n        Entry: clearError\n    end note\n\n    note right of degraded\n        Running but with issues\n        Can recover or deprecate\n        Receive RUNTIME_UPDATE\n        Entry: recordTransition\n    end note\n\n    note right of error\n        Validation or apply failed\n        Can retry, edit, or reset\n        Shows error details\n        Entry: setError\n    end note\n\n    note right of deprecated\n        Marked for removal\n        Can restore or archive\n        Entry: recordTransition\n    end note\n\n    note right of archived\n        No longer active\n        Final state, read-only\n        Entry: recordTransition\n    end note"}),"\n",(0,i.jsx)(n.h2,{id:"9-lifecycle-states",children:"9 Lifecycle States"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"State"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Key Features"}),(0,i.jsx)(n.th,{children:"Transitions"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"draft"})}),(0,i.jsx)(n.td,{children:"Initial creation or edit mode"}),(0,i.jsx)(n.td,{children:"Not yet validated, user editable"}),(0,i.jsx)(n.td,{children:"EDIT (stay), VALIDATE \u2192 validating"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"validating"})}),(0,i.jsx)(n.td,{children:"Running validation pipeline"}),(0,i.jsx)(n.td,{children:"7-stage validation, async, read-only"}),(0,i.jsx)(n.td,{children:"onDone \u2192 error|valid, onError \u2192 error"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"valid"})}),(0,i.jsx)(n.td,{children:"Passed validation, ready to apply"}),(0,i.jsx)(n.td,{children:"Valid configuration, can apply"}),(0,i.jsx)(n.td,{children:"APPLY \u2192 applying, EDIT \u2192 draft"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"applying"})}),(0,i.jsx)(n.td,{children:"Being applied to router"}),(0,i.jsx)(n.td,{children:"Async operation, capturing rollback"}),(0,i.jsx)(n.td,{children:"onDone \u2192 active, onError \u2192 error"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"active"})}),(0,i.jsx)(n.td,{children:"Successfully running on router"}),(0,i.jsx)(n.td,{children:"Healthy state, normal operation"}),(0,i.jsx)(n.td,{children:"EDIT \u2192 draft, DEGRADE \u2192 degraded, DEPRECATE \u2192 deprecated, SYNC \u2192 syncing, RUNTIME_UPDATE"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"degraded"})}),(0,i.jsx)(n.td,{children:"Running but with issues"}),(0,i.jsx)(n.td,{children:"Has problems, can recover"}),(0,i.jsx)(n.td,{children:"RUNTIME_UPDATE, RECOVER \u2192 active, DEPRECATE \u2192 deprecated, EDIT \u2192 draft"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"error"})}),(0,i.jsx)(n.td,{children:"Failed validation or apply"}),(0,i.jsx)(n.td,{children:"Validation/apply error, can retry"}),(0,i.jsx)(n.td,{children:"RETRY \u2192 validating, EDIT \u2192 draft, RESET"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"deprecated"})}),(0,i.jsx)(n.td,{children:"Marked for removal"}),(0,i.jsx)(n.td,{children:"Awaiting archive decision"}),(0,i.jsx)(n.td,{children:"RESTORE \u2192 active, ARCHIVE \u2192 archived"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"archived"})}),(0,i.jsx)(n.td,{children:"No longer active"}),(0,i.jsx)(n.td,{children:"Final state, read-only"}),(0,i.jsx)(n.td,{children:"(no transitions)"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Plus ",(0,i.jsx)(n.strong,{children:"syncing"})," (transient state for router sync)."]}),"\n",(0,i.jsx)(n.h2,{id:"complete-state-reference",children:"Complete State Reference"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export type ResourceLifecycleStateValue =\n  | 'draft'\n  | 'validating'\n  | 'valid'\n  | 'applying'\n  | 'active'\n  | 'degraded'\n  | 'error'\n  | 'deprecated'\n  | 'archived'\n  | 'syncing';\n"})}),"\n",(0,i.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ResourceLifecycleContext<TConfig = unknown> {\n  /** Resource UUID from database */\n  uuid: string | null;\n\n  /** Router ID this resource belongs to */\n  routerId: string | null;\n\n  /** Resource type (e.g., 'wireguard-client') */\n  resourceType: string | null;\n\n  /** Current configuration (what's on the router) */\n  configuration: TConfig | null;\n\n  /** Pending configuration (being edited) */\n  pendingConfiguration: TConfig | null;\n\n  /** Validation result from last validation */\n  validationResult: ValidationResult | null;\n\n  /** Current runtime state from router */\n  runtime: RuntimeState | null;\n\n  /** Error message if in error state */\n  errorMessage: string | null;\n\n  /** Error code for programmatic handling */\n  errorCode: string | null;\n\n  /** Rollback data for recovery */\n  rollbackData: TConfig | null;\n\n  /** Timestamp of last state change */\n  lastTransitionAt: number | null;\n\n  /** Number of apply retries */\n  retryCount: number;\n\n  /** Maximum retries before giving up */\n  maxRetries: number;\n\n  /** Degradation reason if degraded */\n  degradationReason: string | null;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export type ResourceLifecycleEvent<TConfig = unknown> =\n  | { type: 'EDIT'; configuration: TConfig }    // Edit configuration\n  | { type: 'VALIDATE' }                         // Trigger validation\n  | { type: 'VALIDATION_SUCCESS'; result: ValidationResult }\n  | { type: 'VALIDATION_FAILURE'; result: ValidationResult }\n  | { type: 'APPLY'; force?: boolean }           // Apply to router\n  | { type: 'APPLY_SUCCESS'; generatedFields?: Record<string, unknown> }\n  | { type: 'APPLY_FAILURE'; error: string; code?: string }\n  | { type: 'RUNTIME_UPDATE'; runtime: RuntimeState }  // From subscription\n  | { type: 'DEGRADE'; reason: string }          // Mark as degraded\n  | { type: 'RECOVER' }                          // Recover from degraded\n  | { type: 'DEPRECATE' }                        // Mark for removal\n  | { type: 'RESTORE' }                          // Undo deprecation\n  | { type: 'ARCHIVE' }                          // Move to archived\n  | { type: 'RETRY' }                            // Retry failed operation\n  | { type: 'RESET' }                            // Reset to draft\n  | { type: 'SYNC' }                             // Sync from router\n  | { type: 'SYNC_COMPLETE'; configuration: TConfig };\n"})}),"\n",(0,i.jsx)(n.h2,{id:"guards",children:"Guards"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  hasValidationErrors: boolean;      // validationResult.errors.length > 0\n  noValidationErrors: boolean;       // no validation errors\n  canApply: boolean;                 // validationResult.canApply && no errors\n  canRetry: boolean;                 // retryCount < maxRetries\n  hasRollbackData: boolean;          // rollbackData !== null\n  isHealthy: boolean;                // runtime.health === 'HEALTHY'\n  isDegraded: boolean;               // runtime.health in ['DEGRADED', 'CRITICAL']\n  hasUuid: boolean;                  // uuid !== null (required for validate)\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"actions",children:"Actions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  updateConfiguration();            // Set pending config from EDIT\n  setValidationResult();             // Store validation result\n  setRollbackData();                 // Store rollback data from apply\n  updateRuntime();                   // Update runtime state from subscription\n  setError();                        // Store error message and code\n  clearError();                      // Clear error state\n  setDegradation();                  // Mark as degraded with reason\n  clearDegradation();                // Clear degradation\n  incrementRetry();                  // Increment retry count\n  resetRetry();                      // Reset retry count to 0\n  recordTransition();                // Timestamp state change\n  applyGeneratedFields();            // Merge generated fields into config\n  syncConfiguration();               // Update from sync result\n  notifyStateChange();               // Emit state change event\n  notifyError();                     // Callback on error\n  resetContext();                    // Clear all pending state\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"actors",children:"Actors"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"actors: {\n  validateResource(uuid: string): Promise<ValidationResult>;\n\n  applyResource(uuid: string, force?: boolean): Promise<{\n    rollbackData: TConfig;\n    generatedFields?: Record<string, unknown>;\n  }>;\n\n  syncResource(uuid: string): Promise<TConfig>;\n\n  executeRollback(uuid: string, rollbackData: TConfig): Promise<void>;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"integration-with-universal-state-v2",children:"Integration with Universal State v2"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"8-layer resource model"})," maps to machine states:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Layer 1: Metadata          \u2192 resourceType, uuid, routerId\nLayer 2: Configuration     \u2192 configuration (current), pendingConfiguration\nLayer 3: Validation        \u2192 validationResult, status (draft/validating/valid)\nLayer 4: Applied State     \u2192 active/degraded/error (runtime status)\nLayer 5: Derived Data      \u2192 generated fields (computed on apply)\nLayer 6: Lifecycle         \u2192 deprecated/archived states\nLayer 7: Relationships     \u2192 routerId (parent router)\nLayer 8: Audit Trail       \u2192 lastTransitionAt, retryCount\n"})}),"\n",(0,i.jsx)(n.h2,{id:"state-predicates",children:"State Predicates"}),"\n",(0,i.jsx)(n.p,{children:"Helper functions for conditional UI rendering:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import {\n  isResourcePending,      // validating | applying | syncing\n  isResourceActive,       // active | degraded\n  isResourceEditable,     // draft | valid | active | degraded | error\n  isResourceAppliable,    // state === 'valid'\n  isResourceTerminal,     // state === 'archived'\n  getResourceStateDisplayInfo,\n} from '@nasnet/state/machines';\n\n// Returns: { label, description, color, showSpinner }\nconst info = getResourceStateDisplayInfo(state);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"display-info-colors",children:"Display Info Colors"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  draft: { color: 'gray', label: 'Draft', showSpinner: false },\n  validating: { color: 'blue', label: 'Validating', showSpinner: true },\n  valid: { color: 'green', label: 'Valid', showSpinner: false },\n  applying: { color: 'amber', label: 'Applying', showSpinner: true },\n  active: { color: 'green', label: 'Active', showSpinner: false },\n  degraded: { color: 'amber', label: 'Degraded', showSpinner: false },\n  error: { color: 'red', label: 'Error', showSpinner: false },\n  deprecated: { color: 'gray', label: 'Deprecated', showSpinner: false },\n  archived: { color: 'gray', label: 'Archived', showSpinner: false },\n  syncing: { color: 'blue', label: 'Syncing', showSpinner: true },\n}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"usage-with-useresourcelifecycle-hook",children:["Usage with ",(0,i.jsx)(n.code,{children:"useResourceLifecycle"})," Hook"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"import { useResourceLifecycle } from '@nasnet/state/machines';\n\nfunction WireGuardResourceDetail({ resource }: Props) {\n  const {\n    state,\n    context,\n    displayInfo,\n    isPending,\n    isActive,\n    isEditable,\n    isAppliable,\n    validationErrors,\n    edit,\n    validate,\n    apply,\n    updateRuntime,\n    degrade,\n    deprecate,\n    sync,\n  } = useResourceLifecycle<WireGuardConfig>({\n    initialResource: resource,\n    validateResource: async (uuid) => {\n      const response = await api.validateWireGuardResource(uuid);\n      return response.data.validation;\n    },\n    applyResource: async (uuid, force) => {\n      const backup = await api.getBackup(uuid);\n      await api.applyWireGuardResource(uuid, { force });\n      return { rollbackData: backup };\n    },\n    syncResource: async (uuid) => {\n      const response = await api.syncWireGuardResource(uuid);\n      return response.data.configuration;\n    },\n    onStateChange: (newState, ctx) => {\n      console.log(`Resource ${ctx.uuid} transitioned to ${newState}`);\n    },\n  });\n\n  // Setup runtime subscription\n  useEffect(() => {\n    const subscription = subscribeToResourceRuntime(resource.uuid, (runtime) => {\n      updateRuntime(runtime);\n    });\n    return () => subscription.unsubscribe();\n  }, [resource.uuid]);\n\n  return (\n    <div>\n      {/* Status badge */}\n      <StatusBadge\n        status={displayInfo.color}\n        label={displayInfo.label}\n        showSpinner={displayInfo.showSpinner}\n      />\n\n      {/* Validation errors */}\n      {validationErrors.length > 0 && (\n        <ErrorList errors={validationErrors} />\n      )}\n\n      {/* Config form */}\n      <ConfigForm\n        config={context.configuration}\n        disabled={isPending}\n        onSave={(config) => {\n          edit(config);\n          validate();\n        }}\n      />\n\n      {/* Action buttons */}\n      {isAppliable && (\n        <Button onClick={() => apply()} disabled={isPending}>\n          Apply\n        </Button>\n      )}\n      {isActive && (\n        <Button onClick={() => deprecate()}>\n          Deprecate\n        </Button>\n      )}\n      {isActive && (\n        <Button onClick={() => sync()} disabled={isPending}>\n          Sync from Router\n        </Button>\n      )}\n    </div>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,i.jsx)(n.h3,{id:"create-machine",children:"Create Machine"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { createResourceLifecycleMachine } from '@nasnet/state/machines';\n\nconst wireguardMachine = createResourceLifecycleMachine<WireGuardConfig>({\n  id: 'wireguard-lifecycle',\n  initialResource: {\n    uuid: 'wg-001',\n    type: 'wireguard-client',\n    configuration: {\n      privateKey: '...',\n      publicKey: '...',\n      listenPort: 51820,\n    },\n  },\n  validateResource: async (uuid) => {\n    const response = await api.validateWireGuard(uuid);\n    return {\n      canApply: response.valid,\n      errors: response.errors || [],\n      warnings: response.warnings || [],\n    };\n  },\n  applyResource: async (uuid) => {\n    const previous = await api.getWireGuardBackup(uuid);\n    await api.applyWireGuard(uuid);\n    return { rollbackData: previous };\n  },\n  syncResource: async (uuid) => {\n    const response = await api.getWireGuardConfig(uuid);\n    return response.data.configuration;\n  },\n  onStateChange: (state, context) => {\n    console.log(`WireGuard ${context.uuid}: ${state}`);\n  },\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"degradation-handling",children:"Degradation Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"useEffect(() => {\n  // Subscribe to router health updates\n  const unsubscribe = subscribeToHealth(resource.routerId, (health) => {\n    if (health.resources[resource.uuid]?.status === 'unhealthy') {\n      degrade(`CPU usage above 90%`);\n    } else if (state === 'degraded') {\n      recover();\n    }\n  });\n  return unsubscribe;\n}, [resource.uuid]);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"retry-with-exponential-backoff",children:"Retry with Exponential Backoff"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const machine = createResourceLifecycleMachine({\n  // ... config ...\n  maxRetries: 3,  // 3 attempts\n});\n\n// Manual retry with backoff\nlet retryDelay = 1000;\nconst retryWithBackoff = () => {\n  setTimeout(() => {\n    send({ type: 'RETRY' });\n    retryDelay *= 2;  // Exponential backoff\n  }, retryDelay);\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"comparing-states",children:"Comparing States"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"State"}),(0,i.jsx)(n.th,{children:"Editable"}),(0,i.jsx)(n.th,{children:"Validated"}),(0,i.jsx)(n.th,{children:"On Router"}),(0,i.jsx)(n.th,{children:"Can Apply"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"draft"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"valid"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2713"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"applying"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u23f3"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"active"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"degraded"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"error"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"deprecated"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"archived"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2713"}),(0,i.jsx)(n.td,{children:"\u2717"}),(0,i.jsx)(n.td,{children:"\u2717"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Overview:"})," See ",(0,i.jsx)(n.code,{children:"overview.md"})," for machine catalog"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Config Pipeline:"})," See ",(0,i.jsx)(n.code,{children:"config-pipeline.md"})," for configuration change safety flow"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Change Sets:"})," See ",(0,i.jsx)(n.code,{children:"change-set-machine.md"})," for multi-resource atomic operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Persistence:"})," See ",(0,i.jsx)(n.code,{children:"persistence.md"})," for state recovery"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);
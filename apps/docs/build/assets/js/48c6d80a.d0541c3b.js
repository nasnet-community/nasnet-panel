"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[5037],{52166:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"error-handling","title":"Error Handling","description":"NasNetConnect\'s error handling is a multi-layer pipeline that transforms raw protocol errors into structured, user-friendly feedback. The system covers GraphQL errors from Apollo, network-level failures from both Apollo and Axios, component-level error display, and structured error logging with deduplication and batching. The entire pipeline is coordinated by three cooperating modules: the Apollo error link, the error message taxonomy, and the error logging utility \u2014 complemented by React hooks that bring structured errors into the component layer.","source":"@site/../../libs/api-client/docs/error-handling.md","sourceDirName":".","slug":"/error-handling","permalink":"/docs/api-client/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/api-client/docs/error-handling.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Error Handling"},"sidebar":"sidebar","previous":{"title":"Authentication","permalink":"/docs/api-client/authentication"},"next":{"title":"Offline-First Architecture","permalink":"/docs/api-client/offline-first"}}');var s=n(31085),t=n(71184);const i={sidebar_position:5,title:"Error Handling"},d="Error Handling",c={},l=[{value:"Error Pipeline Overview",id:"error-pipeline-overview",level:2},{value:"Error Taxonomy",id:"error-taxonomy",level:2},{value:"Error Code Categories",id:"error-code-categories",level:3},{value:"<code>ErrorInfo</code> Type",id:"errorinfo-type",level:3},{value:"Complete Code Reference",id:"complete-code-reference",level:3},{value:"Exported Functions from <code>error-messages.ts</code>",id:"exported-functions-from-error-messagests",level:2},{value:"<code>getErrorMessage(code, fallbackMessage?)</code>",id:"geterrormessagecode-fallbackmessage",level:4},{value:"<code>getErrorInfo(code, fallbackMessage?)</code>",id:"geterrorinfocode-fallbackmessage",level:4},{value:"<code>getErrorCategory(code)</code>",id:"geterrorcategorycode",level:4},{value:"<code>getErrorSeverity(code)</code>",id:"geterrorseveritycode",level:4},{value:"<code>isRecoverableError(code)</code>",id:"isrecoverableerrorcode",level:4},{value:"<code>getErrorAction(code)</code>",id:"geterroractioncode",level:4},{value:"Category Predicates",id:"category-predicates",level:4},{value:"Apollo Error Link",id:"apollo-error-link",level:2},{value:"GraphQL Error Routing",id:"graphql-error-routing",level:3},{value:"Network Error Routing",id:"network-error-routing",level:3},{value:"<code>createErrorLink(options)</code>",id:"createerrorlinkoptions",level:3},{value:"Structured Error Logging",id:"structured-error-logging",level:2},{value:"Configuration Constants",id:"configuration-constants",level:3},{value:"<code>ErrorLogEntry</code> Type",id:"errorlogentry-type",level:3},{value:"Public API",id:"public-api",level:3},{value:"<code>logError(entry)</code>",id:"logerrorentry",level:4},{value:"<code>logGraphQLError(operation, error, context?)</code>",id:"loggraphqlerroroperation-error-context",level:4},{value:"<code>logNetworkError(operation, error, context?)</code>",id:"lognetworkerroroperation-error-context",level:4},{value:"<code>logComponentError(component, error, errorInfo?)</code>",id:"logcomponenterrorcomponent-error-errorinfo",level:4},{value:"<code>flushErrorBuffer()</code>",id:"flusherrorbuffer",level:4},{value:"<code>getErrorBufferSize()</code>",id:"geterrorbuffersize",level:4},{value:"Axios Error Interceptor",id:"axios-error-interceptor",level:2},{value:"HTTP Status Code Mapping",id:"http-status-code-mapping",level:3},{value:"<code>errorInterceptor(error)</code>",id:"errorinterceptorerror",level:3},{value:"React Hooks",id:"react-hooks",level:2},{value:"<code>useGraphQLError</code>",id:"usegraphqlerror",level:3},{value:"<code>UseGraphQLErrorOptions</code>",id:"usegraphqlerroroptions",level:4},{value:"<code>ProcessedError</code>",id:"processederror",level:4},{value:"<code>UseGraphQLErrorReturn</code>",id:"usegraphqlerrorreturn",level:4},{value:"Usage Examples",id:"usage-examples",level:4},{value:"Utility Exports",id:"utility-exports",level:4},{value:"<code>useQueryWithLoading</code>",id:"usequerywithloading",level:3},{value:"<code>useMutationWithLoading</code>",id:"usemutationwithloading",level:3},{value:"<code>createOptimisticOptions</code>",id:"createoptimisticoptions",level:4},{value:"Error Message Utility API",id:"error-message-utility-api",level:2},{value:"<code>getErrorMessage(code?, fallbackMessage?)</code>",id:"geterrormessagecode-fallbackmessage-1",level:3},{value:"<code>getErrorInfo(code?, fallbackMessage?)</code>",id:"geterrorinfocode-fallbackmessage-1",level:3},{value:"<code>getErrorCategory(code)</code>",id:"geterrorcategorycode-1",level:3},{value:"<code>getErrorSeverity(code?)</code>",id:"geterrorseveritycode-1",level:3},{value:"<code>getErrorAction(code?)</code>",id:"geterroractioncode-1",level:3},{value:"Category Predicates",id:"category-predicates-1",level:3},{value:"Structured Error Logging",id:"structured-error-logging-1",level:2},{value:"Configuration Constants",id:"configuration-constants-1",level:3},{value:"<code>ErrorLogEntry</code> Type",id:"errorlogentry-type-1",level:3},{value:"<code>logError(entry)</code>",id:"logerrorentry-1",level:3},{value:"<code>logGraphQLError(operation, error, context?)</code>",id:"loggraphqlerroroperation-error-context-1",level:3},{value:"<code>logNetworkError(operation, error, context?)</code>",id:"lognetworkerroroperation-error-context-1",level:3},{value:"<code>logComponentError(component, error, errorInfo?)</code>",id:"logcomponenterrorcomponent-error-errorinfo-1",level:3},{value:"<code>flushErrorBuffer()</code>",id:"flusherrorbuffer-1",level:3},{value:"<code>getErrorBufferSize()</code>",id:"geterrorbuffersize-1",level:3},{value:"Enhanced React Hooks API",id:"enhanced-react-hooks-api",level:2},{value:"<code>useQueryWithLoading&lt;TData, TVariables&gt;(query, options?)</code>",id:"usequerywithloadingtdata-tvariablesquery-options",level:3},{value:"<code>useMutationWithLoading&lt;TData, TVariables&gt;(mutation, options?)</code>",id:"usemutationwithloadingtdata-tvariablesmutation-options",level:3},{value:"<code>createOptimisticOptions&lt;TData, TVariables&gt;(config)</code>",id:"createoptimisticoptionstdata-tvariablesconfig",level:3},{value:"<code>useGraphQLError(apolloError?, options?)</code>",id:"usegraphqlerrorapolloerror-options",level:3},{value:"Utility Exports",id:"utility-exports-1",level:4},{value:"See Also",id:"see-also",level:2}];function a(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"error-handling",children:"Error Handling"})}),"\n",(0,s.jsx)(r.p,{children:"NasNetConnect's error handling is a multi-layer pipeline that transforms raw protocol errors into structured, user-friendly feedback. The system covers GraphQL errors from Apollo, network-level failures from both Apollo and Axios, component-level error display, and structured error logging with deduplication and batching. The entire pipeline is coordinated by three cooperating modules: the Apollo error link, the error message taxonomy, and the error logging utility \u2014 complemented by React hooks that bring structured errors into the component layer."}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"error-pipeline-overview",children:"Error Pipeline Overview"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"                  GraphQL Response                Network Failure\n                        \u2502                               \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502  graphQLErrors[]  \u2502         \u2502    networkError      \u2502\n              \u2502  (from server)    \u2502         \u2502  (timeout/HTTP err)  \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502                               \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                        \u25bc\n                              apollo-error-link.ts\n                              (onError handler)\n                                        \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u25bc                   \u25bc                   \u25bc\n             logGraphQLError    classify error code    handleAuthError /\n             logNetworkError    via error-messages.ts  handleNetworkError\n                    \u2502                   \u2502                   \u2502\n                    \u25bc                   \u25bc                   \u25bc\n             error-logging.ts     switch on code      useAuthStore.clearAuth()\n             (buffer/console)     FORBIDDEN            addNotification()\n                                  NOT_FOUND            'auth:expired' event\n                                  VALIDATION_FAILED\n                                  default \u2192 getErrorInfo()\n\n                    \u25bc (component layer)\n              useGraphQLError()     useQueryWithLoading()     useMutationWithLoading()\n              ProcessedError        NetworkStatus states       isLoading/isSuccess/isError\n"})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"error-taxonomy",children:"Error Taxonomy"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/utils/error-messages.ts"})]}),"\n",(0,s.jsx)(r.p,{children:"All error codes follow a six-category scheme. The category is encoded in the first two characters of the code string."}),"\n",(0,s.jsx)(r.h3,{id:"error-code-categories",children:"Error Code Categories"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Prefix"}),(0,s.jsx)(r.th,{children:"Category"}),(0,s.jsx)(r.th,{children:"Examples"}),(0,s.jsx)(r.th,{children:"Notes"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"P1xx"})}),(0,s.jsx)(r.td,{children:"Platform"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"P100"}),", ",(0,s.jsx)(r.code,{children:"P101"}),", ",(0,s.jsx)(r.code,{children:"P102"}),", ",(0,s.jsx)(r.code,{children:"P103"})]}),(0,s.jsx)(r.td,{children:"Router capability/version mismatches"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"R2xx"})}),(0,s.jsx)(r.td,{children:"Protocol"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"R200"}),", ",(0,s.jsx)(r.code,{children:"R201"}),", ",(0,s.jsx)(r.code,{children:"R202"}),", ",(0,s.jsx)(r.code,{children:"R203"})]}),(0,s.jsx)(r.td,{children:"RouterOS connection failures"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"N3xx"})}),(0,s.jsx)(r.td,{children:"Network"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"N300"}),", ",(0,s.jsx)(r.code,{children:"N301"}),", ",(0,s.jsx)(r.code,{children:"N302"})]}),(0,s.jsx)(r.td,{children:"Reachability, DNS, timeout"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"V4xx"})}),(0,s.jsx)(r.td,{children:"Validation"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"V400"}),", ",(0,s.jsx)(r.code,{children:"V401"}),", ",(0,s.jsx)(r.code,{children:"V402"}),", ",(0,s.jsx)(r.code,{children:"V403"})]}),(0,s.jsx)(r.td,{children:"Schema, reference, conflict"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"A5xx"})}),(0,s.jsx)(r.td,{children:"Auth"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"A500"}),", ",(0,s.jsx)(r.code,{children:"A501"}),", ",(0,s.jsx)(r.code,{children:"A502"})]}),(0,s.jsx)(r.td,{children:"Credentials, permissions, expiry"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"S6xx"})}),(0,s.jsx)(r.td,{children:"Resource"}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"S600"}),", ",(0,s.jsx)(r.code,{children:"S601"}),", ",(0,s.jsx)(r.code,{children:"S602"}),", ",(0,s.jsx)(r.code,{children:"S603"})]}),(0,s.jsx)(r.td,{children:"Not found, locked, invalid state"})]})]})]}),"\n",(0,s.jsxs)(r.p,{children:["Additionally, GraphQL-standard codes (",(0,s.jsx)(r.code,{children:"UNAUTHENTICATED"}),", ",(0,s.jsx)(r.code,{children:"FORBIDDEN"}),", ",(0,s.jsx)(r.code,{children:"NOT_FOUND"}),", ",(0,s.jsx)(r.code,{children:"VALIDATION_FAILED"}),") are handled by the error link by name."]}),"\n",(0,s.jsxs)(r.h3,{id:"errorinfo-type",children:[(0,s.jsx)(r.code,{children:"ErrorInfo"})," Type"]}),"\n",(0,s.jsx)(r.p,{children:"Every resolved error code maps to this structure:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"// core/src/utils/error-messages.ts:33\nexport interface ErrorInfo {\n  message: string;      // User-facing message (no jargon)\n  severity: ErrorSeverity;  // 'info' | 'warning' | 'error' | 'critical'\n  recoverable: boolean; // Whether user action can fix it\n  action?: string;      // Suggested recovery step\n  i18nKey?: string;     // Translation key (e.g., 'errors.auth.expired')\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"complete-code-reference",children:"Complete Code Reference"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Platform errors (P1xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"P100"})}),(0,s.jsx)(r.td,{children:"Feature not supported on your router"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Check router compatibility"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"P101"})}),(0,s.jsx)(r.td,{children:"Capability not available"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Install required package"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"P102"})}),(0,s.jsx)(r.td,{children:"RouterOS version too old"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Update RouterOS"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"P103"})}),(0,s.jsx)(r.td,{children:"Required package not installed"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Install missing package"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Protocol errors (R2xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"R200"})}),(0,s.jsx)(r.td,{children:"Failed to connect to router"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Check router IP and credentials"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"R201"})}),(0,s.jsx)(r.td,{children:"Connection timed out"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Try again or check network"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"R202"})}),(0,s.jsx)(r.td,{children:"Protocol error occurred"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Try reconnecting"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"R203"})}),(0,s.jsx)(r.td,{children:"All connection methods failed"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Verify router is accessible"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Network errors (N3xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"N300"})}),(0,s.jsx)(r.td,{children:"Cannot reach the router"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Check your network connection"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"N301"})}),(0,s.jsx)(r.td,{children:"Cannot resolve router address"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Check DNS settings"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"N302"})}),(0,s.jsx)(r.td,{children:"Network request timed out"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Try again"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Validation errors (V4xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"V400"})}),(0,s.jsx)(r.td,{children:"Invalid input provided"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Check your input"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"V401"})}),(0,s.jsx)(r.td,{children:"Referenced item not found"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Select a valid reference"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"V402"})}),(0,s.jsx)(r.td,{children:"Circular dependency detected"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Review configuration"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"V403"})}),(0,s.jsx)(r.td,{children:"Conflicting configuration detected"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Resolve conflicts"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Auth errors (A5xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"A500"})}),(0,s.jsx)(r.td,{children:"Authentication failed"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Check your credentials"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"A501"})}),(0,s.jsx)(r.td,{children:"Permission denied for this action"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Contact administrator"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"A502"})}),(0,s.jsx)(r.td,{children:"Session has expired"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Please log in again"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Resource errors (S6xx)"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Code"}),(0,s.jsx)(r.th,{children:"Message"}),(0,s.jsx)(r.th,{children:"Severity"}),(0,s.jsx)(r.th,{children:"Recoverable"}),(0,s.jsx)(r.th,{children:"Action"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"S600"})}),(0,s.jsx)(r.td,{children:"Requested item was not found"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Item may have been deleted"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"S601"})}),(0,s.jsx)(r.td,{children:"Resource is locked"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Wait and try again"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"S602"})}),(0,s.jsx)(r.td,{children:"Invalid state transition"}),(0,s.jsx)(r.td,{children:"error"}),(0,s.jsx)(r.td,{children:"false"}),(0,s.jsx)(r.td,{children:"Refresh and try again"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"S603"})}),(0,s.jsx)(r.td,{children:"Dependent resource not ready"}),(0,s.jsx)(r.td,{children:"warning"}),(0,s.jsx)(r.td,{children:"true"}),(0,s.jsx)(r.td,{children:"Wait for dependencies"})]})]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsxs)(r.h2,{id:"exported-functions-from-error-messagests",children:["Exported Functions from ",(0,s.jsx)(r.code,{children:"error-messages.ts"})]}),"\n",(0,s.jsx)(r.h4,{id:"geterrormessagecode-fallbackmessage",children:(0,s.jsx)(r.code,{children:"getErrorMessage(code, fallbackMessage?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorMessage(\n  code: string | undefined,\n  fallbackMessage?: string\n): string\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns the user-friendly message string for a code. Resolution order: exact code match \u2192 category prefix fallback \u2192 provided fallback \u2192 generic message. Safe with ",(0,s.jsx)(r.code,{children:"undefined"})," input."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"getErrorMessage('N300')         // \"Cannot reach the router\"\ngetErrorMessage('N399')         // \"Network error occurred\" (category fallback)\ngetErrorMessage('UNKNOWN', 'Oops') // \"Oops\" (explicit fallback)\ngetErrorMessage(undefined)      // \"An error occurred. Please try again.\"\n"})}),"\n",(0,s.jsx)(r.h4,{id:"geterrorinfocode-fallbackmessage",children:(0,s.jsx)(r.code,{children:"getErrorInfo(code, fallbackMessage?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorInfo(\n  code: string | undefined,\n  fallbackMessage?: string\n): ErrorInfo\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns the full ",(0,s.jsx)(r.code,{children:"ErrorInfo"})," object with message, severity, recoverability, action, and i18n key."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:'const info = getErrorInfo(\'A502\');\n// { message: "Your session has expired", severity: "warning",\n//   recoverable: true, action: "Please log in again",\n//   i18nKey: "errors.auth.expired" }\n'})}),"\n",(0,s.jsx)(r.h4,{id:"geterrorcategorycode",children:(0,s.jsx)(r.code,{children:"getErrorCategory(code)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorCategory(code: string): ErrorCategory | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Extracts the two-character category prefix from a code string. Returns ",(0,s.jsx)(r.code,{children:"undefined"})," if the prefix does not match any known category."]}),"\n",(0,s.jsx)(r.h4,{id:"geterrorseveritycode",children:(0,s.jsx)(r.code,{children:"getErrorSeverity(code)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorSeverity(code: string | undefined): ErrorSeverity\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Shorthand to get just the severity level. Returns ",(0,s.jsx)(r.code,{children:"'error'"})," for unknown codes."]}),"\n",(0,s.jsx)(r.h4,{id:"isrecoverableerrorcode",children:(0,s.jsx)(r.code,{children:"isRecoverableError(code)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function isRecoverableError(code: string | undefined): boolean\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns ",(0,s.jsx)(r.code,{children:"true"})," for unknown codes (safe default)."]}),"\n",(0,s.jsx)(r.h4,{id:"geterroractioncode",children:(0,s.jsx)(r.code,{children:"getErrorAction(code)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorAction(code: string | undefined): string | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns the suggested action string or ",(0,s.jsx)(r.code,{children:"undefined"})," if none is defined."]}),"\n",(0,s.jsx)(r.h4,{id:"category-predicates",children:"Category Predicates"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function isAuthError(code: string | undefined): boolean       // code.startsWith('A5')\nexport function isNetworkError(code: string | undefined): boolean    // code.startsWith('N3') || 'R2'\nexport function isValidationError(code: string | undefined): boolean // code.startsWith('V4')\n"})}),"\n",(0,s.jsx)(r.p,{children:"Used by the error link to route errors to the correct handler without repeated string comparisons."}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"apollo-error-link",children:"Apollo Error Link"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/apollo/apollo-error-link.ts"})]}),"\n",(0,s.jsx)(r.p,{children:"The error link is the first link in the chain and receives every error from every downstream link and the server."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"// core/src/apollo/apollo-client.ts:72\nconst link = from([errorLink, retryLink, splitLink]);\n"})}),"\n",(0,s.jsx)(r.h3,{id:"graphql-error-routing",children:"GraphQL Error Routing"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"// core/src/apollo/apollo-error-link.ts:118\nexport const errorLink = onError(({ graphQLErrors, networkError, operation }) => {\n  if (graphQLErrors) {\n    for (const error of graphQLErrors) {\n      const errorCode = extensions?.code as string | undefined;\n\n      logGraphQLError(operation.operationName, error, { ... });\n\n      // 1. Skip validation errors \u2014 handled by React Hook Form\n      if (checkValidationError(errorCode)) { continue; }\n\n      // 2. Auth errors (A5xx codes or UNAUTHENTICATED)\n      if (checkAuthError(errorCode) || errorCode === 'UNAUTHENTICATED') {\n        handleAuthError(message); continue;\n      }\n\n      // 3. Named codes\n      switch (errorCode) {\n        case 'FORBIDDEN':  \u2192 addNotification 'Access denied'\n        case 'NOT_FOUND':  \u2192 addNotification 'Not found' (warning)\n        default:           \u2192 getErrorInfo(code) \u2192 addNotification\n      }\n    }\n  }\n"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"VALIDATION_FAILED"})," / ",(0,s.jsx)(r.code,{children:"V4xx"})," skip-and-continue is deliberate: form validation errors propagate back to the ",(0,s.jsx)(r.code,{children:"useMutation"})," return value where React Hook Form can display field-level errors. Global notifications for form errors would be confusing."]}),"\n",(0,s.jsx)(r.h3,{id:"network-error-routing",children:"Network Error Routing"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"if (networkError) {\n  const statusCode = getStatusCode(networkError);\n  logNetworkError(operation.operationName, networkError, { statusCode });\n\n  if (statusCode === 401) { handleAuthError(...); return; }\n  if (statusCode === 403) { addNotification 'Access denied'; return; }\n\n  handleNetworkError(networkError);  // generic toast + 'network:error' event\n}\n"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"network:error"})," custom event dispatched by ",(0,s.jsx)(r.code,{children:"handleNetworkError"})," is consumed by ",(0,s.jsx)(r.code,{children:"offline-detector.ts"})," to track connectivity state."]}),"\n",(0,s.jsx)(r.h3,{id:"createerrorlinkoptions",children:(0,s.jsx)(r.code,{children:"createErrorLink(options)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function createErrorLink(options: {\n  onAuthError?: (message: string) => void;\n  onNetworkError?: (error: Error) => void;\n})\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Factory for test environments or embedded deployments where the default side effects (notification store, custom events) are unavailable. When ",(0,s.jsx)(r.code,{children:"onAuthError"})," is provided it replaces ",(0,s.jsx)(r.code,{children:"handleAuthError"})," entirely; when absent the default implementation is used."]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"structured-error-logging",children:"Structured Error Logging"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/utils/error-logging.ts"})]}),"\n",(0,s.jsxs)(r.p,{children:["The logging utility provides structured, deduplicated, buffered error logging. It is intentionally separated from the error display logic to enable future observability integration (tracked as ",(0,s.jsx)(r.code,{children:"NAS-13.8"}),")."]}),"\n",(0,s.jsx)(r.h3,{id:"configuration-constants",children:"Configuration Constants"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const MAX_BUFFER_SIZE = 10;           // Buffer flushes at 10 entries\nconst FLUSH_INTERVAL_MS = 60000;      // Flush every 60 seconds\nconst THROTTLE_WINDOW_MS = 5000;      // Deduplicate within 5 seconds\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"errorlogentry-type",children:[(0,s.jsx)(r.code,{children:"ErrorLogEntry"})," Type"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:'export interface ErrorLogEntry {\n  code?: string;        // Error code (e.g. "N300")\n  message: string;\n  operation?: string;   // GraphQL operation name\n  context?: Record<string, unknown>;\n  timestamp: number;    // Auto-generated (ms since epoch)\n  stack?: string;       // Error stack trace\n  url?: string;         // Auto-captured window.location.href\n  component?: string;   // Source component name (for boundary errors)\n}\n'})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"ErrorLogInput"})," is ",(0,s.jsx)(r.code,{children:"Omit<ErrorLogEntry, 'timestamp' | 'url'>"})," \u2014 callers do not provide auto-generated fields."]}),"\n",(0,s.jsx)(r.h3,{id:"public-api",children:"Public API"}),"\n",(0,s.jsx)(r.h4,{id:"logerrorentry",children:(0,s.jsx)(r.code,{children:"logError(entry)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logError(entry: ErrorLogInput): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Core logging function. Deduplication is based on a hash of ",(0,s.jsx)(r.code,{children:"code + message + operation"}),". If the same error fires within 5 seconds it is silently dropped. In development mode it logs to the console immediately with colored grouping. In production it buffers entries and flushes when the buffer reaches ",(0,s.jsx)(r.code,{children:"MAX_BUFFER_SIZE"})," or ",(0,s.jsx)(r.code,{children:"FLUSH_INTERVAL_MS"})," elapses."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"logError({\n  code: 'N300',\n  message: 'Connection failed',\n  operation: 'GetRouter',\n  context: { routerId: 'abc' },\n});\n"})}),"\n",(0,s.jsx)(r.h4,{id:"loggraphqlerroroperation-error-context",children:(0,s.jsx)(r.code,{children:"logGraphQLError(operation, error, context?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logGraphQLError(\n  operation: string,\n  error: { message: string; extensions?: { code?: string } },\n  context?: Record<string, unknown>\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Convenience wrapper used by the error link. Extracts ",(0,s.jsx)(r.code,{children:"extensions.code"})," and calls ",(0,s.jsx)(r.code,{children:"logError"}),"."]}),"\n",(0,s.jsx)(r.h4,{id:"lognetworkerroroperation-error-context",children:(0,s.jsx)(r.code,{children:"logNetworkError(operation, error, context?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logNetworkError(\n  operation: string,\n  error: Error,\n  context?: Record<string, unknown>\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Defaults the code to ",(0,s.jsx)(r.code,{children:"N302"})," (network timeout) since most Apollo network errors do not carry structured codes."]}),"\n",(0,s.jsx)(r.h4,{id:"logcomponenterrorcomponent-error-errorinfo",children:(0,s.jsx)(r.code,{children:"logComponentError(component, error, errorInfo?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logComponentError(\n  component: string,\n  error: Error,\n  errorInfo?: { componentStack?: string }\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Intended for use inside React error boundaries. Sets ",(0,s.jsx)(r.code,{children:"component"})," on the log entry and includes the React component stack in ",(0,s.jsx)(r.code,{children:"context"}),"."]}),"\n",(0,s.jsx)(r.h4,{id:"flusherrorbuffer",children:(0,s.jsx)(r.code,{children:"flushErrorBuffer()"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function flushErrorBuffer(): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Force-flushes the production buffer. Should be called on ",(0,s.jsx)(r.code,{children:"window.beforeunload"})," to avoid losing buffered errors on page close."]}),"\n",(0,s.jsx)(r.h4,{id:"geterrorbuffersize",children:(0,s.jsx)(r.code,{children:"getErrorBufferSize()"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorBufferSize(): number\n"})}),"\n",(0,s.jsx)(r.p,{children:"Returns the current number of entries waiting to be flushed. Useful in monitoring dashboards."}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"axios-error-interceptor",children:"Axios Error Interceptor"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/interceptors/error.ts"})]}),"\n",(0,s.jsxs)(r.p,{children:["The Axios error interceptor handles the REST client path. It runs after the retry interceptor exhausts its attempts (LIFO stack order \u2014 see ",(0,s.jsx)(r.code,{children:"core/src/client.ts"})," for registration order)."]}),"\n",(0,s.jsx)(r.h3,{id:"http-status-code-mapping",children:"HTTP Status Code Mapping"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Status"}),(0,s.jsx)(r.th,{children:"User Message"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"400"}),(0,s.jsx)(r.td,{children:"Bad request. Please check your input."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"401"}),(0,s.jsx)(r.td,{children:"Authentication failed. Check your credentials."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"403"}),(0,s.jsx)(r.td,{children:"Permission denied. You do not have access."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"404"}),(0,s.jsx)(r.td,{children:"Resource not found."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"409"}),(0,s.jsx)(r.td,{children:"Conflict. The resource may have changed."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"429"}),(0,s.jsx)(r.td,{children:"Too many requests. Please try again later."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"500"}),(0,s.jsx)(r.td,{children:"Server error. Please try again."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"502"}),(0,s.jsx)(r.td,{children:"Gateway error. The server is temporarily unavailable."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"503"}),(0,s.jsx)(r.td,{children:"Service unavailable. Please try again later."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"504"}),(0,s.jsx)(r.td,{children:"Gateway timeout. The server is not responding."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Network error (no response)"}),(0,s.jsx)(r.td,{children:"Network error. Check your connection."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"ECONNABORTED"})}),(0,s.jsx)(r.td,{children:"Request timeout. The server took too long to respond."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"\u2265500 (unknown)"}),(0,s.jsx)(r.td,{children:"Server error. Please try again."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"\u2265400 (unknown)"}),(0,s.jsx)(r.td,{children:"Request failed. Please try again."})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"errorinterceptorerror",children:(0,s.jsx)(r.code,{children:"errorInterceptor(error)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function errorInterceptor(error: AxiosError): Promise<never>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Logs the raw error to ",(0,s.jsx)(r.code,{children:"console.error"})," with ",(0,s.jsx)(r.code,{children:"url"}),", ",(0,s.jsx)(r.code,{children:"method"}),", ",(0,s.jsx)(r.code,{children:"status"}),", ",(0,s.jsx)(r.code,{children:"message"}),", and ",(0,s.jsx)(r.code,{children:"timestamp"}),", then rejects with an ",(0,s.jsx)(r.code,{children:"ApiError"})," instance that wraps the Axios error:"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"return Promise.reject(\n  new ApiError(message, error, statusCode, `HTTP_${statusCode}`)\n);\n"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"ApiError"})," class (from ",(0,s.jsx)(r.code,{children:"core/src/types.ts"}),") is type-safe and provides ",(0,s.jsx)(r.code,{children:"statusCode"})," and ",(0,s.jsx)(r.code,{children:"code"})," fields for downstream handlers."]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"react-hooks",children:"React Hooks"}),"\n",(0,s.jsx)(r.h3,{id:"usegraphqlerror",children:(0,s.jsx)(r.code,{children:"useGraphQLError"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useGraphQLError.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function useGraphQLError(\n  apolloError: ApolloError | Error | undefined,\n  options?: UseGraphQLErrorOptions\n): UseGraphQLErrorReturn\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Transforms an ",(0,s.jsx)(r.code,{children:"ApolloError"})," or generic ",(0,s.jsx)(r.code,{children:"Error"})," into a ",(0,s.jsx)(r.code,{children:"ProcessedError"})," ready for UI rendering."]}),"\n",(0,s.jsx)(r.h4,{id:"usegraphqlerroroptions",children:(0,s.jsx)(r.code,{children:"UseGraphQLErrorOptions"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface UseGraphQLErrorOptions {\n  showToast?: boolean;            // Auto-show notification on error (default: false)\n  logErrors?: boolean;            // Log via error-logging.ts (default: true)\n  operationName?: string;         // For structured log entries\n  skipValidationErrors?: boolean; // Suppress V4xx errors (default: false)\n}\n"})}),"\n",(0,s.jsx)(r.h4,{id:"processederror",children:(0,s.jsx)(r.code,{children:"ProcessedError"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface ProcessedError {\n  message: string;            // User-facing message from getErrorInfo()\n  severity: ErrorSeverity;\n  code?: string;\n  technicalMessage?: string;  // Raw apolloError.message for debug views\n  recoverable: boolean;\n  action?: string;\n  isAuthError: boolean;       // True for A5xx or ApolloError with networkError\n  isNetworkError: boolean;\n  isValidationError: boolean;\n  originalError?: ApolloError | Error;\n}\n"})}),"\n",(0,s.jsx)(r.h4,{id:"usegraphqlerrorreturn",children:(0,s.jsx)(r.code,{children:"UseGraphQLErrorReturn"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface UseGraphQLErrorReturn {\n  error: ProcessedError | null;\n  hasError: boolean;\n  clearError: () => void;\n  showErrorToast: () => void;   // Manually trigger notification\n  createRetryHandler: <T>(fn: () => Promise<T>) => () => Promise<T | undefined>;\n}\n"})}),"\n",(0,s.jsx)(r.h4,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Basic query error display:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"function RouterCard({ routerId }: { routerId: string }) {\n  const { data, error: apolloError, refetch } = useQuery(GET_ROUTER);\n  const { error, hasError } = useGraphQLError(apolloError);\n\n  if (hasError) {\n    return (\n      <ErrorCard\n        title={error!.message}\n        type={error!.isNetworkError ? 'network' : 'error'}\n        onRetry={refetch}\n      />\n    );\n  }\n  return <RouterDetails data={data} />;\n}\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Mutation with retry handler:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"function UpdateForm() {\n  const [updateRouter, { error: apolloError }] = useMutation(UPDATE_ROUTER);\n  const { error, createRetryHandler } = useGraphQLError(apolloError, {\n    showToast: true,\n    operationName: 'UpdateRouter',\n  });\n\n  const handleSubmit = createRetryHandler(async () => {\n    await updateRouter({ variables: { id, data } });\n  });\n\n  return <form onSubmit={handleSubmit}>{error && <ErrorCard title={error.message} />}</form>;\n}\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Skipping form validation errors:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const { error } = useGraphQLError(apolloError, {\n  skipValidationErrors: true,\n  // V4xx errors suppressed; React Hook Form handles field display\n});\n"})}),"\n",(0,s.jsx)(r.h4,{id:"utility-exports",children:"Utility Exports"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function isApolloError(error: unknown): error is ApolloError\nexport function getApolloErrorCode(error: ApolloError): string | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"getApolloErrorCode"})," extracts ",(0,s.jsx)(r.code,{children:"graphQLErrors[0]?.extensions?.code"})," \u2014 the primary code when multiple errors are returned."]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h3,{id:"usequerywithloading",children:(0,s.jsx)(r.code,{children:"useQueryWithLoading"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useQueryWithLoading.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function useQueryWithLoading<TData, TVariables>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: QueryHookOptions<TData, TVariables>\n): UseQueryWithLoadingResult<TData, TVariables>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Wraps ",(0,s.jsx)(r.code,{children:"useQuery"})," with ",(0,s.jsx)(r.code,{children:"notifyOnNetworkStatusChange: true"})," and derives four additional loading states from ",(0,s.jsx)(r.code,{children:"NetworkStatus"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface QueryWithLoadingState<TData> {\n  isInitialLoading: boolean;  // loading && !data   \u2014 show skeleton\n  isRevalidating: boolean;    // loading && !!data  \u2014 show refresh indicator\n  isStale: boolean;           // networkStatus === NetworkStatus.refetch\n  isLoading: boolean;         // raw loading flag\n  lastUpdated: Date | null;   // approximate; null while loading\n}\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Why this matters:"})," The standard ",(0,s.jsx)(r.code,{children:"loading"}),' boolean cannot distinguish between "first fetch" and "background refresh". Showing a full skeleton during a background refresh destroys the user\'s context. ',(0,s.jsx)(r.code,{children:"isInitialLoading"})," drives skeleton rendering; ",(0,s.jsx)(r.code,{children:"isRevalidating"})," drives a subtle indicator."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const { data, isInitialLoading, isRevalidating } = useQueryWithLoading(GET_RESOURCES);\n\nif (isInitialLoading) return <ResourceListSkeleton />;\nreturn (\n  <div>\n    {isRevalidating && <RefreshIndicator />}\n    <ResourceTable data={data.resources} />\n  </div>\n);\n"})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h3,{id:"usemutationwithloading",children:(0,s.jsx)(r.code,{children:"useMutationWithLoading"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useMutationWithLoading.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function useMutationWithLoading<TData, TVariables>(\n  mutation: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: MutationHookOptions<TData, TVariables>\n): UseMutationWithLoadingResult<TData, TVariables>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Wraps ",(0,s.jsx)(r.code,{children:"useMutation"})," with explicit ",(0,s.jsx)(r.code,{children:"isSuccess"})," and ",(0,s.jsx)(r.code,{children:"isError"})," boolean state (the standard hook only exposes ",(0,s.jsx)(r.code,{children:"error"})," being non-null for failure):"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface MutationWithLoadingState {\n  isLoading: boolean;         // Apollo loading flag\n  isSuccess: boolean;         // Set on onCompleted\n  isError: boolean;           // Set on onError\n  error: ApolloError | null;\n  reset: () => void;          // Clear isSuccess / isError\n}\n\nexport interface UseMutationWithLoadingResult<TData, TVariables>\n  extends MutationWithLoadingState {\n  mutate: (variables?: TVariables) => Promise<FetchResult<TData>>;\n  mutationTuple: MutationTuple<TData, TVariables>;  // Raw tuple for advanced usage\n  data: TData | null | undefined;\n}\n"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"mutate"})," shorthand clears ",(0,s.jsx)(r.code,{children:"isSuccess"}),"/",(0,s.jsx)(r.code,{children:"isError"})," before each execution so stale state never persists."]}),"\n",(0,s.jsx)(r.h4,{id:"createoptimisticoptions",children:(0,s.jsx)(r.code,{children:"createOptimisticOptions"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function createOptimisticOptions<TData, TVariables>(config: {\n  optimisticResponse: OptimisticResponse<TData>;\n  cacheUpdate?: (cache, data: TData) => void;\n}): Partial<MutationHookOptions<TData, TVariables>>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Helper for building optimistic mutation options from a typed response and optional cache updater, avoiding the ",(0,s.jsx)(r.code,{children:"as any"})," casts that raw optimistic usage requires."]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"error-message-utility-api",children:"Error Message Utility API"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/utils/error-messages.ts:33\u2013200+"})]}),"\n",(0,s.jsx)(r.p,{children:"These utility functions map error codes to structured error information, driving user-facing messages and recovery suggestions."}),"\n",(0,s.jsx)(r.h3,{id:"geterrormessagecode-fallbackmessage-1",children:(0,s.jsx)(r.code,{children:"getErrorMessage(code?, fallbackMessage?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorMessage(\n  code: string | undefined,\n  fallbackMessage?: string\n): string\n"})}),"\n",(0,s.jsx)(r.p,{children:"Returns the user-friendly message string for a code. Resolution order: exact code match \u2192 category prefix fallback \u2192 provided fallback \u2192 generic default."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"getErrorMessage('N300')              // \"Cannot reach the router\"\ngetErrorMessage('N399')              // \"Network error occurred\" (N3xx category fallback)\ngetErrorMessage('UNKNOWN', 'Oops')   // \"Oops\" (explicit fallback)\ngetErrorMessage(undefined)           // \"An error occurred. Please try again.\" (default)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"geterrorinfocode-fallbackmessage-1",children:(0,s.jsx)(r.code,{children:"getErrorInfo(code?, fallbackMessage?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorInfo(\n  code: string | undefined,\n  fallbackMessage?: string\n): ErrorInfo\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns the full ",(0,s.jsx)(r.code,{children:"ErrorInfo"})," object with all metadata:"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"interface ErrorInfo {\n  message: string;           // User-facing message\n  severity: ErrorSeverity;   // 'info' | 'warning' | 'error' | 'critical'\n  recoverable: boolean;      // Whether user action can fix it\n  action?: string;           // Suggested recovery step\n  i18nKey?: string;          // Translation key for i18n integration\n}\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Example:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:'const info = getErrorInfo(\'A502\');\n// {\n//   message: "Your session has expired",\n//   severity: "warning",\n//   recoverable: true,\n//   action: "Please log in again",\n//   i18nKey: "errors.auth.expired"\n// }\n'})}),"\n",(0,s.jsx)(r.h3,{id:"geterrorcategorycode-1",children:(0,s.jsx)(r.code,{children:"getErrorCategory(code)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorCategory(\n  code: string\n): ErrorCategory | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Extracts the two-character category prefix. Returns ",(0,s.jsx)(r.code,{children:"undefined"})," if not recognized."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"getErrorCategory('N300')    // 'N3'\ngetErrorCategory('A501')    // 'A5'\ngetErrorCategory('UNKNOWN') // undefined\n"})}),"\n",(0,s.jsx)(r.h3,{id:"geterrorseveritycode-1",children:(0,s.jsx)(r.code,{children:"getErrorSeverity(code?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorSeverity(\n  code: string | undefined\n): ErrorSeverity\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Shorthand to extract just the severity level. Returns ",(0,s.jsx)(r.code,{children:"'error'"})," for unknown codes (safe default)."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"getErrorSeverity('P100')  // 'warning'\ngetErrorSeverity('A500')  // 'error'\ngetErrorSeverity(undefined) // 'error'\n"})}),"\n",(0,s.jsx)(r.h3,{id:"geterroractioncode-1",children:(0,s.jsx)(r.code,{children:"getErrorAction(code?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorAction(\n  code: string | undefined\n): string | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Returns the suggested action string or ",(0,s.jsx)(r.code,{children:"undefined"})," if none is defined for this code."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"getErrorAction('N300')   // \"Check your network connection\"\ngetErrorAction('P103')   // \"Install missing package\"\ngetErrorAction('S600')   // undefined (no action for \"not found\")\n"})}),"\n",(0,s.jsx)(r.h3,{id:"category-predicates-1",children:"Category Predicates"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function isAuthError(code: string | undefined): boolean\n// true if code.startsWith('A5')\n\nexport function isNetworkError(code: string | undefined): boolean\n// true if code.startsWith('N3') || code.startsWith('R2')\n\nexport function isValidationError(code: string | undefined): boolean\n// true if code.startsWith('V4')\n"})}),"\n",(0,s.jsx)(r.p,{children:"Used by the error link to route errors without repeated string comparisons:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"if (isAuthError(errorCode)) {\n  handleAuthError(message);\n} else if (isNetworkError(errorCode)) {\n  handleNetworkError(networkError);\n}\n"})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"structured-error-logging-1",children:"Structured Error Logging"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/utils/error-logging.ts:1\u2013288"})]}),"\n",(0,s.jsx)(r.p,{children:"The logging system provides structured, deduplicated, buffered error logging suitable for both development debugging and future observability integration. It separates error logging from error display, enabling independent evolution of diagnostics."}),"\n",(0,s.jsx)(r.h3,{id:"configuration-constants-1",children:"Configuration Constants"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const MAX_BUFFER_SIZE = 10;           // Flush at 10 entries\nconst FLUSH_INTERVAL_MS = 60000;      // Flush every 60 seconds (1 minute)\nconst THROTTLE_WINDOW_MS = 5000;      // Deduplicate within 5 seconds\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"errorlogentry-type-1",children:[(0,s.jsx)(r.code,{children:"ErrorLogEntry"})," Type"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface ErrorLogEntry {\n  code?: string;                    // Error code (e.g., 'N300')\n  message: string;\n  operation?: string;               // GraphQL operation name (if applicable)\n  context?: Record<string, unknown>; // Extra diagnostic data\n  timestamp: number;                // Auto-generated: ms since epoch\n  stack?: string;                   // Error stack trace (if available)\n  url?: string;                     // Auto-captured: window.location.href\n  component?: string;               // Source component (for boundary errors)\n}\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"ErrorLogInput"})," is ",(0,s.jsx)(r.code,{children:"Omit<ErrorLogEntry, 'timestamp' | 'url'>"})," \u2014 callers do not provide auto-generated fields."]}),"\n",(0,s.jsx)(r.h3,{id:"logerrorentry-1",children:(0,s.jsx)(r.code,{children:"logError(entry)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logError(entry: ErrorLogInput): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Core logging function. Deduplication is based on ",(0,s.jsx)(r.code,{children:"code + message + operation"}),". If the same error fires within 5 seconds it is silently dropped."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Behavior by environment:"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Environment"}),(0,s.jsx)(r.th,{children:"Behavior"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Development"})}),(0,s.jsx)(r.td,{children:"Logs to console immediately with colored grouping"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Production"})}),(0,s.jsxs)(r.td,{children:["Buffers entries; flushes when buffer reaches ",(0,s.jsx)(r.code,{children:"MAX_BUFFER_SIZE"})," or ",(0,s.jsx)(r.code,{children:"FLUSH_INTERVAL_MS"})," elapses"]})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Example:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"logError({\n  code: 'N300',\n  message: 'Connection failed',\n  operation: 'GetRouter',\n  context: { routerId: 'abc123', attempt: 2 },\n});\n"})}),"\n",(0,s.jsx)(r.h3,{id:"loggraphqlerroroperation-error-context-1",children:(0,s.jsx)(r.code,{children:"logGraphQLError(operation, error, context?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logGraphQLError(\n  operation: string,\n  error: { message: string; extensions?: { code?: string } },\n  context?: Record<string, unknown>\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Convenience wrapper for Apollo errors. Extracts ",(0,s.jsx)(r.code,{children:"extensions.code"})," and calls ",(0,s.jsx)(r.code,{children:"logError"}),"."]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Called by:"})," ",(0,s.jsx)(r.code,{children:"core/src/apollo/apollo-error-link.ts"})," on every GraphQL error."]}),"\n",(0,s.jsx)(r.h3,{id:"lognetworkerroroperation-error-context-1",children:(0,s.jsx)(r.code,{children:"logNetworkError(operation, error, context?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logNetworkError(\n  operation: string,\n  error: Error,\n  context?: Record<string, unknown>\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Logs network errors with default code ",(0,s.jsx)(r.code,{children:"N302"})," (network timeout), since most Apollo network errors don't carry structured codes."]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Called by:"})," ",(0,s.jsx)(r.code,{children:"core/src/apollo/apollo-error-link.ts"})," on network failures."]}),"\n",(0,s.jsx)(r.h3,{id:"logcomponenterrorcomponent-error-errorinfo-1",children:(0,s.jsx)(r.code,{children:"logComponentError(component, error, errorInfo?)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function logComponentError(\n  component: string,\n  error: Error,\n  errorInfo?: { componentStack?: string }\n): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Intended for React error boundaries. Sets ",(0,s.jsx)(r.code,{children:"component"})," on the log entry and includes the component stack in context."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage in error boundary:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"class ErrorBoundary extends React.Component {\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    logComponentError('RouterCard', error, {\n      componentStack: errorInfo.componentStack,\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"flusherrorbuffer-1",children:(0,s.jsx)(r.code,{children:"flushErrorBuffer()"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function flushErrorBuffer(): void\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Force-flushes the production buffer immediately. Should be called on ",(0,s.jsx)(r.code,{children:"window.beforeunload"})," to avoid losing buffered errors on page close."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"window.addEventListener('beforeunload', flushErrorBuffer);\n"})}),"\n",(0,s.jsx)(r.h3,{id:"geterrorbuffersize-1",children:(0,s.jsx)(r.code,{children:"getErrorBufferSize()"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function getErrorBufferSize(): number\n"})}),"\n",(0,s.jsx)(r.p,{children:"Returns the current number of entries waiting to be flushed. Useful for monitoring dashboards or diagnostic panels."}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"enhanced-react-hooks-api",children:"Enhanced React Hooks API"}),"\n",(0,s.jsx)(r.h3,{id:"usequerywithloadingtdata-tvariablesquery-options",children:(0,s.jsx)(r.code,{children:"useQueryWithLoading<TData, TVariables>(query, options?)"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useQueryWithLoading.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface QueryWithLoadingState<TData> {\n  isInitialLoading: boolean;  // loading && !data \u2014 show skeleton\n  isRevalidating: boolean;    // loading && !!data \u2014 show refresh indicator\n  isStale: boolean;           // explicit refetch in progress\n  isLoading: boolean;         // any loading state\n  lastUpdated: Date | null;   // approximate; null while loading\n}\n\nexport function useQueryWithLoading<TData, TVariables>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: QueryHookOptions<TData, TVariables>\n): UseQueryWithLoadingResult<TData, TVariables>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Extends ",(0,s.jsx)(r.code,{children:"useQuery"})," with differentiated loading states. The standard ",(0,s.jsx)(r.code,{children:"loading"}),' boolean cannot distinguish between "first fetch" and "background refresh" \u2014 this hook provides that distinction.']}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"function ResourceList() {\n  const { data, isInitialLoading, isRevalidating } = useQueryWithLoading(GET_RESOURCES);\n\n  if (isInitialLoading) {\n    return <ResourceListSkeleton />;  // Show skeleton on first load\n  }\n\n  return (\n    <div>\n      {isRevalidating && <RefreshSpinner />}  // Show subtle indicator during background refresh\n      <ResourceTable data={data.resources} />\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"usemutationwithloadingtdata-tvariablesmutation-options",children:(0,s.jsx)(r.code,{children:"useMutationWithLoading<TData, TVariables>(mutation, options?)"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useMutationWithLoading.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface MutationWithLoadingState {\n  isLoading: boolean;         // Apollo loading flag\n  isSuccess: boolean;         // Set on onCompleted\n  isError: boolean;           // Set on onError\n  error: ApolloError | null;\n  reset: () => void;          // Clear isSuccess / isError\n}\n\nexport function useMutationWithLoading<TData, TVariables>(\n  mutation: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: MutationHookOptions<TData, TVariables>\n): UseMutationWithLoadingResult<TData, TVariables>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Wraps ",(0,s.jsx)(r.code,{children:"useMutation"})," with explicit ",(0,s.jsx)(r.code,{children:"isSuccess"})," and ",(0,s.jsx)(r.code,{children:"isError"})," states. The shorthand ",(0,s.jsx)(r.code,{children:"mutate"})," function auto-clears these states before each execution."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"function SaveButton() {\n  const { mutate, isLoading, isSuccess, error } = useMutationWithLoading(SAVE_CONFIG);\n\n  return (\n    <>\n      <Button onClick={() => mutate({ config })} disabled={isLoading}>\n        {isLoading ? 'Saving...' : 'Save'}\n      </Button>\n      {isSuccess && <SuccessCheckmark />}\n      {error && <ErrorAlert message={error.message} />}\n    </>\n  );\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"createoptimisticoptionstdata-tvariablesconfig",children:(0,s.jsx)(r.code,{children:"createOptimisticOptions<TData, TVariables>(config)"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function createOptimisticOptions<TData, TVariables>(\n  config: {\n    optimisticResponse: OptimisticResponse<TData>;\n    cacheUpdate?: (cache, data: TData) => void;\n  }\n): Partial<MutationHookOptions<TData, TVariables>>\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Helper for building optimistic mutation options from a typed response and optional cache updater. Avoids ",(0,s.jsx)(r.code,{children:"as any"})," casts."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const { mutate } = useMutation(ENABLE_INTERFACE, {\n  ...createOptimisticOptions({\n    optimisticResponse: {\n      enableInterface: { id: interfaceId, disabled: false },\n    },\n    cacheUpdate: (cache, data) => {\n      cache.modify({\n        fields: {\n          interface(existing) {\n            return { ...existing, ...data.enableInterface };\n          },\n        },\n      });\n    },\n  }),\n});\n"})}),"\n",(0,s.jsx)(r.h3,{id:"usegraphqlerrorapolloerror-options",children:(0,s.jsx)(r.code,{children:"useGraphQLError(apolloError?, options?)"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Source:"})," ",(0,s.jsx)(r.code,{children:"core/src/hooks/useGraphQLError.ts"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export interface UseGraphQLErrorOptions {\n  showToast?: boolean;            // Auto-show notification (default: false)\n  logErrors?: boolean;            // Log via error-logging.ts (default: true)\n  operationName?: string;         // For structured log entries\n  skipValidationErrors?: boolean; // Suppress V4xx (default: false)\n}\n\nexport interface ProcessedError {\n  message: string;            // User-facing from getErrorInfo()\n  severity: ErrorSeverity;\n  code?: string;\n  technicalMessage?: string;  // Raw apolloError.message for debug\n  recoverable: boolean;\n  action?: string;\n  isAuthError: boolean;\n  isNetworkError: boolean;\n  isValidationError: boolean;\n  originalError?: ApolloError | Error;\n}\n\nexport interface UseGraphQLErrorReturn {\n  error: ProcessedError | null;\n  hasError: boolean;\n  clearError: () => void;\n  showErrorToast: () => void;\n  createRetryHandler: <T>(fn: () => Promise<T>) => () => Promise<T | undefined>;\n}\n\nexport function useGraphQLError(\n  apolloError: ApolloError | Error | undefined,\n  options?: UseGraphQLErrorOptions\n): UseGraphQLErrorReturn\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Transforms Apollo errors into ",(0,s.jsx)(r.code,{children:"ProcessedError"})," objects with severity, recoverability, and action classification."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage with automatic toast:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"function UpdateForm() {\n  const [updateRouter] = useMutation(UPDATE_ROUTER);\n  const { error } = useGraphQLError(apolloError, { showToast: true });\n\n  return error && <ErrorCard title={error.message} />;\n}\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Usage with retry handler:"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const { error, createRetryHandler } = useGraphQLError(apolloError);\n\nconst handleSubmit = createRetryHandler(async () => {\n  await updateRouter({ variables: { id, data } });\n});\n"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Skipping validation errors (form handling):"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const { error } = useGraphQLError(apolloError, {\n  skipValidationErrors: true,\n  // V4xx errors suppressed; React Hook Form displays field errors\n});\n"})}),"\n",(0,s.jsx)(r.h4,{id:"utility-exports-1",children:"Utility Exports"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"export function isApolloError(error: unknown): error is ApolloError\nexport function getApolloErrorCode(error: ApolloError): string | undefined\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"getApolloErrorCode"})," extracts ",(0,s.jsx)(r.code,{children:"graphQLErrors[0]?.extensions?.code"})," \u2014 the primary error code when multiple errors are returned."]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./intro.md"})," \u2014 Library overview"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./apollo-client.md"})," \u2014 Link chain assembly (error link position)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./axios-http-client.md"})," \u2014 Axios interceptor registration order"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./authentication.md"})," \u2014 Session expiry handling (auth errors)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./offline-first.md"})," \u2014 How network errors feed the offline detector"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"./domain-query-hooks.md"})," \u2014 Domain hooks using ",(0,s.jsx)(r.code,{children:"useQueryWithLoading"})," and ",(0,s.jsx)(r.code,{children:"useMutationWithLoading"})]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},71184:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>d});var o=n(14041);const s={},t=o.createContext(s);function i(e){const r=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);
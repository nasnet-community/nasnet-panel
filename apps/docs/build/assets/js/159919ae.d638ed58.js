"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[52639],{17545:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"flows/alert-lifecycle-flow","title":"Flow: Alert Lifecycle","description":"Traces the complete path of an alert from an event triggering the engine, through throttle and","source":"@site/../backend/docs/flows/alert-lifecycle-flow.md","sourceDirName":"flows","slug":"/flows/alert-lifecycle-flow","permalink":"/docs/backend/flows/alert-lifecycle-flow","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../backend/docs/flows/alert-lifecycle-flow.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Feature Marketplace","permalink":"/docs/backend/feature-marketplace"},"next":{"title":"Flow: Config Provisioning","permalink":"/docs/backend/flows/config-provisioning-flow"}}');var r=t(31085),s=t(71184);const l={},c="Flow: Alert Lifecycle",d={},a=[{value:"Overview",id:"overview",level:2},{value:"Sequence Diagram",id:"sequence-diagram",level:2},{value:"Step-by-Step Walkthrough",id:"step-by-step-walkthrough",level:2},{value:"Step 1: Engine Start and Subscription",id:"step-1-engine-start-and-subscription",level:3},{value:"Step 2: Event Reception and Storm Detection",id:"step-2-event-reception-and-storm-detection",level:3},{value:"Step 3: Rule Evaluation",id:"step-3-rule-evaluation",level:3},{value:"Step 4: Throttle Check",id:"step-4-throttle-check",level:3},{value:"Step 5: Quiet Hours Check",id:"step-5-quiet-hours-check",level:3},{value:"Step 6: Alert Creation",id:"step-6-alert-creation",level:3},{value:"Step 7: Escalation Tracking",id:"step-7-escalation-tracking",level:3},{value:"Step 8: Alert Event Publication",id:"step-8-alert-event-publication",level:3},{value:"Step 9: Notification Dispatch",id:"step-9-notification-dispatch",level:3},{value:"Step 10: Digest Delivery (Quiet Hours End)",id:"step-10-digest-delivery-quiet-hours-end",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Observability",id:"observability",level:2},{value:"Cross-References",id:"cross-references",level:2}];function o(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"flow-alert-lifecycle",children:"Flow: Alert Lifecycle"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Traces the complete path of an alert from an event triggering the engine, through throttle and\nquiet-hours filtering, to multi-channel notification delivery."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Touches:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/"}),", ",(0,r.jsx)(n.code,{children:"internal/alerts/throttle/"}),", ",(0,r.jsx)(n.code,{children:"internal/notifications/"})," ",(0,r.jsx)(n.strong,{children:"Entry\nPoint:"})," ",(0,r.jsx)(n.code,{children:"Engine.HandleEvent(ctx, event)"})," in ",(0,r.jsx)(n.code,{children:"internal/alerts/engine.go"})," ",(0,r.jsx)(n.strong,{children:"Prerequisites:"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[See: 05-event-system.md] \u2014 how events flow through the Watermill bus"}),"\n",(0,r.jsx)(n.li,{children:"[See: 09-alert-system.md] \u2014 alert rules, channels, and engine configuration"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The alert engine subscribes to all events on the event bus. When an event arrives, the engine checks\nit against a cached rule set. Rules that match undergo a 3-stage filter pipeline: storm detection \u2192\nthrottle check \u2192 quiet hours check. Alerts that pass all filters are persisted to the database and\ntrigger a notification dispatch. Alerts suppressed by quiet hours are queued and delivered as a\ndigest batch when quiet hours end."}),"\n",(0,r.jsx)(n.h2,{id:"sequence-diagram",children:"Sequence Diagram"}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant EventBus\n    participant Engine\n    participant StormDetector\n    participant ThrottleManager\n    participant QuietHoursFilter\n    participant Database as db.Alert\n    participant EscalationEngine\n    participant EventBus2 as EventBus<br/>(publish)\n    participant Dispatcher\n    participant Channels\n\n    EventBus->>Engine: event (any type)\n    Engine->>StormDetector: RecordAlert()\n    StormDetector->>ThrottleManager: suppressed?<br/>(rate > limit)\n    ThrottleManager--\x3e>StormDetector: allowed\n    StormDetector--\x3e>Engine: [allowed]\n\n    Engine->>Engine: getMatchingRules(eventType)<br/>[from cache, O(1)]\n\n    Note over Engine: for each rule:\n    Engine->>Engine: EvaluateConditions(rule, eventData)<br/>[CEL/JSON conditions]\n\n    Engine->>ThrottleManager: ShouldAllow(ruleID, data, config)\n    ThrottleManager->>ThrottleManager: token bucket\n    ThrottleManager--\x3e>Engine: allowed/reason\n\n    Engine->>QuietHoursFilter: ShouldSuppress(config, severity, now)\n    QuietHoursFilter->>QuietHoursFilter: time check\n    QuietHoursFilter--\x3e>Engine: suppress?\n\n    alt suppress\n        Engine->>Engine: queueForDigest()\n    else allowed\n        Engine->>Engine: createAlert()\n    end\n\n    Engine->>Database: db.Alert.Create()\n    Engine->>EscalationEngine: escalationEngine.TrackAlert()\n    Engine->>EventBus2: eventBus.Publish(AlertCreatedEvent)\n\n    Note over EventBus2: Dispatcher<br/>(subscribes to<br/>AlertCreatedEvent)\n\n    EventBus2--\x3e>Dispatcher: AlertCreatedEvent\n    Dispatcher->>Channels: route to channel(s)<br/>email/push/webhook/telegram/ntfy"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Digest delivery (quiet hours end):"})}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant DigestTicker as DigestTicker<br/>(1min)\n    participant Engine\n    participant AlertQueue\n    participant Dispatcher\n\n    DigestTicker->>Engine: tick\n    Engine->>AlertQueue: deliverQueued()\n    AlertQueue->>Dispatcher: DequeueAll()<br/>{deviceID->alerts}\n\n    Engine->>Engine: checkQuietHours()<br/>[still active?]\n    Engine->>Engine: [no] -> FormatDigest()\n    Engine->>Engine: createDigestAlert()\n    Engine->>Dispatcher: eventBus.Publish(digest event)"}),"\n",(0,r.jsx)(n.h2,{id:"step-by-step-walkthrough",children:"Step-by-Step Walkthrough"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-engine-start-and-subscription",children:"Step 1: Engine Start and Subscription"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Engine.Start(ctx)"})," initializes the engine"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine.go:107"})]}),"\n",(0,r.jsxs)(n.li,{children:["Loads all enabled ",(0,r.jsx)(n.code,{children:"AlertRule"})," records from database into ",(0,r.jsx)(n.code,{children:"rulesCache"})," (map[ruleID \u2192 rule])"]}),"\n",(0,r.jsxs)(n.li,{children:["Subscribes ",(0,r.jsx)(n.code,{children:"HandleEvent"})," to ALL events via ",(0,r.jsx)(n.code,{children:"eventBus.SubscribeAll(e.HandleEvent)"})]}),"\n",(0,r.jsxs)(n.li,{children:["Subscribes ",(0,r.jsx)(n.code,{children:"handleRuleChange"})," to ",(0,r.jsx)(n.code,{children:"alert.rule.{created,updated,deleted}"})," for cache invalidation"]}),"\n",(0,r.jsxs)(n.li,{children:["Starts ",(0,r.jsx)(n.code,{children:"throttleManager.StartSummaryWorker()"})," (5-minute interval)"]}),"\n",(0,r.jsxs)(n.li,{children:["Starts ",(0,r.jsx)(n.code,{children:"escalationEngine.Start()"})," if configured"]}),"\n",(0,r.jsxs)(n.li,{children:["Starts ",(0,r.jsx)(n.code,{children:"runDigestDelivery()"})," goroutine with 1-minute ticker"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-2-event-reception-and-storm-detection",children:"Step 2: Event Reception and Storm Detection"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HandleEvent(ctx, event)"})," is called for every event on the bus"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine.go:144"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Storm check first:"})," ",(0,r.jsx)(n.code,{children:"stormDetector.RecordAlert()"})," \u2014 if alert rate exceeds threshold (e.g.\n100/min):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Returns ",(0,r.jsx)(n.code,{children:"false"})," \u2192 all matching rules are tracked as suppressed"]}),"\n",(0,r.jsxs)(n.li,{children:["Suppression reason logged: ",(0,r.jsx)(n.code,{children:'"storm: X/min (threshold: Y/min)"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["If storm not detected: extracts ",(0,r.jsx)(n.code,{children:"eventType"})," and finds matching rules from cache (",(0,r.jsx)(n.code,{children:"O(n)"})," where n =\nrule count)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-3-rule-evaluation",children:"Step 3: Rule Evaluation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"evaluateRule(ctx, rule, eventType, eventData, startTime)"})," is called per matching rule"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:24"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ParseConditions(rule.Conditions)"})," deserializes the rule's JSON condition tree"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EvaluateConditions(conditions, eventData)"})," walks the condition tree against event payload fields"]}),"\n",(0,r.jsx)(n.li,{children:"If conditions fail \u2192 rule is skipped (not a match for this event)"}),"\n",(0,r.jsx)(n.li,{children:"If conditions pass \u2192 move to throttle check"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-4-throttle-check",children:"Step 4: Throttle Check"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"throttleManager.ShouldAllow(ruleID, eventData, throttleConfig)"})," is called"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:61"})]}),"\n",(0,r.jsx)(n.li,{children:"Token bucket algorithm: each rule has a configurable rate limit (e.g. max 1 alert/5min)"}),"\n",(0,r.jsxs)(n.li,{children:["Returns ",(0,r.jsx)(n.code,{children:"(allowed bool, reason string)"})]}),"\n",(0,r.jsxs)(n.li,{children:["If throttled \u2192 ",(0,r.jsx)(n.code,{children:'trackSuppression(ruleID, "throttled: " + reason)'})," and skip"]}),"\n",(0,r.jsx)(n.li,{children:"Suppression counts accumulate and are attached to the next allowed alert"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-5-quiet-hours-check",children:"Step 5: Quiet Hours Check"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"quietHours.ShouldSuppress(config, severity, time.Now())"})," is called"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:89"})]}),"\n",(0,r.jsx)(n.li,{children:"Checks the current time against the rule's quiet hours window (timezone-aware)"}),"\n",(0,r.jsx)(n.li,{children:"CRITICAL severity alerts can override quiet hours (configurable per rule)"}),"\n",(0,r.jsxs)(n.li,{children:["If suppressed:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'digestService.QueueAlert(ctx, alert, channelID, "email", false)'})," queues for later delivery"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"AlertQueue"})," stores alerts grouped by ",(0,r.jsx)(n.code,{children:"deviceID"})," (thread-safe)"]}),"\n",(0,r.jsx)(n.li,{children:"Returns \u2014 no notification sent immediately"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-6-alert-creation",children:"Step 6: Alert Creation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"createAlert(ctx, rule, eventType, eventData, suppressedCount, suppressReason)"})," is called"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:152"})]}),"\n",(0,r.jsxs)(n.li,{children:["Creates ",(0,r.jsx)(n.code,{children:"Alert"})," entity in database: ",(0,r.jsx)(n.code,{children:"ruleID"}),", ",(0,r.jsx)(n.code,{children:"eventType"}),", ",(0,r.jsx)(n.code,{children:"severity"}),", ",(0,r.jsx)(n.code,{children:"title"}),", ",(0,r.jsx)(n.code,{children:"message"}),",\n",(0,r.jsx)(n.code,{children:"triggeredAt"})]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"suppressedCount > 0"}),": attaches suppression count and reason to the alert record"]}),"\n",(0,r.jsxs)(n.li,{children:["Extracts ",(0,r.jsx)(n.code,{children:"device_id"})," or ",(0,r.jsx)(n.code,{children:"router_id"})," from event data for alert attribution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance target:"})," entire evaluation pipeline must complete in ",(0,r.jsx)(n.code,{children:"<100ms"})," (logged as\n",(0,r.jsx)(n.code,{children:"elapsed_ms"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-7-escalation-tracking",children:"Step 7: Escalation Tracking"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"escalationEngine.TrackAlert(ctx, alert, rule)"})," is called if escalation is configured"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:196"})]}),"\n",(0,r.jsx)(n.li,{children:"Registers the alert for escalation if not acknowledged within the configured escalation window"}),"\n",(0,r.jsx)(n.li,{children:"Escalation sends follow-up notifications to different channels on timeout"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-8-alert-event-publication",children:"Step 8: Alert Event Publication"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"publishAlertEvent(ctx, alert, rule, ...)"})," emits ",(0,r.jsx)(n.code,{children:"AlertCreatedEvent"})," to event bus"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:210"})]}),"\n",(0,r.jsxs)(n.li,{children:["Event type: ",(0,r.jsx)(n.code,{children:'"alert.created"'}),", priority: per-severity mapping"]}),"\n",(0,r.jsxs)(n.li,{children:["Payload includes: ",(0,r.jsx)(n.code,{children:"alertID"}),", ",(0,r.jsx)(n.code,{children:"ruleID"}),", ",(0,r.jsx)(n.code,{children:"eventType"}),", ",(0,r.jsx)(n.code,{children:"severity"}),", ",(0,r.jsx)(n.code,{children:"title"}),", ",(0,r.jsx)(n.code,{children:"message"}),", ",(0,r.jsx)(n.code,{children:"deviceID"}),",\n",(0,r.jsx)(n.code,{children:"channels[]"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-9-notification-dispatch",children:"Step 9: Notification Dispatch"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Dispatcher"})," subscribes to ",(0,r.jsx)(n.code,{children:'"alert.created"'})," events"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/notifications/dispatcher.go"})," and ",(0,r.jsx)(n.code,{children:"dispatcher_routing.go"})]}),"\n",(0,r.jsxs)(n.li,{children:["Routes the alert to all channels configured in ",(0,r.jsx)(n.code,{children:"rule.Channels []string"})]}),"\n",(0,r.jsx)(n.li,{children:"Channel types: Email (SMTP), Webhook (HTTP POST), Push (ntfy, Pushover, Telegram), In-App"}),"\n",(0,r.jsx)(n.li,{children:"Each channel delivery is attempted independently; partial failures don't block other channels"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-10-digest-delivery-quiet-hours-end",children:"Step 10: Digest Delivery (Quiet Hours End)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"runDigestDelivery(ctx)"})," goroutine ticks every 1 minute"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"internal/alerts/engine_evaluate.go:241"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"deliverQueuedAlerts(ctx)"})," calls ",(0,r.jsx)(n.code,{children:"alertQueue.DequeueAll()"})," to get all queued alerts by device"]}),"\n",(0,r.jsxs)(n.li,{children:["For each device's alerts: ",(0,r.jsx)(n.code,{children:"checkQuietHoursForDigest()"})," \u2014 still in quiet hours? Re-enqueue if yes"]}),"\n",(0,r.jsxs)(n.li,{children:["If quiet hours have ended: ",(0,r.jsx)(n.code,{children:"FormatDigest(alerts, deviceID)"})," generates grouped summary by severity"]}),"\n",(0,r.jsxs)(n.li,{children:["Creates a single digest ",(0,r.jsx)(n.code,{children:"Alert"})," record with ",(0,r.jsx)(n.code,{children:'eventType: "quiet_hours.digest"'})]}),"\n",(0,r.jsx)(n.li,{children:"Publishes notification event so dispatcher delivers the digest"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Stage"}),(0,r.jsx)(n.th,{children:"Failure"}),(0,r.jsx)(n.th,{children:"Recovery"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rules cache miss"}),(0,r.jsx)(n.td,{children:"DB query error on startup"}),(0,r.jsx)(n.td,{children:"Engine start returns error; must be resolved before proceeding"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rule cache refresh"}),(0,r.jsx)(n.td,{children:"DB error on rule change event"}),(0,r.jsx)(n.td,{children:"Warning logged; stale cache used until next rule change event"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Storm suppression"}),(0,r.jsx)(n.td,{children:"All alerts suppressed"}),(0,r.jsx)(n.td,{children:"Storm status logged; auto-recovers when rate drops below threshold"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Alert DB save"}),(0,r.jsx)(n.td,{children:"Database error"}),(0,r.jsx)(n.td,{children:"Error logged; alert event NOT published; notification NOT sent"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Channel delivery"}),(0,r.jsx)(n.td,{children:"SMTP timeout / webhook 5xx"}),(0,r.jsx)(n.td,{children:"Channel-specific retry; other channels still delivered"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Digest delivery"}),(0,r.jsx)(n.td,{children:"Queue empty or still in quiet hours"}),(0,r.jsx)(n.td,{children:"Re-enqueue; retry on next 1-minute tick"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"observability",children:"Observability"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Events emitted (event bus):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert.created"})," \u2014 for every alert that passes all filters"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"quiet_hours.digest"})," \u2014 for batched digest alerts"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert.throttled"})," \u2014 when ThrottleManager emits summary events (every 5 min)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logs generated:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WARN: alert suppressed due to storm detection"})," with rate/threshold info"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DEBUG: evaluating event against rules"})," with event_type and rule_count"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DEBUG: alert throttled"})," with rule_id and throttle reason"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DEBUG: alert suppressed by quiet hours"})," with rule_id and reason"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"INFO: alert triggered"})," with rule_name, severity, elapsed_ms"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Alert evaluation target: ",(0,r.jsx)(n.code,{children:"<100ms"})," per event end-to-end (logged as ",(0,r.jsx)(n.code,{children:"elapsed_ms"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Rules cache is read-locked (",(0,r.jsx)(n.code,{children:"sync.RWMutex"}),") for concurrent event handling"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[See: 09-alert-system.md \xa7Engine] \u2014 alert rule schema and condition format"}),"\n",(0,r.jsx)(n.li,{children:"[See: 09-alert-system.md \xa7Throttle] \u2014 ThrottleManager token bucket details"}),"\n",(0,r.jsx)(n.li,{children:"[See: 09-alert-system.md \xa7Channels] \u2014 notification channel configuration"}),"\n",(0,r.jsx)(n.li,{children:"[See: 05-event-system.md] \u2014 event bus subscription patterns"}),"\n",(0,r.jsx)(n.li,{children:"[See: 12-security.md \xa7Credentials] \u2014 channel credential storage"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},71184:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var i=t(14041);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);
"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[5772],{38160:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"sub-libraries/forms","title":"Forms & Validation Library Reference","description":"Comprehensive guide to @nasnet/core/forms \u2014 the schema-driven forms library with 7-stage validation pipeline","source":"@site/../../libs/core/docs/sub-libraries/forms.md","sourceDirName":"sub-libraries","slug":"/sub-libraries/forms","permalink":"/docs/core/sub-libraries/forms","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/core/docs/sub-libraries/forms.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Constants Reference","permalink":"/docs/core/sub-libraries/constants"},"next":{"title":"Internationalization (i18n) Library Reference","permalink":"/docs/core/sub-libraries/i18n"}}');var a=r(31085),i=r(71184);const t={},o="Forms & Validation Library Reference",l={},d=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"NasFormProvider Component",id:"nasformprovider-component",level:2},{value:"Usage Example",id:"usage-example",level:3},{value:"useNasFormContext Hook",id:"usenasformcontext-hook",level:3},{value:"useZodForm Hook",id:"usezodform-hook",level:2},{value:"Usage Example",id:"usage-example-1",level:3},{value:"7-Stage Validation Pipeline",id:"7-stage-validation-pipeline",level:2},{value:"Validation Stages",id:"validation-stages",level:3},{value:"Stage Results",id:"stage-results",level:3},{value:"Risk-Level Configuration",id:"risk-level-configuration",level:3},{value:"ValidationPipeline Class",id:"validationpipeline-class",level:3},{value:"useValidationPipeline Hook",id:"usevalidationpipeline-hook",level:3},{value:"Network Validators",id:"network-validators",level:2},{value:"Basic IP Validators",id:"basic-ip-validators",level:3},{value:"MAC Address",id:"mac-address",level:3},{value:"Network Notation",id:"network-notation",level:3},{value:"Port Validators",id:"port-validators",level:3},{value:"VLAN ID",id:"vlan-id",level:3},{value:"WireGuard &amp; Crypto",id:"wireguard--crypto",level:3},{value:"Domain Names",id:"domain-names",level:3},{value:"Interface &amp; Comments",id:"interface--comments",level:3},{value:"Time &amp; Bandwidth",id:"time--bandwidth",level:3},{value:"Extended Validators (NAS-4A.3)",id:"extended-validators-nas-4a3",level:3},{value:"Bulk Import",id:"bulk-import",level:3},{value:"Network Utilities",id:"network-utilities",level:2},{value:"IP Address Manipulation",id:"ip-address-manipulation",level:3},{value:"Subnet Mask Conversion",id:"subnet-mask-conversion",level:3},{value:"Subnet Overlap",id:"subnet-overlap",level:3},{value:"IP Classification",id:"ip-classification",level:3},{value:"Network Generation",id:"network-generation",level:3},{value:"Schema Utilities",id:"schema-utilities",level:2},{value:"Form Persistence",id:"form-persistence",level:2},{value:"Usage Example",id:"usage-example-2",level:3},{value:"Methods",id:"methods",level:3},{value:"Wizard Persistence",id:"wizard-persistence",level:2},{value:"Usage Example",id:"usage-example-3",level:3},{value:"Available Methods",id:"available-methods",level:3},{value:"Form-Resource Sync",id:"form-resource-sync",level:2},{value:"State Layers (Universal State v2)",id:"state-layers-universal-state-v2",level:3},{value:"Usage Example",id:"usage-example-4",level:3},{value:"Actions",id:"actions",level:3},{value:"Backend Error Mapping",id:"backend-error-mapping",level:2},{value:"Usage Example",id:"usage-example-5",level:3},{value:"Error Messages &amp; i18n",id:"error-messages--i18n",level:2},{value:"Default Error Messages",id:"default-error-messages",level:3},{value:"Custom Error Messages",id:"custom-error-messages",level:3},{value:"Validation Strategy Configuration",id:"validation-strategy-configuration",level:2},{value:"Stage Labels",id:"stage-labels",level:3},{value:"Choosing Risk Level",id:"choosing-risk-level",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. <strong>Use NasFormProvider for Standard Forms</strong>",id:"1-use-nasformprovider-for-standard-forms",level:3},{value:"2. <strong>Validate Based on Risk</strong>",id:"2-validate-based-on-risk",level:3},{value:"3. <strong>Use Form Persistence for Wizards</strong>",id:"3-use-form-persistence-for-wizards",level:3},{value:"4. <strong>Handle Backend Errors Properly</strong>",id:"4-handle-backend-errors-properly",level:3},{value:"5. <strong>Sync with Resource State</strong>",id:"5-sync-with-resource-state",level:3},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"forms--validation-library-reference",children:"Forms & Validation Library Reference"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Comprehensive guide to ",(0,a.jsx)(n.code,{children:"@nasnet/core/forms"})," \u2014 the schema-driven forms library with 7-stage validation pipeline"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#nasformprovider-component",children:"NasFormProvider Component"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#usezodform-hook",children:"useZodForm Hook"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#7-stage-validation-pipeline",children:"7-Stage Validation Pipeline"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#network-validators",children:"Network Validators"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#network-utilities",children:"Network Utilities"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#schema-utilities",children:"Schema Utilities"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#form-persistence",children:"Form Persistence"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#wizard-persistence",children:"Wizard Persistence"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#form-resource-sync",children:"Form-Resource Sync"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#backend-error-mapping",children:"Backend Error Mapping"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#error-messages--i18n",children:"Error Messages & i18n"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#validation-strategy-configuration",children:"Validation Strategy Configuration"})}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"@nasnet/core/forms"})," library provides a comprehensive forms system featuring:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Schema-driven forms"})," \u2014 Define forms with Zod schemas for type-safe validation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"7-stage validation pipeline"})," \u2014 Progressive validation from schema \u2192 syntax \u2192 cross-resource \u2192 dependencies \u2192 network \u2192 platform \u2192 dry-run"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Risk-based strategies"})," \u2014 Low (client-only) / Medium (backend validation) / High (full pipeline + preview + countdown)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Network validators"})," \u2014 25+ pre-built validators for IPv4, MAC, CIDR, ports, VLAN IDs, etc."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Form persistence"})," \u2014 Auto-save form state with session/local storage"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Wizard persistence"})," \u2014 Multi-step wizard support with step tracking and TTL"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Universal State v2 integration"})," \u2014 Sync forms with router state (optimistic updates, conflict detection)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Locale-aware error messages"})," \u2014 i18n-aware error message translation"]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"nasformprovider-component",children:"NasFormProvider Component"}),"\n",(0,a.jsx)(n.p,{children:"The main form provider that wraps React Hook Form with Zod validation and the validation pipeline:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface NasFormProviderProps<T extends ZodSchema> {\n  /** Zod schema for form validation */\n  schema: T;\n\n  /** Initial form values */\n  defaultValues?: Partial<z.infer<T>>;\n\n  /** Called when form is submitted */\n  onSubmit: (data: z.infer<T>) => void | Promise<void>;\n\n  /** Called when validation result changes */\n  onValidationChange?: (result: ValidationResult | null) => void;\n\n  /** Risk level: 'low' | 'medium' | 'high' */\n  validationStrategy?: ValidationStrategy;\n\n  /** Optional resource ID for backend validation context */\n  resourceUuid?: string;\n\n  /** Form children */\n  children: React.ReactNode;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { z } from 'zod';\nimport { NasFormProvider, useZodForm } from '@nasnet/core/forms';\nimport { networkValidators } from '@nasnet/core/forms';\n\nconst wireguardSchema = z.object({\n  name: z.string().min(1, 'Name is required'),\n  endpoint: networkValidators.ipWithPort,\n  publicKey: networkValidators.wgKey,\n  dns: networkValidators.ipv4.optional(),\n});\n\nfunction WireguardPeerForm() {\n  const handleSubmit = async (data) => {\n    await api.createWireguardPeer(data);\n  };\n\n  const handleValidationChange = (result) => {\n    console.log('Validation result:', result);\n  };\n\n  return (\n    <NasFormProvider\n      schema={wireguardSchema}\n      defaultValues={{\n        name: '',\n        endpoint: '',\n        publicKey: '',\n        dns: undefined,\n      }}\n      onSubmit={handleSubmit}\n      onValidationChange={handleValidationChange}\n      validationStrategy=\"medium\"\n    >\n      <FormFields />\n      <SubmitButton />\n    </NasFormProvider>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usenasformcontext-hook",children:"useNasFormContext Hook"}),"\n",(0,a.jsx)(n.p,{children:"Access form context within provider:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { useNasFormContext } from '@nasnet/core/forms';\n\nfunction FormDebugInfo() {\n  const { validationStrategy, isSubmitting, validationResult } = useNasFormContext();\n\n  return (\n    <div>\n      <p>Strategy: {validationStrategy}</p>\n      <p>Submitting: {isSubmitting}</p>\n      <p>Valid: {validationResult?.isValid}</p>\n    </div>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"usezodform-hook",children:"useZodForm Hook"}),"\n",(0,a.jsx)(n.p,{children:"A wrapper around React Hook Form that integrates Zod schema validation:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface UseZodFormOptions<T extends ZodSchema>\n  extends Omit<UseFormProps<z.infer<T>>, 'resolver'> {\n  /** Zod schema for validation */\n  readonly schema: T;\n}\n\nfunction useZodForm<T extends ZodSchema>(\n  options: UseZodFormOptions<T>\n): UseFormReturn<z.infer<T>>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example-1",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { z } from 'zod';\nimport { useZodForm } from '@nasnet/core/forms';\n\nconst loginSchema = z.object({\n  email: z.string().email('Invalid email'),\n  password: z.string().min(8, 'Password too short'),\n  rememberMe: z.boolean().default(false),\n});\n\nfunction LoginForm() {\n  const form = useZodForm({\n    schema: loginSchema,\n    defaultValues: {\n      email: '',\n      password: '',\n      rememberMe: false,\n    },\n    mode: 'onBlur',  // Validate on blur\n  });\n\n  const onSubmit = form.handleSubmit(async (data) => {\n    const result = await loginUser(data);\n    if (result.error) {\n      form.setError('root', {\n        type: 'submit',\n        message: result.error,\n      });\n    }\n  });\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input {...form.register('email')} placeholder=\"Email\" />\n      {form.formState.errors.email && (\n        <span>{form.formState.errors.email.message}</span>\n      )}\n\n      <input {...form.register('password')} type=\"password\" placeholder=\"Password\" />\n      {form.formState.errors.password && (\n        <span>{form.formState.errors.password.message}</span>\n      )}\n\n      <label>\n        <input {...form.register('rememberMe')} type=\"checkbox\" />\n        Remember me\n      </label>\n\n      <button type=\"submit\" disabled={form.formState.isSubmitting}>\n        Login\n      </button>\n\n      {form.formState.errors.root && (\n        <Alert type=\"error\">{form.formState.errors.root.message}</Alert>\n      )}\n    </form>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"7-stage-validation-pipeline",children:"7-Stage Validation Pipeline"}),"\n",(0,a.jsx)(n.p,{children:"Progressive validation system with 7 stages, configurable by risk level:"}),"\n",(0,a.jsx)(n.h3,{id:"validation-stages",children:"Validation Stages"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"type ValidationStage =\n  | 'schema'           // Stage 1: Zod schema validation (local)\n  | 'syntax'           // Stage 2: Format and syntax checks\n  | 'cross-resource'   // Stage 3: Conflict detection (IPs, ports, names)\n  | 'dependencies'     // Stage 4: Field dependency validation\n  | 'network'          // Stage 5: Network connectivity checks\n  | 'platform'         // Stage 6: Router compatibility checks\n  | 'dry-run';         // Stage 7: Backend dry-run execution\n"})}),"\n",(0,a.jsx)(n.h3,{id:"stage-results",children:"Stage Results"}),"\n",(0,a.jsx)(n.p,{children:"Each stage produces:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface ValidationStageResult {\n  stage: ValidationStage;\n  status: 'pending' | 'running' | 'passed' | 'failed' | 'skipped';\n  readonly errors: readonly ValidationError[];\n  readonly warnings: readonly ValidationWarning[];\n  durationMs?: number;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"risk-level-configuration",children:"Risk-Level Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Stages executed based on risk level:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Low-risk: Client-only (schema + syntax)\n// Example: WiFi password, display name, comment\nlow: {\n  stages: ['schema', 'syntax'],\n  clientOnly: true,\n  requiresConfirmation: false,\n}\n\n// Medium-risk: Schema + backend validation (no dry-run)\n// Example: Firewall rules, DHCP settings, VPN peer\nmedium: {\n  stages: ['schema', 'syntax', 'cross-resource', 'dependencies'],\n  clientOnly: false,\n  requiresConfirmation: false,\n}\n\n// High-risk: Full pipeline with dry-run + preview + countdown\n// Example: WAN link changes, routing tables, VPN deletion\nhigh: {\n  stages: ['schema', 'syntax', 'cross-resource', 'dependencies', 'network', 'platform', 'dry-run'],\n  clientOnly: false,\n  requiresConfirmation: true,\n  confirmationSteps: ['preview', 'countdown'],\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"validationpipeline-class",children:"ValidationPipeline Class"}),"\n",(0,a.jsx)(n.p,{children:"Low-level orchestration of the validation pipeline:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"class ValidationPipeline {\n  constructor(\n    options: ValidationPipelineOptions,\n    config: ValidationPipelineConfig\n  )\n\n  /**\n   * Run the validation pipeline\n   */\n  async validate(\n    resourceType: string,\n    data: Record<string, unknown>,\n    resourceId?: string,\n    routerId?: string\n  ): Promise<ValidationPipelineResult>\n\n  /**\n   * Abort the running pipeline\n   */\n  abort(): void\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Options:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface ValidationPipelineOptions {\n  /** Function to call backend validation API */\n  validateFn: (request: ValidationRequest) => Promise<ValidationResponse>;\n\n  /** Optional callbacks */\n  onStageStart?: (stage: ValidationStageName) => void;\n  onStageComplete?: (result: ValidationStageResult) => void;\n  onProgress?: (current: number, total: number) => void;\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface ValidationPipelineConfig {\n  /** Risk level: 'low' | 'medium' | 'high' */\n  riskLevel: RiskLevel;\n\n  /** Stop on first error */\n  stopOnError?: boolean;\n\n  /** Stages to skip */\n  skipStages?: ValidationStageName[];\n\n  /** Include dry-run stage */\n  includeDryRun?: boolean;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usevalidationpipeline-hook",children:"useValidationPipeline Hook"}),"\n",(0,a.jsx)(n.p,{children:"React hook for validation pipeline with state management:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface UseValidationPipelineOptions<TFieldValues extends FieldValues> {\n  /** Backend validation function */\n  validateFn: (request: ValidationRequest) => Promise<ValidationResponse>;\n\n  /** Resource type (e.g., 'wireguard-peer') */\n  resourceType: string;\n\n  /** Optional resource ID for edits */\n  resourceId?: string;\n\n  /** Optional router ID for context */\n  routerId?: string;\n\n  /** Risk level */\n  riskLevel?: RiskLevel;\n\n  /** Stop on error */\n  stopOnError?: boolean;\n\n  /** Stages to skip */\n  skipStages?: ValidationStageName[];\n\n  /** Include dry-run */\n  includeDryRun?: boolean;\n\n  /** React Hook Form setError for mapping errors */\n  setError?: UseFormSetError<TFieldValues>;\n\n  /** Callbacks */\n  onComplete?: (result: ValidationPipelineResult) => void;\n  onStageComplete?: (result: ValidationStageResult) => void;\n}\n\nfunction useValidationPipeline<TFieldValues extends FieldValues>(\n  options: UseValidationPipelineOptions<TFieldValues>\n): UseValidationPipelineReturn\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Usage Example:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function WizardStep({ data, onNext }) {\n  const form = useZodForm({ schema: stepSchema, defaultValues: data });\n\n  const { state, validate, hasErrors } = useValidationPipeline({\n    validateFn: api.validateWireguardPeer,\n    resourceType: 'wireguard-peer',\n    riskLevel: 'medium',\n    setError: form.setError,\n  });\n\n  const handleSubmit = async (formData) => {\n    const result = await validate(formData);\n\n    if (result.isValid) {\n      onNext(formData);\n    } else {\n      console.log('Errors:', result.errors);\n    }\n  };\n\n  return (\n    <form onSubmit={form.handleSubmit(handleSubmit)}>\n      {/* form fields */}\n      {state.isValidating && <ProgressBar value={state.progress} />}\n      <button disabled={state.isValidating || hasErrors}>\n        Next\n      </button>\n    </form>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"network-validators",children:"Network Validators"}),"\n",(0,a.jsx)(n.p,{children:"25+ pre-built Zod validators for network-specific types:"}),"\n",(0,a.jsx)(n.h3,{id:"basic-ip-validators",children:"Basic IP Validators"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// IPv4 address (e.g., \"192.168.1.1\")\nipv4.parse('192.168.1.1')       // \u2713\nipv4.parse('256.1.1.1')         // \u2717 (octet > 255)\nipv4.parse('192.168.001.1')     // \u2717 (leading zero)\n\n// IPv6 address (e.g., \"2001:db8::1\")\nipv6.parse('2001:db8::1')       // \u2713\nipv6.parse('::1')               // \u2713 (loopback)\n\n// IP address (IPv4 or IPv6)\nipAddress.parse('192.168.1.1')  // \u2713\nipAddress.parse('2001:db8::1')  // \u2713\n"})}),"\n",(0,a.jsx)(n.h3,{id:"mac-address",children:"MAC Address"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Colon or hyphen separators\nmac.parse('00:1A:2B:3C:4D:5E')  // \u2713\nmac.parse('00-1A-2B-3C-4D-5E')  // \u2713\nmac.parse('001A2B3C4D5E')        // \u2717 (no separators)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"network-notation",children:"Network Notation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// CIDR notation (IPv4)\ncidr.parse('192.168.1.0/24')     // \u2713\ncidr.parse('192.168.1.0/33')     // \u2717 (prefix > 32)\n\n// CIDR notation (IPv6)\ncidr6.parse('2001:db8::/32')     // \u2713\ncidr6.parse('2001:db8::/129')    // \u2717 (prefix > 128)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"port-validators",children:"Port Validators"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Single port number\nport.parse(8080)                 // \u2713\nport.parse(0)                    // \u2717 (< 1)\nport.parse(65536)                // \u2717 (> 65535)\n\n// Port as string\nportString.parse('8080')         // \u2713\nportString.parse('0')            // \u2717\n\n// Port range\nportRange.parse('8080')          // \u2713 (single)\nportRange.parse('80-443')        // \u2713 (range)\nportRange.parse('443-80')        // \u2717 (start > end)\n\n// Multiple ports (comma-separated)\nmultiPort.parse('80,443,8080')   // \u2713\nmultiPort.parse('22, 80, 443')   // \u2713 (spaces allowed)\nmultiPort.parse('80,65536')      // \u2717 (port out of range)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"vlan-id",children:"VLAN ID"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// VLAN ID (1-4094 per IEEE 802.1Q)\nvlanId.parse(100)               // \u2713\nvlanId.parse(4094)              // \u2713 (highest)\nvlanId.parse(0)                 // \u2717 (reserved)\nvlanId.parse(4095)              // \u2717 (reserved)\n\n// As string\nvlanIdString.parse('100')       // \u2713\nvlanIdString.parse('0')         // \u2717\n"})}),"\n",(0,a.jsx)(n.h3,{id:"wireguard--crypto",children:"WireGuard & Crypto"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// WireGuard key (base64, 44 chars ending in '=')\nwgKey.parse('jI6DYlg34+z6Q+q6d8YB5ibQwQAawamJBcht5xF24mE=') // \u2713\nwgKey.parse('AAAA')                                         // \u2717 (too short)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"domain-names",children:"Domain Names"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Hostname (RFC 1123)\nhostname.parse('router')               // \u2713\nhostname.parse('my-router.local')      // \u2713\nhostname.parse('-invalid')             // \u2717 (starts with hyphen)\n\n// Domain name (requires TLD)\ndomain.parse('example.com')            // \u2713\ndomain.parse('sub.example.co.uk')      // \u2713\ndomain.parse('localhost')              // \u2717 (no TLD)\ndomain.parse('example.c')              // \u2717 (TLD too short)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"interface--comments",children:"Interface & Comments"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// MikroTik interface name\ninterfaceName.parse('ether1')          // \u2713\ninterfaceName.parse('vlan.100')        // \u2713\ninterfaceName.parse('bridge-1')        // \u2713\ninterfaceName.parse('_invalid')        // \u2717 (starts with underscore)\n\n// Comment (255 chars, no control chars)\ncomment.parse('This is a valid comment')          // \u2713\ncomment.parse('a'.repeat(255))                    // \u2713\ncomment.parse('a'.repeat(256))                    // \u2717 (too long)\ncomment.parse('Comment\\nwith newline')            // \u2717 (control char)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"time--bandwidth",children:"Time & Bandwidth"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Duration string (s/m/h/d)\nduration.parse('30s')            // \u2713\nduration.parse('5m')             // \u2713\nduration.parse('2h')             // \u2713\nduration.parse('7d')             // \u2713\nduration.parse('30')             // \u2717 (missing unit)\n\n// Bandwidth (optional unit: k/m/g)\nbandwidth.parse('100')           // \u2713\nbandwidth.parse('100k')          // \u2713\nbandwidth.parse('1.5m')          // \u2713\nbandwidth.parse('1G')            // \u2713\nbandwidth.parse('100x')          // \u2717 (invalid unit)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"extended-validators-nas-4a3",children:"Extended Validators (NAS-4A.3)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Subnet mask in dotted decimal\nsubnetMask.parse('255.255.255.0')      // \u2713\nsubnetMask.parse('255.0.255.0')        // \u2717 (non-contiguous)\n\n// IP with port\nipWithPort.parse('192.168.1.1:8080')   // \u2713\nipWithPort.parse('192.168.1.1')        // \u2717 (missing port)\n\n// IP range\nipRange.parse('192.168.1.1-192.168.1.100') // \u2713\nipRange.parse('192.168.1.100-192.168.1.1') // \u2717 (start > end)\n\n// Private IP (RFC 1918)\nprivateIp.parse('192.168.1.1')         // \u2713\nprivateIp.parse('10.0.0.1')            // \u2713\nprivateIp.parse('8.8.8.8')             // \u2717 (public)\n\n// Public IP\npublicIp.parse('8.8.8.8')              // \u2713\npublicIp.parse('192.168.1.1')          // \u2717 (private)\n\n// Multicast IP (224.0.0.0/4)\nmulticastIp.parse('224.0.0.1')         // \u2713\nmulticastIp.parse('192.168.1.1')       // \u2717\n\n// Loopback IP (127.x.x.x)\nloopbackIp.parse('127.0.0.1')          // \u2713\nloopbackIp.parse('192.168.1.1')        // \u2717\n"})}),"\n",(0,a.jsx)(n.h3,{id:"bulk-import",children:"Bulk Import"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { networkValidators } from '@nasnet/core/forms';\n\nconst schema = z.object({\n  ipAddress: networkValidators.ipv4,\n  port: networkValidators.port,\n  vlan: networkValidators.vlanId,\n  dns: networkValidators.ipv4.optional(),\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"network-utilities",children:"Network Utilities"}),"\n",(0,a.jsx)(n.p,{children:"Helper functions for IP manipulation and network calculations:"}),"\n",(0,a.jsx)(n.h3,{id:"ip-address-manipulation",children:"IP Address Manipulation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Convert IPv4 string to 32-bit number\nipToLong('192.168.1.1')     // 3232235777\nipToLong('255.255.255.255') // 4294967295\n\n// Convert 32-bit number to IPv4 string\nlongToIp(3232235777)        // '192.168.1.1'\n\n// Check if IP is in subnet\nisInSubnet('192.168.1.5', '192.168.1.0/24')       // true\nisInSubnet('192.168.2.5', '192.168.1.0/24')       // false\n\n// Get network information from CIDR\ngetSubnetInfo('192.168.1.0/24')\n// {\n//   networkAddress: '192.168.1.0',\n//   broadcastAddress: '192.168.1.255',\n//   subnetMask: '255.255.255.0',\n//   prefixLength: 24,\n//   firstUsableHost: '192.168.1.1',\n//   lastUsableHost: '192.168.1.254',\n//   usableHostCount: 254,\n//   totalAddresses: 256\n// }\n\n// Individual network calculations\ngetNetworkAddress('192.168.1.50', '255.255.255.0')    // '192.168.1.0'\ngetBroadcastAddress('192.168.1.50', '255.255.255.0')  // '192.168.1.255'\ngetFirstUsableHost('192.168.1.0', '255.255.255.0')    // '192.168.1.1'\ngetLastUsableHost('192.168.1.0', '255.255.255.0')     // '192.168.1.254'\ngetUsableHostCount('192.168.1.0/24')                  // 254\n"})}),"\n",(0,a.jsx)(n.h3,{id:"subnet-mask-conversion",children:"Subnet Mask Conversion"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// CIDR to subnet mask\ncidrToSubnetMask(24)        // '255.255.255.0'\ncidrToSubnetMask(16)        // '255.255.0.0'\n\n// Subnet mask to CIDR\nsubnetMaskToCidr('255.255.255.0')  // 24\nsubnetMaskToCidr('255.255.0.0')    // 16\n"})}),"\n",(0,a.jsx)(n.h3,{id:"subnet-overlap",children:"Subnet Overlap"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Check if two subnets overlap\ndoSubnetsOverlap('192.168.1.0/24', '192.168.1.128/25')  // true (overlap)\ndoSubnetsOverlap('192.168.1.0/24', '192.168.2.0/24')    // false (no overlap)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"ip-classification",children:"IP Classification"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Check IP classification\nisPrivateIp('192.168.1.1')      // true\nisPublicIp('8.8.8.8')           // true\nisLoopbackIp('127.0.0.1')       // true\nisMulticastIp('224.0.0.1')      // true\nisLinkLocalIp('169.254.1.1')    // true\n\n// Classify IP\nclassifyIp('192.168.1.1')  // 'private'\nclassifyIp('8.8.8.8')      // 'public'\nclassifyIp('127.0.0.1')    // 'loopback'\nclassifyIp('224.0.0.1')    // 'multicast'\n"})}),"\n",(0,a.jsx)(n.h3,{id:"network-generation",children:"Network Generation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Check for domestic link\nhasDomesticLink(wanLinks)  // boolean\n\n// Generate networks for configuration\ngenerateNetworks({\n  baseNetworks: { Foreign: true, Domestic: true, VPN: true, Split: false },\n  // ... returns available network combinations\n})\n\n// Get network names by type\ngetForeignNetworkNames(networks)   // string[]\ngetDomesticNetworkNames(networks)  // string[]\ngetVPNClientNetworks(networks)     // string[]\n\n// Get available base networks\ngetAvailableBaseNetworks(networks) // BaseNetworks\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"schema-utilities",children:"Schema Utilities"}),"\n",(0,a.jsx)(n.p,{children:"Helper functions for working with Zod schemas:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Make all fields optional\nmakePartial(userSchema)\n// { name?: string; email?: string }\n\n// Merge two schemas\nmergeSchemas(baseSchema, extensionSchema)\n// Combined schema with all fields from both\n\n// Pick specific fields\npickFields(schema, ['name', 'email'])\n// Schema with only name and email\n\n// Omit specific fields\nomitFields(schema, ['password'])\n// Schema without password field\n\n// Optional string (transforms '' to undefined)\noptionalString()\n\n// Required string (min 1 character)\nrequiredString('This field is required')\n\n// Number from string input (for form inputs)\nnumberFromString({ min: 0, max: 100, integer: true })\n\n// Boolean from string input\nbooleanFromString()\n\n// Conditional schema based on values\nconditionalSchema(\n  (data) => data.type === 'custom',\n  z.object({ customField: z.string() })\n)\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"form-persistence",children:"Form Persistence"}),"\n",(0,a.jsx)(n.p,{children:"Auto-save form data with recovery on page reload:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface UseFormPersistenceOptions<T extends FieldValues> {\n  /** React Hook Form instance */\n  form: UseFormReturn<T>;\n\n  /** Unique storage key */\n  storageKey: string;\n\n  /** Storage implementation (defaults to sessionStorage) */\n  storage?: Storage;\n\n  /** Debounce delay in ms (default: 1000) */\n  debounceMs?: number;\n\n  /** Fields to exclude from persistence */\n  excludeFields?: (keyof T)[];\n}\n\nfunction useFormPersistence<T extends FieldValues>(\n  options: UseFormPersistenceOptions<T>\n): UseFormPersistenceResult\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example-2",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { useZodForm, useFormPersistence } from '@nasnet/core/forms';\n\nfunction SetupWizardStep1() {\n  const form = useZodForm({\n    schema: step1Schema,\n    defaultValues: { name: '', address: '' },\n  });\n\n  const persistence = useFormPersistence({\n    form,\n    storageKey: 'setup-wizard-step-1',\n    storage: sessionStorage,\n    debounceMs: 1000,\n  });\n\n  useEffect(() => {\n    if (persistence.hasSavedData()) {\n      // Auto-restored on component mount\n      alert('Your progress has been restored');\n    }\n  }, []);\n\n  const handleNext = async (data) => {\n    // Proceed to next step\n    persistence.clearPersistence(); // Clear when done\n  };\n\n  return (\n    <form onSubmit={form.handleSubmit(handleNext)}>\n      {/* form fields */}\n    </form>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Clear persisted data\npersistence.clearPersistence()\n\n// Check if data exists\npersistence.hasSavedData()  // boolean\n\n// Manually restore (auto-called on mount)\npersistence.restore()       // boolean (true if restored)\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"wizard-persistence",children:"Wizard Persistence"}),"\n",(0,a.jsx)(n.p,{children:"Multi-step wizard state management with progress tracking:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface UseWizardPersistenceOptions<TStepData> {\n  /** Unique storage key */\n  storageKey: string;\n\n  /** Array of step IDs in order */\n  stepIds: string[];\n\n  /** Initial step (default: first) */\n  initialStep?: string | number;\n\n  /** Storage implementation (default: sessionStorage) */\n  storage?: Storage;\n\n  /** TTL in ms (default: 24 hours) */\n  ttlMs?: number;\n\n  /** Callbacks */\n  onRestore?: (state: WizardPersistedState<TStepData>) => void;\n  onExpire?: () => void;\n}\n\nfunction useWizardPersistence<TStepData extends Record<string, FieldValues>>(\n  options: UseWizardPersistenceOptions<TStepData>\n): UseWizardPersistenceReturn<TStepData>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example-3",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"type VPNWizardData = {\n  basic: { name: string; description: string };\n  network: { address: string; port: number };\n  security: { password: string; twoFactor: boolean };\n};\n\nfunction VPNWizard() {\n  const wizard = useWizardPersistence<VPNWizardData>({\n    storageKey: 'vpn-setup-wizard',\n    stepIds: ['basic', 'network', 'security'],\n    ttlMs: 60 * 60 * 1000, // 1 hour\n  });\n\n  if (wizard.wasRestored) {\n    return <Alert>Progress restored from last session</Alert>;\n  }\n\n  return (\n    <>\n      <ProgressBar value={wizard.progress} />\n\n      {wizard.currentStep === 'basic' && (\n        <BasicStep\n          data={wizard.getStepData('basic')}\n          onNext={(data) => {\n            wizard.setStepData('basic', data);\n            wizard.completeStep('basic');\n            wizard.nextStep();\n          }}\n        />\n      )}\n\n      {wizard.currentStep === 'network' && (\n        <NetworkStep\n          data={wizard.getStepData('network')}\n          onNext={(data) => {\n            wizard.setStepData('network', data);\n            wizard.completeStep('network');\n            wizard.nextStep();\n          }}\n        />\n      )}\n\n      {wizard.currentStep === 'security' && (\n        <SecurityStep\n          data={wizard.getStepData('security')}\n          onSubmit={(data) => {\n            wizard.setStepData('security', data);\n            wizard.completeStep('security');\n\n            // Submit all data\n            const allData = wizard.getAllStepData();\n            api.createVPN(allData);\n\n            // Clear persistence when done\n            wizard.clearPersistence();\n          }}\n        />\n      )}\n    </>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"available-methods",children:"Available Methods"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Get/set step data\nwizard.getStepData('basic')         // VPNWizardData['basic'] | undefined\nwizard.setStepData('basic', data)   // void\n\n// Step navigation\nwizard.nextStep()                   // Go to next step\nwizard.prevStep()                   // Go to previous step\nwizard.goToStep('network')          // Jump to specific step\n\n// Step completion\nwizard.completeStep('basic')        // Mark step as done\nwizard.isStepCompleted('basic')     // boolean\nwizard.canGoToStep('network')       // boolean\n\n// State information\nwizard.currentStep                  // 'basic' | 'network' | 'security'\nwizard.currentStepIndex            // 0 | 1 | 2\nwizard.progress                     // 0-100\nwizard.completedSteps               // string[]\nwizard.isFirstStep                  // boolean\nwizard.isLastStep                   // boolean\nwizard.wasRestored                  // boolean\n\n// Metadata\nwizard.setMetadata({ userId: '123' })  // Store custom data\nwizard.state.metadata               // Metadata object\n\n// Reset/clear\nwizard.reset()                      // Reset to initial state\nwizard.clearPersistence()           // Delete all persisted data\nwizard.getAllStepData()             // Get combined data from all steps\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"form-resource-sync",children:"Form-Resource Sync"}),"\n",(0,a.jsx)(n.p,{children:"Synchronize React Hook Form with Universal State v2 (8-layer state model):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface UseFormResourceSyncOptions<T extends FieldValues> {\n  /** Source data from backend */\n  sourceData: T | null;\n\n  /** Unique resource identifier */\n  resourceId?: string;\n\n  /** Resource version for conflict detection */\n  resourceVersion?: string;\n\n  /** Callback when saving */\n  onSave?: (data: T) => Promise<void> | void;\n\n  /** Callback on save error */\n  onSaveError?: (error: Error) => void;\n\n  /** Callback when source changes */\n  onSourceChange?: (newSource: T) => void;\n\n  /** Auto-reset when source changes */\n  autoReset?: boolean;\n\n  /** Track changed fields */\n  trackChanges?: boolean;\n}\n\nfunction useFormResourceSync<T extends FieldValues>(\n  form: UseFormReturn<T>,\n  options: UseFormResourceSyncOptions<T>\n): UseFormResourceSyncReturn<T>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"state-layers-universal-state-v2",children:"State Layers (Universal State v2)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface FormResourceState<T> {\n  /** Layer 1: Source data from backend */\n  source: T | null;\n\n  /** Layer 4: Optimistic state for pending mutations */\n  optimistic: T | null;\n\n  /** Layer 5: Current edit draft in the form */\n  edit: T | null;\n\n  /** Layer 6: Validation results */\n  validation: {\n    isValid: boolean;\n    isValidating: boolean;\n    errors: ValidationError[];\n  };\n\n  /** Layer 7: Error state */\n  error: Error | null;\n\n  // Computed state\n  isDirty: boolean;\n  isSaving: boolean;\n  hasSourceChanged: boolean;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example-4",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { useZodForm, useFormResourceSync } from '@nasnet/core/forms';\nimport { useQuery } from '@apollo/client';\n\nfunction InterfaceEditor({ interfaceId }: { interfaceId: string }) {\n  // Query the interface\n  const { data, refetch } = useQuery(GET_INTERFACE, {\n    variables: { id: interfaceId },\n  });\n\n  const form = useZodForm({\n    schema: interfaceSchema,\n    defaultValues: data?.interface || {},\n  });\n\n  // Sync form with resource\n  const sync = useFormResourceSync(form, {\n    sourceData: data?.interface || null,\n    resourceId: interfaceId,\n    resourceVersion: data?.interface?.version,\n    onSave: async (formData) => {\n      await api.updateInterface(interfaceId, formData);\n    },\n    onSourceChange: (newSource) => {\n      // Handle external changes\n      console.log('Interface updated externally:', newSource);\n    },\n    autoReset: true,\n    trackChanges: true,\n  });\n\n  const handleSubmit = form.handleSubmit(async (data) => {\n    sync.actions.startSave();\n    try {\n      await sync.actions.applyOptimistic(data);\n      await sync.actions.completeSave();\n    } catch (error) {\n      sync.actions.handleSaveError(error as Error);\n    }\n  });\n\n  return (\n    <>\n      {sync.state.hasSourceChanged && (\n        <Alert>\n          This resource was modified elsewhere.\n          <button onClick={() => sync.actions.resetToSource()}>\n            Reload\n          </button>\n        </Alert>\n      )}\n\n      <form onSubmit={handleSubmit}>\n        {/* form fields */}\n      </form>\n\n      <div>\n        <p>Changed fields: {sync.changedFields.join(', ')}</p>\n        <p>Dirty: {sync.state.isDirty}</p>\n        <p>Saving: {sync.state.isSaving}</p>\n        <button\n          onClick={() => sync.actions.discardChanges()}\n          disabled={!sync.state.isDirty}\n        >\n          Discard\n        </button>\n      </div>\n    </>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Apply source data\nsync.actions.applySource(newData)\n\n// Optimistic updates (immediate UI feedback)\nsync.actions.applyOptimistic(optimisticData)\nsync.actions.clearOptimistic()\n\n// Save operations\nsync.actions.startSave()\nsync.actions.completeSave()\nsync.actions.handleSaveError(error)\n\n// Reset and discard\nsync.actions.resetToSource()\nsync.actions.discardChanges()\n\n// Conflict resolution\nsync.actions.mergeSourceChanges((source, edit) => ({\n  ...source,\n  ...edit,\n  // Custom merge logic\n}))\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"backend-error-mapping",children:"Backend Error Mapping"}),"\n",(0,a.jsx)(n.p,{children:"Convert backend validation errors to React Hook Form errors:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Map errors from backend validation\nmapBackendErrorsToForm(errors, form.setError)\n\n// Clear server-type errors\nclearServerErrors(form.formState.errors, form.clearErrors)\n\n// Convert single error\ntoFormError(backendError)\n// { type: 'server', message: 'Email already exists' }\n\n// Group errors by field\ngroupErrorsByField(errors)\n// { email: [error1], password: [error2] }\n\n// Combine multiple errors per field\ncombineFieldErrors(errorsByField)\n// { email: { type: 'server', message: 'Email already exists' } }\n"})}),"\n",(0,a.jsx)(n.h3,{id:"usage-example-5",children:"Usage Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const result = await validateMutation({ variables: { data } });\n\nif (!result.isValid) {\n  // Map backend errors to form fields\n  mapBackendErrorsToForm(result.errors, form.setError);\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"error-messages--i18n",children:"Error Messages & i18n"}),"\n",(0,a.jsx)(n.p,{children:"Custom Zod error messages with i18n support:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { createZodErrorMap, setGlobalErrorMap } from '@nasnet/core/forms';\nimport { useTranslation } from '@nasnet/core/i18n';\n\nfunction FormSetup() {\n  const { t } = useTranslation('validation');\n\n  // Create error map with translations\n  const errorMap = createZodErrorMap(t);\n\n  // Set globally (affects all Zod parsing in app)\n  z.setErrorMap(errorMap);\n\n  // Or use per-schema\n  const schema = z.string().min(1);\n  const result = schema.safeParse('', { errorMap });\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"default-error-messages",children:"Default Error Messages"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"{\n  'validation.required': 'This field is required',\n  'validation.string.min': 'Must be at least {{min}} characters',\n  'validation.string.max': 'Must be at most {{max}} characters',\n  'validation.string.email': 'Please enter a valid email address',\n  'validation.number.min': 'Must be at least {{min}}',\n  'validation.number.max': 'Must be at most {{max}}',\n  'validation.number.int': 'Must be a whole number',\n  // ... etc\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"custom-error-messages",children:"Custom Error Messages"}),"\n",(0,a.jsx)(n.p,{children:"Define custom error messages in translation files:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"locales/en/validation.json:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "validation": {\n    "ipv4": "Invalid IPv4 address",\n    "mac": "Invalid MAC address format",\n    "wireguard_key": "Invalid WireGuard key",\n    "custom.peer_name": "Peer name must be unique"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Then use in schemas:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const peerSchema = z.object({\n  name: z.string().min(1).refine(\n    async (val) => {\n      const exists = await checkPeerExists(val);\n      return !exists;\n    },\n    { message: t('validation.custom.peer_name') }\n  ),\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"validation-strategy-configuration",children:"Validation Strategy Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Risk-based validation configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"export const VALIDATION_CONFIGS: Record<ValidationStrategy, ValidationConfig> = {\n  low: {\n    stages: ['schema', 'syntax'],\n    clientOnly: true,\n    requiresConfirmation: false,\n  },\n  medium: {\n    stages: ['schema', 'syntax', 'cross-resource', 'dependencies'],\n    clientOnly: false,\n    requiresConfirmation: false,\n  },\n  high: {\n    stages: ['schema', 'syntax', 'cross-resource', 'dependencies', 'network', 'platform', 'dry-run'],\n    clientOnly: false,\n    requiresConfirmation: true,\n    confirmationSteps: ['preview', 'countdown'],\n  },\n};\n"})}),"\n",(0,a.jsx)(n.h3,{id:"stage-labels",children:"Stage Labels"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"export const STAGE_LABELS: Record<ValidationStage, string> = {\n  schema: 'Schema Validation',\n  syntax: 'Format Check',\n  'cross-resource': 'Conflict Detection',\n  dependencies: 'Dependencies',\n  network: 'Network Availability',\n  platform: 'Router Compatibility',\n  'dry-run': 'Simulation',\n};\n"})}),"\n",(0,a.jsx)(n.h3,{id:"choosing-risk-level",children:"Choosing Risk Level"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Low Risk"})," (WiFi password, display name, comment):"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"User-facing text fields"}),"\n",(0,a.jsx)(n.li,{children:"Simple input validation"}),"\n",(0,a.jsx)(n.li,{children:"No backend impact"}),"\n",(0,a.jsx)(n.li,{children:"Fast response needed"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Medium Risk"})," (Firewall rules, DHCP settings, VPN peer config):"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Network configuration"}),"\n",(0,a.jsx)(n.li,{children:"Could conflict with other resources"}),"\n",(0,a.jsx)(n.li,{children:"Backend validation needed"}),"\n",(0,a.jsx)(n.li,{children:"No dry-run required"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"High Risk"})," (WAN link changes, routing tables, VPN deletion):"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"System-critical changes"}),"\n",(0,a.jsx)(n.li,{children:"Could break connectivity"}),"\n",(0,a.jsx)(n.li,{children:"Requires dry-run + preview"}),"\n",(0,a.jsx)(n.li,{children:"Needs explicit confirmation countdown"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(n.h3,{id:"1-use-nasformprovider-for-standard-forms",children:["1. ",(0,a.jsx)(n.strong,{children:"Use NasFormProvider for Standard Forms"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'// Preferred\n<NasFormProvider\n  schema={schema}\n  onSubmit={handleSubmit}\n  validationStrategy="medium"\n>\n  {/* form fields */}\n</NasFormProvider>\n\n// Only use useZodForm directly for simple forms without validation pipeline\nconst form = useZodForm({ schema });\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"2-validate-based-on-risk",children:["2. ",(0,a.jsx)(n.strong,{children:"Validate Based on Risk"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'// Low-risk: Just use Zod\n<NasFormProvider\n  schema={simpleSchema}\n  validationStrategy="low"\n  onSubmit={handleSubmit}\n>\n  {/* No backend calls */}\n</NasFormProvider>\n\n// Medium-risk: Schema + backend validation\n<NasFormProvider\n  schema={networSchema}\n  validationStrategy="medium"\n  onSubmit={handleSubmit}\n>\n  {/* Backend validates for conflicts */}\n</NasFormProvider>\n\n// High-risk: Full validation + preview + countdown\n<NasFormProvider\n  schema={criticalSchema}\n  validationStrategy="high"\n  onSubmit={handleSubmit}\n>\n  {/* Full pipeline with dry-run */}\n</NasFormProvider>\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"3-use-form-persistence-for-wizards",children:["3. ",(0,a.jsx)(n.strong,{children:"Use Form Persistence for Wizards"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Multi-step wizard\nconst wizard = useWizardPersistence({\n  storageKey: 'setup-wizard',\n  stepIds: ['step1', 'step2', 'step3'],\n});\n\n// Single-step form with recovery\nconst persistence = useFormPersistence({\n  form,\n  storageKey: 'complex-form',\n});\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"4-handle-backend-errors-properly",children:["4. ",(0,a.jsx)(n.strong,{children:"Handle Backend Errors Properly"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const handleSubmit = async (data) => {\n  try {\n    const result = await api.validate(data);\n    if (!result.isValid) {\n      mapBackendErrorsToForm(result.errors, form.setError);\n      return;\n    }\n    await api.save(data);\n  } catch (error) {\n    form.setError('root', {\n      type: 'submit',\n      message: 'Failed to save'\n    });\n  }\n};\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"5-sync-with-resource-state",children:["5. ",(0,a.jsx)(n.strong,{children:"Sync with Resource State"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Use form-resource sync for editor forms\nconst sync = useFormResourceSync(form, {\n  sourceData: currentResource,\n  resourceId: resourceId,\n  onSave: api.updateResource,\n  trackChanges: true,\n});\n\n// Show dirty state and conflict warnings\n{sync.state.isDirty && <SaveButton />}\n{sync.state.hasSourceChanged && <ConflictAlert />}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Validation Pipeline Architecture:"})," ",(0,a.jsx)(n.code,{children:"Docs/architecture/implementation-patterns/data-validation-patterns.md"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Universal State v2:"})," ",(0,a.jsx)(n.code,{children:"Docs/architecture/data-architecture.md"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"React Hook Form Docs:"})," ",(0,a.jsx)(n.a,{href:"https://react-hook-form.com/",children:"https://react-hook-form.com/"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Zod Docs:"})," ",(0,a.jsx)(n.a,{href:"https://zod.dev/",children:"https://zod.dev/"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},71184:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var s=r(14041);const a={},i=s.createContext(a);function t(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);
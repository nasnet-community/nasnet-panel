"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[72742],{7460:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"architecture/overview","title":"Architecture Overview","description":"The apps/connect frontend is the React-based management interface for NasNetConnect. It","source":"@site/../connect/docs/architecture/overview.md","sourceDirName":"architecture","slug":"/architecture/overview","permalink":"/docs/frontend/architecture/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/architecture/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Monorepo Library Dependency Graph","permalink":"/docs/frontend/architecture/library-dependencies"},"next":{"title":"Provider Stack Deep Dive","permalink":"/docs/frontend/architecture/provider-stack"}}');var i=r(31085),t=r(71184);const c={},o="Architecture Overview",l={},d=[{value:"Request Flow",id:"request-flow",level:2},{value:"Architecture Layers",id:"architecture-layers",level:2},{value:"Layer 1 \u2014 Core / Data",id:"layer-1--core--data",level:3},{value:"Layer 2 \u2014 UI Component System",id:"layer-2--ui-component-system",level:3},{value:"Layer 3 \u2014 Feature Modules",id:"layer-3--feature-modules",level:3},{value:"Layer 4 \u2014 Application Shell",id:"layer-4--application-shell",level:3},{value:"Hexagonal Architecture Reference",id:"hexagonal-architecture-reference",level:2},{value:"Separation of Concerns",id:"separation-of-concerns",level:2},{value:"Related Documents",id:"related-documents",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"architecture-overview",children:"Architecture Overview"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"apps/connect"})," frontend is the React-based management interface for NasNetConnect. It\ncommunicates with a Go backend over GraphQL, which in turn proxies commands to MikroTik routers via\nRouterOS API, SSH, or Telnet."]}),"\n",(0,i.jsx)(n.h2,{id:"request-flow",children:"Request Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TD\n    subgraph Browser["Browser (React App)"]\n        A[User Action] --\x3e B[React Component]\n        B --\x3e C[Apollo Client / TanStack Query]\n        C --\x3e D[TanStack Router]\n    end\n\n    D --\x3e|"HTTP POST /api/graphql\\nWS /api/graphql (subscriptions)"| E\n\n    subgraph Backend["Go Backend (NNC binary)"]\n        E[GraphQL Server - gqlgen] --\x3e F[Resolver Layer]\n        F --\x3e G["Service / Use-Case Layer\\n(Hexagonal Architecture)"]\n        G --\x3e H["Router Adapter\\n(RouterOS API / SSH / Telnet)"]\n    end\n\n    H --\x3e|"RouterOS API (8728/8729)\\nSSH (22) \xb7 Telnet (23)"| I\n\n    subgraph Router["MikroTik Router (RouterOS)"]\n        I[RouterOS]\n    end'}),"\n",(0,i.jsx)(n.h2,{id:"architecture-layers",children:"Architecture Layers"}),"\n",(0,i.jsx)(n.p,{children:"The frontend is organized into four horizontal layers. Each layer has a strict one-directional\ndependency: higher layers consume lower layers; lower layers never import from higher layers."}),"\n",(0,i.jsx)(n.mermaid,{value:'block-beta\n    columns 1\n    block:L4["Layer 4 \u2014 UI / Presentation"]\n        L4a["apps/connect/src/routes/ \xb7 apps/connect/src/app/"]\n    end\n    block:L3["Layer 3 \u2014 Feature Modules"]\n        L3a["libs/features/*/src \u2014 Domain-specific components, forms, hooks"]\n    end\n    block:L2["Layer 2 \u2014 UI Component System"]\n        L2a["libs/ui/primitives \xb7 libs/ui/patterns \xb7 libs/ui/layouts"]\n    end\n    block:L1["Layer 1 \u2014 Core / Data"]\n        L1a["libs/core/* \xb7 libs/api-client/* \xb7 libs/state/stores"]\n    end\n\n    L4 --\x3e L3 --\x3e L2 --\x3e L1'}),"\n",(0,i.jsx)(n.h3,{id:"layer-1--core--data",children:"Layer 1 \u2014 Core / Data"}),"\n",(0,i.jsx)(n.p,{children:"The foundation. Contains no React components."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/core/types"})," \u2014 Shared TypeScript interfaces and enums"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/core/utils"})," \u2014 Pure utility functions (IP formatting, status calculations)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/core/constants"})," \u2014 App-wide constants, route paths, socket events"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/core/forms"})," \u2014 React Hook Form + Zod integration, validation utilities"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/core/i18n"})," \u2014 i18next setup, hooks, direction detection"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/api-client/core"})," \u2014 Apollo Client configuration, links, normalized cache"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/api-client/generated"})," \u2014 Auto-generated TypeScript types and React hooks from GraphQL schema"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/api-client/queries"})," \u2014 Human-authored Apollo Client hooks organized by domain"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/state/stores"})," \u2014 Zustand stores (theme, sidebar, connection status, notifications)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"layer-2--ui-component-system",children:"Layer 2 \u2014 UI Component System"}),"\n",(0,i.jsx)(n.p,{children:"Reusable, domain-agnostic components. The three-tier component library:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/ui/primitives"})," \u2014 ~40 shadcn/ui + Radix UI base components (Button, Card, Input, Dialog)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/ui/patterns"})," \u2014 ~56 composite components implementing the Headless + Platform Presenter\npattern"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/ui/layouts"})," \u2014 Page shells (ResponsiveShell), sidebar providers, PlatformProvider"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"layer-3--feature-modules",children:"Layer 3 \u2014 Feature Modules"}),"\n",(0,i.jsx)(n.p,{children:"Domain-specific logic. Each feature module is self-contained and cannot import from sibling feature\nmodules."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/router-discovery"})," \u2014 Router scanning and onboarding"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/dashboard"})," \u2014 Fleet overview and quick stats"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/wireless"})," \u2014 WiFi interface management"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/firewall"})," \u2014 Firewall rules, address lists, NAT"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/logs"})," \u2014 Log streaming and filtering"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/network"})," \u2014 DHCP, VLANs, bridging, routing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/alerts"})," \u2014 Alert rules, notification channels, quiet hours"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/diagnostics"})," \u2014 Traceroute, DNS lookup, circuit breaker"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/services"})," \u2014 Feature marketplace (Tor, sing-box, Xray, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/features/configuration-import"})," \u2014 Config import/export wizard"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"layer-4--application-shell",children:"Layer 4 \u2014 Application Shell"}),"\n",(0,i.jsxs)(n.p,{children:["The entry point and routing layer. Defined in ",(0,i.jsx)(n.code,{children:"apps/connect/src/"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"main.tsx"})," \u2014 React DOM mount, router creation, i18n bootstrap, XState Inspector (dev)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"routes/__root.tsx"})," \u2014 Root route: wraps all routes in the ",(0,i.jsx)(n.code,{children:"Providers"})," stack, renders\n",(0,i.jsx)(n.code,{children:"ResponsiveShell"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"routes/**/*.tsx"})," \u2014 File-based route tree (47 routes total)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"app/components/"})," \u2014 App-level components (AppHeader, AppSidebar)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"app/providers/"})," \u2014 Context provider composition (8 providers)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"app/hooks/"})," \u2014 App-level hooks (connection heartbeat, toast notifications, keyboard shortcuts)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"hexagonal-architecture-reference",children:"Hexagonal Architecture Reference"}),"\n",(0,i.jsx)(n.p,{children:"The Go backend uses hexagonal (ports-and-adapters) architecture. The frontend mirrors this by\nenforcing its own layered boundary:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ports (inward):"})," GraphQL schema (single source of truth in ",(0,i.jsx)(n.code,{children:"schema/"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Adapters (data in):"})," ",(0,i.jsx)(n.code,{children:"libs/api-client"})," \u2014 Apollo Client hooks translate GraphQL responses into\nReact state"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Adapters (data out):"})," ",(0,i.jsx)(n.code,{children:"libs/api-client/queries"})," \u2014 hooks that emit mutations back to the backend"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The frontend never talks directly to RouterOS. All router state flows through the Go backend's\nGraphQL API."}),"\n",(0,i.jsx)(n.h2,{id:"separation-of-concerns",children:"Separation of Concerns"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Concern"}),(0,i.jsx)(n.th,{children:"Location"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Routing / navigation"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/connect/src/routes/"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Global app shell"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/connect/src/routes/__root.tsx"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Provider composition"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/connect/src/app/providers/"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Business logic (feature)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/features/*/src"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"UI component logic (headless)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"libs/ui/patterns/src"})," (hooks)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"UI rendering"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"libs/ui/patterns/src"})," (presenters)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Server state (GraphQL)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/api-client/queries/src"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Client UI state"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/state/stores/src"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Complex workflow state"}),(0,i.jsxs)(n.td,{children:["XState machines in ",(0,i.jsx)(n.code,{children:"libs/state/machines/"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Form state"}),(0,i.jsx)(n.td,{children:"React Hook Form instances inside components"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Types"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/core/types/src"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Design tokens"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/ui/tokens/src"})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"related-documents",children:"Related Documents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/frontend/architecture/provider-stack",children:"Provider Stack"})," \u2014 All 8 providers in detail"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/frontend/architecture/routing",children:"Routing"})," \u2014 TanStack Router file-based routing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/frontend/architecture/library-dependencies",children:"Library Dependencies"})," \u2014 Monorepo import graph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/frontend/architecture/build-system",children:"Build System"})," \u2014 Vite configuration and bundle strategy"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/frontend/getting-started/project-structure",children:"Getting Started \u2014 Project Structure"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},71184:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var s=r(14041);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);
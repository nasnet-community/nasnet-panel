"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[61647],{19441:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"operations/development-workflow","title":"Development Workflow","description":"Day-to-day guide for developing the apps/connect frontend. Covers environment startup, HMR behaviour, debugging, common development tasks, and the PR process.","source":"@site/../connect/docs/operations/development-workflow.md","sourceDirName":"operations","slug":"/operations/development-workflow","permalink":"/docs/frontend/operations/development-workflow","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/operations/development-workflow.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Internationalization (i18n)","permalink":"/docs/frontend/i18n-accessibility/i18n"},"next":{"title":"Performance Guide","permalink":"/docs/frontend/operations/performance"}}');var t=s(31085),o=s(71184);const i={},l="Development Workflow",c={},d=[{value:"Starting the Development Environment",id:"starting-the-development-environment",level:2},{value:"Frontend Only",id:"frontend-only",level:3},{value:"Backend Only",id:"backend-only",level:3},{value:"Both Together (Recommended)",id:"both-together-recommended",level:3},{value:"Verbose Mode",id:"verbose-mode",level:3},{value:"HMR (Hot Module Replacement)",id:"hmr-hot-module-replacement",level:2},{value:"React Component Changes",id:"react-component-changes",level:3},{value:"Design Token Changes",id:"design-token-changes",level:3},{value:"GraphQL Schema Changes",id:"graphql-schema-changes",level:3},{value:"TanStack Router Route Tree",id:"tanstack-router-route-tree",level:3},{value:"Known HMR Caveats",id:"known-hmr-caveats",level:3},{value:"Browser DevTools Setup",id:"browser-devtools-setup",level:2},{value:"Apollo DevTools",id:"apollo-devtools",level:3},{value:"React DevTools",id:"react-devtools",level:3},{value:"TanStack Router Devtools",id:"tanstack-router-devtools",level:3},{value:"XState Inspector",id:"xstate-inspector",level:3},{value:"Debugging Techniques",id:"debugging-techniques",level:2},{value:"TypeScript Errors in the Browser",id:"typescript-errors-in-the-browser",level:3},{value:"Network Request Inspection",id:"network-request-inspection",level:3},{value:"Console Logging",id:"console-logging",level:3},{value:"Source Maps",id:"source-maps",level:3},{value:"Common Development Scenarios",id:"common-development-scenarios",level:2},{value:"Adding a New Page / Route",id:"adding-a-new-page--route",level:3},{value:"Adding a New GraphQL Query / Mutation",id:"adding-a-new-graphql-query--mutation",level:3},{value:"Adding a New UI Component",id:"adding-a-new-ui-component",level:3},{value:"Modifying the GraphQL Schema and Running Codegen",id:"modifying-the-graphql-schema-and-running-codegen",level:3},{value:"PR Workflow and Code Review",id:"pr-workflow-and-code-review",level:2},{value:"Before Submitting a PR",id:"before-submitting-a-pr",level:3},{value:"Commit Message Convention",id:"commit-message-convention",level:3},{value:"Code Review Checklist",id:"code-review-checklist",level:3},{value:"Nx Affected (Speed Up CI)",id:"nx-affected-speed-up-ci",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"development-workflow",children:"Development Workflow"})}),"\n",(0,t.jsxs)(n.p,{children:["Day-to-day guide for developing the ",(0,t.jsx)(n.code,{children:"apps/connect"})," frontend. Covers environment startup, HMR behaviour, debugging, common development tasks, and the PR process."]}),"\n",(0,t.jsx)(n.p,{children:"See also:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/frontend/getting-started/key-commands",children:"Key Commands"})," \u2014 full command reference"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/frontend/architecture/build-system",children:"Build System"})," \u2014 Vite configuration details"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"starting-the-development-environment",children:"Starting the Development Environment"}),"\n",(0,t.jsx)(n.h3,{id:"frontend-only",children:"Frontend Only"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run dev:frontend\n# Vite dev server starts at http://localhost:5173\n# Browser opens automatically (open: true in vite.config.ts)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The Vite dev server binds to ",(0,t.jsx)(n.code,{children:"0.0.0.0"})," (",(0,t.jsx)(n.code,{children:"host: true"}),"), so it is reachable from other devices on the same LAN \u2014 useful for testing on a phone."]}),"\n",(0,t.jsx)(n.h3,{id:"backend-only",children:"Backend Only"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run dev:backend\n# Go backend with air hot reload at http://localhost:8080\n"})}),"\n",(0,t.jsx)(n.h3,{id:"both-together-recommended",children:"Both Together (Recommended)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run dev:all\n# Runs connect + backend in parallel with verbose output\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The frontend dev server proxies all ",(0,t.jsx)(n.code,{children:"/api/*"})," requests to the Go backend (default: ",(0,t.jsx)(n.code,{children:"http://localhost:80"}),", override with ",(0,t.jsx)(n.code,{children:"VITE_PROXY_URL"})," in ",(0,t.jsx)(n.code,{children:".env.development"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:"# apps/connect/.env.development\nVITE_API_URL=http://localhost:8080\nVITE_PROXY_URL=http://localhost:8080\n"})}),"\n",(0,t.jsx)(n.h3,{id:"verbose-mode",children:"Verbose Mode"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run dev:verbose\n# Prints all Vite plugin activity \u2014 useful when debugging token HMR or router codegen\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"hmr-hot-module-replacement",children:"HMR (Hot Module Replacement)"}),"\n",(0,t.jsxs)(n.p,{children:["Vite's HMR is configured via ",(0,t.jsx)(n.code,{children:"@vitejs/plugin-react"})," (Fast Refresh). The following behaviours apply:"]}),"\n",(0,t.jsx)(n.h3,{id:"react-component-changes",children:"React Component Changes"}),"\n",(0,t.jsx)(n.p,{children:"Standard React Fast Refresh: component state is preserved across edits when the component signature does not change. If you add or remove hooks, the module is fully reloaded and local state is reset."}),"\n",(0,t.jsx)(n.h3,{id:"design-token-changes",children:"Design Token Changes"}),"\n",(0,t.jsxs)(n.p,{children:["The project includes a custom ",(0,t.jsx)(n.code,{children:"designTokensHMR"})," Vite plugin (defined in ",(0,t.jsx)(n.code,{children:"apps/connect/vite.config.ts"}),"). When ",(0,t.jsx)(n.code,{children:"libs/ui/tokens/src/tokens.json"})," is modified:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["The plugin detects the change and runs ",(0,t.jsx)(n.code,{children:"node libs/ui/tokens/build.js"})]}),"\n",(0,t.jsxs)(n.li,{children:["The rebuilt ",(0,t.jsx)(n.code,{children:"libs/ui/tokens/dist/variables.css"})," is invalidated in Vite's module graph"]}),"\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.code,{children:"full-reload"})," is sent to the browser"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["This means editing design tokens does ",(0,t.jsx)(n.strong,{children:"not"})," preserve component state \u2014 expect a full page reload. Run ",(0,t.jsx)(n.code,{children:"npm run tokens:build"})," once on first setup if CSS variables are missing."]}),"\n",(0,t.jsx)(n.h3,{id:"graphql-schema-changes",children:"GraphQL Schema Changes"}),"\n",(0,t.jsxs)(n.p,{children:["Changes to ",(0,t.jsx)(n.code,{children:".graphql"})," files do ",(0,t.jsx)(n.strong,{children:"not"})," trigger automatic HMR. You must run codegen manually:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run codegen:ts   # TypeScript types, hooks, Zod schemas\n"})}),"\n",(0,t.jsxs)(n.p,{children:["After codegen, Vite detects changes to the generated files under ",(0,t.jsx)(n.code,{children:"libs/api-client/generated/"})," and triggers HMR for any modules that import them."]}),"\n",(0,t.jsx)(n.h3,{id:"tanstack-router-route-tree",children:"TanStack Router Route Tree"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"TanStackRouterVite"})," plugin watches ",(0,t.jsx)(n.code,{children:"src/routes/"})," for new or removed route files. When you add a route file, the plugin automatically regenerates ",(0,t.jsx)(n.code,{children:"src/routeTree.gen.ts"})," and Vite picks up the change. No manual step is needed."]}),"\n",(0,t.jsx)(n.h3,{id:"known-hmr-caveats",children:"Known HMR Caveats"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Scenario"}),(0,t.jsx)(n.th,{children:"Behaviour"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Adding/removing a React hook"}),(0,t.jsx)(n.td,{children:"Full module reload, state reset"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Editing CSS custom properties"}),(0,t.jsx)(n.td,{children:"Full page reload (token rebuild cycle)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:["Modifying ",(0,t.jsx)(n.code,{children:"vite.config.ts"})," itself"]}),(0,t.jsx)(n.td,{children:"Manual server restart required"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Changing XState machine definition"}),(0,t.jsx)(n.td,{children:"Full module reload"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:["Editing ",(0,t.jsx)(n.code,{children:".graphql"})," files"]}),(0,t.jsxs)(n.td,{children:["Manual ",(0,t.jsx)(n.code,{children:"npm run codegen:ts"})," required"]})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"browser-devtools-setup",children:"Browser DevTools Setup"}),"\n",(0,t.jsx)(n.h3,{id:"apollo-devtools",children:"Apollo DevTools"}),"\n",(0,t.jsxs)(n.p,{children:["Install the ",(0,t.jsx)(n.a,{href:"https://www.apollographql.com/docs/react/development-testing/developer-tooling/#apollo-client-devtools",children:"Apollo Client Devtools"})," browser extension."]}),"\n",(0,t.jsxs)(n.p,{children:["Once installed, the ",(0,t.jsx)(n.strong,{children:"Apollo"})," tab appears in Chrome DevTools. Use it to:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Inspect the Apollo cache"}),"\n",(0,t.jsx)(n.li,{children:"Run GraphQL queries directly against the connected router"}),"\n",(0,t.jsx)(n.li,{children:"Watch active query/subscription states"}),"\n",(0,t.jsx)(n.li,{children:"Examine query variables and responses"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Apollo DevTools is available in development builds only. The cache is configured with ",(0,t.jsx)(n.code,{children:"InMemoryCache"})," and type policies defined in ",(0,t.jsx)(n.code,{children:"libs/api-client/core/src/"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"react-devtools",children:"React DevTools"}),"\n",(0,t.jsxs)(n.p,{children:["Install the ",(0,t.jsx)(n.a,{href:"https://react.dev/learn/react-developer-tools",children:"React Developer Tools"})," browser extension."]}),"\n",(0,t.jsx)(n.p,{children:"Useful tasks:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Inspect component trees and props"}),"\n",(0,t.jsx)(n.li,{children:"Profile render performance with the Profiler tab"}),"\n",(0,t.jsxs)(n.li,{children:["Check Zustand store state via ",(0,t.jsx)(n.code,{children:"useStore"})," hooks (visible in component props)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"tanstack-router-devtools",children:"TanStack Router Devtools"}),"\n",(0,t.jsxs)(n.p,{children:["TanStack Router Devtools are embedded directly in the app during development. A floating button appears in the bottom-right corner (rendered by ",(0,t.jsx)(n.code,{children:'<TanStackRouterDevtools position="bottom-right" />'})," in ",(0,t.jsx)(n.code,{children:"src/routes/__root.tsx"}),"). It is automatically excluded from production builds via the ",(0,t.jsx)(n.code,{children:"import.meta.env.DEV"})," guard."]}),"\n",(0,t.jsx)(n.p,{children:"Use it to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Inspect the current route tree"}),"\n",(0,t.jsx)(n.li,{children:"View route params and search params"}),"\n",(0,t.jsx)(n.li,{children:"Navigate to any route"}),"\n",(0,t.jsx)(n.li,{children:"Inspect loader data"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"xstate-inspector",children:"XState Inspector"}),"\n",(0,t.jsxs)(n.p,{children:["For debugging XState machines, the project has ",(0,t.jsx)(n.code,{children:"@statelyai/inspect"})," in devDependencies. To enable, import and call ",(0,t.jsx)(n.code,{children:"createBrowserInspector()"})," from ",(0,t.jsx)(n.code,{children:"@statelyai/inspect"})," at the top of the machine file during development."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"debugging-techniques",children:"Debugging Techniques"}),"\n",(0,t.jsx)(n.h3,{id:"typescript-errors-in-the-browser",children:"TypeScript Errors in the Browser"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"vite-plugin-checker"})," runs TypeScript type-checking in a background worker during development. Type errors appear as:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["An overlay in the browser (",(0,t.jsx)(n.code,{children:"overlay.initialIsOpen: false"})," \u2014 minimised by default, click the warning icon to expand)"]}),"\n",(0,t.jsx)(n.li,{children:"Terminal output with file path and line number"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Fix the type error in your editor; the overlay clears automatically on save."}),"\n",(0,t.jsx)(n.h3,{id:"network-request-inspection",children:"Network Request Inspection"}),"\n",(0,t.jsxs)(n.p,{children:["All GraphQL requests go to ",(0,t.jsx)(n.code,{children:"/api/graphql"}),". In the browser's Network tab:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Filter by ",(0,t.jsx)(n.code,{children:"XHR"})," or ",(0,t.jsx)(n.code,{children:"Fetch"})]}),"\n",(0,t.jsxs)(n.li,{children:["Look for ",(0,t.jsx)(n.code,{children:"graphql"})," requests to inspect queries, mutations, and responses"]}),"\n",(0,t.jsxs)(n.li,{children:["WebSocket subscriptions appear under the ",(0,t.jsx)(n.code,{children:"WS"})," filter"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"console-logging",children:"Console Logging"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"console.log"})," is stripped in production builds (Terser ",(0,t.jsx)(n.code,{children:"drop_console: true"}),"). During development, use the browser console freely. For structured debugging, prefer React DevTools over console logging."]}),"\n",(0,t.jsx)(n.h3,{id:"source-maps",children:"Source Maps"}),"\n",(0,t.jsxs)(n.p,{children:["Source maps are generated in development and staging mode (",(0,t.jsx)(n.code,{children:"sourcemap: mode !== 'production'"}),"). TypeScript and TSX source files are visible in the Sources tab. Breakpoints set on TypeScript source lines work as expected."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-development-scenarios",children:"Common Development Scenarios"}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-new-page--route",children:"Adding a New Page / Route"}),"\n",(0,t.jsxs)(n.p,{children:["TanStack Router uses file-based routing. All route files live under ",(0,t.jsx)(n.code,{children:"apps/connect/src/routes/"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create the route file following the naming convention:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"src/routes/router/$id/my-feature.tsx\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Define and export the route:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { createFileRoute } from '@tanstack/react-router';\nimport { MyFeaturePage } from '@/app/pages/my-feature/MyFeaturePage';\n\nexport const Route = createFileRoute('/router/$id/my-feature')({\n  component: MyFeaturePage,\n});\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"TanStackRouterVite"})," plugin regenerates ",(0,t.jsx)(n.code,{children:"src/routeTree.gen.ts"})," automatically on save."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add a navigation link in ",(0,t.jsx)(n.code,{children:"AppSidebar.tsx"})," or the relevant tab navigation component."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"For heavy tabs"})," (those with large tables or complex forms), use lazy loading with a skeleton fallback:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { createFileRoute } from '@tanstack/react-router';\nimport { LazyBoundary } from '@nasnet/ui/patterns';\nimport { Skeleton } from '@nasnet/ui/primitives';\nimport { LazyMyFeatureTab } from '@/app/routes/router-panel/tabs/lazy';\n\nfunction MyFeatureSkeleton() {\n  return (\n    <div className=\"space-y-4 p-4 animate-fade-in-up\" aria-busy=\"true\">\n      <Skeleton className=\"h-6 w-40\" />\n      <Skeleton className=\"h-64 w-full\" />\n    </div>\n  );\n}\n\nexport const Route = createFileRoute('/router/$id/my-feature')({\n  component: () => (\n    <LazyBoundary fallback={<MyFeatureSkeleton />}>\n      <LazyMyFeatureTab />\n    </LazyBoundary>\n  ),\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Register the lazy component in ",(0,t.jsx)(n.code,{children:"src/app/routes/router-panel/tabs/lazy.ts"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export const [LazyMyFeatureTab, preloadMyFeatureTab] = createLazyWithPreload(\n  () => import('./MyFeatureTab').then((m) => ({ default: m.MyFeatureTab }))\n);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-new-graphql-query--mutation",children:"Adding a New GraphQL Query / Mutation"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Add to the GraphQL schema"})," in ",(0,t.jsx)(n.code,{children:"schema/"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"# schema/my-domain/my-feature.graphql\ntype Query {\n  myFeature(routerId: ID!): MyFeatureResult!\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Run TypeScript codegen:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run codegen:ts\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This generates typed hooks in ",(0,t.jsx)(n.code,{children:"libs/api-client/generated/"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Create a domain hook"})," in ",(0,t.jsx)(n.code,{children:"libs/api-client/queries/src/"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// libs/api-client/queries/src/my-domain/useMyFeature.ts\nimport { useQuery } from '@apollo/client';\nimport { GetMyFeatureDocument } from '@nasnet/api-client/generated';\n\nexport function useMyFeature(routerId: string) {\n  return useQuery(GetMyFeatureDocument, {\n    variables: { routerId },\n    context: { headers: { 'X-Router-Id': routerId } },\n  });\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Export from the queries index"})," and use in your component."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"If the schema also has a backend resolver"}),", run the full codegen:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run codegen\n"})}),"\n",(0,t.jsxs)(n.p,{children:["After modifying ",(0,t.jsx)(n.code,{children:".graphql"})," files, always remind yourself to run codegen \u2014 the TypeScript types and Go resolver stubs must stay in sync."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-new-ui-component",children:"Adding a New UI Component"}),"\n",(0,t.jsx)(n.p,{children:"Follow the three-layer architecture:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primitive"})," (",(0,t.jsx)(n.code,{children:"libs/ui/primitives/"}),") \u2014 only for new shadcn/Radix wrapper components with zero business logic"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pattern"})," (",(0,t.jsx)(n.code,{children:"libs/ui/patterns/"}),") \u2014 composite, reusable, platform-aware components"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Domain"})," (",(0,t.jsx)(n.code,{children:"libs/features/*/components/"}),") \u2014 feature-specific, not shared"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For a new ",(0,t.jsx)(n.strong,{children:"pattern"})," component:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create the headless hook:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/my-component/useMyComponent.ts\nexport function useMyComponent(props: MyComponentProps) {\n  // business logic, state, handlers\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create platform presenters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/my-component/MyComponent.mobile.tsx\nexport function MyComponentMobile(props: MyComponentProps) { ... }\n\n// libs/ui/patterns/src/my-component/MyComponent.desktop.tsx\nexport function MyComponentDesktop(props: MyComponentProps) { ... }\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create the platform-switching wrapper:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/my-component/MyComponent.tsx\nimport { usePlatform } from '@nasnet/ui/layouts';\n\nexport function MyComponent(props: MyComponentProps) {\n  const platform = usePlatform();\n  return platform === 'mobile'\n    ? <MyComponentMobile {...props} />\n    : <MyComponentDesktop {...props} />;\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Export from ",(0,t.jsx)(n.code,{children:"libs/ui/patterns/src/index.ts"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Write a Storybook story (see ",(0,t.jsx)(n.a,{href:"/docs/frontend/operations/storybook",children:"Storybook Guide"}),")."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"modifying-the-graphql-schema-and-running-codegen",children:"Modifying the GraphQL Schema and Running Codegen"}),"\n",(0,t.jsxs)(n.p,{children:["Schema files are the single source of truth for the API contract. They live in ",(0,t.jsx)(n.code,{children:"schema/"})," at the monorepo root."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Full codegen workflow:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# 1. Edit schema files in schema/\n# 2. Run full codegen (TypeScript + Go)\nnpm run codegen\n\n# Or run selectively:\nnpm run codegen:ts    # TypeScript only\nnpm run codegen:go    # Go (ent ORM + gqlgen + wire)\n\n# 3. Verify generated code is in sync (also run in CI)\nnpm run codegen:check\n"})}),"\n",(0,t.jsx)(n.p,{children:"The codegen produces:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"libs/api-client/generated/"})," \u2014 TypeScript types, Apollo hooks, Zod schemas"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"apps/backend/graph/generated.go"})," \u2014 Go GraphQL executor"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"apps/backend/graph/model/models_gen.go"})," \u2014 Go model types"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"apps/backend/generated/ent/"})," \u2014 ent ORM code"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Never manually edit files in these generated directories. Any hand edits are overwritten on the next codegen run."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"pr-workflow-and-code-review",children:"PR Workflow and Code Review"}),"\n",(0,t.jsx)(n.h3,{id:"before-submitting-a-pr",children:"Before Submitting a PR"}),"\n",(0,t.jsx)(n.p,{children:"Run the full check suite from the monorepo root:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Recommended pre-PR check\nnpm run check          # typecheck + lint sequentially\nnpm run test           # all frontend tests\nnpm run build:check    # build + verify bundle size <3MB gzipped\n"})}),"\n",(0,t.jsx)(n.p,{children:"For backend changes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run check:backend  # Go lint + vet + build\nnpm run test:go        # Go tests\n"})}),"\n",(0,t.jsx)(n.p,{children:"For the complete CI suite (mirrors the GitHub Actions pipeline):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run ci             # lint, test, build, typecheck\n"})}),"\n",(0,t.jsx)(n.h3,{id:"commit-message-convention",children:"Commit Message Convention"}),"\n",(0,t.jsxs)(n.p,{children:["The project uses ",(0,t.jsx)(n.a,{href:"https://www.conventionalcommits.org/",children:"Conventional Commits"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"feat(firewall): add port-knocking rule editor\nfix(dhcp): handle empty lease table gracefully\ndocs(api-client): clarify codegen workflow\nchore(deps): update tanstack-router to 1.157\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Commitlint enforces this via ",(0,t.jsx)(n.code,{children:"@commitlint/cli"})," and ",(0,t.jsx)(n.code,{children:"@commitlint/config-conventional"})," in the Husky pre-commit hook."]}),"\n",(0,t.jsx)(n.h3,{id:"code-review-checklist",children:"Code Review Checklist"}),"\n",(0,t.jsx)(n.p,{children:"When reviewing frontend PRs, verify:"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","New components follow the three-layer architecture"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pattern components implement both Mobile and Desktop presenters"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","WCAG AAA contrast maintained (use ",(0,t.jsx)(n.code,{children:"@storybook/addon-a11y"})," to check)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","44px minimum touch targets on interactive elements"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Semantic tokens used (not primitive Tailwind colors)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","TypeScript passes with zero errors (",(0,t.jsx)(n.code,{children:"npm run typecheck"}),")"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Tests cover new business logic"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Bundle size not regressed (",(0,t.jsx)(n.code,{children:"npm run build:check"}),")"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","If ",(0,t.jsx)(n.code,{children:".graphql"})," files changed, codegen was re-run and committed"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"nx-affected-speed-up-ci",children:"Nx Affected (Speed Up CI)"}),"\n",(0,t.jsx)(n.p,{children:"When working on a feature branch, run only affected checks:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx nx affected -t build   # Build only what changed\nnpx nx affected -t test    # Test only what changed\nnpx nx affected -t lint    # Lint only what changed\n"})}),"\n",(0,t.jsx)(n.p,{children:"Nx computes affected projects based on the git diff against the base branch."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var r=s(14041);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);
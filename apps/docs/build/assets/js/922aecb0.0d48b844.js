"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[2171],{49458:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"translator-layer","title":"Translator Layer","description":"Bidirectional translation between GraphQL field names and RouterOS property names, with type conversion, SSH response parsing, and protocol-specific command formatting.","source":"@site/../backend/docs/translator-layer.md","sourceDirName":".","slug":"/translator-layer","permalink":"/docs/backend/translator-layer","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../backend/docs/translator-layer.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Service Orchestrator","permalink":"/docs/backend/service-orchestrator"},"next":{"title":"Validation Pipeline","permalink":"/docs/backend/validation-pipeline"}}');var t=n(31085),i=n(71184);const a={},o="Translator Layer",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Package Reference",id:"package-reference",level:2},{value:"<code>internal/translator</code>",id:"internaltranslator",level:3},{value:"Field Mapping Registry",id:"field-mapping-registry",level:4},{value:"Automatic Name Conversion",id:"automatic-name-conversion",level:4},{value:"Type Parsers (RouterOS \u2192 Go)",id:"type-parsers-routeros--go",level:4},{value:"Type Formatters (Go \u2192 RouterOS)",id:"type-formatters-go--routeros",level:4},{value:"Response Translator",id:"response-translator",level:4},{value:"Batch and Streaming Translators",id:"batch-and-streaming-translators",level:4},{value:"<code>internal/translator/formatters</code>",id:"internaltranslatorformatters",level:3},{value:"ProtocolFormatter Interface",id:"protocolformatter-interface",level:4},{value:"APIFormatter",id:"apiformatter",level:4},{value:"<code>internal/router/ssh</code>",id:"internalrouterssh",level:3},{value:"<code>internal/router/ssh/parser</code>",id:"internalroutersshparser",level:3},{value:"Parser Strategies and Priority",id:"parser-strategies-and-priority",level:4},{value:"Terse Parser (<code>terse_parser.go</code>)",id:"terse-parser-terse_parsergo",level:4},{value:"Table Parser (<code>table_parser.go</code>)",id:"table-parser-table_parsergo",level:4},{value:"Detail Parser (<code>detail_parser.go</code>)",id:"detail-parser-detail_parsergo",level:4},{value:"Key-Value Parser (<code>keyvalue_parser.go</code>)",id:"key-value-parser-keyvalue_parsergo",level:4},{value:"ParseResult and ParseWarning",id:"parseresult-and-parsewarning",level:4},{value:"ParseError (<code>errors.go</code>)",id:"parseerror-errorsgo",level:4},{value:"Data Flow Examples",id:"data-flow-examples",level:2},{value:"RouterOS \u2192 GraphQL (Read Path)",id:"routeros--graphql-read-path",level:3},{value:"GraphQL \u2192 RouterOS (Write Path)",id:"graphql--routeros-write-path",level:3},{value:"Cross-References",id:"cross-references",level:2}];function c(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"translator-layer",children:"Translator Layer"})}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"Bidirectional translation between GraphQL field names and RouterOS property names, with type conversion, SSH response parsing, and protocol-specific command formatting."}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Packages:"})," ",(0,t.jsx)(r.code,{children:"internal/translator/"}),", ",(0,t.jsx)(r.code,{children:"internal/translator/formatters/"}),", ",(0,t.jsx)(r.code,{children:"internal/router/ssh/"}),", ",(0,t.jsx)(r.code,{children:"internal/router/ssh/parser/"}),"\n",(0,t.jsx)(r.strong,{children:"Key Files:"})," ",(0,t.jsx)(r.code,{children:"translator/formatters/formatter.go"}),", ",(0,t.jsx)(r.code,{children:"translator/formatters/api_formatter.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/translator.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/parser/table_parser.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/parser/terse_parser.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/parser/detail_parser.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/parser/keyvalue_parser.go"}),", ",(0,t.jsx)(r.code,{children:"router/ssh/parser/errors.go"}),"\n",(0,t.jsx)(r.strong,{children:"Prerequisites:"})," [See: 04-router-communication.md \xa7Package Reference]"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(r.p,{children:"The translator layer sits between the GraphQL API and the RouterOS protocol adapters. Its purpose is to convert between two incompatible naming and type systems:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"GraphQL"})," uses camelCase field names and Go-native types (",(0,t.jsx)(r.code,{children:"bool"}),", ",(0,t.jsx)(r.code,{children:"int"}),", ",(0,t.jsx)(r.code,{children:"time.Duration"}),")"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"RouterOS"})," uses kebab-case property names and string-encoded values (",(0,t.jsx)(r.code,{children:'"yes"'}),"/",(0,t.jsx)(r.code,{children:'"no"'}),", ",(0,t.jsx)(r.code,{children:'"1d2h30m"'}),", ",(0,t.jsx)(r.code,{children:'"1500"'}),")"]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"The layer has two major sub-systems:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Field mapping and type conversion"})," (",(0,t.jsx)(r.code,{children:"internal/translator/"}),") \u2014 Translates field names and value types bidirectionally using a registry of explicit mappings with automatic camelCase\u2194kebab-case fallback."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"SSH response parsing"})," (",(0,t.jsx)(r.code,{children:"internal/router/ssh/parser/"}),") \u2014 Parses the four RouterOS CLI output formats (terse, table, detail, key-value) into structured records."]}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"GraphQL Resolver\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ResponseTranslator / BatchTranslator        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502           FieldMappingRegistry                   \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502   \u2502\n\u2502  \u2502  \u2502 Explicit maps  \u2502   \u2502 Auto camelCase\u2194kebab  \u2502 \u2502   \u2502\n\u2502  \u2502  \u2502 (macAddress \u2192  \u2502   \u2502 (txBytes \u2192 tx-bytes)  \u2502 \u2502   \u2502\n\u2502  \u2502  \u2502  mac-address)  \u2502   \u2502                        \u2502 \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502           Type Converters                        \u2502   \u2502\n\u2502  \u2502  Bool \u2502 Int \u2502 Duration \u2502 List \u2502 Size \u2502 MAC \u2502 IP  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502 CanonicalResponse\n                        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Protocol Formatters (FormatterRegistry)     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502REST Format \u2502  \u2502 API Format \u2502  \u2502   SSH Format     \u2502  \u2502\n\u2502   \u2502JSON payload\u2502  \u2502=key=value  \u2502  \u2502 CLI commands     \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502 raw bytes\n                        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              SSH Parser (SSHParserService)               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  Terse  \u2502 \u2502  Table  \u2502 \u2502  Detail  \u2502 \u2502KeyValue  \u2502   \u2502\n\u2502   \u2502priority1\u2502 \u2502priority2\u2502 \u2502priority3 \u2502 \u2502priority5 \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"package-reference",children:"Package Reference"}),"\n",(0,t.jsx)(r.h3,{id:"internaltranslator",children:(0,t.jsx)(r.code,{children:"internal/translator"})}),"\n",(0,t.jsx)(r.p,{children:"The core package for field name and type translation."}),"\n",(0,t.jsx)(r.h4,{id:"field-mapping-registry",children:"Field Mapping Registry"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// FieldMapping maps a single GraphQL field to its RouterOS equivalent.\ntype FieldMapping struct {\n    GraphQLField  string    // camelCase name used in GraphQL schema\n    MikroTikField string    // kebab-case name used by RouterOS\n    Path          string    // RouterOS resource path (e.g., "/interface")\n    Type          FieldType // Controls type conversion behavior\n}\n\n// FieldType determines how values are converted.\ntype FieldType string\n\nconst (\n    FieldTypeString   FieldType = "string"   // No conversion\n    FieldTypeInt      FieldType = "int"       // "1500" \u2192 int(1500)\n    FieldTypeBool     FieldType = "bool"      // "yes"/"no" \u2192 bool\n    FieldTypeDuration FieldType = "duration"  // "1d2h30m" \u2192 time.Duration\n    FieldTypeList     FieldType = "list"      // "a,b,c" \u2192 []string\n    FieldTypeMAC      FieldType = "mac"       // MAC address string (no conversion)\n    FieldTypeIP       FieldType = "ip"        // IP address string (no conversion)\n    FieldTypeSize     FieldType = "size"      // "1M" \u2192 int64(1048576)\n)\n\n// FieldMappingRegistry is the bidirectional field translation registry.\ntype FieldMappingRegistry struct { /* ... */ }\n\nfunc NewFieldMappingRegistry() *FieldMappingRegistry\nfunc (r *FieldMappingRegistry) Register(m *FieldMapping)\n\n// GraphQL \u2192 MikroTik lookup (global, not path-scoped)\nfunc (r *FieldMappingRegistry) GetMikroTikField(graphqlField string) (string, bool)\n\n// MikroTik \u2192 GraphQL lookup (path-scoped)\nfunc (r *FieldMappingRegistry) GetGraphQLField(path, mikrotikField string) (string, bool)\n\n// Full mapping lookup (path-scoped)\nfunc (r *FieldMappingRegistry) GetMapping(path, graphqlField string) (*FieldMapping, bool)\nfunc (r *FieldMappingRegistry) GetMappingsForPath(path string) map[string]*FieldMapping\n\n// TranslateFieldName converts a GraphQL field to RouterOS with fallback.\n// Falls back to automatic CamelToKebab() if no explicit mapping exists.\nfunc (r *FieldMappingRegistry) TranslateFieldName(graphqlField string) string\n'})}),"\n",(0,t.jsxs)(r.p,{children:["The registry is populated via ",(0,t.jsx)(r.code,{children:"BuildDefaultRegistry()"}),", which registers mappings for all known RouterOS paths including ",(0,t.jsx)(r.code,{children:"/interface"}),", ",(0,t.jsx)(r.code,{children:"/ip/address"}),", ",(0,t.jsx)(r.code,{children:"/system/resource"}),", and others."]}),"\n",(0,t.jsx)(r.h4,{id:"automatic-name-conversion",children:"Automatic Name Conversion"}),"\n",(0,t.jsx)(r.p,{children:"For fields without explicit mappings, the translator applies automatic conversion:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// CamelToKebab converts camelCase to kebab-case.\n// "macAddress" \u2192 "mac-address"\n// "txBytes"    \u2192 "tx-bytes"\n// "freeMemory" \u2192 "free-memory"\nfunc CamelToKebab(s string) string\n\n// KebabToCamel converts kebab-case to camelCase.\n// "mac-address" \u2192 "macAddress"\n// "tx-byte"     \u2192 "txByte"\n// ".id"         \u2192 "id"    (MikroTik internal field)\n// ".nextid"     \u2192 "nextid"\nfunc KebabToCamel(s string) string\n'})}),"\n",(0,t.jsxs)(r.p,{children:["Note: MikroTik internal fields prefixed with ",(0,t.jsx)(r.code,{children:"."})," (",(0,t.jsx)(r.code,{children:".id"}),", ",(0,t.jsx)(r.code,{children:".nextid"}),") have the dot stripped during conversion."]}),"\n",(0,t.jsx)(r.h4,{id:"type-parsers-routeros--go",children:"Type Parsers (RouterOS \u2192 Go)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// ParseMikroTikBool parses RouterOS boolean strings.\n// Input: "yes"/"no", "true"/"false", "YES"/"NO", "1"/"0"\n// Output: bool\nfunc ParseMikroTikBool(s string) bool\n\n// ParseMikroTikDuration parses RouterOS duration strings.\n// Input: "1d", "1h", "30m", "45s", "1d2h3m4s", "1w", "1w2d", "3600" (plain seconds)\n// Output: time.Duration\nfunc ParseMikroTikDuration(s string) (time.Duration, error)\n\n// ParseMikroTikList parses comma-separated lists.\n// Input: "a,b,c", " a , b , c " (whitespace trimmed)\n// Output: []string (nil for empty input)\nfunc ParseMikroTikList(s string) []string\n\n// ParseMikroTikSize parses size strings with K/M/G suffixes.\n// Input: "1024", "1K", "1M", "1G"\n// Output: int64 in bytes\nfunc ParseMikroTikSize(s string) (int64, error)\n'})}),"\n",(0,t.jsx)(r.h4,{id:"type-formatters-go--routeros",children:"Type Formatters (Go \u2192 RouterOS)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// FormatBool converts Go/string booleans to RouterOS format.\n// Input: true/"true"/"yes"/"1" \u2192 "yes"\n// Input: false/"false"/"no"/"0" \u2192 "no"\nfunc FormatBool(v interface{}) string\n\n// FormatDuration converts time.Duration or int (seconds) to RouterOS format.\n// Input: 25*time.Hour + 30*time.Minute \u2192 "1d1h30m"\n// Input: int(3600) \u2192 "1h"\nfunc FormatDuration(v interface{}) string\n\n// FormatList converts []string to comma-separated string.\n// Input: []string{"a","b","c"} \u2192 "a,b,c"\nfunc FormatList(v interface{}) string\n\n// FormatMikroTikValue formats any value according to its FieldType.\nfunc FormatMikroTikValue(v interface{}, ft FieldType) string\n'})}),"\n",(0,t.jsx)(r.h4,{id:"response-translator",children:"Response Translator"}),"\n",(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:"ResponseTranslator"})," takes a ",(0,t.jsx)(r.code,{children:"CanonicalResponse"})," from a protocol adapter and produces a GraphQL-ready response:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// ResponseTranslator converts RouterOS protocol responses to GraphQL format.\ntype ResponseTranslator struct { /* ... */ }\n\nfunc NewResponseTranslator(registry *FieldMappingRegistry) *ResponseTranslator\n\n// TranslateResponse converts a single response.\n// - Checks context for cancellation\n// - Passes error responses through unchanged\n// - For data responses: translates field names and converts value types\nfunc (t *ResponseTranslator) TranslateResponse(\n    ctx context.Context,\n    path string,\n    response *CanonicalResponse,\n) (*CanonicalResponse, error)\n\n// NormalizeRecord applies universal transformations to any record:\n// - ".id" field is renamed to "id"\n// - "disabled" bool/string is inverted and renamed to "enabled"\nfunc (t *ResponseTranslator) NormalizeRecord(record map[string]interface{}) map[string]interface{}\n\n// translateRecord translates a single RouterOS record.\n// Uses registry mappings first; falls back to auto-conversion.\n// Auto-detection attempts int, then bool conversion for unmapped fields.\nfunc (t *ResponseTranslator) translateRecord(path string, record map[string]interface{}) map[string]interface{}\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Key invariants:"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"disabled=yes"})," \u2192 ",(0,t.jsx)(r.code,{children:"enabled=false"})," (field renamed and value inverted)"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:".id=*1"})," \u2192 ",(0,t.jsx)(r.code,{children:"id=*1"})," (dot prefix stripped)"]}),"\n",(0,t.jsx)(r.li,{children:"Nil registry falls back gracefully to auto-conversion"}),"\n",(0,t.jsx)(r.li,{children:"Context cancellation returns an error immediately"}),"\n"]}),"\n",(0,t.jsx)(r.h4,{id:"batch-and-streaming-translators",children:"Batch and Streaming Translators"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"// BatchTranslator translates multiple responses in a single call.\ntype BatchTranslator struct { /* ... */ }\n\nfunc NewBatchTranslator(registry *FieldMappingRegistry) *BatchTranslator\n\n// TranslateBatch requires len(paths) == len(responses).\n// Respects context cancellation.\nfunc (bt *BatchTranslator) TranslateBatch(\n    ctx context.Context,\n    paths []string,\n    responses []*CanonicalResponse,\n) ([]*CanonicalResponse, error)\n\n// StreamingResponseTranslator translates a channel of responses.\ntype StreamingResponseTranslator struct { /* ... */ }\n\nfunc NewStreamingResponseTranslator(path string, registry *FieldMappingRegistry) *StreamingResponseTranslator\n\n// Translate translates a single response (for one-shot streaming events).\nfunc (srt *StreamingResponseTranslator) Translate(ctx context.Context, response *CanonicalResponse) (*CanonicalResponse, error)\n\n// TranslateChannel returns a new channel of translated responses.\n// Closes output channel when input closes or context is cancelled.\n// Nil responses from input produce error responses on output.\nfunc (srt *StreamingResponseTranslator) TranslateChannel(ctx context.Context, input <-chan *CanonicalResponse) <-chan *CanonicalResponse\n"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h3,{id:"internaltranslatorformatters",children:(0,t.jsx)(r.code,{children:"internal/translator/formatters"})}),"\n",(0,t.jsxs)(r.p,{children:["Protocol-specific command formatting. Converts ",(0,t.jsx)(r.code,{children:"CanonicalCommand"})," to protocol bytes and parses responses back."]}),"\n",(0,t.jsx)(r.h4,{id:"protocolformatter-interface",children:"ProtocolFormatter Interface"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"// ProtocolFormatter converts canonical commands to/from protocol-specific bytes.\ntype ProtocolFormatter interface {\n    Format(cmd *translator.CanonicalCommand) ([]byte, error)\n    Parse(response []byte) (*translator.CanonicalResponse, error)\n    Protocol() translator.Protocol\n}\n\n// FormatterRegistry holds all protocol formatters.\ntype FormatterRegistry struct { /* ... */ }\n\nfunc NewFormatterRegistry() *FormatterRegistry // Registers REST, API, SSH formatters\nfunc (r *FormatterRegistry) Register(f ProtocolFormatter)\nfunc (r *FormatterRegistry) Get(protocol translator.Protocol) (ProtocolFormatter, bool)\nfunc (r *FormatterRegistry) Format(protocol translator.Protocol, cmd *translator.CanonicalCommand) ([]byte, error)\nfunc (r *FormatterRegistry) Parse(protocol translator.Protocol, response []byte) (*translator.CanonicalResponse, error)\n"})}),"\n",(0,t.jsx)(r.h4,{id:"apiformatter",children:"APIFormatter"}),"\n",(0,t.jsx)(r.p,{children:"Handles the RouterOS Binary API protocol (port 8728/8729)."}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Format output:"})," A JSON-encoded ",(0,t.jsx)(r.code,{children:"APICommand"})," struct:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'type APICommand struct {\n    Command string   `json:"command"` // e.g., "/interface/ethernet/print"\n    Args    []string `json:"args"`    // e.g., ["=name=ether1", "?.id=*1"]\n}\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Action-to-verb mapping:"})}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Canonical Action"}),(0,t.jsx)(r.th,{children:"API Verb"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"print"}),", ",(0,t.jsx)(r.code,{children:"get"})]}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"print"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"add"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"add"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"set"}),", ",(0,t.jsx)(r.code,{children:"enable"}),", ",(0,t.jsx)(r.code,{children:"disable"})]}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"set"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"remove"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"remove"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"move"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"move"})})]})]})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Enable/Disable encoding:"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"ActionEnable"})," \u2192 ",(0,t.jsx)(r.code,{children:"=disabled=no"})]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"ActionDisable"})," \u2192 ",(0,t.jsx)(r.code,{children:"=disabled=yes"})]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Filter operators:"})}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Operator"}),(0,t.jsx)(r.th,{children:"API Syntax"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Equals"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"?field=value"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Greater"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"?field>value"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Less"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"?field<value"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Contains"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"?field~value"})," (regex)"]})]})]})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Parse behavior:"})}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:["First attempts JSON unmarshalling as ",(0,t.jsx)(r.code,{children:"APIResponse"})," (preferred path)"]}),"\n",(0,t.jsxs)(r.li,{children:["Falls back to parsing raw ",(0,t.jsx)(r.code,{children:"!re"}),"/",(0,t.jsx)(r.code,{children:"!done"}),"/",(0,t.jsx)(r.code,{children:"!trap"})," protocol lines"]}),"\n",(0,t.jsx)(r.li,{children:"Errors are categorized by RouterOS category code (0\u20135) and message content"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Error categorization:"})}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Category/Message Pattern"}),(0,t.jsx)(r.th,{children:"ErrorCategory"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:'"not found", "no such item"'}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"NotFound"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:'"already", "duplicate"'}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"Conflict"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:'"invalid", "bad"'}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"Validation"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Category 4 (login failure)"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"Permission"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"All others"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"Internal"})})]})]})]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h3,{id:"internalrouterssh",children:(0,t.jsx)(r.code,{children:"internal/router/ssh"})}),"\n",(0,t.jsxs)(r.p,{children:["SSH-specific translator that bridges between the ",(0,t.jsx)(r.code,{children:"router.RouterPort"})," command interface and the SSH parser."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"// Translator wraps the SSH parser service and normalizer.\ntype Translator struct {\n    parserService parser.SSHParserService\n    normalizer    *parser.Normalizer\n    converter     *parser.TypeConverter\n}\n\nfunc NewTranslator() *Translator\nfunc NewTranslatorWithConfig(config parser.ParserConfig) *Translator\n\n// ParseResponse parses raw SSH CLI output into router.CommandResult.\nfunc (t *Translator) ParseResponse(ctx context.Context, raw string, hints parser.ParseHints) (*router.CommandResult, error)\n\n// GetParseHintsFromCommand maps router.Command.Action to parser.CommandType.\nfunc GetParseHintsFromCommand(cmd router.Command) parser.ParseHints\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Action-to-CommandType mapping:"})}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"router.Command.Action"}),(0,t.jsx)(r.th,{children:"parser.CommandType"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"print"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandPrint"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"print detail"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandPrintDetail"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"print terse"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandPrintTerse"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"export"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandExport"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"export verbose"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandExportVerbose"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"get"'})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandGet"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"(any other)"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"CommandPrint"})})]})]})]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h3,{id:"internalroutersshparser",children:(0,t.jsx)(r.code,{children:"internal/router/ssh/parser"})}),"\n",(0,t.jsx)(r.p,{children:"The SSH parser sub-system detects the CLI output format automatically and dispatches to the appropriate strategy."}),"\n",(0,t.jsx)(r.h4,{id:"parser-strategies-and-priority",children:"Parser Strategies and Priority"}),"\n",(0,t.jsxs)(r.p,{children:["Four strategies compete to parse each response. The ",(0,t.jsx)(r.code,{children:"SSHParserService"})," tries them in priority order:"]}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Strategy"}),(0,t.jsx)(r.th,{children:"Priority"}),(0,t.jsx)(r.th,{children:"Trigger"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Terse"}),(0,t.jsx)(r.td,{children:"1"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"CommandPrintTerse"})," hint OR semicolon-separated ",(0,t.jsx)(r.code,{children:"key=value"})," pairs"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Table"}),(0,t.jsx)(r.td,{children:"2"}),(0,t.jsxs)(r.td,{children:["Flag definition line (",(0,t.jsx)(r.code,{children:"Flags: X - disabled"}),") OR ",(0,t.jsx)(r.code,{children:"#"})," header OR multiple uppercase column headers"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Detail"}),(0,t.jsx)(r.td,{children:"3"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"CommandPrintDetail"})," hint OR indented ",(0,t.jsx)(r.code,{children:"key=value"})," rows with continuation lines"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"KeyValue"}),(0,t.jsx)(r.td,{children:"5"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"CommandSystemResource"}),"/",(0,t.jsx)(r.code,{children:"CommandGet"})," hint OR \u22653 ",(0,t.jsx)(r.code,{children:"key: value"})," colon-separated lines"]})]})]})]}),"\n",(0,t.jsxs)(r.p,{children:["All strategies implement ",(0,t.jsx)(r.code,{children:"ParserStrategy"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"type ParserStrategy interface {\n    Name() string\n    Priority() int\n    CanParse(raw string, hints ParseHints) bool\n    Parse(ctx context.Context, raw string, hints ParseHints) (*ParseResult, error)\n}\n"})}),"\n",(0,t.jsxs)(r.p,{children:["All strategies respect context cancellation and pass the ",(0,t.jsx)(r.code,{children:"Normalizer"})," to normalize field names before returning resources."]}),"\n",(0,t.jsxs)(r.h4,{id:"terse-parser-terse_parsergo",children:["Terse Parser (",(0,t.jsx)(r.code,{children:"terse_parser.go"}),")"]}),"\n",(0,t.jsx)(r.p,{children:"RouterOS 6.43+ preferred format. Most reliable."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Input format:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:".id=*1;name=vpn-usa;listen-port=51820;mtu=1420;running=true\n.id=*2;name=vpn-eu;listen-port=51821;mtu=1420;running=true\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Each line is a single resource. Pairs are semicolon-separated ",(0,t.jsx)(r.code,{children:"key=value"}),". Quoted values (single or double) are supported and unquoted."]}),"\n",(0,t.jsxs)(r.h4,{id:"table-parser-table_parsergo",children:["Table Parser (",(0,t.jsx)(r.code,{children:"table_parser.go"}),")"]}),"\n",(0,t.jsx)(r.p,{children:"Fixed-width column format for list output."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Input format:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Flags: X - disabled, R - running\n #   NAME      LISTEN-PORT   MTU    RUNNING\n 0 R vpn-usa   51820         1420   true\n 1 R vpn-eu    51821         1420   true\n"})}),"\n",(0,t.jsx)(r.p,{children:"Row extraction steps:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:["Parse ",(0,t.jsx)(r.code,{children:"Flags:"})," line for flag character definitions"]}),"\n",(0,t.jsxs)(r.li,{children:["Locate header line (by uppercase words or ",(0,t.jsx)(r.code,{children:"#"})," prefix)"]}),"\n",(0,t.jsx)(r.li,{children:"Extract column positions using regex on header"}),"\n",(0,t.jsx)(r.li,{children:"For each data row: extract row number, flag characters, then column values by position"}),"\n",(0,t.jsx)(r.li,{children:"Fall back to whitespace splitting if position-based extraction yields no data"}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Flag characters:"})," ",(0,t.jsx)(r.code,{children:"X"})," (disabled), ",(0,t.jsx)(r.code,{children:"R"})," (running), ",(0,t.jsx)(r.code,{children:"D"})," (dynamic), ",(0,t.jsx)(r.code,{children:"I"})," (inactive), ",(0,t.jsx)(r.code,{children:"A"})," (active), ",(0,t.jsx)(r.code,{children:"C"})," (complete), ",(0,t.jsx)(r.code,{children:"S"})," (static), ",(0,t.jsx)(r.code,{children:"H"})," (hw-offload), ",(0,t.jsx)(r.code,{children:"P"})," (passive), ",(0,t.jsx)(r.code,{children:"B"})," (backup), ",(0,t.jsx)(r.code,{children:"M"})," (master), ",(0,t.jsx)(r.code,{children:"L"})," (log), ",(0,t.jsx)(r.code,{children:"E"})," (established)"]}),"\n",(0,t.jsxs)(r.h4,{id:"detail-parser-detail_parsergo",children:["Detail Parser (",(0,t.jsx)(r.code,{children:"detail_parser.go"}),")"]}),"\n",(0,t.jsxs)(r.p,{children:["Multi-line records for ",(0,t.jsx)(r.code,{children:"print detail"})," output."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Input format:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'0 R name="vpn-usa" listen-port=51820 mtu=1420 private-key="xxx"\n    running=true disabled=false\n\n1 R name="vpn-eu" listen-port=51821 mtu=1420 private-key="yyy"\n    running=true disabled=false\n'})}),"\n",(0,t.jsxs)(r.p,{children:["Row boundaries: Row start lines have \u22645 leading spaces and begin with a digit optionally followed by flag characters. Continuation lines have \u22654 leading spaces. A state machine handles quoted values (including ",(0,t.jsx)(r.code,{children:"="})," inside quotes)."]}),"\n",(0,t.jsxs)(r.h4,{id:"key-value-parser-keyvalue_parsergo",children:["Key-Value Parser (",(0,t.jsx)(r.code,{children:"keyvalue_parser.go"}),")"]}),"\n",(0,t.jsx)(r.p,{children:"Single-resource colon-separated format for system info commands."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Input format:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"uptime: 2w3d12h30m45s\nversion: 7.13.2 (stable)\nboard-name: RB4011iGS+5HacQ2HnD-IN\ncpu-load: 5\nfree-memory: 512.0MiB\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Produces a single resource from all ",(0,t.jsx)(r.code,{children:"key: value"})," pairs. Requires \u22653 valid key-value lines for format detection."]}),"\n",(0,t.jsx)(r.h4,{id:"parseresult-and-parsewarning",children:"ParseResult and ParseWarning"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'type ParseResult struct {\n    Resources []Resource         // []map[string]any, one per router item\n    Metadata  ParseMetadata\n    Warnings  []ParseWarning\n}\n\ntype ParseMetadata struct {\n    Format   OutputFormat // "terse", "table", "detail", "keyvalue"\n    RowCount int\n}\n\ntype ParseWarning struct {\n    Line    int\n    Message string\n    Code    WarnCode // WarnMalformedLine\n}\n'})}),"\n",(0,t.jsxs)(r.h4,{id:"parseerror-errorsgo",children:["ParseError (",(0,t.jsx)(r.code,{children:"errors.go"}),")"]}),"\n",(0,t.jsx)(r.p,{children:"Rich parse errors with diagnostic context:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"type ParseError struct {\n    Code        ErrorCode\n    Message     string\n    Command     string     // SSH command that produced the output\n    LineNumber  int        // 1-indexed\n    RawSnippet  string     // up to 500 chars of raw output\n    Cause       error\n    Suggestions []string   // troubleshooting hints\n}\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Error codes:"})}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Code"}),(0,t.jsx)(r.th,{children:"Meaning"}),(0,t.jsx)(r.th,{children:"Retryable"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"PARSE_TIMEOUT"})}),(0,t.jsx)(r.td,{children:"Parsing timed out"}),(0,t.jsx)(r.td,{children:"Yes"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"INVALID_FORMAT"})}),(0,t.jsx)(r.td,{children:"Could not detect format"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"UNKNOWN_COMMAND"})}),(0,t.jsx)(r.td,{children:"Command type not supported"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"PARTIAL_PARSE"})}),(0,t.jsx)(r.td,{children:"Some rows failed"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"OUTPUT_TOO_LARGE"})}),(0,t.jsx)(r.td,{children:"Output exceeds size limit"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"MALFORMED_TABLE"})}),(0,t.jsx)(r.td,{children:"Table header/column issue"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"MALFORMED_DETAIL"})}),(0,t.jsx)(r.td,{children:"Detail format quote/indent issue"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"MALFORMED_EXPORT"})}),(0,t.jsx)(r.td,{children:"Export format truncated"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"NO_MATCHING_PARSER"})}),(0,t.jsx)(r.td,{children:"No strategy matched"}),(0,t.jsx)(r.td,{children:"No"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"EMPTY_OUTPUT"})}),(0,t.jsx)(r.td,{children:"Router returned nothing"}),(0,t.jsx)(r.td,{children:"No"})]})]})]}),"\n",(0,t.jsxs)(r.p,{children:["Constructor functions include ",(0,t.jsx)(r.code,{children:"WithSuggestions()"})," and ",(0,t.jsx)(r.code,{children:"WithRawSnippet()"})," for building contextual errors."]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"data-flow-examples",children:"Data Flow Examples"}),"\n",(0,t.jsx)(r.h3,{id:"routeros--graphql-read-path",children:"RouterOS \u2192 GraphQL (Read Path)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'RouterOS output:  {"mac-address": "AA:BB:CC:DD:EE:FF", "mtu": "1500", "disabled": "no"}\n                                    \u2193 KebabToCamel + FieldMapping\nGraphQL response: {"macAddress": "AA:BB:CC:DD:EE:FF", "mtu": 1500, "enabled": true}\n'})}),"\n",(0,t.jsx)(r.h3,{id:"graphql--routeros-write-path",children:"GraphQL \u2192 RouterOS (Write Path)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'GraphQL input:    {"macAddress": "AA:BB:CC:DD:EE:FF", "mtu": 1500, "enabled": true}\n                                    \u2193 CamelToKebab + FormatMikroTikValue\nRouterOS command: {"mac-address": "AA:BB:CC:DD:EE:FF", "mtu": "1500", "disabled": "no"}\n'})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"[See: 04-router-communication.md \xa7Package Reference] \u2014 Router adapters that consume formatted commands and produce CanonicalResponse"}),"\n",(0,t.jsx)(r.li,{children:"[See: 03-graphql-api.md] \u2014 GraphQL resolvers that call ResponseTranslator"}),"\n",(0,t.jsx)(r.li,{children:"[See: 08-provisioning-engine.md] \u2014 Provisioning uses FieldMappingRegistry for config generation"}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},71184:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>o});var s=n(14041);const t={},i=s.createContext(t);function a(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);
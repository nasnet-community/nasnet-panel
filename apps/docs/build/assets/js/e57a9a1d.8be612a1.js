"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[32248],{25357:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"feature-alerts","title":"Feature Module: Alerts (libs/features/alerts)","description":"1. Overview","source":"@site/../../libs/features/docs/feature-alerts.md","sourceDirName":".","slug":"/feature-alerts","permalink":"/docs/features/feature-alerts","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/features/docs/feature-alerts.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Error Handling Architecture","permalink":"/docs/features/error-handling"},"next":{"title":"Feature: Dashboard (libs/features/dashboard)","permalink":"/docs/features/feature-dashboard"}}');var r=s(31085),l=s(71184);const i={},o="Feature Module: Alerts (libs/features/alerts)",d={},c=[{value:"1. Overview",id:"1-overview",level:2},{value:"Public import path",id:"public-import-path",level:3},{value:"2. Directory Tree",id:"2-directory-tree",level:2},{value:"3. Component Catalogue",id:"3-component-catalogue",level:2},{value:"3.1 Core Alert Components",id:"31-core-alert-components",level:3},{value:"3.2 Email Channel Forms",id:"32-email-channel-forms",level:3},{value:"3.3 Webhook Config Forms",id:"33-webhook-config-forms",level:3},{value:"3.4 Ntfy Channel Forms",id:"34-ntfy-channel-forms",level:3},{value:"3.5 Quiet Hours Components",id:"35-quiet-hours-components",level:3},{value:"3.6 Alert Template Components (NAS-18.12)",id:"36-alert-template-components-nas-1812",level:3},{value:"4. Desktop / Mobile Variants Summary",id:"4-desktop--mobile-variants-summary",level:2},{value:"5. Notification Channels",id:"5-notification-channels",level:2},{value:"6. Alert Rule Form and Schema",id:"6-alert-rule-form-and-schema",level:2},{value:"6.1 Main Schema (<code>schemas/alert-rule.schema.ts</code>)",id:"61-main-schema-schemasalert-ruleschemats",level:3},{value:"6.2 Alert Condition Schema",id:"62-alert-condition-schema",level:3},{value:"6.3 Throttle Config Schema",id:"63-throttle-config-schema",level:3},{value:"6.4 Quiet Hours Config Schema",id:"64-quiet-hours-config-schema",level:3},{value:"6.5 Severity Configuration",id:"65-severity-configuration",level:3},{value:"6.6 Common Event Types",id:"66-common-event-types",level:3},{value:"6.7 Default Alert Rule",id:"67-default-alert-rule",level:3},{value:"7. Quiet Hours Configuration",id:"7-quiet-hours-configuration",level:2},{value:"7.1 Data Shape",id:"71-data-shape",level:3},{value:"7.2 Component Composition",id:"72-component-composition",level:3},{value:"7.3 Headless Hook",id:"73-headless-hook",level:3},{value:"8. Alert Template System (NAS-18.12)",id:"8-alert-template-system-nas-1812",level:2},{value:"8.1 Template Categories",id:"81-template-categories",level:3},{value:"8.2 Template Schema (<code>schemas/alert-rule-template.schema.ts</code>)",id:"82-template-schema-schemasalert-rule-templateschemats",level:3},{value:"8.3 Template Variable Schema",id:"83-template-variable-schema",level:3},{value:"8.4 Apply Input Schema",id:"84-apply-input-schema",level:3},{value:"8.5 Template Apply Flow",id:"85-template-apply-flow",level:3},{value:"8.6 Import / Export",id:"86-import--export",level:3},{value:"8.7 useTemplateBrowser Hook",id:"87-usetemplatebrowser-hook",level:3},{value:"9. Hooks",id:"9-hooks",level:2},{value:"9.1 <code>useAlertNotifications</code>",id:"91-usealertnotifications",level:3},{value:"9.2 <code>useAlertRules</code>",id:"92-usealertrules",level:3},{value:"9.3 <code>useAlerts</code>",id:"93-usealerts",level:3},{value:"9.4 <code>useNotificationChannels</code>",id:"94-usenotificationchannels",level:3},{value:"9.5 Channel Form Hooks",id:"95-channel-form-hooks",level:3},{value:"9.6 <code>usePushoverUsage</code>",id:"96-usepushoverusage",level:3},{value:"9.7 <code>useAlertRuleTemplates</code>",id:"97-usealertruletemplates",level:3},{value:"10. Pages",id:"10-pages",level:2},{value:"<code>NotificationSettingsPage</code>",id:"notificationsettingspage",level:3},{value:"11. Dispatch Chain Overview",id:"11-dispatch-chain-overview",level:2},{value:"12. Schemas Summary",id:"12-schemas-summary",level:2},{value:"13. Cross-References",id:"13-cross-references",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsxs)(n.h1,{id:"feature-module-alerts-libsfeaturesalerts",children:["Feature Module: Alerts (",(0,r.jsx)(n.code,{children:"libs/features/alerts"}),")"]})}),"\n",(0,r.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"@nasnet/features/alerts"})," library is a Layer 3 domain feature module (NAS-18) that provides the complete frontend alert system for NasNetConnect. It covers:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Alert rules"})," \u2014 create, edit, delete, enable/disable rules that trigger on router events."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Alert notifications"})," \u2014 real-time delivery via GraphQL subscriptions, in-app badge, toast notifications, and sound."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Notification channels"})," \u2014 Email (SMTP), Telegram Bot, Pushover, Webhook (via a dedicated webhook configuration page), Ntfy.sh, and In-App."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Quiet hours"})," \u2014 time-windowed suppression of non-critical alerts with day-of-week and timezone selectors."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Alert templates"})," \u2014 a browseable gallery of pre-built alert rule templates (built-in and custom) with variable substitution, apply flow, import/export, and custom template persistence."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The module is kept strictly isolated from other feature modules. It imports only from ",(0,r.jsx)(n.code,{children:"@nasnet/ui"}),", ",(0,r.jsx)(n.code,{children:"@nasnet/core"}),", ",(0,r.jsx)(n.code,{children:"@nasnet/api-client"}),", and ",(0,r.jsx)(n.code,{children:"@nasnet/state"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"public-import-path",children:"Public import path"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import {\n  AlertBadge, AlertList, AlertRuleForm,\n  QuietHoursConfig, QueuedAlertBadge,\n  NtfyChannelForm, EmailChannelForm, WebhookConfigForm,\n  AlertTemplateBrowser, AlertTemplateApplyDialog,\n  NotificationSettingsPage,\n  alertRuleFormSchema, ntfyConfigSchema, webhookConfigSchema,\n  useAlertNotifications, useAlertRules, useAlerts,\n} from '@nasnet/features/alerts';\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-directory-tree",children:"2. Directory Tree"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"libs/features/alerts/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 index.ts                              # Public barrel export (200 lines)\n\u2502   \u251c\u2500\u2500 components/\n\u2502   \u2502   \u251c\u2500\u2500 AlertBadge.tsx                    # Header notification count badge\n\u2502   \u2502   \u251c\u2500\u2500 AlertList.tsx                     # Paginated list of alert events\n\u2502   \u2502   \u251c\u2500\u2500 AlertRuleForm.tsx                 # Full rule creation/edit form\n\u2502   \u2502   \u251c\u2500\u2500 InAppNotificationPreferences.tsx  # User preferences for in-app notifications\n\u2502   \u2502   \u251c\u2500\u2500 QueuedAlertBadge.tsx              # Queued / quiet-hours bypass indicator\n\u2502   \u2502   \u251c\u2500\u2500 EmailChannelForm.tsx              # Dispatcher for email form\n\u2502   \u2502   \u251c\u2500\u2500 EmailChannelFormDesktop.tsx       # Desktop SMTP config form\n\u2502   \u2502   \u251c\u2500\u2500 EmailChannelFormMobile.tsx        # Mobile SMTP config form\n\u2502   \u2502   \u251c\u2500\u2500 WebhookConfigForm.tsx             # Dispatcher for webhook form\n\u2502   \u2502   \u251c\u2500\u2500 WebhookConfigFormDesktop.tsx      # Desktop webhook form\n\u2502   \u2502   \u251c\u2500\u2500 WebhookConfigFormMobile.tsx       # Mobile webhook form\n\u2502   \u2502   \u251c\u2500\u2500 ChannelForms/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 NtfyChannelForm.tsx           # Dispatcher for ntfy form\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 NtfyChannelFormDesktop.tsx    # Desktop ntfy config form\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 NtfyChannelFormMobile.tsx     # Mobile ntfy config form\n\u2502   \u2502   \u251c\u2500\u2500 QuietHoursConfig/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 types.ts                      # QuietHoursConfigProps, QuietHoursConfigData, DayOfWeek\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 QuietHoursConfig.tsx          # Platform dispatcher\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 QuietHoursConfig.Desktop.tsx  # Desktop 2-column grid layout\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 QuietHoursConfig.Mobile.tsx   # Mobile single-column layout\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 DayOfWeekSelector.tsx         # Toggle buttons Mon-Sun\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TimeRangeInput.tsx            # HH:MM start/end time inputs\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TimezoneSelector.tsx          # IANA timezone combobox\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 useQuietHoursConfig.ts        # Headless logic hook\n\u2502   \u2502   \u2514\u2500\u2500 alert-templates/\n\u2502   \u2502       \u251c\u2500\u2500 index.ts\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateBrowser.tsx      # Platform-adaptive gallery (NAS-18.12)\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateBrowserNew.tsx   # Alternate new-style browser variant\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateBrowserDesktop.tsx\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateBrowserMobile.tsx\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateDetailPanel.tsx  # Right-side detail panel for selected template\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateVariableInputForm.tsx # Variable value form for apply\n\u2502   \u2502       \u251c\u2500\u2500 AlertTemplateApplyDialog.tsx  # Apply flow dialog\n\u2502   \u2502       \u251c\u2500\u2500 SaveTemplateDialog.tsx        # Save current rule as custom template\n\u2502   \u2502       \u251c\u2500\u2500 ImportTemplateDialog.tsx      # Import JSON template file\n\u2502   \u2502       \u251c\u2500\u2500 ExportTemplateDialog.tsx      # Download template as JSON\n\u2502   \u2502       \u2514\u2500\u2500 useTemplateBrowser.ts         # Headless hook for browser state\n\u2502   \u251c\u2500\u2500 hooks/\n\u2502   \u2502   \u251c\u2500\u2500 useAlerts.ts                      # useAlerts, useAcknowledgeAlert, useUnacknowledgedAlertCount\n\u2502   \u2502   \u251c\u2500\u2500 useAlertRules.ts                  # CRUD hooks for alert rules\n\u2502   \u2502   \u251c\u2500\u2500 useAlertRuleTemplates.ts          # Template CRUD + apply/import/export\n\u2502   \u2502   \u251c\u2500\u2500 useAlertNotifications.ts          # Real-time subscription + store + toast + sound\n\u2502   \u2502   \u251c\u2500\u2500 useNotificationChannels.ts        # Test and manage channel configurations\n\u2502   \u2502   \u251c\u2500\u2500 useEmailChannelForm.ts            # RHF headless hook for email form\n\u2502   \u2502   \u251c\u2500\u2500 useWebhookConfigForm.ts           # RHF headless hook for webhook form\n\u2502   \u2502   \u251c\u2500\u2500 useNtfyChannelForm.ts             # RHF headless hook for ntfy form\n\u2502   \u2502   \u2514\u2500\u2500 usePushoverUsage.ts              # Pushover monthly message quota tracker\n\u2502   \u251c\u2500\u2500 pages/\n\u2502   \u2502   \u2514\u2500\u2500 NotificationSettingsPage.tsx      # Full notification configuration page\n\u2502   \u251c\u2500\u2500 schemas/\n\u2502   \u2502   \u251c\u2500\u2500 alert-rule.schema.ts              # alertRuleFormSchema, COMMON_EVENT_TYPES, NOTIFICATION_CHANNELS\n\u2502   \u2502   \u251c\u2500\u2500 alert-rule-template.schema.ts     # alertRuleTemplateSchema, variable types, apply input\n\u2502   \u2502   \u251c\u2500\u2500 email-config.schema.ts            # emailConfigSchema, SMTP_PORT_PRESETS\n\u2502   \u2502   \u251c\u2500\u2500 ntfy-config.schema.ts             # ntfyConfigSchema, priority presets\n\u2502   \u2502   \u2514\u2500\u2500 webhook.schema.ts                 # webhookConfigSchema, AUTH_TYPE_OPTIONS, template presets\n\u2502   \u251c\u2500\u2500 utils/\n\u2502   \u2502   \u2514\u2500\u2500 alert-template-categories.ts     # ALERT_TEMPLATE_CATEGORIES, getCategoryMeta, getAllCategories\n\u2502   \u2514\u2500\u2500 __test-utils__/\n\u2502       \u2514\u2500\u2500 alert-rule-template-fixtures.ts  # Shared test fixtures for template specs\n\u251c\u2500\u2500 test-setup.ts\n\u251c\u2500\u2500 vitest.config.ts\n\u251c\u2500\u2500 tsconfig.json\n\u2514\u2500\u2500 project.json\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-component-catalogue",children:"3. Component Catalogue"}),"\n",(0,r.jsx)(n.h3,{id:"31-core-alert-components",children:"3.1 Core Alert Components"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertBadge"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/AlertBadge.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:['Displays count of unacknowledged alerts in the app header. Hides when count is 0; shows "99+" when count exceeds 99. Subscribes via ',(0,r.jsx)(n.code,{children:"useUnacknowledgedAlertCount"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertList"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/AlertList.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:'Paginated list of alert events with severity icons, timestamps, acknowledge actions, and "mark all as read"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertRuleForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/AlertRuleForm.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Full rule creation and edit form (name, eventType, conditions, severity, channels, throttle, quietHours). Built with React Hook Form + ",(0,r.jsx)(n.code,{children:"alertRuleFormSchema"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"InAppNotificationPreferences"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/InAppNotificationPreferences.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:"Preferences panel for in-app notification settings (enabled, severity filter, sound on/off, auto-dismiss duration)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QueuedAlertBadge"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QueuedAlertBadge.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:['Shows either a "Queued until HH',":MM",'" countdown badge (blue) or a "Bypassed quiet hours" badge (amber) for critical alerts during quiet hours. Renders ',(0,r.jsx)(n.code,{children:"null"})," when neither prop is set."]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"32-email-channel-forms",children:"3.2 Email Channel Forms"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/EmailChannelForm.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:"Platform dispatcher \u2014 renders Desktop or Mobile variant"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/EmailChannelFormDesktop.tsx"})}),(0,r.jsx)(n.td,{children:"Desktop"}),(0,r.jsxs)(n.td,{children:["Two-column SMTP config form (host, port, user, pass, TLS, from, to[]); uses ",(0,r.jsx)(n.code,{children:"useEmailChannelForm"})," headless hook"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/EmailChannelFormMobile.tsx"})}),(0,r.jsx)(n.td,{children:"Mobile"}),(0,r.jsx)(n.td,{children:"Single-column stacked SMTP form with 44px inputs"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"33-webhook-config-forms",children:"3.3 Webhook Config Forms"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/WebhookConfigForm.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:"Dispatcher for webhook configuration form"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/WebhookConfigFormDesktop.tsx"})}),(0,r.jsx)(n.td,{children:"Desktop"}),(0,r.jsx)(n.td,{children:"Full webhook form: name, HTTPS URL, auth type (None/Basic/Bearer), template preset (Generic/Slack/Discord/Teams/Custom), custom JSON template, custom headers, HMAC signing secret, timeout, retries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/WebhookConfigFormMobile.tsx"})}),(0,r.jsx)(n.td,{children:"Mobile"}),(0,r.jsx)(n.td,{children:"Simplified mobile webhook form; advanced fields collapsed behind an accordion"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"34-ntfy-channel-forms",children:"3.4 Ntfy Channel Forms"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/ChannelForms/NtfyChannelForm.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:"Dispatcher for ntfy form"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/ChannelForms/NtfyChannelFormDesktop.tsx"})}),(0,r.jsx)(n.td,{children:"Desktop"}),(0,r.jsx)(n.td,{children:"Ntfy server URL, topic, optional auth (user/pass), priority (1-5), tags"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/ChannelForms/NtfyChannelFormMobile.tsx"})}),(0,r.jsx)(n.td,{children:"Mobile"}),(0,r.jsx)(n.td,{children:"Same fields in single-column mobile layout"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"35-quiet-hours-components",children:"3.5 Quiet Hours Components"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/QuietHoursConfig.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Platform dispatcher using ",(0,r.jsx)(n.code,{children:"usePlatform()"})," \u2014 selects Desktop or Mobile variant"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig.Desktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/QuietHoursConfig.Desktop.tsx"})}),(0,r.jsx)(n.td,{children:"Desktop"}),(0,r.jsx)(n.td,{children:"2-column grid: start/end time on left, day-of-week and timezone on right; bypass-critical toggle"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig.Mobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/QuietHoursConfig.Mobile.tsx"})}),(0,r.jsx)(n.td,{children:"Mobile"}),(0,r.jsx)(n.td,{children:"Single-column stacked form with 44px touch targets"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DayOfWeekSelector"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/DayOfWeekSelector.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["7 toggle buttons (Mon-Sun) using ",(0,r.jsx)(n.code,{children:"DayOfWeek"})," = ",(0,r.jsx)(n.code,{children:"0-6"})," (0 = Sunday). Multiple selections allowed."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"TimeRangeInput"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/TimeRangeInput.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Two HH",":MM"," text inputs for startTime and endTime; validates against `TIME_FORMAT_PATTERN = /^([0-1][0-9]"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"TimezoneSelector"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/QuietHoursConfig/TimezoneSelector.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Searchable combobox over IANA timezone list (e.g., ",(0,r.jsx)(n.code,{children:"America/New_York"}),")"]})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"QuietHoursConfig"})," uses a headless hook ",(0,r.jsx)(n.code,{children:"useQuietHoursConfig"})," for all business logic."]}),"\n",(0,r.jsx)(n.h3,{id:"36-alert-template-components-nas-1812",children:"3.6 Alert Template Components (NAS-18.12)"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowser"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateBrowser.tsx"})}),(0,r.jsx)(n.td,{children:"Adaptive"}),(0,r.jsxs)(n.td,{children:["Composes Layer 2 ",(0,r.jsx)(n.code,{children:"TemplateGallery"})," with alert-specific data from ",(0,r.jsx)(n.code,{children:"useAlertRuleTemplates"})," query; handles apply mutation with toast feedback"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowserNew"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateBrowserNew.tsx"})}),(0,r.jsx)(n.td,{children:"Adaptive"}),(0,r.jsx)(n.td,{children:"Alternate newer-style browser variant with updated filtering UI"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowserDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateBrowserDesktop.tsx"})}),(0,r.jsx)(n.td,{children:"Desktop"}),(0,r.jsx)(n.td,{children:"Desktop-specific template gallery layout with side-by-side list and detail panel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowserMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateBrowserMobile.tsx"})}),(0,r.jsx)(n.td,{children:"Mobile"}),(0,r.jsx)(n.td,{children:"Full-screen template list with detail sheet on selection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateDetailPanel"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateDetailPanel.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:'Right-panel showing template name, description, category badge, severity, conditions, variables list, and "Apply" CTA'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateVariableInputForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateVariableInputForm.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Dynamic form generated from template ",(0,r.jsx)(n.code,{children:"variables[]"}),"; each variable maps to a typed input (STRING, INTEGER, DURATION, PERCENTAGE)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateApplyDialog"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/AlertTemplateApplyDialog.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Modal dialog that composes ",(0,r.jsx)(n.code,{children:"AlertTemplateVariableInputForm"}),"; on submit calls ",(0,r.jsx)(n.code,{children:"useApplyAlertRuleTemplate"})," mutation"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SaveTemplateDialog"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/SaveTemplateDialog.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["Dialog to snapshot an existing alert rule as a named custom template; calls ",(0,r.jsx)(n.code,{children:"useSaveCustomAlertRuleTemplate"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ImportTemplateDialog"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/ImportTemplateDialog.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsxs)(n.td,{children:["File-upload dialog that accepts a JSON template file; validates against ",(0,r.jsx)(n.code,{children:"alertRuleTemplateImportSchema"})," before calling ",(0,r.jsx)(n.code,{children:"useImportAlertRuleTemplate"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ExportTemplateDialog"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"components/alert-templates/ExportTemplateDialog.tsx"})}),(0,r.jsx)(n.td,{children:"Shared"}),(0,r.jsx)(n.td,{children:"Download dialog that serializes a template to JSON and triggers a browser download"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-desktop--mobile-variants-summary",children:"4. Desktop / Mobile Variants Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Domain"}),(0,r.jsx)(n.th,{children:"Desktop Component"}),(0,r.jsx)(n.th,{children:"Mobile Component"}),(0,r.jsx)(n.th,{children:"Dispatcher"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Email channel"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelForm"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Webhook config"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigForm"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ntfy channel"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelFormDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelFormMobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelForm"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Quiet hours"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig.Desktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig.Mobile"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Template browser"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowserDesktop"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AlertTemplateBrowserMobile"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"AlertTemplateBrowser"})," (via ",(0,r.jsx)(n.code,{children:"TemplateGallery"}),")"]})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["All dispatchers use ",(0,r.jsx)(n.code,{children:"usePlatform()"})," from ",(0,r.jsx)(n.code,{children:"@nasnet/ui/layouts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// QuietHoursConfig.tsx \u2014 canonical example\nconst platform = usePlatform();\nswitch (platform) {\n  case 'mobile': return <QuietHoursConfigMobile {...props} />;\n  case 'tablet':\n  case 'desktop':\n  default: return <QuietHoursConfigDesktop {...props} />;\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-notification-channels",children:"5. Notification Channels"}),"\n",(0,r.jsx)(n.p,{children:"The system supports six delivery channels:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Channel"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Config Schema"}),(0,r.jsx)(n.th,{children:"Form Component"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"In-App"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inapp"})}),(0,r.jsx)(n.td,{children:"(Zustand store)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"InAppNotificationPreferences"})}),(0,r.jsx)(n.td,{children:"Always enabled; no external config required. Delivered via subscription + Zustand store + toast."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Email"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"email"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"emailConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"EmailChannelForm"})}),(0,r.jsx)(n.td,{children:"SMTP-based email delivery; supports TLS, multiple recipients, preset port configs"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Telegram"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"telegram"})}),(0,r.jsxs)(n.td,{children:["Inline in ",(0,r.jsx)(n.code,{children:"NotificationSettingsPage"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"TelegramChannelForm"})," (inline)"]}),(0,r.jsx)(n.td,{children:"Bot token + one or more Chat IDs (numeric user/group or @channel username)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Pushover"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pushover"})}),(0,r.jsxs)(n.td,{children:["Inline in ",(0,r.jsx)(n.code,{children:"NotificationSettingsPage"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PushoverChannelForm"})," (inline)"]}),(0,r.jsx)(n.td,{children:"User Key + API Token + optional device name; shows monthly usage quota bar"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Webhook"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"webhook"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"webhookConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"WebhookConfigForm"})}),(0,r.jsx)(n.td,{children:"HTTPS-only; supports Basic/Bearer auth, presets (Slack/Discord/Teams), HMAC signing, custom headers, retries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ntfy"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ntfy"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ntfyConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NtfyChannelForm"})}),(0,r.jsx)(n.td,{children:"Push notifications via ntfy.sh (or self-hosted); topic-based routing with priority 1-5"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"NOTIFICATION_CHANNELS"})," constant in ",(0,r.jsx)(n.code,{children:"alert-rule.schema.ts"})," lists all channels with display labels and icon identifiers:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const NOTIFICATION_CHANNELS = [\n  { value: 'inapp', label: 'In-App Notifications', icon: 'Bell' },\n  { value: 'email', label: 'Email', icon: 'Mail' },\n  { value: 'telegram', label: 'Telegram', icon: 'MessageCircle' },\n  { value: 'pushover', label: 'Pushover', icon: 'Smartphone' },\n  { value: 'webhook', label: 'Webhook', icon: 'Webhook' },\n] as const;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-alert-rule-form-and-schema",children:"6. Alert Rule Form and Schema"}),"\n",(0,r.jsxs)(n.h3,{id:"61-main-schema-schemasalert-ruleschemats",children:["6.1 Main Schema (",(0,r.jsx)(n.code,{children:"schemas/alert-rule.schema.ts"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const alertRuleFormSchema = z.object({\n  name: z.string().min(1).max(100),\n  description: z.string().max(500).optional(),\n  eventType: z.string().min(1),    // e.g., 'device.offline', 'interface.down'\n  conditions: z.array(alertConditionSchema).min(1).max(10),\n  severity: z.enum(['CRITICAL', 'WARNING', 'INFO']),\n  channels: z.array(z.string()).min(1).max(5),\n  throttle: throttleConfigSchema.optional(),\n  quietHours: quietHoursConfigSchema.optional(),\n  deviceId: z.string().optional(),\n  enabled: z.boolean().default(true),\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"62-alert-condition-schema",children:"6.2 Alert Condition Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const alertConditionSchema = z.object({\n  field: z.string().min(1),     // field to monitor, e.g., 'cpu_usage'\n  operator: z.enum([\n    'EQUALS', 'NOT_EQUALS', 'GREATER_THAN', 'LESS_THAN', 'CONTAINS', 'REGEX'\n  ]),\n  value: z.string().min(1),     // comparison value, e.g., '80'\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Constraints"}),": min 1, max 10 conditions per rule."]}),"\n",(0,r.jsx)(n.h3,{id:"63-throttle-config-schema",children:"6.3 Throttle Config Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const throttleConfigSchema = z.object({\n  maxAlerts: z.number().int().min(1),          // max alerts per period\n  periodSeconds: z.number().int().min(60),     // period minimum 60 seconds\n  groupByField: z.string().optional(),\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"64-quiet-hours-config-schema",children:"6.4 Quiet Hours Config Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const quietHoursConfigSchema = z.object({\n  startTime: z.string().regex(/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/),  // HH:MM\n  endTime: z.string().regex(/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/),    // HH:MM\n  timezone: z.string().min(1),         // IANA timezone\n  bypassCritical: z.boolean().default(true),\n  daysOfWeek: z.array(z.number().int().min(0).max(6)).min(1),        // 0=Sunday\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"65-severity-configuration",children:"6.5 Severity Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const SEVERITY_CONFIG = {\n  CRITICAL: { label: 'Critical', color: 'semantic.error',   badgeClass: 'bg-error text-white'   },\n  WARNING:  { label: 'Warning',  color: 'semantic.warning', badgeClass: 'bg-warning text-white' },\n  INFO:     { label: 'Info',     color: 'semantic.info',    badgeClass: 'bg-info text-white'    },\n} as const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"66-common-event-types",children:"6.6 Common Event Types"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"COMMON_EVENT_TYPES"})," provides autocomplete suggestions for the ",(0,r.jsx)(n.code,{children:"eventType"})," field:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"'device.offline' | 'device.online' | 'device.cpu.high' | 'device.memory.high'\n'device.disk.full' | 'interface.down' | 'interface.up' | 'interface.traffic.high'\n'vpn.tunnel.down' | 'vpn.tunnel.up' | 'dhcp.lease.exhausted'\n'firewall.attack.detected' | 'backup.failed' | 'update.available'\n"})}),"\n",(0,r.jsx)(n.h3,{id:"67-default-alert-rule",children:"6.7 Default Alert Rule"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const defaultAlertRule: Partial<AlertRuleFormData> = {\n  name: '',\n  description: '',\n  eventType: '',\n  conditions: [{ field: '', operator: 'EQUALS', value: '' }],\n  severity: 'WARNING',\n  channels: ['inapp'],\n  enabled: true,\n};\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-quiet-hours-configuration",children:"7. Quiet Hours Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"71-data-shape",children:"7.1 Data Shape"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'interface QuietHoursConfigData {\n  startTime: string;         // "HH:MM" e.g., "22:00"\n  endTime: string;           // "HH:MM" e.g., "08:00"\n  timezone: string;          // IANA e.g., "America/New_York"\n  bypassCritical: boolean;   // true = CRITICAL alerts bypass quiet hours\n  daysOfWeek: number[];      // 0=Sunday, 1=Monday, ..., 6=Saturday\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"72-component-composition",children:"7.2 Component Composition"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"QuietHoursConfig (dispatcher)\n  \u251c\u2500\u2500 QuietHoursConfig.Desktop\n  \u2502     \u251c\u2500\u2500 TimeRangeInput (startTime, endTime)\n  \u2502     \u251c\u2500\u2500 DayOfWeekSelector (0-6 toggle buttons)\n  \u2502     \u251c\u2500\u2500 TimezoneSelector (IANA combobox)\n  \u2502     \u2514\u2500\u2500 Checkbox (bypassCritical)\n  \u2514\u2500\u2500 QuietHoursConfig.Mobile\n        \u2514\u2500\u2500 (same sub-components, single-column layout)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"73-headless-hook",children:"7.3 Headless Hook"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useQuietHoursConfig"})," encapsulates all business logic including:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Local state management for the form values"}),"\n",(0,r.jsxs)(n.li,{children:["Validation using ",(0,r.jsx)(n.code,{children:"quietHoursConfigSchema"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onChange"})," callback propagation to parent"]}),"\n",(0,r.jsx)(n.li,{children:"Day-of-week toggle handlers"}),"\n",(0,r.jsxs)(n.li,{children:["Cross-midnight range validation (if ",(0,r.jsx)(n.code,{children:"endTime < startTime"}),", the window spans midnight)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-alert-template-system-nas-1812",children:"8. Alert Template System (NAS-18.12)"}),"\n",(0,r.jsx)(n.h3,{id:"81-template-categories",children:"8.1 Template Categories"}),"\n",(0,r.jsxs)(n.p,{children:["Seven categories are defined in ",(0,r.jsx)(n.code,{children:"utils/alert-template-categories.ts"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Category"}),(0,r.jsx)(n.th,{children:"ID"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Icon"}),(0,r.jsx)(n.th,{children:"Color"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NETWORK"})}),(0,r.jsx)(n.td,{children:"Connectivity, device status, interface monitoring"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"network"})}),(0,r.jsx)(n.td,{children:"Blue"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Security"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SECURITY"})}),(0,r.jsx)(n.td,{children:"Firewall events, intrusion detection"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"shield"})}),(0,r.jsx)(n.td,{children:"Red"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resources"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"RESOURCES"})}),(0,r.jsx)(n.td,{children:"CPU, memory, disk usage"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cpu"})}),(0,r.jsx)(n.td,{children:"Orange"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"VPN"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"VPN"})}),(0,r.jsx)(n.td,{children:"Tunnel status, connection failures"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lock"})}),(0,r.jsx)(n.td,{children:"Green"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"DHCP"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DHCP"})}),(0,r.jsx)(n.td,{children:"Pool exhaustion, lease conflicts"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"server"})}),(0,r.jsx)(n.td,{children:"Purple"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"System"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SYSTEM"})}),(0,r.jsx)(n.td,{children:"Updates, backups, configuration changes"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"settings"})}),(0,r.jsx)(n.td,{children:"Gray"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Custom"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CUSTOM"})}),(0,r.jsx)(n.td,{children:"User-created templates"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"star"})}),(0,r.jsx)(n.td,{children:"Amber"})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"82-template-schema-schemasalert-rule-templateschemats",children:["8.2 Template Schema (",(0,r.jsx)(n.code,{children:"schemas/alert-rule-template.schema.ts"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const alertRuleTemplateSchema = z.object({\n  id: z.string().min(1),\n  name: z.string().min(1).max(100),\n  description: z.string().min(1).max(500),\n  category: z.enum(['NETWORK', 'SECURITY', 'RESOURCES', 'VPN', 'DHCP', 'SYSTEM', 'CUSTOM']),\n  eventType: z.string().regex(/^[a-z]+\\.[a-z_]+$/),\n  severity: z.enum(['CRITICAL', 'WARNING', 'INFO']),\n  conditions: z.array(alertConditionSchema).min(1),\n  channels: z.array(z.string()).min(1).max(5),\n  throttle: throttleConfigSchema.optional(),\n  variables: z.array(alertRuleTemplateVariableSchema).default([]),\n  isBuiltIn: z.boolean().default(false),\n  version: z.string().default('1.0.0'),\n  createdAt: z.string().datetime().optional(),\n  updatedAt: z.string().datetime().optional(),\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"83-template-variable-schema",children:"8.3 Template Variable Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const alertRuleTemplateVariableSchema = z.object({\n  name: z.string()\n    .regex(/^[A-Z][A-Z0-9_]*$/, 'UPPER_SNAKE_CASE required'),  // e.g., CPU_THRESHOLD\n  label: z.string().min(1).max(100),\n  type: z.enum(['STRING', 'INTEGER', 'DURATION', 'PERCENTAGE']),\n  required: z.boolean().default(true),\n  defaultValue: z.string().optional(),\n  min: z.number().int().optional(),\n  max: z.number().int().optional(),\n  unit: z.string().max(20).optional(),     // e.g., '%', 'ms', 'seconds'\n  description: z.string().max(500).optional(),\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Variable names in condition values use ",(0,r.jsx)(n.code,{children:"{{VARIABLE_NAME}}"})," substitution syntax. The ",(0,r.jsx)(n.code,{children:"extractVariablesFromConditions"})," helper (in the schema file) scans condition values for ",(0,r.jsx)(n.code,{children:"{{...}}"})," references and validates they are all defined in the variables array."]}),"\n",(0,r.jsx)(n.h3,{id:"84-apply-input-schema",children:"8.4 Apply Input Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const applyAlertRuleTemplateInputSchema = z.object({\n  templateId: z.string().min(1),\n  variables: z.record(\n    z.string().regex(/^[A-Z][A-Z0-9_]*/),\n    z.union([z.string(), z.number()])\n  ),\n  customizations: z.object({\n    name: z.string().optional(),\n    description: z.string().optional(),\n    deviceId: z.string().optional(),\n    enabled: z.boolean().default(true),\n  }).optional(),\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"85-template-apply-flow",children:"8.5 Template Apply Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'User clicks "Apply" in AlertTemplateDetailPanel\n  \u2514\u2500> AlertTemplateApplyDialog opens\n        \u2514\u2500> AlertTemplateVariableInputForm (dynamic form)\n              \u2514\u2500> User fills in variable values\n                    \u2514\u2500> Submit \u2192 useApplyAlertRuleTemplate mutation\n                          \u2514\u2500> Apollo GraphQL mutation: applyAlertRuleTemplate\n                                \u2514\u2500> Backend creates alert rule with resolved conditions\n                                      \u2514\u2500> toast.success("Alert rule created")\n                                            \u2514\u2500> onRuleCreated(ruleId) callback\n'})}),"\n",(0,r.jsx)(n.h3,{id:"86-import--export",children:"8.6 Import / Export"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Import"}),": ",(0,r.jsx)(n.code,{children:"ImportTemplateDialog"})," accepts a JSON file. The content is parsed and validated against ",(0,r.jsx)(n.code,{children:"alertRuleTemplateImportSchema"})," (which is ",(0,r.jsx)(n.code,{children:"alertRuleTemplateSchema"})," minus ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"isBuiltIn"}),", ",(0,r.jsx)(n.code,{children:"createdAt"}),", and ",(0,r.jsx)(n.code,{children:"updatedAt"}),"). On validation success, ",(0,r.jsx)(n.code,{children:"useImportAlertRuleTemplate"})," mutation is called."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Export"}),": ",(0,r.jsx)(n.code,{children:"ExportTemplateDialog"})," serializes the template to JSON and triggers a browser file download via the ",(0,r.jsx)(n.code,{children:"Blob"})," + ",(0,r.jsx)(n.code,{children:"URL.createObjectURL"})," pattern."]}),"\n",(0,r.jsx)(n.h3,{id:"87-usetemplatebrowser-hook",children:"8.7 useTemplateBrowser Hook"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useTemplateBrowser"})," provides all headless state for the template browser:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"interface UseTemplateBrowserReturn {\n  templates: AlertRuleTemplate[];\n  loading: boolean;\n  filter: TemplateFilter;          // { category, search, isBuiltIn? }\n  sort: TemplateSort;              // { field: TemplateSortField; direction: SortDirection }\n  selection: TemplateSelection;    // { selectedId, selectedTemplate }\n  setFilter: (filter: Partial<TemplateFilter>) => void;\n  setSort: (sort: Partial<TemplateSort>) => void;\n  selectTemplate: (id: string | null) => void;\n  clearSelection: () => void;\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-hooks",children:"9. Hooks"}),"\n",(0,r.jsxs)(n.h3,{id:"91-usealertnotifications",children:["9.1 ",(0,r.jsx)(n.code,{children:"useAlertNotifications"})]}),"\n",(0,r.jsx)(n.p,{children:"The central hook that connects the backend alert stream to the UI. Must be mounted once at app-layout level."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function useAlertNotifications(options?: {\n  deviceId?: string;   // scopes subscription to specific router\n  enabled?: boolean;   // default true\n}): void\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Internal flow:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Subscribes to ",(0,r.jsx)(n.code,{children:"alertEvents(deviceId)"})," via Apollo ",(0,r.jsx)(n.code,{children:"useSubscription"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Deduplicates events using a ",(0,r.jsx)(n.code,{children:"useRef<Set<string>>(processedAlerts)"})," \u2014 clears to last 100 on overflow."]}),"\n",(0,r.jsxs)(n.li,{children:["Filters by ",(0,r.jsx)(n.code,{children:"settings.severityFilter"})," (CRITICAL > WARNING > INFO hierarchy)."]}),"\n",(0,r.jsxs)(n.li,{children:["Calls ",(0,r.jsx)(n.code,{children:"addNotification()"})," on the Zustand ",(0,r.jsx)(n.code,{children:"useAlertNotificationStore"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Calls ",(0,r.jsx)(n.code,{children:"playAlertSound(severity, soundEnabled)"})," \u2014 maps severity to ",(0,r.jsx)(n.code,{children:"/sounds/alert-{level}.mp3"}),"; critical alerts never auto-dismiss."]}),"\n",(0,r.jsxs)(n.li,{children:["Maps ",(0,r.jsx)(n.code,{children:"alert.eventType"})," to an app route via ",(0,r.jsx)(n.code,{children:"eventTypeToRoute"}),' for contextual "View" actions in toast.']}),"\n",(0,r.jsxs)(n.li,{children:["Shows toast: ",(0,r.jsx)(n.code,{children:".error()"})," for CRITICAL, ",(0,r.jsx)(n.code,{children:".warning()"})," for WARNING, ",(0,r.jsx)(n.code,{children:".info()"})," for INFO."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Auto-dismiss timing:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Severity"}),(0,r.jsx)(n.th,{children:"Duration"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CRITICAL"}),(0,r.jsx)(n.td,{children:"Never (requires manual acknowledgment)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WARNING"}),(0,r.jsx)(n.td,{children:"8,000 ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"INFO"}),(0,r.jsx)(n.td,{children:"5,000 ms"})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"92-usealertrules",children:["9.2 ",(0,r.jsx)(n.code,{children:"useAlertRules"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function useAlertRules(): { rules, loading, error }\nexport function useAlertRule(id: string): { rule, loading, error }\nexport function useCreateAlertRule(): [createFn, { loading }]\nexport function useUpdateAlertRule(): [updateFn, { loading }]\nexport function useDeleteAlertRule(): [deleteFn, { loading }]\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"93-usealerts",children:["9.3 ",(0,r.jsx)(n.code,{children:"useAlerts"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function useAlerts(options?): { alerts, loading, error, fetchMore }\nexport function useAcknowledgeAlert(): [acknowledgeFn, { loading }]\nexport function useAcknowledgeAlerts(): [acknowledgeAllFn, { loading }]\nexport function useUnacknowledgedAlertCount(deviceId?: string): number\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useUnacknowledgedAlertCount"})," is used directly by ",(0,r.jsx)(n.code,{children:"AlertBadge"})," to render the header count."]}),"\n",(0,r.jsxs)(n.h3,{id:"94-usenotificationchannels",children:["9.4 ",(0,r.jsx)(n.code,{children:"useNotificationChannels"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export type ChannelConfig = Record<string, unknown>;\n\nexport function useNotificationChannels(): {\n  testChannel: (channel: string, config: ChannelConfig) => Promise<void>;\n  testResults: Record<string, { success: boolean; message: string }>;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Invoked by ",(0,r.jsx)(n.code,{children:"NotificationSettingsPage"}),' to power the "Test Notification" buttons on each channel\'s config form.']}),"\n",(0,r.jsx)(n.h3,{id:"95-channel-form-hooks",children:"9.5 Channel Form Hooks"}),"\n",(0,r.jsx)(n.p,{children:"Each headless hook encapsulates React Hook Form setup, Zod schema binding, and submit handler:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Hook"}),(0,r.jsx)(n.th,{children:"Schema"}),(0,r.jsx)(n.th,{children:"Returns"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"useEmailChannelForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"emailConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{ form, onSubmit, onTest, isSubmitting, isTesting }"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"useWebhookConfigForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"webhookConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{ form, onSubmit, isSubmitting }"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"useNtfyChannelForm"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ntfyConfigSchema"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{ form, onSubmit, isSubmitting }"})})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"96-usepushoverusage",children:["9.6 ",(0,r.jsx)(n.code,{children:"usePushoverUsage"})]}),"\n",(0,r.jsx)(n.p,{children:"Tracks the user's Pushover monthly message quota:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function usePushoverUsage(): {\n  usage: { used: number; remaining: number; limit: number; resetAt: string } | null;\n  percentUsed: number;\n  isNearLimit: boolean;    // >= 80%\n  isExceeded: boolean;     // >= 100%\n  loading: boolean;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Displayed in ",(0,r.jsx)(n.code,{children:"PushoverChannelForm"})," (within ",(0,r.jsx)(n.code,{children:"NotificationSettingsPage"}),") as a color-coded progress bar."]}),"\n",(0,r.jsxs)(n.h3,{id:"97-usealertruletemplates",children:["9.7 ",(0,r.jsx)(n.code,{children:"useAlertRuleTemplates"})]}),"\n",(0,r.jsx)(n.p,{children:"Full CRUD suite for templates:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function useAlertRuleTemplates(options?): { data, loading, error, refetch }\nexport function useAlertRuleTemplate(id: string): { data, loading, error }\nexport function usePreviewAlertRuleTemplate(): [previewFn, { data, loading }]\nexport function useApplyAlertRuleTemplate(options?): [applyFn, { loading }]\nexport function useSaveCustomAlertRuleTemplate(): [saveFn, { loading }]\nexport function useDeleteCustomAlertRuleTemplate(): [deleteFn, { loading }]\nexport function useImportAlertRuleTemplate(): [importFn, { loading }]\nexport function useExportAlertRuleTemplate(): [exportFn, { loading }]\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"10-pages",children:"10. Pages"}),"\n",(0,r.jsx)(n.h3,{id:"notificationsettingspage",children:(0,r.jsx)(n.code,{children:"NotificationSettingsPage"})}),"\n",(0,r.jsxs)(n.p,{children:["File: ",(0,r.jsx)(n.code,{children:"pages/NotificationSettingsPage.tsx"})]}),"\n",(0,r.jsx)(n.p,{children:"The single page export of this module. It provides:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"QuietHoursConfig section"})," \u2014 renders the platform-adaptive quiet hours form; persists via GraphQL mutation (TODO in current codebase, logged to console)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Notification Channels tab bar"})," \u2014 four tabs: Email, Telegram Bot, Pushover, Webhook."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Channel forms"})," \u2014 each tab mounts the corresponding config form:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EmailChannelForm"})," \u2014 uses ",(0,r.jsx)(n.code,{children:"useEmailChannelForm"})," headless hook with SMTP presets."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"TelegramChannelForm"})," (inline) \u2014 bot token + textarea of newline-separated Chat IDs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PushoverChannelForm"})," (inline) \u2014 user key + API token + optional device; shows ",(0,r.jsx)(n.code,{children:"usePushoverUsage"})," quota bar."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WebhookChannelCard"})," (inline) \u2014 links to ",(0,r.jsx)(n.code,{children:"/settings/notifications/webhooks"})," for full webhook config."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test button"}),' \u2014 each form has a "Test Notification" button wired to ',(0,r.jsx)(n.code,{children:"useNotificationChannels().testChannel"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pro tip banner"})," \u2014 explains that in-app notifications are always enabled."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { NotificationSettingsPage } from '@nasnet/features/alerts';\n// Mount as a lazy-loaded route:\n<Route path=\"/settings/notifications\" element={<NotificationSettingsPage />} />\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"11-dispatch-chain-overview",children:"11. Dispatch Chain Overview"}),"\n",(0,r.jsx)(n.p,{children:"The alert dispatch chain spans backend and frontend:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[Alert Engine]           Backend (Go)\n  \u2502 - Evaluates rules against events\n  \u2502 - Passes matching alerts to throttle queue\n  \u2502\n[Throttle / Quiet Hours Queue]\n  \u2502 - Suppresses alerts exceeding maxAlerts/periodSeconds\n  \u2502 - Queues non-critical alerts during quiet hours\n  \u2502 - Bypasses quiet hours for CRITICAL severity\n  \u2502\n[Channel Dispatcher]     Backend\n  \u2502 - Routes to: SMTP, Telegram Bot API, Pushover API,\n  \u2502              Webhook HTTP, Ntfy HTTP, In-App store\n  \u2502\n[GraphQL Subscription]   Transport (WebSocket / SSE)\n  \u2502  alertEvents(deviceId) subscription\n  \u2502\n[useAlertNotifications]  Frontend Hook\n  \u2502 - Deduplicates events (Set<string> ref)\n  \u2502 - Filters by severityFilter setting\n  \u2502 - Adds to useAlertNotificationStore (Zustand)\n  \u2502 - Plays alert sound\n  \u2502 - Shows toast (useToast)\n  \u2502\n[AlertBadge]             UI \u2014 Header\n  \u2514\u2500 useUnacknowledgedAlertCount \u2192 badge count\n     (auto-hides at 0, caps at "99+")\n\n[QueuedAlertBadge]       UI \u2014 Alert list items\n  \u2514\u2500 Shows countdown or bypass indicator on queued alerts\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"12-schemas-summary",children:"12. Schemas Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Schema"}),(0,r.jsx)(n.th,{children:"File"}),(0,r.jsx)(n.th,{children:"Key Exports"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Alert rule"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"schemas/alert-rule.schema.ts"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"alertRuleFormSchema"}),", ",(0,r.jsx)(n.code,{children:"alertConditionSchema"}),", ",(0,r.jsx)(n.code,{children:"throttleConfigSchema"}),", ",(0,r.jsx)(n.code,{children:"quietHoursConfigSchema"}),", ",(0,r.jsx)(n.code,{children:"COMMON_EVENT_TYPES"}),", ",(0,r.jsx)(n.code,{children:"NOTIFICATION_CHANNELS"}),", ",(0,r.jsx)(n.code,{children:"SEVERITY_CONFIG"}),", ",(0,r.jsx)(n.code,{children:"OPERATOR_CONFIG"}),", ",(0,r.jsx)(n.code,{children:"defaultAlertRule"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Alert rule template"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"schemas/alert-rule-template.schema.ts"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"alertRuleTemplateSchema"}),", ",(0,r.jsx)(n.code,{children:"alertRuleTemplateVariableSchema"}),", ",(0,r.jsx)(n.code,{children:"applyAlertRuleTemplateInputSchema"}),", ",(0,r.jsx)(n.code,{children:"alertRuleTemplateImportSchema"}),", ",(0,r.jsx)(n.code,{children:"customAlertRuleTemplateInputSchema"}),", ",(0,r.jsx)(n.code,{children:"alertRuleTemplatePreviewSchema"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Email config"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"schemas/email-config.schema.ts"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"emailConfigSchema"}),", ",(0,r.jsx)(n.code,{children:"defaultEmailConfig"}),", ",(0,r.jsx)(n.code,{children:"SMTP_PORT_PRESETS"}),", ",(0,r.jsx)(n.code,{children:"isValidEmail"}),", ",(0,r.jsx)(n.code,{children:"toEmailConfigInput"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ntfy config"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"schemas/ntfy-config.schema.ts"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ntfyConfigSchema"}),", ",(0,r.jsx)(n.code,{children:"DEFAULT_NTFY_CONFIG"}),", ",(0,r.jsx)(n.code,{children:"NTFY_PRIORITY_PRESETS"}),", ",(0,r.jsx)(n.code,{children:"NTFY_SERVER_PRESETS"}),", ",(0,r.jsx)(n.code,{children:"isValidNtfyTopic"}),", ",(0,r.jsx)(n.code,{children:"formatNtfyTags"}),", ",(0,r.jsx)(n.code,{children:"parseNtfyTags"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Webhook config"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"schemas/webhook.schema.ts"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"webhookConfigSchema"}),", ",(0,r.jsx)(n.code,{children:"DEFAULT_WEBHOOK_CONFIG"}),", ",(0,r.jsx)(n.code,{children:"WEBHOOK_TEMPLATE_PRESETS"}),", ",(0,r.jsx)(n.code,{children:"AUTH_TYPE_OPTIONS"}),", ",(0,r.jsx)(n.code,{children:"toWebhookInput"})]})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"13-cross-references",children:"13. Cross-References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Zustand stores"})," \u2014 ",(0,r.jsx)(n.code,{children:"useAlertNotificationStore"})," (notifications, settings, addNotification), ",(0,r.jsx)(n.code,{children:"useConnectionStore"})," (activeRouterId for subscription scoping). See ",(0,r.jsx)(n.code,{children:"libs/state/stores"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"GraphQL subscriptions"})," \u2014 ",(0,r.jsx)(n.code,{children:"alertEvents(deviceId)"})," subscription is defined inline in ",(0,r.jsx)(n.code,{children:"useAlertNotifications.ts"}),". The subscription field is declared in ",(0,r.jsx)(n.code,{children:"schema/alerts/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"TemplateGallery (Layer 2)"})," \u2014 ",(0,r.jsx)(n.code,{children:"AlertTemplateBrowser"})," composes ",(0,r.jsx)(n.code,{children:"TemplateGallery"})," from ",(0,r.jsx)(n.code,{children:"@nasnet/ui/patterns"}),". The alerts module provides data; the gallery handles all UI presentation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Platform Presenter pattern"})," \u2014 ",(0,r.jsx)(n.code,{children:"QuietHoursConfig"}),", ",(0,r.jsx)(n.code,{children:"EmailChannelForm"}),", ",(0,r.jsx)(n.code,{children:"WebhookConfigForm"}),", ",(0,r.jsx)(n.code,{children:"NtfyChannelForm"}),", and the template browser all follow the headless + presenter pattern described in ",(0,r.jsx)(n.code,{children:"Docs/design/PLATFORM_PRESENTER_GUIDE.md"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Design tokens"})," \u2014 ",(0,r.jsx)(n.code,{children:"bg-error/10"}),", ",(0,r.jsx)(n.code,{children:"text-error"}),", ",(0,r.jsx)(n.code,{children:"bg-warning/10"}),", ",(0,r.jsx)(n.code,{children:"bg-info/10"}),", ",(0,r.jsx)(n.code,{children:"bg-success/10"})," are used consistently for severity-coloured status indicators. See ",(0,r.jsx)(n.code,{children:"Docs/design/DESIGN_TOKENS.md"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend alert engine"})," \u2014 Go implementation in ",(0,r.jsx)(n.code,{children:"apps/backend/internal/alerts/"}),". The engine evaluates rules, the throttle queue is in ",(0,r.jsx)(n.code,{children:"internal/alerts/throttle/"}),", and the notification dispatcher is in ",(0,r.jsx)(n.code,{children:"internal/notifications/dispatcher.go"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"GraphQL schema"})," \u2014 Alert types and operations are in ",(0,r.jsx)(n.code,{children:"schema/alerts/"})," (24 files covering rules, channels, subscriptions, templates, quiet hours, webhooks)."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var t=s(14041);const r={},l=t.createContext(r);function i(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);
"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[16339],{60321:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"guides/device-detection-pipeline","title":"Device Detection Pipeline Guide","description":"Cross-cutting guide for detecting connected device types from MAC addresses, hostnames, and vendor information.","source":"@site/../../libs/core/docs/guides/device-detection-pipeline.md","sourceDirName":"guides","slug":"/guides/device-detection-pipeline","permalink":"/docs/core/guides/device-detection-pipeline","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/core/docs/guides/device-detection-pipeline.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Change Set Operations: Atomic Multi-Resource Transactions","permalink":"/docs/core/guides/change-set-operations"},"next":{"title":"Firewall System Guide","permalink":"/docs/core/guides/firewall-system"}}');var s=i(31085),c=i(71184);const r={},o="Device Detection Pipeline Guide",d={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Detection Flow Overview",id:"detection-flow-overview",level:2},{value:"Device Type Categories",id:"device-type-categories",level:2},{value:"Complete Device Type Taxonomy",id:"complete-device-type-taxonomy",level:3},{value:"Device Type Characteristics",id:"device-type-characteristics",level:3},{value:"OUI Database and MAC Vendor Lookup",id:"oui-database-and-mac-vendor-lookup",level:2},{value:"OUI (Organizationally Unique Identifier)",id:"oui-organizationally-unique-identifier",level:3},{value:"MAC Address Formats Supported",id:"mac-address-formats-supported",level:3},{value:"Vendor Hint Mapping",id:"vendor-hint-mapping",level:3},{value:"DHCP Fingerprinting",id:"dhcp-fingerprinting",level:2},{value:"DHCP Fingerprint Types",id:"dhcp-fingerprint-types",level:3},{value:"Hostname Pattern Matching",id:"hostname-pattern-matching",level:2},{value:"Hostname Pattern Database",id:"hostname-pattern-database",level:3},{value:"Real Hostname Examples",id:"real-hostname-examples",level:3},{value:"Display Integration",id:"display-integration",level:2},{value:"Icon Mapping",id:"icon-mapping",level:3},{value:"Label Mapping",id:"label-mapping",level:3},{value:"Component Usage",id:"component-usage",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Example 1: Detecting Device Type from DHCP Lease",id:"example-1-detecting-device-type-from-dhcp-lease",level:3},{value:"Example 2: Batch Device Detection",id:"example-2-batch-device-detection",level:3},{value:"Example 3: Building Device Group Reports",id:"example-3-building-device-group-reports",level:3},{value:"Example 4: Confidence Levels",id:"example-4-confidence-levels",level:3},{value:"Example 5: Device Sorting/Grouping",id:"example-5-device-sortinggrouping",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Device Shows as UNKNOWN",id:"device-shows-as-unknown",level:3},{value:"Incorrect Device Classification",id:"incorrect-device-classification",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"device-detection-pipeline-guide",children:"Device Detection Pipeline Guide"})}),"\n",(0,s.jsx)(n.p,{children:"Cross-cutting guide for detecting connected device types from MAC addresses, hostnames, and vendor information."}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#detection-flow-overview",children:"Detection Flow Overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#device-type-categories",children:"Device Type Categories"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#oui-database-and-mac-vendor-lookup",children:"OUI Database and MAC Vendor Lookup"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#dhcp-fingerprinting",children:"DHCP Fingerprinting"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#hostname-pattern-matching",children:"Hostname Pattern Matching"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#display-integration",children:"Display Integration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#usage-examples",children:"Usage Examples"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"detection-flow-overview",children:"Detection Flow Overview"}),"\n",(0,s.jsx)(n.p,{children:"The device detection pipeline identifies device types through a 3-tier algorithm:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   DHCP Lease Received                       \u2502\n\u2502         (hostname, MAC address, fingerprint)                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n                       \u25bc\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  1. HOSTNAME PATTERN MATCHING    \u2502\n        \u2502     (Most Reliable)              \u2502\n        \u2502  \u2022 Check 50+ patterns            \u2502\n        \u2502  \u2022 Return on first match         \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n                  No Match?\n                       \u2502\n                       \u25bc\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  2. MAC VENDOR LOOKUP            \u2502\n        \u2502     (OUI Database)               \u2502\n        \u2502  \u2022 Extract first 3 octets        \u2502\n        \u2502  \u2022 Look up vendor in DB          \u2502\n        \u2502  \u2022 Map vendor \u2192 device type      \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n              No Vendor Match?\n                       \u2502\n                       \u25bc\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  3. FALLBACK TO UNKNOWN          \u2502\n        \u2502  \u2022 Used when nothing matched     \u2502\n        \u2502  \u2022 Shows generic icon/label      \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n                       \u25bc\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502        DeviceType Result         \u2502\n        \u2502  (SMARTPHONE, TV, PRINTER, etc.) \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Key Principle:"})," Hostname patterns are most reliable (explicit user input), vendor hints are fallback."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"device-type-categories",children:"Device Type Categories"}),"\n",(0,s.jsx)(n.h3,{id:"complete-device-type-taxonomy",children:"Complete Device Type Taxonomy"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"types/router/connected-device.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export enum DeviceType {\n  SMARTPHONE = 'smartphone',      // Mobile phones\n  TABLET = 'tablet',              // iPads, Android tablets\n  LAPTOP = 'laptop',              // Laptops and ultrabooks\n  DESKTOP = 'desktop',            // Desktops and workstations\n  PRINTER = 'printer',            // Printers and scanners\n  TV = 'tv',                      // Smart TVs and streaming devices\n  GAMING_CONSOLE = 'gaming_console', // PS5, Xbox, Nintendo Switch\n  IOT = 'iot',                    // IoT devices and sensors\n  ROUTER = 'router',              // Network equipment\n  UNKNOWN = 'unknown',            // Unidentified devices\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"device-type-characteristics",children:"Device Type Characteristics"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Count"}),(0,s.jsx)(n.th,{children:"Examples"}),(0,s.jsx)(n.th,{children:"Icon"}),(0,s.jsx)(n.th,{children:"Use Cases"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Smartphone"})}),(0,s.jsx)(n.td,{children:"100-200+"}),(0,s.jsx)(n.td,{children:"iPhone, Galaxy, Pixel"}),(0,s.jsx)(n.td,{children:"\ud83d\udcf1"}),(0,s.jsx)(n.td,{children:"User devices, mobile access"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Tablet"})}),(0,s.jsx)(n.td,{children:"5-20"}),(0,s.jsx)(n.td,{children:"iPad, Tab S, Pixel Pad"}),(0,s.jsx)(n.td,{children:"\ud83d\udcf1"}),(0,s.jsx)(n.td,{children:"Media consumption, sketching"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Laptop"})}),(0,s.jsx)(n.td,{children:"5-50"}),(0,s.jsx)(n.td,{children:"MacBook, ThinkPad, XPS"}),(0,s.jsx)(n.td,{children:"\ud83d\udcbb"}),(0,s.jsx)(n.td,{children:"Work, development, remote access"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Desktop"})}),(0,s.jsx)(n.td,{children:"2-10"}),(0,s.jsx)(n.td,{children:"iMac, Mac Mini, Optiplex"}),(0,s.jsx)(n.td,{children:"\ud83d\udda5\ufe0f"}),(0,s.jsx)(n.td,{children:"Stationary workstations"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Printer"})}),(0,s.jsx)(n.td,{children:"1-5"}),(0,s.jsx)(n.td,{children:"HP LaserJet, Canon"}),(0,s.jsx)(n.td,{children:"\ud83d\udda8\ufe0f"}),(0,s.jsx)(n.td,{children:"Document handling"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"TV"})}),(0,s.jsx)(n.td,{children:"1-3"}),(0,s.jsx)(n.td,{children:"Roku, Fire TV, Smart TV"}),(0,s.jsx)(n.td,{children:"\ud83d\udcfa"}),(0,s.jsx)(n.td,{children:"Streaming and media"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Gaming Console"})}),(0,s.jsx)(n.td,{children:"1-5"}),(0,s.jsx)(n.td,{children:"PS5, Xbox, Switch"}),(0,s.jsx)(n.td,{children:"\ud83c\udfae"}),(0,s.jsx)(n.td,{children:"Gaming and streaming"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"IoT"})}),(0,s.jsx)(n.td,{children:"10-100+"}),(0,s.jsx)(n.td,{children:"Shelly, Sonoff, Hue"}),(0,s.jsx)(n.td,{children:"\ud83d\udd0c"}),(0,s.jsx)(n.td,{children:"Home automation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Router"})}),(0,s.jsx)(n.td,{children:"1-10"}),(0,s.jsx)(n.td,{children:"MikroTik, UniFi, Netgear"}),(0,s.jsx)(n.td,{children:"\ud83c\udf10"}),(0,s.jsx)(n.td,{children:"Network infrastructure"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"oui-database-and-mac-vendor-lookup",children:"OUI Database and MAC Vendor Lookup"}),"\n",(0,s.jsx)(n.h3,{id:"oui-organizationally-unique-identifier",children:"OUI (Organizationally Unique Identifier)"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"utils/mac-vendor/oui-database.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// OUI database contains ~350 common MAC prefixes\nexport const OUI_DATABASE = {\n  '00:0F:E2': 'MikroTik',\n  'AC:DE:48': 'Apple Inc.',\n  '00:50:F2': 'Microsoft',\n  '00:25:86': 'Apple Inc.',\n  'F4:5E:AB': 'Samsung Electronics',\n  // ... 350+ more entries\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Database Structure:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Keys: OUI in ",(0,s.jsx)(n.code,{children:"XX:XX:XX"})," format (first 3 octets of MAC)"]}),"\n",(0,s.jsx)(n.li,{children:"Values: Vendor names"}),"\n",(0,s.jsx)(n.li,{children:"Coverage: ~350 entries covering most common devices"}),"\n",(0,s.jsx)(n.li,{children:"Format: Uppercase hex with colons"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"mac-address-formats-supported",children:"MAC Address Formats Supported"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { lookupVendor, isValidMac, formatMac } from '@nasnet/core/utils/mac-vendor';\n\n// All these formats work:\nlookupVendor('00:0F:E2:12:34:56');      // Colon-separated (standard)\nlookupVendor('00-0F-E2-12-34-56');      // Dash-separated\nlookupVendor('000FE2123456');           // No separator\n\n// Validation\nisValidMac('00:0F:E2:12:34:56');        // true\nisValidMac('invalid');                  // false\n\n// Formatting to standard\nformatMac('aabbccddeeff');              // => 'AA:BB:CC:DD:EE:FF'\nformatMac('aa-bb-cc-dd-ee-ff');         // => 'AA:BB:CC:DD:EE:FF'\n"})}),"\n",(0,s.jsx)(n.h3,{id:"vendor-hint-mapping",children:"Vendor Hint Mapping"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"utils/device/deviceTypeDetection.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const VENDOR_HINTS = {\n  // Smartphones (most common)\n  'Apple': DeviceType.SMARTPHONE,\n  'Samsung Electronics': DeviceType.SMARTPHONE,\n  'Google': DeviceType.SMARTPHONE,\n  'Xiaomi': DeviceType.SMARTPHONE,\n  'OnePlus': DeviceType.SMARTPHONE,\n\n  // Computers\n  'Microsoft': DeviceType.DESKTOP,\n  'Dell': DeviceType.LAPTOP,\n  'Lenovo': DeviceType.LAPTOP,\n\n  // Network Equipment\n  'MikroTik': DeviceType.ROUTER,\n  'Ubiquiti': DeviceType.ROUTER,\n  'TP-Link': DeviceType.ROUTER,\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Vendor Matching:"})," Case-insensitive substring match"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// "Samsung Electronics Co., Ltd." includes "Samsung" \u2192 SMARTPHONE\nif (vendor.includes(vendorName)) {\n  return type;\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"dhcp-fingerprinting",children:"DHCP Fingerprinting"}),"\n",(0,s.jsx)(n.h3,{id:"dhcp-fingerprint-types",children:"DHCP Fingerprint Types"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"types/router/connected-device.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'export interface ConnectedDevice {\n  // ... other fields\n  dhcpFingerprint?: string;   // DHCP fingerprint from client\n  hostname?: string;          // DHCP hostname\n}\n\n// DHCP fingerprints help identify OS\n// Examples:\n// - "1,3,6,15,31,33,40,41,42,43,44,46,47,..."\n// - Different for Windows vs macOS vs iOS vs Android\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fingerprint Format:"})," Comma-separated DHCP option codes"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Unique per OS family (Windows, macOS, iOS, Android, Linux)"}),"\n",(0,s.jsx)(n.li,{children:"Allows distinguishing device OS even without hostname"}),"\n",(0,s.jsx)(n.li,{children:"Used as secondary detection method"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"hostname-pattern-matching",children:"Hostname Pattern Matching"}),"\n",(0,s.jsx)(n.h3,{id:"hostname-pattern-database",children:"Hostname Pattern Database"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"utils/device/deviceTypeDetection.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const HOSTNAME_PATTERNS: Array<[RegExp, DeviceType]> = [\n  // Smartphones (most specific first)\n  [/iphone/i, DeviceType.SMARTPHONE],\n  [/android|galaxy|pixel|oneplus|huawei|xiaomi|redmi|oppo|vivo/i, DeviceType.SMARTPHONE],\n\n  // Tablets\n  [/ipad/i, DeviceType.TABLET],\n  [/tablet|tab-|kindle/i, DeviceType.TABLET],\n\n  // Laptops\n  [/macbook|mbp|mba|mac-?book/i, DeviceType.LAPTOP],\n  [/surface|thinkpad|xps|latitude|ideapad|zenbook|pavilion|inspiron|elitebook/i, DeviceType.LAPTOP],\n  [/laptop/i, DeviceType.LAPTOP],\n\n  // Desktops\n  [/imac|mac-?mini|mac-?pro|mac-?studio/i, DeviceType.DESKTOP],\n  [/desktop|pc-|workstation|optiplex/i, DeviceType.DESKTOP],\n\n  // Printers\n  [/printer|epson|hp-|canon|brother|xerox|laserjet/i, DeviceType.PRINTER],\n\n  // TVs and Media\n  [/roku|fire-?tv|apple-?tv|chromecast|shield|smart-?tv|lg-tv|samsung-tv/i, DeviceType.TV],\n\n  // Gaming Consoles\n  [/playstation|ps[3456]|xbox|nintendo|switch|steam-?deck/i, DeviceType.GAMING_CONSOLE],\n\n  // IoT Devices\n  [/esp|tasmota|shelly|sonoff|tuya|smart-?plug|nest|ring|hue|philips-hue|wemo/i, DeviceType.IOT],\n  [/iot|sensor|smart-?home|alexa|echo|google-?home/i, DeviceType.IOT],\n\n  // Routers and Network Equipment\n  [/mikrotik|router|gateway|ubiquiti|unifi|netgear|asus-rt|tp-?link|linksys/i, DeviceType.ROUTER],\n  [/access-?point|ap-|switch/i, DeviceType.ROUTER],\n];\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Pattern Characteristics:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Case-insensitive (",(0,s.jsx)(n.code,{children:"/i"})," flag)"]}),"\n",(0,s.jsx)(n.li,{children:"Ordered by specificity (most specific patterns first)"}),"\n",(0,s.jsxs)(n.li,{children:["Loose matching with wildcards (",(0,s.jsx)(n.code,{children:"|"})," for alternatives)"]}),"\n",(0,s.jsx)(n.li,{children:"Supports brand names and model identifiers"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"real-hostname-examples",children:"Real Hostname Examples"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Smartphones\n"Johns-iPhone"           \u2192 SMARTPHONE\n"samsung-galaxy-s24"     \u2192 SMARTPHONE\n"google-pixel-8-pro"     \u2192 SMARTPHONE\n"oneplus-12"             \u2192 SMARTPHONE\n\n// Tablets\n"iPad-Air"               \u2192 TABLET\n"Samsung-Galaxy-Tab-S9"  \u2192 TABLET\n\n// Laptops\n"macbook-pro"            \u2192 LAPTOP\n"ThinkPad-X1"            \u2192 LAPTOP\n"Dell-XPS-15"            \u2192 LAPTOP\n\n// Desktops\n"iMac-Office"            \u2192 DESKTOP\n"workstation-01"         \u2192 DESKTOP\n\n// Printers\n"HP-LaserJet-M404"       \u2192 PRINTER\n"canon-pixma"            \u2192 PRINTER\n\n// Smart Devices\n"Shelly-Plug-1"          \u2192 IOT\n"Philips-Hue-Bridge"     \u2192 IOT\n"smart-thermostat"       \u2192 IOT\n\n// Network Equipment\n"MikroTik-Router-OS"     \u2192 ROUTER\n"Ubiquiti-UniFi-AP"      \u2192 ROUTER\n\n// Unrecognized\n"unknown-device"         \u2192 UNKNOWN\n"192-168-1-100"          \u2192 UNKNOWN\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"display-integration",children:"Display Integration"}),"\n",(0,s.jsx)(n.h3,{id:"icon-mapping",children:"Icon Mapping"}),"\n",(0,s.jsxs)(n.p,{children:["Located in ",(0,s.jsx)(n.code,{children:"utils/device/deviceTypeDetection.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export const DEVICE_TYPE_ICONS = {\n  [DeviceType.SMARTPHONE]: 'Smartphone',      // Lucide icon name\n  [DeviceType.TABLET]: 'Tablet',\n  [DeviceType.LAPTOP]: 'Laptop',\n  [DeviceType.DESKTOP]: 'Monitor',\n  [DeviceType.ROUTER]: 'Router',\n  [DeviceType.IOT]: 'Cpu',\n  [DeviceType.PRINTER]: 'Printer',\n  [DeviceType.TV]: 'Tv',\n  [DeviceType.GAMING_CONSOLE]: 'Gamepad2',\n  [DeviceType.UNKNOWN]: 'HelpCircle',\n};\n\n// Usage in React component\nimport { LucideIcon, Smartphone, Router } from 'lucide-react';\n\nfunction DeviceIcon({ type }: { type: DeviceType }) {\n  const iconName = DEVICE_TYPE_ICONS[type];\n  const IconComponent = lucideIcons[iconName] as LucideIcon;\n  return <IconComponent className=\"w-5 h-5\" />;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"label-mapping",children:"Label Mapping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export const DEVICE_TYPE_LABELS = {\n  [DeviceType.SMARTPHONE]: 'Smartphone',\n  [DeviceType.TABLET]: 'Tablet',\n  [DeviceType.LAPTOP]: 'Laptop',\n  [DeviceType.DESKTOP]: 'Desktop',\n  [DeviceType.ROUTER]: 'Router',\n  [DeviceType.IOT]: 'IoT Device',\n  [DeviceType.PRINTER]: 'Printer',\n  [DeviceType.TV]: 'TV / Media',\n  [DeviceType.GAMING_CONSOLE]: 'Gaming Console',\n  [DeviceType.UNKNOWN]: 'Unknown',\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"component-usage",children:"Component Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import { DeviceType } from \'@nasnet/core/types\';\nimport { detectDeviceType, DEVICE_TYPE_ICONS, DEVICE_TYPE_LABELS } from \'@nasnet/core/utils/device\';\n\nexport function ConnectedDeviceCard({ hostname, macAddress, vendor }) {\n  const deviceType = detectDeviceType(hostname, vendor);\n  const icon = DEVICE_TYPE_ICONS[deviceType];\n  const label = DEVICE_TYPE_LABELS[deviceType];\n\n  return (\n    <div className="flex items-center gap-2">\n      <LucideIcon name={icon} className="w-5 h-5" />\n      <div>\n        <p className="font-semibold">{hostname || macAddress}</p>\n        <p className="text-sm text-gray-500">{label}</p>\n      </div>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-detecting-device-type-from-dhcp-lease",children:"Example 1: Detecting Device Type from DHCP Lease"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { detectDeviceType } from '@nasnet/core/utils/device';\n\n// Scenario: New device connects to DHCP\nconst lease = {\n  hostname: 'Johns-iPhone',\n  macAddress: 'AC:DE:48:12:34:56',\n  vendorClass: 'iPhone OS',\n};\n\nconst vendor = lookupVendor(lease.macAddress);  // \"Apple Inc.\"\nconst deviceType = detectDeviceType(lease.hostname, vendor);\n// => DeviceType.SMARTPHONE\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-batch-device-detection",children:"Example 2: Batch Device Detection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { detectDeviceType } from '@nasnet/core/utils/device';\n\nconst dhcpLeases = [\n  { hostname: 'desktop-01', mac: 'AA:BB:CC:DD:EE:01' },\n  { hostname: 'printer-hp', mac: 'AA:BB:CC:DD:EE:02' },\n  { hostname: null, mac: 'AA:BB:CC:DD:EE:03' },  // Unknown\n  { hostname: 'Samsung-Galaxy', mac: 'F4:5E:AB:12:34:56' },\n];\n\nconst detectedDevices = dhcpLeases.map(lease => {\n  const vendor = lookupVendor(lease.mac);\n  const type = detectDeviceType(lease.hostname, vendor);\n  return {\n    ...lease,\n    deviceType: type,\n    vendor: vendor,\n  };\n});\n\n// Result:\n// [\n//   { ..., deviceType: 'desktop', vendor: null },\n//   { ..., deviceType: 'printer', vendor: null },\n//   { ..., deviceType: 'unknown', vendor: null },\n//   { ..., deviceType: 'smartphone', vendor: 'Samsung Electronics' },\n// ]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-building-device-group-reports",children:"Example 3: Building Device Group Reports"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { detectDeviceType, DEVICE_TYPE_LABELS } from '@nasnet/core/utils/device';\n\nfunction getDeviceStatistics(dhcpLeases) {\n  const stats = new Map();\n\n  for (const lease of dhcpLeases) {\n    const vendor = lookupVendor(lease.macAddress);\n    const type = detectDeviceType(lease.hostname, vendor);\n    const label = DEVICE_TYPE_LABELS[type];\n\n    if (!stats.has(label)) {\n      stats.set(label, []);\n    }\n    stats.get(label).push(lease);\n  }\n\n  // Display:\n  // Smartphone: 8 devices\n  // Laptop: 3 devices\n  // Printer: 1 device\n  // Desktop: 1 device\n  // Unknown: 2 devices\n\n  return Array.from(stats.entries()).map(([label, devices]) => ({\n    label,\n    count: devices.length,\n    devices,\n  }));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-confidence-levels",children:"Example 4: Confidence Levels"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { detectDeviceType } from '@nasnet/core/utils/device';\n\ninterface DetectionResult {\n  type: DeviceType;\n  confidence: 'high' | 'medium' | 'low';\n  sources: string[];\n}\n\nfunction detectWithConfidence(hostname, vendor): DetectionResult {\n  // Hostname match = high confidence\n  if (hostname) {\n    for (const [pattern, type] of HOSTNAME_PATTERNS) {\n      if (pattern.test(hostname)) {\n        return {\n          type,\n          confidence: 'high',\n          sources: ['hostname pattern'],\n        };\n      }\n    }\n  }\n\n  // Vendor match = medium confidence\n  if (vendor) {\n    for (const [vendorName, type] of Object.entries(VENDOR_HINTS)) {\n      if (vendor.includes(vendorName)) {\n        return {\n          type,\n          confidence: 'medium',\n          sources: ['MAC vendor lookup'],\n        };\n      }\n    }\n  }\n\n  // Unknown = low confidence\n  return {\n    type: DeviceType.UNKNOWN,\n    confidence: 'low',\n    sources: [],\n  };\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-5-device-sortinggrouping",children:"Example 5: Device Sorting/Grouping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Sort devices by type (phones first, then everything else)\nconst sortedDevices = connectedDevices.sort((a, b) => {\n  const typeOrder = {\n    [DeviceType.SMARTPHONE]: 0,\n    [DeviceType.TABLET]: 1,\n    [DeviceType.LAPTOP]: 2,\n    [DeviceType.DESKTOP]: 3,\n    [DeviceType.PRINTER]: 4,\n    [DeviceType.TV]: 5,\n    [DeviceType.GAMING_CONSOLE]: 6,\n    [DeviceType.IOT]: 7,\n    [DeviceType.ROUTER]: 8,\n    [DeviceType.UNKNOWN]: 9,\n  };\n\n  return (typeOrder[a.deviceType] ?? 9) - (typeOrder[b.deviceType] ?? 9);\n});\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"device-shows-as-unknown",children:"Device Shows as UNKNOWN"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Causes (in order):"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Hostname doesn't match any pattern"}),"\n",(0,s.jsx)(n.li,{children:"MAC vendor not in database"}),"\n",(0,s.jsx)(n.li,{children:"MAC address is locally-administered (bit 1 of first octet set)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Update hostname to include device model/brand"}),"\n",(0,s.jsx)(n.li,{children:"Add custom vendor to OUI_DATABASE"}),"\n",(0,s.jsxs)(n.li,{children:["Check if MAC is valid (usually ",(0,s.jsx)(n.code,{children:"XX:XX:XX:XX:XX:XX"})," where XX is hex)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"incorrect-device-classification",children:"Incorrect Device Classification"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example:"}),' iPhone detected as generic smartphone instead of "iPhone"']}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:'Check hostname contains "iPhone" or "iphone"'}),"\n",(0,s.jsxs)(n.li,{children:["Verify MAC starts with ",(0,s.jsx)(n.code,{children:"AC:DE:48"})," (Apple OUI)"]}),"\n",(0,s.jsx)(n.li,{children:"Add more specific pattern if needed"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,s.jsx)(n.p,{children:"For large device lists (100+ devices):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c Don't: Re-detect for every render\ndevices.map(d => detectDeviceType(d.hostname, d.vendor));\n\n// \u2705 Do: Memoize or cache results\nconst detectionCache = new Map();\n\nfunction getCachedDeviceType(mac, hostname, vendor) {\n  if (detectionCache.has(mac)) {\n    return detectionCache.get(mac);\n  }\n  const type = detectDeviceType(hostname, vendor);\n  detectionCache.set(mac, type);\n  return type;\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Connected Device Types:"})," ",(0,s.jsx)(n.code,{children:"libs/core/types/src/router/connected-device.ts"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MAC Vendor Lookup:"})," ",(0,s.jsx)(n.code,{children:"libs/core/utils/mac-vendor/"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Network Configuration:"})," ",(0,s.jsx)(n.code,{children:"libs/core/docs/guides/network-configuration.md"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DHCP Types:"})," ",(0,s.jsx)(n.code,{children:"libs/core/types/src/router/dhcp.ts"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},71184:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var t=i(14041);const s={},c=t.createContext(s);function r(e){const n=t.useContext(c);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);
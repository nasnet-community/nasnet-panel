"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[23803],{35537:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"intro","title":"API Client \u2014 Overview","description":"The libs/api-client library is the single point of entry for all network communication in NasNetConnect. It provides two transport layers \u2014 a GraphQL Apollo Client for the main application data model and an Axios HTTP client for REST calls and direct RouterOS access \u2014 along with generated TypeScript types, Zod validation schemas, and a rich set of domain query hooks organized by feature area.","source":"@site/../../libs/api-client/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/docs/api-client/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/api-client/docs/intro.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"API Client \u2014 Overview"},"sidebar":"sidebar","next":{"title":"Apollo Client","permalink":"/docs/api-client/apollo-client"}}');var i=r(31085),o=r(71184);const s={sidebar_position:1,title:"API Client \u2014 Overview"},c="API Client Library",a={},l=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Package Structure",id:"package-structure",level:2},{value:"Import Aliases",id:"import-aliases",level:2},{value:"Technology Stack",id:"technology-stack",level:2},{value:"Architecture Diagram",id:"architecture-diagram",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Wrap your app in the Apollo provider",id:"1-wrap-your-app-in-the-apollo-provider",level:3},{value:"2. Set up offline detection",id:"2-set-up-offline-detection",level:3},{value:"3. Use domain query hooks in feature components",id:"3-use-domain-query-hooks-in-feature-components",level:3},{value:"4. Execute mutations",id:"4-execute-mutations",level:3},{value:"5. Direct RouterOS access (when GraphQL is not available)",id:"5-direct-routeros-access-when-graphql-is-not-available",level:3},{value:"6. Code generation",id:"6-code-generation",level:3},{value:"Decision Matrix",id:"decision-matrix",level:2},{value:"Document Navigation Index",id:"document-navigation-index",level:2},{value:"Core Transport",id:"core-transport",level:3},{value:"Authentication and Security",id:"authentication-and-security",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Connectivity",id:"connectivity",level:3},{value:"Data Model",id:"data-model",level:3},{value:"Query Hooks",id:"query-hooks",level:3},{value:"Service Lifecycle",id:"service-lifecycle",level:3},{value:"Testing and Codegen",id:"testing-and-codegen",level:3},{value:"Schema and Domain Layers",id:"schema-and-domain-layers",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"api-client-library",children:"API Client Library"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"libs/api-client"})," library is the single point of entry for all network communication in NasNetConnect. It provides two transport layers \u2014 a GraphQL Apollo Client for the main application data model and an Axios HTTP client for REST calls and direct RouterOS access \u2014 along with generated TypeScript types, Zod validation schemas, and a rich set of domain query hooks organized by feature area."]}),"\n",(0,i.jsx)(n.p,{children:"The library is designed to run inside a browser on a device that may have intermittent connectivity to a MikroTik router. Offline-first design is a first-class concern: the Apollo cache is persisted to IndexedDB, failed mutations are queued for replay, and network status is tracked in Zustand stores."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#package-structure",children:"Package Structure"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#import-aliases",children:"Import Aliases"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#technology-stack",children:"Technology Stack"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#architecture-diagram",children:"Architecture Diagram"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#quick-start",children:"Quick Start"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#decision-matrix",children:"Decision Matrix: Apollo vs. Axios vs. Generated Hooks"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#document-navigation-index",children:"Document Navigation Index"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"package-structure",children:"Package Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"libs/api-client/\n\u251c\u2500\u2500 core/                    # Transport infrastructure\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 apollo/          # Apollo Client: links, cache, persistence, offline\n\u2502       \u2502   \u251c\u2500\u2500 apollo-client.ts          main client + cache\n\u2502       \u2502   \u251c\u2500\u2500 apollo-auth-link.ts       JWT + Basic auth headers\n\u2502       \u2502   \u251c\u2500\u2500 apollo-error-link.ts      centralized error handling\n\u2502       \u2502   \u251c\u2500\u2500 apollo-retry-link.ts      exponential backoff retry\n\u2502       \u2502   \u251c\u2500\u2500 apollo-ws-client.ts       WebSocket client (subscriptions)\n\u2502       \u2502   \u251c\u2500\u2500 apollo-cache-persist.ts   IndexedDB cache persistence\n\u2502       \u2502   \u251c\u2500\u2500 apollo-provider.tsx       production React provider\n\u2502       \u2502   \u251c\u2500\u2500 apollo-mock-provider.tsx  stub provider for tests\n\u2502       \u2502   \u251c\u2500\u2500 offline-detector.ts       connectivity monitoring\n\u2502       \u2502   \u2514\u2500\u2500 offline-queue.ts          mutation queue when offline\n\u2502       \u251c\u2500\u2500 interceptors/    # Axios interceptors\n\u2502       \u2502   \u251c\u2500\u2500 auth.ts                   Basic auth header injection\n\u2502       \u2502   \u251c\u2500\u2500 retry.ts                  exponential backoff retry\n\u2502       \u2502   \u2514\u2500\u2500 error.ts                  ApiError transformation\n\u2502       \u251c\u2500\u2500 hooks/           # Enhanced Apollo hooks\n\u2502       \u2502   \u251c\u2500\u2500 useGraphQLError.ts        error \u2192 ProcessedError\n\u2502       \u2502   \u251c\u2500\u2500 useQueryWithLoading.ts    loading state differentiation\n\u2502       \u2502   \u2514\u2500\u2500 useMutationWithLoading.ts isLoading/isSuccess/isError states\n\u2502       \u251c\u2500\u2500 utils/           # Error utilities\n\u2502       \u2502   \u251c\u2500\u2500 error-messages.ts         error code \u2192 user message mapping\n\u2502       \u2502   \u2514\u2500\u2500 error-logging.ts          structured throttled logging\n\u2502       \u251c\u2500\u2500 client.ts        # Axios factory and apiClient singleton\n\u2502       \u251c\u2500\u2500 router-proxy.ts  # RouterOS REST proxy client\n\u2502       \u251c\u2500\u2500 types.ts         # Shared TypeScript types\n\u2502       \u2514\u2500\u2500 index.ts         # Public API surface\n\u2502\n\u251c\u2500\u2500 queries/                 # Domain query hooks\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 alerts/          # Alert rules, templates, digest\n\u2502       \u251c\u2500\u2500 batch/           # Batch job hooks\n\u2502       \u251c\u2500\u2500 change-set/      # Change set queries, mutations, subscriptions\n\u2502       \u251c\u2500\u2500 dhcp/            # DHCP server + lease hooks\n\u2502       \u251c\u2500\u2500 diagnostics/     # Ping, traceroute, DNS, troubleshoot\n\u2502       \u251c\u2500\u2500 discovery/       # Router discovery (subnet scan)\n\u2502       \u251c\u2500\u2500 dns/             # DNS configuration\n\u2502       \u251c\u2500\u2500 firewall/        # Filter rules, NAT, address lists, port knock\n\u2502       \u251c\u2500\u2500 network/         # Interfaces, IP addresses, VLANs, bridges\n\u2502       \u251c\u2500\u2500 notifications/   # In-app and push notification channels\n\u2502       \u251c\u2500\u2500 oui/             # OUI/vendor lookup\n\u2502       \u251c\u2500\u2500 resources/       # Universal State v2 resource model\n\u2502       \u251c\u2500\u2500 router/          # Router CRUD and health\n\u2502       \u251c\u2500\u2500 services/        # Feature marketplace lifecycle\n\u2502       \u251c\u2500\u2500 storage/         # Storage configuration\n\u2502       \u251c\u2500\u2500 system/          # System info, logs, resource gauges\n\u2502       \u251c\u2500\u2500 vpn/             # WireGuard, OpenVPN, IPsec VPN clients/servers\n\u2502       \u251c\u2500\u2500 wan/             # WAN interface management\n\u2502       \u2514\u2500\u2500 wireless/        # Wi-Fi SSID and client management\n\u2502\n\u2514\u2500\u2500 generated/               # Codegen output (do not edit manually)\n    \u251c\u2500\u2500 types.ts             # TypeScript types from schema\n    \u251c\u2500\u2500 operations.ts        # Apollo hooks (useQuery, useMutation, etc.)\n    \u251c\u2500\u2500 fragment-matcher.ts  # possibleTypes for InMemoryCache\n    \u251c\u2500\u2500 schemas/             # Zod validation schemas\n    \u2514\u2500\u2500 index.ts             # Re-exports everything\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"import-aliases",children:"Import Aliases"}),"\n",(0,i.jsxs)(n.p,{children:["Defined in ",(0,i.jsx)(n.code,{children:"apps/connect/vite.config.ts"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Alias"}),(0,i.jsx)(n.th,{children:"Resolves to"}),(0,i.jsx)(n.th,{children:"Contents"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@nasnet/api-client/core"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/api-client/core/src"})}),(0,i.jsx)(n.td,{children:"Apollo client, Axios client, hooks, utils"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@nasnet/api-client/queries"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/api-client/queries/src"})}),(0,i.jsx)(n.td,{children:"Domain query hooks"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@nasnet/api-client/generated"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/api-client/generated"})}),(0,i.jsx)(n.td,{children:"Generated types, operations, Zod schemas"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// Core transport\nimport { apolloClient, apolloCache, ApolloProvider } from '@nasnet/api-client/core';\nimport { apiClient, makeRouterOSRequest } from '@nasnet/api-client/core';\n\n// Domain hooks\nimport { useGetRouter, useUpdateRouter } from '@nasnet/api-client/queries';\nimport { useDHCP } from '@nasnet/api-client/queries';\nimport { useFirewallRules } from '@nasnet/api-client/queries';\n\n// Generated types\nimport type { Router, Resource, FirewallRule } from '@nasnet/api-client/generated';\nimport { possibleTypesResult } from '@nasnet/api-client/generated';\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Concern"}),(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Version"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"GraphQL client"}),(0,i.jsx)(n.td,{children:"Apollo Client"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@apollo/client"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"GraphQL subscriptions"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"graphql-ws"})}),(0,i.jsx)(n.td,{children:"WebSocket transport"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"HTTP client"}),(0,i.jsx)(n.td,{children:"Axios"}),(0,i.jsx)(n.td,{children:"REST + interceptors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cache persistence"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"apollo3-cache-persist"})," + ",(0,i.jsx)(n.code,{children:"localforage"})]}),(0,i.jsx)(n.td,{children:"IndexedDB with fallback"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Code generation"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@graphql-codegen"})}),(0,i.jsx)(n.td,{children:"Types, hooks, Zod schemas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Schema (source of truth)"}),(0,i.jsx)(n.td,{children:"GraphQL SDL"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"schema/"})," directory"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"State integration"}),(0,i.jsx)(n.td,{children:"Zustand"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"@nasnet/state/stores"})})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"architecture-diagram",children:"Architecture Diagram"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"+----------------------------------------------------------+\n|                    Feature Components                     |\n|  (libs/features/*, apps/connect/src/)                    |\n+----------------------------------------------------------+\n          |                |                |\n          | Apollo         | Domain         | Axios\n          | hooks          | query hooks    | (REST)\n          v                v                v\n+------------------+ +--------------+ +------------+\n|  @apollo/client  | | queries/src/ | | axios      |\n|  useQuery        | | useDHCP      | | apiClient  |\n|  useMutation     | | useFirewall  | |            |\n|  useSubscription | | useVPN ...   | |            |\n+------------------+ +--------------+ +-----+------+\n          |                |                |\n          v                v                |\n+----------------------------------------------------------+\n|                 @nasnet/api-client/core                   |\n|                                                           |\n|  Apollo Client (apollo-client.ts)                        |\n|    Link chain: errorLink \u2192 retryLink \u2192 splitLink         |\n|      HTTP path: authLink.concat(httpLink)                |\n|      WS path:   GraphQLWsLink(wsClient)                  |\n|    InMemoryCache with type policies (Universal State v2) |\n|    Cache persistence \u2192 IndexedDB (apollo-cache-persist)  |\n|                                                           |\n|  Axios Client (client.ts)                                |\n|    Interceptors: authInterceptor \u2192 retryInterceptor      |\n|                  \u2192 errorInterceptor                       |\n|                                                           |\n|  Router Proxy (router-proxy.ts)                          |\n|    makeRouterOSRequest \u2192 POST /api/router/proxy          |\n|                                                           |\n|  Offline Support                                         |\n|    offline-detector.ts  \u2192 useNetworkStore                |\n|    offline-queue.ts     \u2192 IndexedDB mutation queue       |\n+----------------------------------------------------------+\n          |                                |\n          v                                v\n+--------------------+          +---------------------+\n| NasNet Go backend  |          | NasNet Go backend   |\n| POST /graphql      |          | POST /api/router/   |\n| (queries/mutations)|          |   proxy             |\n| GET  /graphql (WS) |          | (CORS bypass for    |\n| (subscriptions)    |          |  RouterOS REST API) |\n+--------------------+          +---------------------+\n          |                                |\n          v                                v\n+----------------------------------------------------------+\n|                 MikroTik RouterOS                         |\n+----------------------------------------------------------+\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.h3,{id:"1-wrap-your-app-in-the-apollo-provider",children:"1. Wrap your app in the Apollo provider"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// apps/connect/src/app/providers/index.tsx\nimport { ApolloProvider } from '@nasnet/api-client/core';\n\nexport function Providers({ children }: { children: ReactNode }) {\n  return (\n    <ApolloProvider>\n      {children}\n    </ApolloProvider>\n  );\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ApolloProvider"})," automatically restores the persisted cache from IndexedDB before rendering children, and lazy-loads Apollo DevTools in development."]}),"\n",(0,i.jsx)(n.h3,{id:"2-set-up-offline-detection",children:"2. Set up offline detection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// apps/connect/src/app/App.tsx\nimport { useOfflineDetector } from '@nasnet/api-client/core';\n\nexport function App() {\n  useOfflineDetector();  // monitors browser + WS + periodic health check\n  return <RouterOutlet />;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-use-domain-query-hooks-in-feature-components",children:"3. Use domain query hooks in feature components"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// A typical feature component\nimport { useGetRouter } from '@nasnet/api-client/queries';\nimport { useQueryWithLoading } from '@nasnet/api-client/core';\n\nfunction RouterOverview({ routerId }: { routerId: string }) {\n  const { data, isInitialLoading, error } = useGetRouter(routerId);\n\n  if (isInitialLoading) return <OverviewSkeleton />;\n  if (error) return <ErrorCard error={error} />;\n\n  return <RouterDetails router={data.router} />;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-execute-mutations",children:"4. Execute mutations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"import { useUpdateRouterName } from '@nasnet/api-client/queries';\nimport { useMutationWithLoading } from '@nasnet/api-client/core';\n\nfunction RenameForm({ routerId }: { routerId: string }) {\n  const { mutate, isLoading } = useMutationWithLoading(UPDATE_ROUTER_NAME);\n\n  return (\n    <form onSubmit={(e) => {\n      e.preventDefault();\n      mutate({ id: routerId, name: e.currentTarget.name.value });\n    }}>\n      <input name=\"name\" />\n      <Button type=\"submit\" disabled={isLoading}>\n        {isLoading ? 'Saving...' : 'Save'}\n      </Button>\n    </form>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-direct-routeros-access-when-graphql-is-not-available",children:"5. Direct RouterOS access (when GraphQL is not available)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { makeRouterOSRequest } from '@nasnet/api-client/core';\n\nconst result = await makeRouterOSRequest<SystemResource[]>(\n  '192.168.88.1',\n  'system/resource'\n);\n\nif (result.success) {\n  console.log(result.data);  // camelCase keys\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"6-code-generation",children:"6. Code generation"}),"\n",(0,i.jsxs)(n.p,{children:["After modifying any ",(0,i.jsx)(n.code,{children:".graphql"})," schema file, regenerate types and hooks:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm run codegen        # full: TypeScript + Go\nnpm run codegen:ts     # TypeScript only (types, hooks, Zod schemas)\nnpm run codegen:check  # verify generated code matches schema\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"decision-matrix",children:"Decision Matrix"}),"\n",(0,i.jsx)(n.p,{children:"Use this table to decide which layer to use for a given scenario:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scenario"}),(0,i.jsx)(n.th,{children:"Recommended approach"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Reading structured data from the NasNet backend (routers, resources, services)"}),(0,i.jsxs)(n.td,{children:["Apollo ",(0,i.jsx)(n.code,{children:"useQuery"})," or a domain query hook from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/queries"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Real-time data (router status, service logs, bandwidth charts)"}),(0,i.jsx)(n.td,{children:"Apollo subscription via WebSocket"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Creating, updating, deleting entities"}),(0,i.jsxs)(n.td,{children:["Apollo ",(0,i.jsx)(n.code,{children:"useMutation"})," or domain mutation hook"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Multi-step workflow with pending/apply/rollback semantics"}),(0,i.jsxs)(n.td,{children:["Apollo mutation with change-set pattern (",(0,i.jsx)(n.code,{children:"./change-set-pattern.md"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Raw RouterOS REST API access (non-GraphQL)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"makeRouterOSRequest"})," from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/core"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"TanStack Query + RouterOS data (router discovery flow)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"createProxyQueryFn"})," / ",(0,i.jsx)(n.code,{children:"createProxyMutationFn"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Authentication (login, token refresh)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"apiClient"})," (Axios) \u2014 before Apollo is configured"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:["Backend REST endpoints outside GraphQL (",(0,i.jsx)(n.code,{children:"/api/v1/*"}),")"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"apiClient"})," (Axios)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Storybook story that needs Apollo context"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"MockApolloProvider"})," from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/core"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Unit test that needs mock GraphQL responses"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"MockedProvider"})," from ",(0,i.jsx)(n.code,{children:"@apollo/client/testing"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"GraphQL schema drives Apollo."})," If a data shape exists in ",(0,i.jsx)(n.code,{children:"schema/"}),", use Apollo. If you need data that the Go backend proxies but does not expose through GraphQL (e.g., raw RouterOS diagnostic endpoints), use ",(0,i.jsx)(n.code,{children:"makeRouterOSRequest"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"document-navigation-index",children:"Document Navigation Index"}),"\n",(0,i.jsx)(n.p,{children:"The following documents cover each area of the library in detail:"}),"\n",(0,i.jsx)(n.h3,{id:"core-transport",children:"Core Transport"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/apollo-client",children:"01 - Apollo Client"})}),"\nThe complete Apollo Client infrastructure: the four-link chain (",(0,i.jsx)(n.code,{children:"errorLink"})," \u2192 ",(0,i.jsx)(n.code,{children:"retryLink"})," \u2192 ",(0,i.jsx)(n.code,{children:"splitLink"}),"), the WebSocket client with exponential backoff reconnection, the InMemoryCache with Universal State v2 type policies, cache persistence to IndexedDB, offline detection, the offline mutation queue, and both the production ",(0,i.jsx)(n.code,{children:"ApolloProvider"})," and ",(0,i.jsx)(n.code,{children:"MockApolloProvider"}),". Covers all exports from ",(0,i.jsx)(n.code,{children:"core/src/apollo/"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/axios-http-client",children:"02 - Axios HTTP Client"})}),"\nThe Axios factory (",(0,i.jsx)(n.code,{children:"createApiClient"}),"), the ",(0,i.jsx)(n.code,{children:"apiClient"})," singleton, the three-interceptor chain (auth \u2192 retry \u2192 error), the router proxy client (",(0,i.jsx)(n.code,{children:"makeRouterOSRequest"}),", ",(0,i.jsx)(n.code,{children:"createProxyQueryFn"}),", ",(0,i.jsx)(n.code,{children:"createProxyMutationFn"}),"), the ",(0,i.jsx)(n.code,{children:"ApiError"})," class, and the ",(0,i.jsx)(n.code,{children:"StoredCredentials"})," flow. Covers all exports from ",(0,i.jsx)(n.code,{children:"core/src/client.ts"}),", ",(0,i.jsx)(n.code,{children:"core/src/router-proxy.ts"}),", and ",(0,i.jsx)(n.code,{children:"core/src/interceptors/"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"authentication-and-security",children:"Authentication and Security"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/authentication",children:"03 - Authentication"})}),"\nHow JWT tokens are stored in ",(0,i.jsx)(n.code,{children:"useAuthStore"}),", how Basic auth credentials flow through ",(0,i.jsx)(n.code,{children:"sessionStorage"})," per router, how both the Apollo auth link and the Axios auth interceptor obtain tokens, and the ",(0,i.jsx)(n.code,{children:"auth:expired"})," event contract."]}),"\n",(0,i.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/error-handling",children:"04 - Error Handling"})}),"\nThe structured error code taxonomy (",(0,i.jsx)(n.code,{children:"P1xx"})," platform, ",(0,i.jsx)(n.code,{children:"R2xx"})," protocol, ",(0,i.jsx)(n.code,{children:"N3xx"})," network, ",(0,i.jsx)(n.code,{children:"V4xx"})," validation, ",(0,i.jsx)(n.code,{children:"A5xx"})," auth, ",(0,i.jsx)(n.code,{children:"S6xx"})," resource), the ",(0,i.jsx)(n.code,{children:"useGraphQLError"})," hook, error boundaries, the throttled ",(0,i.jsx)(n.code,{children:"logError"})," / ",(0,i.jsx)(n.code,{children:"logGraphQLError"})," / ",(0,i.jsx)(n.code,{children:"logNetworkError"})," utilities, and how validation errors are intentionally skipped by the global error link and handled by React Hook Form."]}),"\n",(0,i.jsx)(n.h3,{id:"connectivity",children:"Connectivity"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/offline-first",children:"05 - Offline First"})}),"\nThe complete offline-first architecture: cache persistence lifecycle, the ",(0,i.jsx)(n.code,{children:"OfflineMutationQueue"})," with FIFO replay and last-write-wins deduplication, ",(0,i.jsx)(n.code,{children:"setupAutoReplay"}),", how ",(0,i.jsx)(n.code,{children:"isOffline()"})," and ",(0,i.jsx)(n.code,{children:"isDegraded()"})," work, and the UI patterns for degraded mode (stale data badges, reconnecting banners)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/websocket-subscriptions",children:"06 - WebSocket Subscriptions"})}),"\nHow to write and consume GraphQL subscriptions, the ",(0,i.jsx)(n.code,{children:"graphql-ws"})," transport, the reconnect strategy and exponential backoff, connection lifecycle events (",(0,i.jsx)(n.code,{children:"ws:connecting"}),", ",(0,i.jsx)(n.code,{children:"ws:connected"}),", ",(0,i.jsx)(n.code,{children:"ws:closed"}),", ",(0,i.jsx)(n.code,{children:"ws:error"}),"), and patterns for real-time data in the router dashboard."]}),"\n",(0,i.jsx)(n.h3,{id:"data-model",children:"Data Model"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/universal-state-resource-model",children:"07 - Universal State Resource Model"})}),"\nThe eight-layer resource model (Config \u2192 Desired \u2192 Deployment \u2192 Runtime \u2192 Telemetry \u2192 Validation \u2192 Metadata \u2192 Relations) and how it maps to Apollo cache type policies in ",(0,i.jsx)(n.code,{children:"apollo-client.ts"}),". Covers ",(0,i.jsx)(n.code,{children:"keyFields: ['uuid']"}),", the runtime merge strategy, and the 24-hour bandwidth history accumulation."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/change-set-pattern",children:"08 - Change Set Pattern"})}),"\nThe Apply-Confirm-Merge flow for configuration changes: how ",(0,i.jsx)(n.code,{children:"useChangeSetMutations"})," and ",(0,i.jsx)(n.code,{children:"useChangeSetSubscription"})," work, optimistic UI with automatic rollback, the ",(0,i.jsx)(n.code,{children:"change-set/"})," query domain, and how XState governs the multi-step apply pipeline."]}),"\n",(0,i.jsx)(n.h3,{id:"query-hooks",children:"Query Hooks"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/domain-query-hooks",children:"09 - Domain Query Hooks"})}),"\nHow domain hooks in ",(0,i.jsx)(n.code,{children:"queries/src/"})," are structured, the pattern for ",(0,i.jsx)(n.code,{children:"routerId"}),"-scoped queries, the convention for mutation hooks with optimistic updates, and a complete catalog of available hooks across all 19 domains (alerts, batch, change-set, dhcp, diagnostics, discovery, dns, firewall, network, notifications, oui, resources, router, services, storage, system, vpn, wan, wireless)."]}),"\n",(0,i.jsx)(n.h3,{id:"service-lifecycle",children:"Service Lifecycle"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/service-lifecycle",children:"10 - Service Lifecycle"})}),"\nThe feature marketplace service lifecycle (install, start, stop, update, uninstall) as modeled through ",(0,i.jsx)(n.code,{children:"services/"})," query hooks and the GraphQL subscriptions that track async operation progress."]}),"\n",(0,i.jsx)(n.h3,{id:"testing-and-codegen",children:"Testing and Codegen"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/testing-and-codegen",children:"11 - Testing and Codegen"})}),"\nHow to test components that use Apollo: ",(0,i.jsx)(n.code,{children:"MockApolloProvider"})," for loading states, ",(0,i.jsx)(n.code,{children:"MockedProvider"})," for mocked responses, subscription testing utilities (",(0,i.jsx)(n.code,{children:"core/src/apollo/__tests__/subscription-test-utils.ts"}),"). The codegen pipeline: schema \u2192 ",(0,i.jsx)(n.code,{children:"npm run codegen:ts"})," \u2192 ",(0,i.jsx)(n.code,{children:"generated/types.ts"}),", ",(0,i.jsx)(n.code,{children:"generated/operations.ts"}),", ",(0,i.jsx)(n.code,{children:"generated/schemas/"}),". How to add new operations, regenerate, and verify with ",(0,i.jsx)(n.code,{children:"npm run codegen:check"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"schema-and-domain-layers",children:"Schema and Domain Layers"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/graphql-schema-contracts",children:"12 - GraphQL Schema Contracts"})}),"\nThe 12 custom scalars (DateTime, JSON, IPv4, IPv6, MAC, CIDR, Port, PortRange, Duration, Bandwidth, Size, ULID) and their TypeScript mappings. The full directive taxonomy: ",(0,i.jsx)(n.code,{children:"@cache"}),", ",(0,i.jsx)(n.code,{children:"@realtime"}),", ",(0,i.jsx)(n.code,{children:"@validate"}),", ",(0,i.jsx)(n.code,{children:"@sensitive"}),", ",(0,i.jsx)(n.code,{children:"@auth"}),", ",(0,i.jsx)(n.code,{children:"@capability"}),", ",(0,i.jsx)(n.code,{children:"@migrateFrom"}),", and platform mapping directives. How Zod schemas are generated from ",(0,i.jsx)(n.code,{children:"@validate"})," constraints and how to use them in React Hook Form. Covers all directives from ",(0,i.jsx)(n.code,{children:"schema/core/core-directives-*.graphql"})," and ",(0,i.jsx)(n.code,{children:"schema/scalars.graphql"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/tanstack-query-modules",children:"13 - TanStack Query Modules"})}),"\nThe three REST-only modules that use TanStack Query instead of Apollo: batch job submission/polling, MAC vendor lookup (OUI), and router connection testing. The decision boundary between GraphQL (Apollo) and REST (TanStack Query). Caching strategies: batch jobs poll until terminal state, vendor lookups cache indefinitely, connection tests never cache. Includes ",(0,i.jsx)(n.code,{children:"useBatchJob"}),", ",(0,i.jsx)(n.code,{children:"useCreateBatchJob"}),", ",(0,i.jsx)(n.code,{children:"useCancelBatchJob"}),", ",(0,i.jsx)(n.code,{children:"useVendorLookup"}),", ",(0,i.jsx)(n.code,{children:"useBatchVendorLookup"}),", and ",(0,i.jsx)(n.code,{children:"useTestConnection"})," hooks with examples. Covers ",(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/batch/"}),", ",(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/oui/"}),", and ",(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/discovery/"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/api-client/notifications-webhooks",children:"14 - Notifications and Webhooks"})}),"\nWebhook CRUD operations and delivery monitoring. Query hooks: ",(0,i.jsx)(n.code,{children:"useWebhooks"}),", ",(0,i.jsx)(n.code,{children:"useWebhook"}),", ",(0,i.jsx)(n.code,{children:"useNotificationLogs"}),". Mutation hooks: ",(0,i.jsx)(n.code,{children:"useCreateWebhook"}),", ",(0,i.jsx)(n.code,{children:"useUpdateWebhook"}),", ",(0,i.jsx)(n.code,{children:"useDeleteWebhook"}),", ",(0,i.jsx)(n.code,{children:"useTestWebhook"}),". Webhook types (GENERIC, SLACK, DISCORD, TEAMS, CUSTOM), auth types (NONE, BASIC, BEARER), and delivery stats tracking. Cache update strategies (add-to-list, in-place update, evict+gc). Integration with alert rules. Covers all exports from ",(0,i.jsx)(n.code,{children:"libs/api-client/queries/src/notifications/webhooks.ts"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},71184:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var t=r(14041);const i={},o=t.createContext(i);function s(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);
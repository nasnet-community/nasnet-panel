"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[14362],{50540:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"api-client-and-graphql","title":"API Client and GraphQL","description":"This document covers the complete API client layer used by the libs/features/ modules to communicate with the NasNetConnect backend. The layer is built on Apollo Client 3 with a schema-first GraphQL design.","source":"@site/../../libs/features/docs/api-client-and-graphql.md","sourceDirName":".","slug":"/api-client-and-graphql","permalink":"/docs/features/api-client-and-graphql","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/features/docs/api-client-and-graphql.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Introduction","permalink":"/docs/features/intro"},"next":{"title":"Architecture Overview","permalink":"/docs/features/architecture-overview"}}');var i=r(31085),t=r(71184);const c={},d="API Client and GraphQL",l={},o=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"1. Architecture Overview",id:"1-architecture-overview",level:2},{value:"2. Apollo Client Configuration",id:"2-apollo-client-configuration",level:2},{value:"3. Link Chain",id:"3-link-chain",level:2},{value:"errorLink (<code>apollo-error-link.ts</code>)",id:"errorlink-apollo-error-linkts",level:3},{value:"retryLink (<code>apollo-retry-link.ts</code>)",id:"retrylink-apollo-retry-linkts",level:3},{value:"authLink (<code>apollo-auth-link.ts</code>)",id:"authlink-apollo-auth-linkts",level:3},{value:"wsClient (<code>apollo-ws-client.ts</code>)",id:"wsclient-apollo-ws-clientts",level:3},{value:"4. Cache Configuration",id:"4-cache-configuration",level:2},{value:"Key Type Policies",id:"key-type-policies",level:3},{value:"5. Query Modules Reference",id:"5-query-modules-reference",level:2},{value:"6. Query Hook Patterns",id:"6-query-hook-patterns",level:2},{value:"Standard useQuery Hook",id:"standard-usequery-hook",level:3},{value:"Hook with Conditional Skip",id:"hook-with-conditional-skip",level:3},{value:"useQueryWithLoading",id:"usequerywithloading",level:3},{value:"7. Mutation Patterns",id:"7-mutation-patterns",level:2},{value:"Basic Mutation",id:"basic-mutation",level:3},{value:"Mutation with Optimistic Update",id:"mutation-with-optimistic-update",level:3},{value:"Cache Invalidation",id:"cache-invalidation",level:3},{value:"8. Subscription Patterns",id:"8-subscription-patterns",level:2},{value:"Single Resource Runtime Subscription",id:"single-resource-runtime-subscription",level:3},{value:"State Change Subscription",id:"state-change-subscription",level:3},{value:"Validation Progress Subscription",id:"validation-progress-subscription",level:3},{value:"Batch Runtime for Lists",id:"batch-runtime-for-lists",level:3},{value:"Combined Subscription Hook",id:"combined-subscription-hook",level:3},{value:"WebSocket Connection Parameters",id:"websocket-connection-parameters",level:3},{value:"9. GraphQL Schema Organization",id:"9-graphql-schema-organization",level:2},{value:"Schema-First Principle",id:"schema-first-principle",level:3},{value:"10. Custom Scalars",id:"10-custom-scalars",level:2},{value:"11. Custom Directives",id:"11-custom-directives",level:2},{value:"Validation Directive (<code>@validate</code>)",id:"validation-directive-validate",level:3},{value:"Sensitive Data Directive (<code>@sensitive</code>)",id:"sensitive-data-directive-sensitive",level:3},{value:"Platform Mapping Directives",id:"platform-mapping-directives",level:3},{value:"Capability Directive (<code>@capability</code>)",id:"capability-directive-capability",level:3},{value:"Realtime Directive (<code>@realtime</code>)",id:"realtime-directive-realtime",level:3},{value:"Cache Directive (<code>@cache</code>)",id:"cache-directive-cache",level:3},{value:"Auth Directive (<code>@auth</code>)",id:"auth-directive-auth",level:3},{value:"12. Generated Code",id:"12-generated-code",level:2},{value:"TypeScript Types",id:"typescript-types",level:3},{value:"13. Zod Validation Schemas",id:"13-zod-validation-schemas",level:2},{value:"14. Error Handling Patterns",id:"14-error-handling-patterns",level:2},{value:"In Query Hooks",id:"in-query-hooks",level:3},{value:"useGraphQLError",id:"usegraphqlerror",level:3},{value:"Global Error Handling",id:"global-error-handling",level:3},{value:"Feature-Level Error Components",id:"feature-level-error-components",level:3},{value:"15. Code Generation Workflow",id:"15-code-generation-workflow",level:2},{value:"When to Run Codegen",id:"when-to-run-codegen",level:3},{value:"Codegen Inputs and Outputs",id:"codegen-inputs-and-outputs",level:3},{value:"Cross-References",id:"cross-references",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"api-client-and-graphql",children:"API Client and GraphQL"})}),"\n",(0,i.jsxs)(n.p,{children:["This document covers the complete API client layer used by the ",(0,i.jsx)(n.code,{children:"libs/features/"})," modules to communicate with the NasNetConnect backend. The layer is built on Apollo Client 3 with a schema-first GraphQL design."]}),"\n",(0,i.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#1-architecture-overview",children:"Architecture Overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#2-apollo-client-configuration",children:"Apollo Client Configuration"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#3-link-chain",children:"Link Chain"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#4-cache-configuration",children:"Cache Configuration"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#5-query-modules-reference",children:"Query Modules Reference"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#6-query-hook-patterns",children:"Query Hook Patterns"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#7-mutation-patterns",children:"Mutation Patterns"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#8-subscription-patterns",children:"Subscription Patterns"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#9-graphql-schema-organization",children:"GraphQL Schema Organization"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#10-custom-scalars",children:"Custom Scalars"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#11-custom-directives",children:"Custom Directives"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#12-generated-code",children:"Generated Code"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#13-zod-validation-schemas",children:"Zod Validation Schemas"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#14-error-handling-patterns",children:"Error Handling Patterns"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#15-code-generation-workflow",children:"Code Generation Workflow"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-architecture-overview",children:"1. Architecture Overview"}),"\n",(0,i.jsx)(n.p,{children:"The API client layer is split across two library roots:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"libs/api-client/\n\u251c\u2500\u2500 core/                   # Apollo Client setup (links, cache, provider)\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 apollo/         # Client, links, WS, persistence\n\u2502       \u251c\u2500\u2500 hooks/          # useGraphQLError, useQueryWithLoading\n\u2502       \u251c\u2500\u2500 interceptors/   # Axios-style interceptors (error.ts)\n\u2502       \u2514\u2500\u2500 utils/          # error-messages.ts, error-logging.ts\n\u251c\u2500\u2500 queries/                # Domain query/mutation/subscription hooks\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 alerts/         # Alert rules, templates, digest\n\u2502       \u251c\u2500\u2500 batch/          # Batch job hooks\n\u2502       \u251c\u2500\u2500 change-set/     # Change set queries and mutations\n\u2502       \u251c\u2500\u2500 dhcp/           # DHCP server and lease operations\n\u2502       \u251c\u2500\u2500 diagnostics/    # Troubleshoot, ping, traceroute\n\u2502       \u251c\u2500\u2500 discovery/      # Router connection testing\n\u2502       \u251c\u2500\u2500 dns/            # DNS configuration hooks\n\u2502       \u251c\u2500\u2500 firewall/       # Filter, mangle, NAT, raw, connections\n\u2502       \u251c\u2500\u2500 network/        # Interfaces, bridges, VLANs, routes, DNS\n\u2502       \u251c\u2500\u2500 notifications/  # Notification channel hooks\n\u2502       \u251c\u2500\u2500 oui/            # Vendor lookup by MAC OUI\n\u2502       \u251c\u2500\u2500 resources/      # Universal State v2 resource layers\n\u2502       \u251c\u2500\u2500 services/       # Feature marketplace (instances, VIF, logs)\n\u2502       \u251c\u2500\u2500 storage/        # Storage info and configuration\n\u2502       \u251c\u2500\u2500 system/         # IP services, system notes\n\u2502       \u251c\u2500\u2500 vpn/            # PPP, IPsec active connections\n\u2502       \u2514\u2500\u2500 wan/            # WAN interface queries and mutations\n\u2514\u2500\u2500 generated/              # Codegen output\n    \u251c\u2500\u2500 index.ts            # possibleTypes (union/interface resolution)\n    \u2514\u2500\u2500 schemas/            # Zod schemas and network validators\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"schema/"})," directory at the repository root is the single source of truth for all GraphQL types. Feature modules import from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/queries"})," and never write raw ",(0,i.jsx)(n.code,{children:"gql"})," strings themselves (with the exception of resource layer hooks which define inline fragments)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-apollo-client-configuration",children:"2. Apollo Client Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"libs/api-client/core/src/apollo/apollo-client.ts"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export const apolloClient: ApolloClient<NormalizedCacheObject> = new ApolloClient({\n  link,   // full link chain (see section 3)\n  cache,  // InMemoryCache with possibleTypes and type policies\n  defaultOptions: {\n    watchQuery: {\n      fetchPolicy: 'cache-and-network',   // serve cache immediately, refresh from network\n      nextFetchPolicy: 'cache-first',     // avoid redundant network requests on re-render\n      errorPolicy: 'all',                 // return partial data on field-level errors\n    },\n    query: {\n      fetchPolicy: 'cache-first',\n      errorPolicy: 'all',\n    },\n    mutate: {\n      errorPolicy: 'all',\n    },\n  },\n  connectToDevTools: import.meta.env.DEV,\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The client is used via ",(0,i.jsx)(n.code,{children:"ApolloProvider"})," (",(0,i.jsx)(n.code,{children:"libs/api-client/core/src/apollo/apollo-provider.tsx"}),"), which also initializes IndexedDB/localStorage cache persistence (5 MB limit, 1 s debounce) before rendering children to enable offline data availability."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-link-chain",children:"3. Link Chain"}),"\n",(0,i.jsx)(n.p,{children:"The complete request processing chain runs as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Request \u2192 errorLink \u2192 retryLink \u2192 splitLink\n                                       \u251c\u2500\u2500 (subscription) wsLink (WebSocket)\n                                       \u2514\u2500\u2500 (query/mutation) authLink \u2192 httpLink\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"errorlink-apollo-error-linkts",children:["errorLink (",(0,i.jsx)(n.code,{children:"apollo-error-link.ts"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Handles all GraphQL and network errors centrally:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["GraphQL ",(0,i.jsx)(n.code,{children:"UNAUTHENTICATED"})]})," - calls ",(0,i.jsx)(n.code,{children:"useAuthStore.getState().clearAuth()"}),", fires ",(0,i.jsx)(n.code,{children:"auth:expired"})," event"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["GraphQL ",(0,i.jsx)(n.code,{children:"FORBIDDEN"})]}),' - shows "Access denied" notification via ',(0,i.jsx)(n.code,{children:"useNotificationStore"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["GraphQL ",(0,i.jsx)(n.code,{children:"NOT_FOUND"})]}),' - shows "Not found" warning notification']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HTTP 401"})," - triggers auth clear and redirect"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HTTP 403"})," - shows permission denied notification"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Network errors"})," - fires ",(0,i.jsx)(n.code,{children:"network:error"})," custom event and shows generic error toast"]}),"\n",(0,i.jsx)(n.li,{children:"Validation errors (form-level) are intentionally skipped"}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"retrylink-apollo-retry-linkts",children:["retryLink (",(0,i.jsx)(n.code,{children:"apollo-retry-link.ts"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Automatic retry with exponential backoff:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const retryLink = new RetryLink({\n  delay: { initial: 300, max: 3000, jitter: true },\n  attempts: {\n    max: 3,\n    retryIf: (error) => {\n      const isNetworkError = !!error && !error.result;\n      const isClientError = statusCode >= 400 && statusCode < 500;\n      return isNetworkError && !isClientError;\n    },\n  },\n});\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"authlink-apollo-auth-linkts",children:["authLink (",(0,i.jsx)(n.code,{children:"apollo-auth-link.ts"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Injects per-request headers using Zustand store state (not React context):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export const authLink = setContext((_, { headers }) => {\n  const { currentRouterId } = useConnectionStore.getState();\n  const authorization = getAuthorizationHeader(currentRouterId);\n  return {\n    headers: {\n      ...headers,\n      'X-Router-Id': currentRouterId || '',\n      ...(authorization && { Authorization: authorization }),\n    },\n  };\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"Authorization priority:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["JWT Bearer token from ",(0,i.jsx)(n.code,{children:"useAuthStore"})]}),"\n",(0,i.jsxs)(n.li,{children:["Basic auth from ",(0,i.jsx)(n.code,{children:"sessionStorage"})," per-router credentials (",(0,i.jsx)(n.code,{children:"router-credentials-{routerId}"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"wsclient-apollo-ws-clientts",children:["wsClient (",(0,i.jsx)(n.code,{children:"apollo-ws-client.ts"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["GraphQL subscriptions use ",(0,i.jsx)(n.code,{children:"graphql-ws"})," over WebSocket with:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Auto-detected URL (",(0,i.jsx)(n.code,{children:"wss://"})," on HTTPS, ",(0,i.jsx)(n.code,{children:"ws://"})," on HTTP)"]}),"\n",(0,i.jsxs)(n.li,{children:["Re-authentication on every reconnect via ",(0,i.jsx)(n.code,{children:"connectionParams"})]}),"\n",(0,i.jsxs)(n.li,{children:["Exponential backoff with ",(0,i.jsx)(n.code,{children:"calculateBackoff"})," from reconnect utilities"]}),"\n",(0,i.jsx)(n.li,{children:"Maximum 10 retry attempts"}),"\n",(0,i.jsx)(n.li,{children:"Does not retry on close codes 4401 (auth failed) or 4403 (forbidden)"}),"\n",(0,i.jsxs)(n.li,{children:["Updates ",(0,i.jsx)(n.code,{children:"useConnectionStore"})," (connecting / connected / error / disconnected)"]}),"\n",(0,i.jsx)(n.li,{children:"Shows toast notifications when reconnected after outage"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-cache-configuration",children:"4. Cache Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"libs/api-client/core/src/apollo/apollo-client.ts"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const cache = new InMemoryCache({\n  possibleTypes: possibleTypesResult.possibleTypes, // from codegen\n  typePolicies: { ... }\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"key-type-policies",children:"Key Type Policies"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Key Field"}),(0,i.jsx)(n.th,{children:"Runtime/Telemetry Merge"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Router"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"id"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"status"})," field deep-merged"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Resource"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"uuid"})," (ULID)"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"runtime"})," merged, ",(0,i.jsx)(n.code,{children:"telemetry"})," appended (24h rolling, 288 5-min intervals)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"WireGuardClient"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uuid"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"runtime"})," merged"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LANNetwork"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uuid"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"runtime"})," merged"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"WANLink"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uuid"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"runtime"})," merged"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"FeatureResource"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uuid"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"runtime"})," merged"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ValidationResult"})}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsxs)(n.td,{children:["Full replacement (",(0,i.jsx)(n.code,{children:"merge: false"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DeploymentState"})}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsxs)(n.td,{children:["Full replacement (",(0,i.jsx)(n.code,{children:"merge: false"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RuntimeState"})}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsxs)(n.td,{children:["Shallow merge (",(0,i.jsx)(n.code,{children:"merge: true"}),")"]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"routers"})," query field is keyed by ",(0,i.jsx)(n.code,{children:"filter"})," argument. The ",(0,i.jsx)(n.code,{children:"resources"})," query field is keyed by ",(0,i.jsx)(n.code,{children:"[routerId, category, type, state]"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Telemetry history merge keeps the last 288 data points (24 hours at 5-minute intervals):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"bandwidthHistory: [\n  ...(existing.bandwidthHistory ?? []),\n  ...(incoming.bandwidthHistory ?? []),\n].slice(-288),\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-query-modules-reference",children:"5. Query Modules Reference"}),"\n",(0,i.jsxs)(n.p,{children:["All query hooks are exported from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/queries"}),". The table below lists all 21 domain modules."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Domain"}),(0,i.jsx)(n.th,{children:"Path"}),(0,i.jsx)(n.th,{children:"Key Hooks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"alerts"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/alerts/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useAlertRuleTemplates"}),", ",(0,i.jsx)(n.code,{children:"useAlertTemplate"}),", ",(0,i.jsx)(n.code,{children:"useSaveAlertTemplate"}),", ",(0,i.jsx)(n.code,{children:"usePreviewAlertTemplate"}),", ",(0,i.jsx)(n.code,{children:"useDigestQueueCount"}),", ",(0,i.jsx)(n.code,{children:"useDigestHistory"}),", ",(0,i.jsx)(n.code,{children:"useTriggerDigestNow"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"batch"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/batch/"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"useBatchJob"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"change-set"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/change-set/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useChangeSetQueries"}),", ",(0,i.jsx)(n.code,{children:"useChangeSetMutations"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dhcp"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/dhcp/"})}),(0,i.jsx)(n.td,{children:"DHCP server queries, lease mutations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"diagnostics"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/diagnostics/"})}),(0,i.jsxs)(n.td,{children:["Troubleshoot step operations (see ",(0,i.jsx)(n.code,{children:"operations.ts"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"discovery"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/discovery/"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"useTestConnection"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dns"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/dns/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useDNS"}),", DNS mutations"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"firewall"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/firewall/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useFilterRules"}),", ",(0,i.jsx)(n.code,{children:"useMangleRules"}),", ",(0,i.jsx)(n.code,{children:"useRawRules"}),", ",(0,i.jsx)(n.code,{children:"useConnections"}),", ",(0,i.jsx)(n.code,{children:"useKillConnection"}),", ",(0,i.jsx)(n.code,{children:"useConnectionTrackingSettings"}),", ",(0,i.jsx)(n.code,{children:"useUpdateConnectionTracking"}),", firewall templates"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"network"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/network/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useBridgeQueries"}),", ",(0,i.jsx)(n.code,{children:"useBridgeMutations"}),", ",(0,i.jsx)(n.code,{children:"useInterfaceMutations"}),", ",(0,i.jsx)(n.code,{children:"useIPAddressMutations"}),", ",(0,i.jsx)(n.code,{children:"useVlanMutations"}),", ",(0,i.jsx)(n.code,{children:"useRoutes"}),", ",(0,i.jsx)(n.code,{children:"useRouteLookup"}),", ",(0,i.jsx)(n.code,{children:"useDnsLookup"}),", ",(0,i.jsx)(n.code,{children:"useDnsBenchmark"}),", ",(0,i.jsx)(n.code,{children:"useDnsCacheStats"}),", ",(0,i.jsx)(n.code,{children:"useFlushDnsCache"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"notifications"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/notifications/"})}),(0,i.jsx)(n.td,{children:"Notification channel operations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"oui"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/oui/"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"useVendorLookup"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"resources"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/resources/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useResourceValidation"}),", ",(0,i.jsx)(n.code,{children:"useResourceDeployment"}),", ",(0,i.jsx)(n.code,{children:"useResourceRuntime"}),", ",(0,i.jsx)(n.code,{children:"useResourceTelemetry"}),", ",(0,i.jsx)(n.code,{children:"useResourceMetadata"}),", ",(0,i.jsx)(n.code,{children:"useResourceRelationships"}),", ",(0,i.jsx)(n.code,{children:"useResourcePlatform"}),", ",(0,i.jsx)(n.code,{children:"useResourceConfiguration"}),", ",(0,i.jsx)(n.code,{children:"useResourceMutations"}),", ",(0,i.jsx)(n.code,{children:"useResourceRuntimeSubscription"}),", ",(0,i.jsx)(n.code,{children:"useResourceStateSubscription"}),", ",(0,i.jsx)(n.code,{children:"useResourceValidationSubscription"}),", ",(0,i.jsx)(n.code,{children:"useResourcesRuntimeSubscription"}),", ",(0,i.jsx)(n.code,{children:"useResourceSubscriptions"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"services"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/services/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useAvailableServices"}),", ",(0,i.jsx)(n.code,{children:"useInstanceMutations"}),", ",(0,i.jsx)(n.code,{children:"useFeatureVerification"}),", ",(0,i.jsx)(n.code,{children:"useVirtualInterfaces"}),", ",(0,i.jsx)(n.code,{children:"useBridgeStatus"}),", ",(0,i.jsx)(n.code,{children:"useDependencies"}),", ",(0,i.jsx)(n.code,{children:"useDependencyMutations"}),", ",(0,i.jsx)(n.code,{children:"useGatewayStatus"}),", ",(0,i.jsx)(n.code,{children:"useVLANAllocations"}),", ",(0,i.jsx)(n.code,{children:"useVLANPoolStatus"}),", ",(0,i.jsx)(n.code,{children:"useCleanupOrphanedVLANs"}),", ",(0,i.jsx)(n.code,{children:"useUpdateVLANPoolConfig"}),", ",(0,i.jsx)(n.code,{children:"useSystemResources"}),", ",(0,i.jsx)(n.code,{children:"useServiceLogs"}),", ",(0,i.jsx)(n.code,{children:"useDiagnostics"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"storage"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/storage/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useStorageInfo"}),", ",(0,i.jsx)(n.code,{children:"useStorageUsage"}),", ",(0,i.jsx)(n.code,{children:"useStorageConfig"}),", ",(0,i.jsx)(n.code,{children:"useStorageMutations"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"system"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/system/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"useIPServices"}),", ",(0,i.jsx)(n.code,{children:"useSystemNote"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"vpn"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/vpn/"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"usePPPActive"}),", ",(0,i.jsx)(n.code,{children:"useIPsecActive"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"wan"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/wan/"})}),(0,i.jsxs)(n.td,{children:["WAN interface queries, ",(0,i.jsx)(n.code,{children:"useWANMutations"})]})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-query-hook-patterns",children:"6. Query Hook Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"standard-usequery-hook",children:"Standard useQuery Hook"}),"\n",(0,i.jsxs)(n.p,{children:["All query hooks wrap Apollo's ",(0,i.jsx)(n.code,{children:"useQuery"})," with domain-specific types and default options:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Example: libs/api-client/queries/src/resources/useResourceLayers.ts\n\nexport function useResourceRuntime(\n  uuid: string | undefined,\n  options: LayerHookOptions = {}\n): LayerHookResult<RuntimeState> {\n  const { skip = false, pollInterval = 0, fetchPolicy = 'cache-and-network' } = options;\n\n  const { data, loading, error, refetch } = useQuery(GET_RESOURCE_RUNTIME, {\n    variables: { uuid },\n    skip: skip || !uuid,   // guard against undefined ID\n    pollInterval,\n    fetchPolicy,\n  });\n\n  return {\n    data: data?.resource?.runtime,\n    loading,\n    error,\n    refetch: async () => { await refetch(); },\n  };\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"LayerHookOptions"})," / ",(0,i.jsx)(n.code,{children:"LayerHookResult<T>"})," pattern is consistent across all resource layer hooks:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface LayerHookOptions {\n  skip?: boolean;\n  pollInterval?: number;\n  fetchPolicy?: 'cache-first' | 'cache-and-network' | 'network-only';\n}\n\ninterface LayerHookResult<T> {\n  data: T | undefined;\n  loading: boolean;\n  error: ApolloError | undefined;\n  refetch: () => Promise<void>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"hook-with-conditional-skip",children:"Hook with Conditional Skip"}),"\n",(0,i.jsx)(n.p,{children:"Always guard queries against missing IDs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { data } = useResourceTelemetry(uuid, {\n  skip: !uuid,\n  pollInterval: 5000,\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"usequerywithloading",children:"useQueryWithLoading"}),"\n",(0,i.jsxs)(n.p,{children:["Available from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/core"})," for loading-state management:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { useQueryWithLoading } from '@nasnet/api-client/core';\n\nconst { data, isLoading } = useQueryWithLoading(GET_DHCP_SERVERS, {\n  variables: { routerId },\n  minLoadingDuration: 500, // prevent flash of loading state\n});\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"7-mutation-patterns",children:"7. Mutation Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"basic-mutation",children:"Basic Mutation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// libs/api-client/queries/src/services/useInstanceMutations.ts\n\nexport function useInstanceMutations() {\n  const client = useApolloClient();\n\n  const [startInstance, startMutation] = useMutation(START_INSTANCE, {\n    refetchQueries: [GET_SERVICE_INSTANCES, GET_SERVICE_INSTANCE],\n  });\n\n  const [deleteInstance] = useMutation(DELETE_INSTANCE, {\n    onCompleted: (data) => {\n      if (data?.deleteInstance?.instance === null) {\n        client.refetchQueries({ include: [GET_SERVICE_INSTANCES] });\n      }\n    },\n  });\n\n  return {\n    startInstance: (input: StartInstanceInput) =>\n      startInstance({ variables: { input } }),\n    deleteInstance: (input: DeleteInstanceInput) =>\n      deleteInstance({ variables: { input } }),\n    loading: {\n      start: startMutation.loading,\n      delete: deleteMutation.loading,\n    },\n    errors: {\n      start: startMutation.error,\n      delete: deleteMutation.error,\n    },\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mutation-with-optimistic-update",children:"Mutation with Optimistic Update"}),"\n",(0,i.jsx)(n.p,{children:"For fast UI feedback before network confirmation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const [toggleDisabled] = useMutation(TOGGLE_FILTER_RULE, {\n  optimisticResponse: {\n    toggleFilterRule: {\n      __typename: 'ToggleFilterRulePayload',\n      rule: { ...currentRule, disabled: !currentRule.disabled },\n    },\n  },\n  update: (cache, { data }) => {\n    cache.modify({\n      id: cache.identify({ __typename: 'FilterRule', id: ruleId }),\n      fields: {\n        disabled: () => data?.toggleFilterRule?.rule?.disabled,\n      },\n    });\n  },\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cache-invalidation",children:"Cache Invalidation"}),"\n",(0,i.jsx)(n.p,{children:"Three strategies are used depending on context:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Strategy 1: refetchQueries (simple list refresh)\nuseMutation(CREATE_BRIDGE, {\n  refetchQueries: [GET_BRIDGES, GET_INTERFACES],\n});\n\n// Strategy 2: cache.evict (remove specific entry)\nuseMutation(DELETE_ADDRESS_LIST, {\n  update: (cache, { data }) => {\n    cache.evict({ id: cache.identify(data.deleteAddressList.deletedEntry) });\n    cache.gc();\n  },\n});\n\n// Strategy 3: client.refetchQueries (imperative, from hook result)\nconst client = useApolloClient();\nawait client.refetchQueries({ include: [GET_SERVICE_INSTANCES] });\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"8-subscription-patterns",children:"8. Subscription Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"single-resource-runtime-subscription",children:"Single Resource Runtime Subscription"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// libs/api-client/queries/src/resources/useResourceSubscription.ts\n\nconst { data, isConnected } = useResourceRuntimeSubscription(uuid, {\n  onUpdate: (event) => {\n    console.log('Runtime metrics:', event.runtime.metrics);\n  },\n  throttleMs: 1000, // throttle to 1 update per second\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The subscription uses ",(0,i.jsx)(n.code,{children:"graphql-ws"})," over the WebSocket link. Updates include the full ",(0,i.jsx)(n.code,{children:"RuntimeState"})," with ",(0,i.jsx)(n.code,{children:"metrics"}),", ",(0,i.jsx)(n.code,{children:"health"}),", ",(0,i.jsx)(n.code,{children:"activeConnections"}),", and ",(0,i.jsx)(n.code,{children:"uptime"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"state-change-subscription",children:"State Change Subscription"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"useResourceStateSubscription(uuid, {\n  onStateChange: (event) => {\n    toast.info(`State: ${event.previousState} \u2192 ${event.newState}`);\n  },\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"validation-progress-subscription",children:"Validation Progress Subscription"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { data } = useResourceValidationSubscription(uuid, {\n  skip: !isValidating,\n  onProgress: (event) => {\n    setCurrentStage(event.stage); // SYNTAX | SEMANTIC | DEPENDENCY | PLATFORM | ...\n  },\n});\n\nif (data?.stage === 'FINAL' && data?.isComplete) {\n  // validation done\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"batch-runtime-for-lists",children:"Batch Runtime for Lists"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const uuids = resources.map(r => r.uuid);\nconst { data: runtimeMap } = useResourcesRuntimeSubscription(uuids);\n\n// data is Map<string, RuntimeState>\nconst runtime = runtimeMap.get(resource.uuid);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"combined-subscription-hook",children:"Combined Subscription Hook"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"useResourceSubscriptions(uuid, {\n  runtime: true,\n  stateChanges: true,\n  validation: false,\n  onRuntimeUpdate: (e) => updateMetrics(e.runtime.metrics),\n  onStateChange: (e) => toast.info(`New state: ${e.newState}`),\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"websocket-connection-parameters",children:"WebSocket Connection Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["Subscriptions authenticate via ",(0,i.jsx)(n.code,{children:"connectionParams"})," on every connection and reconnect:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"connectionParams: () => ({\n  routerId: currentRouterId,\n  authorization: `Bearer ${jwtToken}` || `Basic ${base64(user:pass)}`,\n})\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"9-graphql-schema-organization",children:"9. GraphQL Schema Organization"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"schema/"})," directory contains 15 domain areas totaling 100+ ",(0,i.jsx)(n.code,{children:".graphql"})," files. All operations are defined schema-first and processed by ",(0,i.jsx)(n.code,{children:"gqlgen"})," (Go) and TypeScript codegen."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Domain"}),(0,i.jsx)(n.th,{children:"Location"}),(0,i.jsx)(n.th,{children:"File Count"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Core"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/core/"})}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"Router types, connections, credentials, scanner, capabilities, directives"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Resources"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/resources/"})}),(0,i.jsx)(n.td,{children:"12"}),(0,i.jsx)(n.td,{children:"8-layer Universal State v2 model, composite types"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Network"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/network/"})}),(0,i.jsx)(n.td,{children:"14"}),(0,i.jsx)(n.td,{children:"Interfaces, VLANs, IP, routing, bridges, tunnels, port mirrors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Services"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/services/"})}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"Feature marketplace, dependencies, isolation, traffic, chains, sharing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Alerts"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/alerts/"})}),(0,i.jsx)(n.td,{children:"24"}),(0,i.jsx)(n.td,{children:"Rules, conditions, channels, webhooks, throttle, escalation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Firewall"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/firewall/"})}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"Address lists, NAT, port knocking, filter/mangle/raw/templates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Diagnostics"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/diagnostics/"})}),(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"Troubleshoot, traceroute, DNS lookup, route lookup, DNS cache"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"WAN"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/wan/"})}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"WAN types, health history, operations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Changeset"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/changeset/"})}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"Change set enums, operations, payloads"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Storage"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/storage/"})}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"Storage types, events, operations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Auth"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/auth.graphql"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Authentication types and operations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Health"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/health.graphql"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Health check types"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Port Registry"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/port-registry.graphql"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Port allocation types"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Scalars"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/scalars.graphql"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Custom scalar definitions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Fragments"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/fragments/"})}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"Client-side query fragments (core, telemetry, composite)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"schema-first-principle",children:"Schema-First Principle"}),"\n",(0,i.jsxs)(n.p,{children:["All types are defined in ",(0,i.jsx)(n.code,{children:".graphql"})," files. The backend uses ",(0,i.jsx)(n.code,{children:"gqlgen"})," to generate Go resolver interfaces. The frontend uses ",(0,i.jsx)(n.code,{children:"graphql-code-generator"})," to produce TypeScript types and React hooks."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"10-custom-scalars",children:"10. Custom Scalars"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"schema/scalars.graphql"})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scalar"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DateTime"})}),(0,i.jsx)(n.td,{children:"ISO 8601 datetime"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"2024-01-15T10:30:00Z"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"JSON"})}),(0,i.jsx)(n.td,{children:"Arbitrary JSON for configuration"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'{ "key": "value" }'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"IPv4"})}),(0,i.jsx)(n.td,{children:"IPv4 address"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"192.168.1.1"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"IPv6"})}),(0,i.jsx)(n.td,{children:"IPv6 address"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"2001:0db8::1"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MAC"})}),(0,i.jsx)(n.td,{children:"MAC address (colon or dash separated)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"00:1A:2B:3C:4D:5E"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CIDR"})}),(0,i.jsx)(n.td,{children:"Network address in CIDR notation"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"192.168.1.0/24"'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Port"})}),(0,i.jsx)(n.td,{children:"TCP/UDP port number (1\u201365535)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"8080"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PortRange"})}),(0,i.jsx)(n.td,{children:"Port or port range string"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"80-443"'}),", ",(0,i.jsx)(n.code,{children:'"80,443"'})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Duration"})}),(0,i.jsx)(n.td,{children:"RouterOS duration format"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"1d2h3m4s"'}),", ",(0,i.jsx)(n.code,{children:'"30s"'})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Bandwidth"})}),(0,i.jsx)(n.td,{children:"Bandwidth with unit"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"10M"'}),", ",(0,i.jsx)(n.code,{children:'"1G"'}),", ",(0,i.jsx)(n.code,{children:'"100k"'})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Size"})}),(0,i.jsx)(n.td,{children:"Size in bytes with optional unit"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"1024"'}),", ",(0,i.jsx)(n.code,{children:'"1M"'})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ULID"})}),(0,i.jsx)(n.td,{children:"Lexicographically sortable unique ID"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'"01ARZ3NDEKTSV4RRFFQ69G5FAV"'})})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["In frontend Zod schemas, these map to the network validators exported from ",(0,i.jsx)(n.code,{children:"@nasnet/core/forms"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { ipv4, cidr, mac, port, duration } from '@nasnet/core/forms';\n\nconst schema = z.object({\n  gateway: ipv4,\n  network: cidr,\n  device: mac,\n  listenPort: port,\n  leaseTime: duration,\n});\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"11-custom-directives",children:"11. Custom Directives"}),"\n",(0,i.jsxs)(n.h3,{id:"validation-directive-validate",children:["Validation Directive (",(0,i.jsx)(n.code,{children:"@validate"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"schema/core/core-directives-validation.graphql"})]}),"\n",(0,i.jsx)(n.p,{children:"Used on input fields to declare server-side and codegen-side validation constraints:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'input CreateDHCPServerInput {\n  name: String! @validate(minLength: 1, maxLength: 64)\n  addressPool: CIDR! @validate(format: IPV4)\n  gateway: IPv4 @validate(format: IPV4)\n  leaseTime: Duration @validate(pattern: "^\\\\d+[smhd]$")\n  maxLeases: Int @validate(min: 1, max: 65535)\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Supported arguments: ",(0,i.jsx)(n.code,{children:"min"}),", ",(0,i.jsx)(n.code,{children:"max"}),", ",(0,i.jsx)(n.code,{children:"minLength"}),", ",(0,i.jsx)(n.code,{children:"maxLength"}),", ",(0,i.jsx)(n.code,{children:"pattern"}),", ",(0,i.jsx)(n.code,{children:"format"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Supported format values: ",(0,i.jsx)(n.code,{children:"EMAIL"}),", ",(0,i.jsx)(n.code,{children:"URL"}),", ",(0,i.jsx)(n.code,{children:"UUID"}),", ",(0,i.jsx)(n.code,{children:"IPV4"}),", ",(0,i.jsx)(n.code,{children:"IPV6"}),", ",(0,i.jsx)(n.code,{children:"MAC"}),", ",(0,i.jsx)(n.code,{children:"CIDR"}),", ",(0,i.jsx)(n.code,{children:"HOSTNAME"}),", ",(0,i.jsx)(n.code,{children:"FQDN"}),"."]}),"\n",(0,i.jsxs)(n.h3,{id:"sensitive-data-directive-sensitive",children:["Sensitive Data Directive (",(0,i.jsx)(n.code,{children:"@sensitive"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"input CredentialsInput {\n  username: String!\n  password: String! @sensitive\n  apiKey: String @sensitive\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Values are redacted from logs and error responses in production. The Go resolver layer strips sensitive fields before persisting errors."}),"\n",(0,i.jsx)(n.h3,{id:"platform-mapping-directives",children:"Platform Mapping Directives"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"schema/core/core-directives-platform.graphql"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"# Map to MikroTik RouterOS API path\ndirective @mikrotik(path: String!, field: String, cmd: String) on FIELD_DEFINITION | OBJECT\n\n# Map to OpenWrt ubus call\ndirective @openwrt(ubus: String!, method: String, field: String) on FIELD_DEFINITION | OBJECT\n\n# Map to VyOS configuration path\ndirective @vyos(path: String!, field: String) on FIELD_DEFINITION | OBJECT\n"})}),"\n",(0,i.jsx)(n.p,{children:"Usage example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type IPAddress @mikrotik(path: "/ip/address") {\n  address: CIDR! @mikrotik(path: "/ip/address", field: "address")\n  interface: String! @mikrotik(path: "/ip/address", field: "interface")\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The Go resolver layer reads these directives at runtime to translate GraphQL operations into RouterOS API calls."}),"\n",(0,i.jsxs)(n.h3,{id:"capability-directive-capability",children:["Capability Directive (",(0,i.jsx)(n.code,{children:"@capability"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  containerStats: ContainerStats @capability(requires: ["container"])\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Gates fields based on detected router capabilities. The capability detector runs on connection to determine available features."}),"\n",(0,i.jsxs)(n.h3,{id:"realtime-directive-realtime",children:["Realtime Directive (",(0,i.jsx)(n.code,{children:"@realtime"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Subscription {\n  resourceRuntime(uuid: ULID!): RuntimeUpdateEvent @realtime(interval: 5000, topic: "runtime")\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"cache-directive-cache",children:["Cache Directive (",(0,i.jsx)(n.code,{children:"@cache"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"type Query {\n  routerInfo: RouterInfo @cache(maxAge: 300, scope: PRIVATE)\n}\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"auth-directive-auth",children:["Auth Directive (",(0,i.jsx)(n.code,{children:"@auth"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Mutation {\n  deleteRouter(id: ID!): DeleteRouterPayload @auth(requires: "admin")\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"12-generated-code",children:"12. Generated Code"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"libs/api-client/generated/index.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"possibleTypesResult"})," export contains the union/interface type map required by ",(0,i.jsx)(n.code,{children:"InMemoryCache"})," for correct fragment matching:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { possibleTypesResult } from '@nasnet/api-client/generated';\n\nconst cache = new InMemoryCache({\n  possibleTypes: possibleTypesResult.possibleTypes,\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This is regenerated when the schema changes via ",(0,i.jsx)(n.code,{children:"npm run codegen"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"typescript-types",children:"TypeScript Types"}),"\n",(0,i.jsxs)(n.p,{children:["Generated types are consumed from ",(0,i.jsx)(n.code,{children:"@nasnet/api-client/generated"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import type {\n  StartInstanceInput,\n  StopInstanceInput,\n  RestartInstanceInput,\n  DeleteInstanceInput,\n} from '@nasnet/api-client/generated';\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"13-zod-validation-schemas",children:"13. Zod Validation Schemas"}),"\n",(0,i.jsxs)(n.p,{children:["File: ",(0,i.jsx)(n.code,{children:"libs/api-client/generated/schemas/index.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["The generated schemas module re-exports all network validators from ",(0,i.jsx)(n.code,{children:"@nasnet/core/forms"})," alongside schema utilities:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Network validators\nexport { ipv4, ipv6, ipAddress, mac, cidr, cidr6, port, portRange,\n         vlanId, wgKey, hostname, domain, interfaceName, duration, bandwidth } from '@nasnet/core/forms';\n\n// Schema utilities\nexport { makePartial, mergeSchemas, pickFields, omitFields, conditionalSchema } from '@nasnet/core/forms';\n"})}),"\n",(0,i.jsx)(n.p,{children:"Example schemas included as reference implementations:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// DHCP server schema\nexport const dhcpServerConfigSchema = z.object({\n  name: z.string().min(1).max(64),\n  interface: z.string().min(1),\n  addressPool: cidr,\n  gateway: ipv4,\n  leaseTime: duration,\n  dnsServers: z.array(ipv4).optional(),\n  disabled: z.boolean().default(false),\n});\n\n// WireGuard peer schema\nexport const wireguardPeerSchema = z.object({\n  publicKey: z.string().length(44).regex(/^[A-Za-z0-9+/]{43}=$/),\n  allowedAddress: z.array(cidr).min(1),\n  endpointAddress: ipv4.optional(),\n  endpointPort: port.optional(),\n  persistentKeepalive: z.number().int().min(0).max(65535).optional(),\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Domain feature modules define their own schemas in ",(0,i.jsx)(n.code,{children:"src/schemas/"})," subfolders and compose these validators. See, for example:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"libs/features/network/src/dns/schemas/dns-settings.schema.test.ts"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"libs/features/alerts/src/schemas/alert-rule.schema.d.ts"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"14-error-handling-patterns",children:"14. Error Handling Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"in-query-hooks",children:"In Query Hooks"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { data, loading, error } = useResourceRuntime(uuid);\n\nif (error) {\n  return <ErrorDisplay message={error.message} onRetry={refetch} />;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"usegraphqlerror",children:"useGraphQLError"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { useGraphQLError } from '@nasnet/api-client/core';\n\nconst { error, isAuthError, isNetworkError, userMessage } = useGraphQLError(apolloError);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"global-error-handling",children:"Global Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"errorLink"})," in the link chain handles errors globally:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Auth errors automatically clear auth store and fire ",(0,i.jsx)(n.code,{children:"auth:expired"})]}),"\n",(0,i.jsxs)(n.li,{children:["Network errors fire ",(0,i.jsx)(n.code,{children:"network:error"})," and show toast"]}),"\n",(0,i.jsx)(n.li,{children:"Validation errors are skipped (handled by forms)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"feature-level-error-components",children:"Feature-Level Error Components"}),"\n",(0,i.jsxs)(n.p,{children:["Each feature module provides its own error display components. The network feature has ",(0,i.jsx)(n.code,{children:"ErrorDisplay.tsx"})," for interface-level errors. Diagnostics tools have ",(0,i.jsx)(n.code,{children:"DnsError.tsx"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"15-code-generation-workflow",children:"15. Code Generation Workflow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Full codegen (TypeScript + Go)\nnpm run codegen\n\n# TypeScript types, React hooks, and Zod schemas only\nnpm run codegen:ts\n\n# ent ORM generation (database entities)\nnpm run codegen:ent\n\n# gqlgen resolver stubs (Go backend)\nnpm run codegen:gqlgen\n\n# Both Go generators\nnpm run codegen:go\n\n# Verify generated code is in sync with schema\nnpm run codegen:check\n"})}),"\n",(0,i.jsx)(n.h3,{id:"when-to-run-codegen",children:"When to Run Codegen"}),"\n",(0,i.jsxs)(n.p,{children:["Run ",(0,i.jsx)(n.code,{children:"npm run codegen"})," after any change to:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Files in ",(0,i.jsx)(n.code,{children:"schema/"})," (",(0,i.jsx)(n.code,{children:".graphql"})," files)"]}),"\n",(0,i.jsxs)(n.li,{children:["Files in ",(0,i.jsx)(n.code,{children:"libs/data/ent/schema/"})," (ent schema definitions)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"codegen:check"})," command is run in CI to block merges when generated files are out of sync with the schema."]}),"\n",(0,i.jsx)(n.h3,{id:"codegen-inputs-and-outputs",children:"Codegen Inputs and Outputs"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Input"}),(0,i.jsx)(n.th,{children:"Output"}),(0,i.jsx)(n.th,{children:"Tool"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/**/*.graphql"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"libs/api-client/generated/"})," (TS types, hooks)"]}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"graphql-code-generator"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/**/*.graphql"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/backend/graph/generated.go"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"gqlgen"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"schema/**/*.graphql"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/backend/graph/model/models_gen.go"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"gqlgen"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"libs/data/ent/schema/"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"apps/backend/generated/ent/"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"entgo"})})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Do not manually edit files in ",(0,i.jsx)(n.code,{children:"apps/backend/graph/generated.go"}),", ",(0,i.jsx)(n.code,{children:"apps/backend/graph/model/models_gen.go"}),", or ",(0,i.jsx)(n.code,{children:"apps/backend/generated/ent/"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["State management patterns: ",(0,i.jsx)(n.code,{children:"libs/features/docs/state-management.md"})]}),"\n",(0,i.jsxs)(n.li,{children:["Cross-cutting flows using API client: ",(0,i.jsx)(n.code,{children:"libs/features/docs/cross-cutting-flows.md"})]}),"\n",(0,i.jsxs)(n.li,{children:["Backend architecture: ",(0,i.jsx)(n.code,{children:"Docs/architecture/backend-architecture.md"})]}),"\n",(0,i.jsxs)(n.li,{children:["GraphQL schema conventions: ",(0,i.jsx)(n.code,{children:"Docs/architecture/api-contracts.md"})]}),"\n",(0,i.jsxs)(n.li,{children:["Data architecture (Universal State v2): ",(0,i.jsx)(n.code,{children:"Docs/architecture/data-architecture.md"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},71184:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>d});var s=r(14041);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);
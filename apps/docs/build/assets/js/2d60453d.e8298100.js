"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[88455],{56748:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"feature-modules/logs","title":"Logs Feature Module","description":"Source: libs/features/logs/src/","source":"@site/../connect/docs/feature-modules/logs.md","sourceDirName":"feature-modules","slug":"/feature-modules/logs","permalink":"/docs/frontend/feature-modules/logs","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/feature-modules/logs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Firewall Feature","permalink":"/docs/frontend/feature-modules/firewall"},"next":{"title":"Network Feature","permalink":"/docs/frontend/feature-modules/network"}}');var i=s(31085),t=s(71184);const o={},c="Logs Feature Module",l={},d=[{value:"Module Structure",id:"module-structure",level:2},{value:"Route and Tab Integration",id:"route-and-tab-integration",level:2},{value:"Log Action Registry",id:"log-action-registry",level:2},{value:"Log Bookmarks",id:"log-bookmarks",level:2},{value:"Log Correlation and Grouping",id:"log-correlation-and-grouping",level:2},{value:"Options",id:"options",level:3},{value:"Group Structure",id:"group-structure",level:3},{value:"Time-Window Grouping",id:"time-window-grouping",level:3},{value:"Topic Grouping",id:"topic-grouping",level:3},{value:"Hook API",id:"hook-api",level:3},{value:"Log Alert Service",id:"log-alert-service",level:2},{value:"Alert Settings",id:"alert-settings",level:3},{value:"Default Rules",id:"default-rules",level:3},{value:"Rule Matching",id:"rule-matching",level:3},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Notification Channels",id:"notification-channels",level:3},{value:"Singleton Access",id:"singleton-access",level:3},{value:"Log Cache (IndexedDB)",id:"log-cache-indexeddb",level:2},{value:"Schema",id:"schema",level:3},{value:"Configuration",id:"configuration",level:3},{value:"LogCache Class Methods",id:"logcache-class-methods",level:3},{value:"Cached Entry Shape",id:"cached-entry-shape",level:3},{value:"Singleton Access",id:"singleton-access-1",level:3},{value:"Severity Levels",id:"severity-levels",level:2},{value:"Log Topics",id:"log-topics",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"logs-feature-module",children:"Logs Feature Module"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Source:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/"})]}),"\n",(0,i.jsxs)(n.p,{children:["The logs feature provides system-level log viewing with bookmarking, correlation/grouping, real-time alert rules, and an offline IndexedDB cache. The main router-panel log viewer is rendered in ",(0,i.jsx)(n.code,{children:"LogsTab"}),", which delegates to ",(0,i.jsx)(n.code,{children:"LogViewer"})," from ",(0,i.jsx)(n.code,{children:"@nasnet/features/dashboard"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"module-structure",children:"Module Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"libs/features/logs/src/\n\u251c\u2500\u2500 actions/\n\u2502   \u251c\u2500\u2500 logActionRegistry.ts     \u2014 Topic-specific contextual actions\n\u2502   \u2514\u2500\u2500 LogActionMenu.tsx        \u2014 Context menu for log entries\n\u251c\u2500\u2500 alerts/\n\u2502   \u251c\u2500\u2500 LogAlertService.ts       \u2014 Alert rule matching + notification dispatch\n\u2502   \u251c\u2500\u2500 useLogAlerts.ts          \u2014 Hook that integrates LogAlertService\n\u2502   \u2514\u2500\u2500 AlertSettingsDialog.tsx  \u2014 UI for configuring alert rules\n\u251c\u2500\u2500 bookmarks/\n\u2502   \u2514\u2500\u2500 useLogBookmarks.ts       \u2014 SessionStorage-backed bookmark state\n\u251c\u2500\u2500 cache/\n\u2502   \u251c\u2500\u2500 logCache.ts              \u2014 IndexedDB-based log cache (class + singleton)\n\u2502   \u2514\u2500\u2500 useLogCache.ts           \u2014 React hook wrapping logCache\n\u251c\u2500\u2500 correlation/\n\u2502   \u2514\u2500\u2500 useLogCorrelation.ts     \u2014 Time-window and topic-based grouping\n\u2514\u2500\u2500 settings/\n    \u2514\u2500\u2500 LogSettingsDialog.tsx    \u2014 Display preferences dialog\n"})}),"\n",(0,i.jsx)(n.h2,{id:"route-and-tab-integration",children:"Route and Tab Integration"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Route file:"})," ",(0,i.jsx)(n.code,{children:"apps/connect/src/routes/router/$id/logs.tsx"})]}),"\n",(0,i.jsxs)(n.p,{children:["The logs route is ",(0,i.jsx)(n.strong,{children:"code-split"})," for bundle optimization. It lazy-loads ",(0,i.jsx)(n.code,{children:"LazyLogsTab"})," wrapped in ",(0,i.jsx)(n.code,{children:"LazyBoundary"}),". The skeleton shown during load uses the ",(0,i.jsx)(n.code,{children:"bg-logs"})," category accent color and renders:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Header with category accent stripe"}),"\n",(0,i.jsx)(n.li,{children:"Filter controls row skeleton"}),"\n",(0,i.jsx)(n.li,{children:"96-height table area skeleton"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"export const Route = createFileRoute('/router/$id/logs')({\n  component: () => (\n    <LazyBoundary fallback={<LogsTabSkeleton />}>\n      <LazyLogsTab />\n    </LazyBoundary>\n  ),\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tab component:"})," ",(0,i.jsx)(n.code,{children:"apps/connect/src/app/routes/router-panel/tabs/LogsTab.tsx"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"LogsTab"})," is a thin wrapper that renders ",(0,i.jsx)(n.code,{children:"LogViewer"})," (from ",(0,i.jsx)(n.code,{children:"@nasnet/features/dashboard"}),") with ",(0,i.jsx)(n.code,{children:"limit={100}"})," and a translated title/description header."]}),"\n",(0,i.jsx)(n.h2,{id:"log-action-registry",children:"Log Action Registry"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/actions/logActionRegistry.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["Defines contextual actions available per log topic. Each ",(0,i.jsx)(n.code,{children:"LogAction"})," has:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface LogAction {\n  id: string;\n  label: string;\n  icon: string;            // Lucide icon name\n  description?: string;\n  handler: 'navigate' | 'dialog' | 'api';\n  target?: string;         // Route path or dialog ID\n  extractPattern?: RegExp; // Regex to pull data from log message\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Topic-specific actions:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Topic"}),(0,i.jsx)(n.th,{children:"Actions"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"firewall"})}),(0,i.jsx)(n.td,{children:"View Firewall Rule, Add IP to Whitelist, Block IP Address"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dhcp"})}),(0,i.jsx)(n.td,{children:"View DHCP Lease, Make Lease Static"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"wireless"})}),(0,i.jsx)(n.td,{children:"View Wireless Client, Disconnect Client"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"interface"})}),(0,i.jsx)(n.td,{children:"View Interface"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"vpn"})}),(0,i.jsx)(n.td,{children:"View VPN Connection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dns"})}),(0,i.jsx)(n.td,{children:"View DNS Settings"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"route"})}),(0,i.jsx)(n.td,{children:"View Routing Table"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ppp"})}),(0,i.jsx)(n.td,{children:"View PPP Connection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"script"})}),(0,i.jsx)(n.td,{children:"View Scripts"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"system"}),", ",(0,i.jsx)(n.code,{children:"critical"}),", ",(0,i.jsx)(n.code,{children:"info"}),", ",(0,i.jsx)(n.code,{children:"warning"}),", ",(0,i.jsx)(n.code,{children:"error"})]}),(0,i.jsx)(n.td,{children:"(common actions only)"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common actions"})," available on every log entry regardless of topic: Copy Log Entry, Bookmark, View Details."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"getActionsForTopic(topic)"})})," returns the merged array of topic actions + common actions."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"extractDataFromMessage(message, action)"})})," applies ",(0,i.jsx)(n.code,{children:"action.extractPattern"})," and returns the first capture group, or ",(0,i.jsx)(n.code,{children:"null"}),". Used to extract IPs, MAC addresses, etc. for pre-populating dialogs."]}),"\n",(0,i.jsx)(n.h2,{id:"log-bookmarks",children:"Log Bookmarks"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/bookmarks/useLogBookmarks.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["Persists bookmarked log entries in ",(0,i.jsx)(n.code,{children:"sessionStorage"})," under the key ",(0,i.jsx)(n.code,{children:"nasnet-log-bookmarks"}),". Maximum of 50 bookmarks."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Return type:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface UseLogBookmarksReturn {\n  bookmarkedIds: Set<string>;        // O(1) lookup\n  bookmarkedLogs: LogEntry[];\n  isBookmarked: (logId: string) => boolean;\n  toggleBookmark: (log: LogEntry) => void;\n  addBookmark: (log: LogEntry) => void;\n  removeBookmark: (logId: string) => void;\n  clearBookmarks: () => void;\n  count: number;\n  isMaxReached: boolean;             // true when count === 50\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Date"})," objects in ",(0,i.jsx)(n.code,{children:"LogEntry.timestamp"})," are round-tripped through JSON correctly \u2014 the hook converts timestamp strings back to ",(0,i.jsx)(n.code,{children:"Date"})," on load."]}),"\n",(0,i.jsx)(n.h2,{id:"log-correlation-and-grouping",children:"Log Correlation and Grouping"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/correlation/useLogCorrelation.ts"})]}),"\n",(0,i.jsx)(n.p,{children:"Groups log entries either by time proximity or by topic."}),"\n",(0,i.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface UseLogCorrelationOptions {\n  windowMs?: number;      // Time window for grouping (default: 1000ms)\n  groupByTopic?: boolean; // Group by topic instead of time\n  minGroupSize?: number;  // Minimum entries to form a group (default: 2)\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"group-structure",children:"Group Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface LogGroup {\n  id: string;\n  startTime: Date;\n  endTime: Date;\n  entries: LogEntry[];\n  primaryTopic: string;    // Most frequent topic in the group\n  severityLevel: 'debug' | 'info' | 'warning' | 'error' | 'critical';\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"time-window-grouping",children:"Time-Window Grouping"}),"\n",(0,i.jsxs)(n.p,{children:["Logs are sorted by timestamp. Consecutive entries within ",(0,i.jsx)(n.code,{children:"windowMs"})," are merged into a group. Groups below ",(0,i.jsx)(n.code,{children:"minGroupSize"})," are split into individual-entry groups."]}),"\n",(0,i.jsx)(n.h3,{id:"topic-grouping",children:"Topic Grouping"}),"\n",(0,i.jsx)(n.p,{children:"All entries sharing the same topic are placed in one group, sorted internally by timestamp."}),"\n",(0,i.jsx)(n.h3,{id:"hook-api",children:"Hook API"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { groups, flatLogs, isGrouped, toggleGrouping, setGroupByTopic } = useLogCorrelation(logs, options);\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"isGrouped"})," starts ",(0,i.jsx)(n.code,{children:"true"}),". ",(0,i.jsx)(n.code,{children:"toggleGrouping()"})," disables grouping (returns each log as its own single-entry group)."]}),"\n",(0,i.jsx)(n.h2,{id:"log-alert-service",children:"Log Alert Service"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/alerts/LogAlertService.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["A class (used as a singleton via ",(0,i.jsx)(n.code,{children:"getLogAlertService()"}),") that processes log entries against user-defined alert rules."]}),"\n",(0,i.jsx)(n.h3,{id:"alert-settings",children:"Alert Settings"}),"\n",(0,i.jsxs)(n.p,{children:["Settings persist in ",(0,i.jsx)(n.code,{children:"localStorage"})," under ",(0,i.jsx)(n.code,{children:"nasnet-log-alert-settings"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface AlertSettings {\n  enabled: boolean;\n  notificationPreference: 'browser' | 'toast' | 'both' | 'none';\n  soundEnabled: boolean;\n  rules: AlertRule[];\n  rateLimitMs: number;    // Per-topic rate limit (default: 10000ms)\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"default-rules",children:"Default Rules"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"ID"}),(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"Severities"}),(0,i.jsx)(n.th,{children:"Notification"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"critical-errors"})}),(0,i.jsx)(n.td,{children:"Critical & Error Alerts"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"critical"}),", ",(0,i.jsx)(n.code,{children:"error"})]}),(0,i.jsx)(n.td,{children:"both"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"firewall-blocks"})}),(0,i.jsx)(n.td,{children:"Firewall Blocks"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"warning"}),", ",(0,i.jsx)(n.code,{children:"error"}),", ",(0,i.jsx)(n.code,{children:"critical"})]}),(0,i.jsx)(n.td,{children:"toast (disabled by default)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"rule-matching",children:"Rule Matching"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"matchesRule(log, rule)"})," returns true when all of:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"rule.enabled === true"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"log.topic"})," in ",(0,i.jsx)(n.code,{children:"rule.topics"})," (or topics list is empty = match all)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"log.severity"})," in ",(0,i.jsx)(n.code,{children:"rule.severities"})," (or empty = match all)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"log.message"})," matches ",(0,i.jsx)(n.code,{children:"rule.messagePattern"})," regex (if set)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,i.jsxs)(n.p,{children:["Per-topic: once a notification fires for a topic, the same topic is suppressed for ",(0,i.jsx)(n.code,{children:"rateLimitMs"})," (default 10 seconds). Prevents notification storms."]}),"\n",(0,i.jsx)(n.h3,{id:"notification-channels",children:"Notification Channels"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Mechanism"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"browser"})}),(0,i.jsx)(n.td,{children:"Web Notifications API"}),(0,i.jsxs)(n.td,{children:["Requires ",(0,i.jsx)(n.code,{children:"Notification.permission === 'granted'"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"toast"})}),(0,i.jsxs)(n.td,{children:["In-app toast via ",(0,i.jsx)(n.code,{children:"toastHandler"})," callback"]}),(0,i.jsxs)(n.td,{children:["Set via ",(0,i.jsx)(n.code,{children:"setToastHandler()"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"both"})}),(0,i.jsx)(n.td,{children:"Browser + toast"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"none"})}),(0,i.jsx)(n.td,{children:"No notification"}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Critical severity notifications use ",(0,i.jsx)(n.code,{children:"requireInteraction: true"})," and do not auto-close. Non-critical auto-close after 5 seconds."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sound:"})," Optional Web Audio API beep (sine wave at 800 Hz, 150ms). Silently fails if AudioContext is unavailable."]}),"\n",(0,i.jsx)(n.h3,{id:"singleton-access",children:"Singleton Access"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { getLogAlertService } from '@nasnet/features/logs';\nconst alertService = getLogAlertService();\nalertService.processLogEntry(logEntry);\nalertService.processLogEntries(logEntries);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"log-cache-indexeddb",children:"Log Cache (IndexedDB)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"libs/features/logs/src/cache/logCache.ts"})]}),"\n",(0,i.jsxs)(n.p,{children:["Provides offline log access via an IndexedDB database named ",(0,i.jsx)(n.code,{children:"nasnet-logs"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"schema",children:"Schema"}),"\n",(0,i.jsxs)(n.p,{children:["Object store: ",(0,i.jsx)(n.code,{children:"logs"})," (keyPath: ",(0,i.jsx)(n.code,{children:"id"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["Indexes: ",(0,i.jsx)(n.code,{children:"routerIp"}),", ",(0,i.jsx)(n.code,{children:"timestamp"}),", ",(0,i.jsx)(n.code,{children:"topic"}),", ",(0,i.jsx)(n.code,{children:"severity"}),", ",(0,i.jsx)(n.code,{children:"expiresAt"})]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface LogCacheConfig {\n  ttlDays: number;     // Default: 7 days\n  maxEntries: number;  // Default: 10000\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"logcache-class-methods",children:"LogCache Class Methods"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"init()"})}),(0,i.jsx)(n.td,{children:"Open/create IndexedDB database (idempotent)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"storeLogs(routerIp, logs)"})}),(0,i.jsx)(n.td,{children:"Store logs with TTL metadata"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getLogs(routerIp, limit?)"})}),(0,i.jsx)(n.td,{children:"Retrieve non-expired logs, sorted newest-first"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cleanupExpired()"})}),(0,i.jsxs)(n.td,{children:["Delete all entries past ",(0,i.jsx)(n.code,{children:"expiresAt"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"clearAll()"})}),(0,i.jsx)(n.td,{children:"Wipe entire cache"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getStats()"})}),(0,i.jsxs)(n.td,{children:["Return ",(0,i.jsx)(n.code,{children:"{ totalEntries, oldestEntry, newestEntry }"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"close()"})}),(0,i.jsx)(n.td,{children:"Release database connection"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"cached-entry-shape",children:"Cached Entry Shape"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface CachedLogEntry extends LogEntry {\n  routerIp: string;\n  cachedAt: number;   // Unix timestamp (ms)\n  expiresAt: number;  // cachedAt + ttlDays * 86400000\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"singleton-access-1",children:"Singleton Access"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { getLogCache } from '@nasnet/features/logs';\nconst cache = getLogCache({ ttlDays: 14 }); // config only used on first call\nawait cache.storeLogs('192.168.1.1', entries);\nconst logs = await cache.getLogs('192.168.1.1', 200);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"useLogCache"})," hook (",(0,i.jsx)(n.code,{children:"cache/useLogCache.ts"}),") wraps ",(0,i.jsx)(n.code,{children:"getLogCache()"})," for use inside React components."]}),"\n",(0,i.jsx)(n.h2,{id:"severity-levels",children:"Severity Levels"}),"\n",(0,i.jsx)(n.p,{children:"The log system uses five severity levels ordered from low to high:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Level"}),(0,i.jsx)(n.th,{children:"Color"}),(0,i.jsx)(n.th,{children:"Usage"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"debug"})}),(0,i.jsx)(n.td,{children:"muted"}),(0,i.jsx)(n.td,{children:"Verbose diagnostic output"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"info"})}),(0,i.jsx)(n.td,{children:"info"}),(0,i.jsx)(n.td,{children:"Routine informational entries"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"warning"})}),(0,i.jsx)(n.td,{children:"warning"}),(0,i.jsx)(n.td,{children:"Degraded conditions, non-critical failures"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"error"})}),(0,i.jsx)(n.td,{children:"error"}),(0,i.jsx)(n.td,{children:"Errors requiring attention"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"critical"})}),(0,i.jsx)(n.td,{children:"error"}),(0,i.jsx)(n.td,{children:"Service-affecting failures"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Severity comparison is index-based in ",(0,i.jsx)(n.code,{children:"getHighestSeverity()"})," (used by log correlation)."]}),"\n",(0,i.jsx)(n.h2,{id:"log-topics",children:"Log Topics"}),"\n",(0,i.jsxs)(n.p,{children:["Each log entry has a ",(0,i.jsx)(n.code,{children:"topic: LogTopic"}),". The full set (from ",(0,i.jsx)(n.code,{children:"@nasnet/core/types"}),"):"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"firewall"}),", ",(0,i.jsx)(n.code,{children:"dhcp"}),", ",(0,i.jsx)(n.code,{children:"wireless"}),", ",(0,i.jsx)(n.code,{children:"interface"}),", ",(0,i.jsx)(n.code,{children:"vpn"}),", ",(0,i.jsx)(n.code,{children:"dns"}),", ",(0,i.jsx)(n.code,{children:"route"}),", ",(0,i.jsx)(n.code,{children:"ppp"}),", ",(0,i.jsx)(n.code,{children:"script"}),", ",(0,i.jsx)(n.code,{children:"system"}),", ",(0,i.jsx)(n.code,{children:"critical"}),", ",(0,i.jsx)(n.code,{children:"info"}),", ",(0,i.jsx)(n.code,{children:"warning"}),", ",(0,i.jsx)(n.code,{children:"error"})]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"../data-fetching/graphql-hooks.md"})," \u2014 Log streaming GraphQL subscription"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"../ui-system/platform-presenters.md"})," \u2014 Headless + Platform Presenters pattern"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"../cross-cutting-features/service-marketplace.md"})," \u2014 ",(0,i.jsx)(n.code,{children:"ServiceLogViewer"})," for per-service logs"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(14041);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);
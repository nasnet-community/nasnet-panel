"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[92895],{51923:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"index","title":"Feature Library Documentation","description":"This directory contains the technical reference documentation for libs/features/, the Layer 3 domain layer in NasNetConnect\'s three-tier component architecture.","source":"@site/../../libs/features/docs/index.md","sourceDirName":".","slug":"/","permalink":"/docs/features/","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/features/docs/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"VPN Feature Module Documentation","permalink":"/docs/features/feature-vpn"},"next":{"title":"Routing and Navigation Architecture","permalink":"/docs/features/routing-and-navigation"}}');var s=r(31085),i=r(71184);const d={},c="Feature Library Documentation",o={},a=[{value:"What Is the Feature Layer?",id:"what-is-the-feature-layer",level:2},{value:"Document Index",id:"document-index",level:2},{value:"Glossary of Key Terms",id:"glossary-of-key-terms",level:2},{value:"Dependency Rules Summary",id:"dependency-rules-summary",level:2},{value:"Quick Links to Related Documentation",id:"quick-links-to-related-documentation",level:2}];function l(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"feature-library-documentation",children:"Feature Library Documentation"})}),"\n",(0,s.jsxs)(t.p,{children:["This directory contains the technical reference documentation for ",(0,s.jsx)(t.code,{children:"libs/features/"}),", the Layer 3 domain layer in NasNetConnect's three-tier component architecture."]}),"\n",(0,s.jsx)(t.h2,{id:"what-is-the-feature-layer",children:"What Is the Feature Layer?"}),"\n",(0,s.jsx)(t.p,{children:"The feature layer sits at the top of the component hierarchy:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"Layer 1: libs/ui/primitives    \u2014 shadcn/ui + Radix base components (~40 components)\nLayer 2: libs/ui/patterns      \u2014 Composite reusable components with Platform Presenters (~56 components)\nLayer 3: libs/features/*/      \u2014 Domain-specific business logic, pages, and feature modules (this layer)\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Each feature module in ",(0,s.jsx)(t.code,{children:"libs/features/"})," is a self-contained library that encapsulates everything needed for one product domain: components, hooks, XState machines, Zod schemas, services, and utility functions. Modules are consumed exclusively by the ",(0,s.jsx)(t.code,{children:"apps/"})," layer and never by other feature modules."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"document-index",children:"Document Index"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"File"}),(0,s.jsx)(t.th,{children:"Title"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"index.md"})}),(0,s.jsx)(t.td,{children:"Feature Library Documentation"}),(0,s.jsx)(t.td,{children:"This file. Master navigation index, glossary, and dependency rules."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"architecture-overview.md"})}),(0,s.jsx)(t.td,{children:"Architecture Overview"}),(0,s.jsx)(t.td,{children:"Feature module anatomy, Platform Presenter pattern, dependency rules, naming conventions, and module inventory with real source examples."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"state-management.md"})}),(0,s.jsx)(t.td,{children:"State Management"}),(0,s.jsx)(t.td,{children:"Apollo Client, Zustand stores, React Hook Form + Zod, change-set store, drift detection, history/undo patterns."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"xstate-machines.md"})}),(0,s.jsx)(t.td,{children:"XState Machines"}),(0,s.jsx)(t.td,{children:"All 9 XState machines: configPipeline, changeSet, templateApply, resourceLifecycle, wizard, update, ping, troubleshoot, VPN connection \u2014 with ASCII state diagrams."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-firewall.md"})}),(0,s.jsx)(t.td,{children:"Firewall Feature Module"}),(0,s.jsx)(t.td,{children:"43 components, 8 pages, template safety pipeline, address list import/export, port knocking, Zustand stores, schemas."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-services.md"})}),(0,s.jsx)(t.td,{children:"Services Feature Module"}),(0,s.jsx)(t.td,{children:"Feature Marketplace (Tor, sing-box, Xray, MTProxy, Psiphon, AdGuard Home), install flow, config forms, updates, VLAN pool, kill switch, device routing, traffic/quota, storage, sharing."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-network.md"})}),(0,s.jsx)(t.td,{children:"Network Feature Module"}),(0,s.jsx)(t.td,{children:"10 sub-modules: interfaces, IP address, routes, bridges, VLANs, DHCP, DNS, WAN, interface-stats, DNS diagnostics."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-diagnostics.md"})}),(0,s.jsx)(t.td,{children:"Diagnostics Feature Module"}),(0,s.jsx)(t.td,{children:"5 diagnostic tools (ping, traceroute, DNS lookup, device scan, troubleshoot wizard), fix registry, diagnostic executor."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-alerts.md"})}),(0,s.jsx)(t.td,{children:"Alerts Feature Module"}),(0,s.jsx)(t.td,{children:"Alert rules, 6 notification channels, quiet hours, alert templates, dispatch chain."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-dashboard.md"})}),(0,s.jsx)(t.td,{children:"Dashboard Feature Module"}),(0,s.jsx)(t.td,{children:"Bandwidth chart, interface grid, resource gauges, recent logs, router health summary, cached data badge."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-logs.md"})}),(0,s.jsx)(t.td,{children:"Logs Feature Module"}),(0,s.jsx)(t.td,{children:"IndexedDB cache, log correlation, action registry, bookmarks, alert integration, log settings."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-minor.md"})}),(0,s.jsx)(t.td,{children:"Minor Feature Modules"}),(0,s.jsx)(t.td,{children:"Wireless (9 components), Router Discovery (scanner + credential services), Configuration Import (wizard + protocol selector)."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"api-client-and-graphql.md"})}),(0,s.jsx)(t.td,{children:"API Client and GraphQL"}),(0,s.jsx)(t.td,{children:"21 query modules, Apollo Client link chain, 15 schema domains, custom scalars/directives, subscriptions, codegen workflow."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"cross-cutting-flows.md"})}),(0,s.jsx)(t.td,{children:"Cross-Cutting Flows"}),(0,s.jsx)(t.td,{children:"6 end-to-end multi-package flows: Apply-Confirm-Merge, firewall template safety, service install, troubleshoot wizard, alert dispatch, VIF isolation."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"testing-and-storybook.md"})}),(0,s.jsx)(t.td,{children:"Testing and Storybook"}),(0,s.jsx)(t.td,{children:"Vitest patterns, Storybook 10.2.7, XState machine testing, accessibility testing, platform presenter testing, CI integration."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"routing-and-navigation.md"})}),(0,s.jsx)(t.td,{children:"Routing and Navigation"}),(0,s.jsx)(t.td,{children:"TanStack Router file-based routing, complete route tree (40+ routes), code splitting with LazyBoundary, route guards, token refresh, root layout, app-level hooks."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feature-vpn.md"})}),(0,s.jsx)(t.td,{children:"VPN Feature Module"}),(0,s.jsx)(t.td,{children:"Multi-protocol VPN management (WireGuard, L2TP, PPTP, SSTP, IKEv2, OpenVPN), 9 pattern components, 20+ API hooks, client/server pages, protocol stats."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"error-handling.md"})}),(0,s.jsx)(t.td,{children:"Error Handling"}),(0,s.jsx)(t.td,{children:"Three-tier error boundary hierarchy (App \u2192 Route \u2192 Component), withErrorBoundary HOC, TanStack Router error integration, GraphQL error handling, testing patterns."})]})]})]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"glossary-of-key-terms",children:"Glossary of Key Terms"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Platform Presenter"}),"\nA rendering component that targets a specific device class (Mobile, Tablet, Desktop). It receives all state and callbacks as props from the headless wrapper and renders the appropriate UI. File naming convention: ",(0,s.jsx)(t.code,{children:"ComponentNameMobile.tsx"}),", ",(0,s.jsx)(t.code,{children:"ComponentNameDesktop.tsx"}),", or ",(0,s.jsx)(t.code,{children:"ComponentName.Mobile.tsx"}),", ",(0,s.jsx)(t.code,{children:"ComponentName.Desktop.tsx"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Headless Hook"}),"\nA React hook (or the logic section of a wrapper component) that owns all business logic, data fetching, filtering, and callbacks, but produces no JSX itself. It returns a ",(0,s.jsx)(t.code,{children:"sharedProps"})," object passed to whichever Platform Presenter is active. Named with the ",(0,s.jsx)(t.code,{children:"use"})," prefix: ",(0,s.jsx)(t.code,{children:"useInterfaceList"}),", ",(0,s.jsx)(t.code,{children:"useChainSummary"}),", ",(0,s.jsx)(t.code,{children:"useAlertRules"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Feature Module"}),"\nA standalone Nx library under ",(0,s.jsx)(t.code,{children:"libs/features/<name>/"})," with its own ",(0,s.jsx)(t.code,{children:"src/index.ts"})," barrel export. It represents one product domain and contains components, hooks, pages, schemas, and optional machines or services. Consumed exclusively by ",(0,s.jsx)(t.code,{children:"apps/"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Domain Component"}),"\nA component inside ",(0,s.jsx)(t.code,{children:"libs/features/<name>/src/components/"})," that encodes business logic specific to one feature domain. It composes Layer 2 patterns and Layer 1 primitives. Not reused across feature modules."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Apply-Confirm-Merge"}),"\nThe safety-first configuration pipeline used for router mutations: Draft \u2192 Validate \u2192 Preview \u2192 Apply \u2192 Verify \u2192 Auto-Rollback. Implemented with XState and surfaced in the ",(0,s.jsx)(t.code,{children:"TemplateApplyFlow"})," component and related machines. See ",(0,s.jsx)(t.code,{children:"Docs/architecture/data-architecture.md"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"VIF (Virtual Interface)"}),"\nA software network interface managed by the orchestrator. VIFs provide isolation and traffic routing for downloadable services (Tor, sing-box, etc.). The ",(0,s.jsx)(t.code,{children:"services"})," feature module's ",(0,s.jsx)(t.code,{children:"GatewayStatusCard"})," and device routing pages expose VIF state to the UI."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Kill Switch"}),"\nA failsafe mechanism that drops all traffic for a service if its VIF loses connectivity, preventing IP leaks. Exposed in the ",(0,s.jsx)(t.code,{children:"services"})," feature via isolation-related components and the VIF bootstrap layer."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Change Set"}),"\nA set of pending router configuration mutations that can be previewed and atomically applied or discarded. Change sets are the unit of the Apply-Confirm-Merge pipeline. The ",(0,s.jsx)(t.code,{children:"firewall"})," module's ",(0,s.jsx)(t.code,{children:"TemplateApplyFlow"})," and ",(0,s.jsx)(t.code,{children:"UndoFloatingButton"})," implement this at the UI layer."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Universal State"}),"\nThe 8-layer resource model (",(0,s.jsx)(t.code,{children:"Docs/architecture/data-architecture.md"}),") that describes how router configuration flows from physical hardware through the provisioning layer up to the UI. Each feature module reads a slice of this state via Apollo Client GraphQL queries."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Safety Pipeline"}),"\nOne of the 8 novel architectural patterns (see ",(0,s.jsx)(t.code,{children:"Docs/architecture/novel-pattern-designs.md"}),"). Applies to any UI operation that can break network connectivity: it enforces a preview step, a confirmation countdown, and a timed rollback window. The ",(0,s.jsx)(t.code,{children:"template-apply.machine.ts"})," in ",(0,s.jsx)(t.code,{children:"libs/features/firewall/"})," is the reference implementation."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"dependency-rules-summary",children:"Dependency Rules Summary"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"apps/connect  \u2192  features/*\n              \u2192  libs/ui/primitives, libs/ui/patterns, libs/ui/layouts\n              \u2192  libs/api-client/queries, libs/api-client/generated\n              \u2192  libs/core/types, libs/core/utils, libs/core/constants\n              \u2192  libs/state/stores\n\nfeatures/*    \u2192  libs/ui/primitives, libs/ui/patterns, libs/ui/layouts\n              \u2192  libs/api-client/queries, libs/api-client/generated\n              \u2192  libs/core/types, libs/core/utils, libs/core/constants\n              \u2192  libs/state/stores\n\n              NEVER  \u2192  other features/*\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Features are ",(0,s.jsx)(t.strong,{children:"consumers"})," of the shared layer and ",(0,s.jsx)(t.strong,{children:"providers"})," to the application layer. Cross-feature imports are forbidden. If two features need shared logic, that logic belongs in ",(0,s.jsx)(t.code,{children:"libs/core/utils"}),", ",(0,s.jsx)(t.code,{children:"libs/ui/patterns"}),", or ",(0,s.jsx)(t.code,{children:"libs/api-client/queries"}),"."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"quick-links-to-related-documentation",children:"Quick Links to Related Documentation"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Topic"}),(0,s.jsx)(t.th,{children:"Document"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Platform Presenter implementation guide"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/PLATFORM_PRESENTER_GUIDE.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Complete design token reference"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/DESIGN_TOKENS.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"56-component pattern catalog"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/ux-design/6-component-library.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"3-layer architecture overview"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/ux-design/1-design-system-foundation.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Frontend architecture (20 principles)"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/frontend-architecture.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Universal State v2 and Apply-Confirm-Merge"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/data-architecture.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Novel patterns (VIF, Safety Pipeline, etc.)"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/novel-pattern-designs.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"GraphQL schema conventions"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/api-contracts.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Testing strategy (trophy model)"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/implementation-patterns/testing-strategy-patterns.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"WCAG AAA accessibility requirements"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/ux-design/8-responsive-design-accessibility.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"All architecture docs"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/architecture/index.md"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"All design docs"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Docs/design/README.md"})})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},71184:(e,t,r)=>{r.d(t,{R:()=>d,x:()=>c});var n=r(14041);const s={},i=n.createContext(s);function d(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);
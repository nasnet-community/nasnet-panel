"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[30767],{25219:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"forms-validation/overview","title":"Forms and Validation Overview","description":"NasNetConnect uses React Hook Form for form state management and Zod for schema-driven validation. These two libraries are integrated through a set of utilities in libs/core/forms/src/.","source":"@site/../connect/docs/forms-validation/overview.md","sourceDirName":"forms-validation","slug":"/forms-validation/overview","permalink":"/docs/frontend/forms-validation/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/forms-validation/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Network Validators","permalink":"/docs/frontend/forms-validation/network-validators"},"next":{"title":"Validation Pipeline","permalink":"/docs/frontend/forms-validation/validation-pipeline"}}');var i=n(31085),t=n(71184);const d={},o="Forms and Validation Overview",a={},l=[{value:"Core Stack",id:"core-stack",level:2},{value:"Standard Form Pattern",id:"standard-form-pattern",level:2},{value:"NasFormProvider (High-Level API)",id:"nasformprovider-high-level-api",level:2},{value:"Validation Modes",id:"validation-modes",level:2},{value:"Form Utilities Available",id:"form-utilities-available",level:2},{value:"Import Path",id:"import-path",level:2},{value:"Related Documents",id:"related-documents",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"forms-and-validation-overview",children:"Forms and Validation Overview"})}),"\n",(0,i.jsxs)(r.p,{children:["NasNetConnect uses React Hook Form for form state management and Zod for schema-driven validation. These two libraries are integrated through a set of utilities in ",(0,i.jsx)(r.code,{children:"libs/core/forms/src/"}),"."]}),"\n",(0,i.jsx)(r.h2,{id:"core-stack",children:"Core Stack"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Library"}),(0,i.jsx)(r.th,{children:"Role"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"react-hook-form"})}),(0,i.jsx)(r.td,{children:"Uncontrolled form state, field registration, submission handling"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"zod"})}),(0,i.jsx)(r.td,{children:"Schema definition and synchronous validation"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"@hookform/resolvers/zod"})}),(0,i.jsx)(r.td,{children:"Bridges Zod schemas into React Hook Form's resolver interface"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"standard-form-pattern",children:"Standard Form Pattern"}),"\n",(0,i.jsx)(r.p,{children:"The standard pattern for any form in the codebase is:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"import { z } from 'zod';\nimport { useZodForm } from '@nasnet/core/forms';\nimport { ipv4, port } from '@nasnet/core/forms/network-validators';\n\n// 1. Define schema with Zod\nconst schema = z.object({\n  name: z.string().min(1, 'Name is required').max(64),\n  address: ipv4,\n  listenPort: port,\n  enabled: z.boolean().default(true),\n});\n\ntype FormData = z.infer<typeof schema>;\n\n// 2. Create form with useZodForm\nfunction WireGuardForm() {\n  const form = useZodForm({\n    schema,\n    defaultValues: {\n      name: '',\n      address: '',\n      listenPort: 51820,\n      enabled: true,\n    },\n    mode: 'onBlur',  // default\n  });\n\n  // 3. Handle submission\n  const handleSubmit = form.handleSubmit(async (data: FormData) => {\n    await createWireGuard(data);\n  });\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input {...form.register('name')} />\n      {form.formState.errors.name && (\n        <span>{form.formState.errors.name.message}</span>\n      )}\n      <button type=\"submit\" disabled={form.formState.isSubmitting}>\n        Save\n      </button>\n    </form>\n  );\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"nasformprovider-high-level-api",children:"NasFormProvider (High-Level API)"}),"\n",(0,i.jsxs)(r.p,{children:["For forms that require backend validation, use ",(0,i.jsx)(r.code,{children:"NasFormProvider"}),". It wraps the above pattern and wires in the validation pipeline automatically:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"import { NasFormProvider } from '@nasnet/core/forms';\n\nfunction WireGuardForm() {\n  return (\n    <NasFormProvider\n      schema={schema}\n      defaultValues={{ name: '', address: '', listenPort: 51820 }}\n      onSubmit={async (data) => await createWireGuard(data)}\n      validationStrategy=\"high\"   // 'low' | 'medium' | 'high'\n      resourceUuid={existingId}   // for edit forms\n    >\n      <FormFields />\n      <FormSubmitButton />\n    </NasFormProvider>\n  );\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"NasFormProvider"})," (",(0,i.jsx)(r.code,{children:"libs/core/forms/src/NasFormProvider.tsx"}),"):"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Initialises React Hook Form with ",(0,i.jsx)(r.code,{children:"zodResolver"})]}),"\n",(0,i.jsxs)(r.li,{children:["Runs the validation pipeline on submit for ",(0,i.jsx)(r.code,{children:"medium"})," and ",(0,i.jsx)(r.code,{children:"high"})," strategies"]}),"\n",(0,i.jsxs)(r.li,{children:["Maps backend validation errors back to form fields via ",(0,i.jsx)(r.code,{children:"mapBackendErrorsToForm"})]}),"\n",(0,i.jsxs)(r.li,{children:["Exposes ",(0,i.jsx)(r.code,{children:"useNasFormContext()"})," for child components to read ",(0,i.jsx)(r.code,{children:"isSubmitting"})," and ",(0,i.jsx)(r.code,{children:"validationResult"})]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"validation-modes",children:"Validation Modes"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Mode"}),(0,i.jsx)(r.th,{children:"When triggered"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"onBlur"})," (default)"]}),(0,i.jsx)(r.td,{children:"Validate each field when the user leaves it"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"onChange"})}),(0,i.jsx)(r.td,{children:"Validate on every keystroke (expensive, avoid for complex forms)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"onSubmit"})}),(0,i.jsx)(r.td,{children:"Only validate when the form is submitted"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"all"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"onChange"})," + ",(0,i.jsx)(r.code,{children:"onBlur"})]})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"useZodForm"})," defaults to ",(0,i.jsx)(r.code,{children:"onBlur"}),"."]}),"\n",(0,i.jsx)(r.h2,{id:"form-utilities-available",children:"Form Utilities Available"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Utility"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useZodForm"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useZodForm.ts"})}),(0,i.jsx)(r.td,{children:"RHF + Zod integration hook"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"NasFormProvider"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"NasFormProvider.tsx"})}),(0,i.jsx)(r.td,{children:"High-level form provider with pipeline"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useFormPersistence"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useFormPersistence.ts"})}),(0,i.jsx)(r.td,{children:"Persist form data to sessionStorage"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useFormResourceSync"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useFormResourceSync.ts"})}),(0,i.jsx)(r.td,{children:"Sync form with Universal State v2 layers"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useWizardPersistence"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useWizardPersistence.ts"})}),(0,i.jsx)(r.td,{children:"Multi-step wizard state and persistence"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useValidationPipeline"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useValidationPipeline.ts"})}),(0,i.jsx)(r.td,{children:"Low-level pipeline hook"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"mapBackendErrorsToForm"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"mapBackendErrors.ts"})}),(0,i.jsx)(r.td,{children:"Map server errors to RHF fields"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"clearServerErrors"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"mapBackendErrors.ts"})}),(0,i.jsx)(r.td,{children:"Remove stale server errors"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Network validators"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"network-validators.ts"})}),(0,i.jsx)(r.td,{children:"20+ Zod schemas for IP, ports, etc."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Schema utilities"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"schema-utils.ts"})}),(0,i.jsx)(r.td,{children:"Common Zod schema compositions"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Error messages"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"error-messages.ts"})}),(0,i.jsx)(r.td,{children:"Standardised validation message strings"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useAsyncValidation"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useAsyncValidation.ts"})}),(0,i.jsx)(r.td,{children:"Debounced async field validation"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"import-path",children:"Import Path"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"// Core form utilities\nimport { useZodForm, NasFormProvider, useFormPersistence } from '@nasnet/core/forms';\n\n// Network validators\nimport { ipv4, cidr, port, mac } from '@nasnet/core/forms/network-validators';\nimport { networkValidators } from '@nasnet/core/forms/network-validators';\n\n// Validation pipeline\nimport { ValidationPipeline, createValidationPipeline } from '@nasnet/core/forms';\n"})}),"\n",(0,i.jsx)(r.h2,{id:"related-documents",children:"Related Documents"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/frontend/forms-validation/validation-pipeline",children:"Validation Pipeline"})," \u2014 the 7-stage backend validation flow"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/frontend/forms-validation/network-validators",children:"Network Validators"})," \u2014 all 20+ Zod schemas for network types"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/frontend/forms-validation/form-utilities",children:"Form Utilities"})," \u2014 useZodForm, useFormPersistence, useFormResourceSync"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/frontend/forms-validation/wizard-forms",children:"Wizard Forms"})," \u2014 multi-step forms with persistence"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/frontend/cross-cutting-features/change-set-system",children:(0,i.jsx)(r.code,{children:"../cross-cutting-features/change-set-system.md"})})," \u2014 how form submissions interact with change sets"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},71184:(e,r,n)=>{n.d(r,{R:()=>d,x:()=>o});var s=n(14041);const i={},t=s.createContext(i);function d(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);
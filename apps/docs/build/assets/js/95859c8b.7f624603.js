"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[62486],{10095:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"feature-minor","title":"Feature: Wireless, Router Discovery, and Configuration Import","description":"This document covers three focused feature modules: the Wireless library (libs/features/wireless), the Router Discovery library (libs/features/router-discovery), and the Configuration Import library (libs/features/configuration-import). All three are consumed primarily by apps/connect/src/ and follow the same Layer 3 domain component architecture as the other feature libraries.","source":"@site/../../libs/features/docs/feature-minor.md","sourceDirName":".","slug":"/feature-minor","permalink":"/docs/features/feature-minor","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/features/docs/feature-minor.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Feature: Logs (libs/features/logs)","permalink":"/docs/features/feature-logs"},"next":{"title":"Feature: Network (libs/features/network)","permalink":"/docs/features/feature-network"}}');var i=n(31085),t=n(71184);const c={},d="Feature: Wireless, Router Discovery, and Configuration Import",o={},l=[{value:"Part 1: Wireless Feature (<code>libs/features/wireless</code>)",id:"part-1-wireless-feature-libsfeatureswireless",level:2},{value:"Overview",id:"overview",level:3},{value:"Directory Structure",id:"directory-structure",level:3},{value:"Component Table",id:"component-table",level:3},{value:"Key Components",id:"key-components",level:3},{value:"<code>WirelessInterfaceCard</code>",id:"wirelessinterfacecard",level:4},{value:"<code>WirelessSettingsForm</code>",id:"wirelesssettingsform",level:4},{value:"<code>InterfaceToggle</code>",id:"interfacetoggle",level:4},{value:"<code>SecurityLevelBadge</code>",id:"securitylevelbadge",level:4},{value:"<code>WifiStatusHero</code>",id:"wifistatushero",level:4},{value:"<code>ConnectedClientsTable</code>",id:"connectedclientstable",level:4},{value:"<code>WifiPage</code>",id:"wifipage",level:4},{value:"<code>WifiDetailPage</code>",id:"wifidetailpage",level:4},{value:"Static Data (<code>wirelessOptions.ts</code>)",id:"static-data-wirelessoptionsts",level:3},{value:"Validation Schema",id:"validation-schema",level:3},{value:"Part 2: Router Discovery Feature (<code>libs/features/router-discovery</code>)",id:"part-2-router-discovery-feature-libsfeaturesrouter-discovery",level:2},{value:"Overview",id:"overview-1",level:3},{value:"Directory Structure",id:"directory-structure-1",level:3},{value:"Component Table",id:"component-table-1",level:3},{value:"Service Table",id:"service-table",level:3},{value:"Discovery Flow",id:"discovery-flow",level:3},{value:"<code>NetworkScanner</code>",id:"networkscanner",level:3},{value:"<code>ManualRouterEntry</code>",id:"manualrouterentry",level:3},{value:"<code>CredentialDialog</code>",id:"credentialdialog",level:3},{value:"<code>RouterCard</code>",id:"routercard",level:3},{value:"<code>credentialService</code>",id:"credentialservice",level:3},{value:"Part 3: Configuration Import Feature (<code>libs/features/configuration-import</code>)",id:"part-3-configuration-import-feature-libsfeaturesconfiguration-import",level:2},{value:"Overview",id:"overview-2",level:3},{value:"Directory Structure",id:"directory-structure-2",level:3},{value:"Component Table",id:"component-table-2",level:3},{value:"Hook Table",id:"hook-table",level:3},{value:"Import Flow",id:"import-flow",level:3},{value:"<code>ConfigurationImportWizard</code>",id:"configurationimportwizard",level:3},{value:"<code>ConfigurationInput</code>",id:"configurationinput",level:3},{value:"<code>ProtocolSelector</code>",id:"protocolselector",level:3},{value:"<code>ExecutionProgress</code>",id:"executionprogress",level:3},{value:"<code>useConfigurationCheck</code>",id:"useconfigurationcheck",level:3},{value:"Cross-References",id:"cross-references",level:2}];function a(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"feature-wireless-router-discovery-and-configuration-import",children:"Feature: Wireless, Router Discovery, and Configuration Import"})}),"\n",(0,i.jsxs)(r.p,{children:["This document covers three focused feature modules: the ",(0,i.jsx)(r.strong,{children:"Wireless"})," library (",(0,i.jsx)(r.code,{children:"libs/features/wireless"}),"), the ",(0,i.jsx)(r.strong,{children:"Router Discovery"})," library (",(0,i.jsx)(r.code,{children:"libs/features/router-discovery"}),"), and the ",(0,i.jsx)(r.strong,{children:"Configuration Import"})," library (",(0,i.jsx)(r.code,{children:"libs/features/configuration-import"}),"). All three are consumed primarily by ",(0,i.jsx)(r.code,{children:"apps/connect/src/"})," and follow the same Layer 3 domain component architecture as the other feature libraries."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsxs)(r.h2,{id:"part-1-wireless-feature-libsfeatureswireless",children:["Part 1: Wireless Feature (",(0,i.jsx)(r.code,{children:"libs/features/wireless"}),")"]}),"\n",(0,i.jsx)(r.h3,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(r.p,{children:["The wireless feature library provides components for managing MikroTik wireless interfaces: listing interfaces, viewing and editing per-interface settings (SSID, security, channel, power), toggling interfaces on and off, and displaying connected client information. Additional display components (",(0,i.jsx)(r.code,{children:"WifiStatusHero"}),", ",(0,i.jsx)(r.code,{children:"WifiSecuritySummary"}),", ",(0,i.jsx)(r.code,{children:"WifiQuickActions"}),") live in ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/components/"})," as page-level components that compose the wireless library."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Library path:"})," ",(0,i.jsx)(r.code,{children:"libs/features/wireless/src/"})]}),"\n",(0,i.jsx)(r.h3,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"libs/features/wireless/src/\n\u251c\u2500\u2500 index.ts                          # Public API barrel export\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 WirelessInterfaceCard.tsx     # Single interface card\n\u2502   \u251c\u2500\u2500 WirelessInterfaceList.tsx     # Grid of interface cards\n\u2502   \u251c\u2500\u2500 WirelessInterfaceDetail.tsx   # Detail view (stories + types)\n\u2502   \u251c\u2500\u2500 WirelessSettingsForm.tsx      # Full settings edit form\n\u2502   \u251c\u2500\u2500 WirelessSettingsModal.tsx     # Modal wrapper for settings form\n\u2502   \u251c\u2500\u2500 SecurityProfileSection.tsx    # Security mode + password section\n\u2502   \u251c\u2500\u2500 SecurityLevelBadge.tsx        # WPA2/WPA3/Open badge\n\u2502   \u251c\u2500\u2500 PasswordField.tsx             # Show/hide password input\n\u2502   \u2514\u2500\u2500 InterfaceToggle.tsx           # Enable/disable switch\n\u251c\u2500\u2500 validation/\n\u2502   \u2514\u2500\u2500 wirelessSettings.schema.ts    # Zod schema for settings form\n\u2514\u2500\u2500 data/\n    \u2514\u2500\u2500 wirelessOptions.ts            # Channel, width, country, TX power options\n"})}),"\n",(0,i.jsx)(r.h3,{id:"component-table",children:"Component Table"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Component"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WirelessInterfaceCard"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/WirelessInterfaceCard.tsx"})}),(0,i.jsx)(r.td,{children:"Status card for a single interface"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WirelessInterfaceList"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/WirelessInterfaceList.tsx"})}),(0,i.jsx)(r.td,{children:"Grid/list of all wireless interfaces"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WirelessInterfaceDetail"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/WirelessInterfaceDetail.tsx"})}),(0,i.jsx)(r.td,{children:"Expanded detail view of one interface"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WirelessSettingsForm"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/WirelessSettingsForm.tsx"})}),(0,i.jsx)(r.td,{children:"Full edit form (SSID, channel, security)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WirelessSettingsModal"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/WirelessSettingsModal.tsx"})}),(0,i.jsx)(r.td,{children:"Dialog wrapper for the settings form"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"SecurityProfileSection"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/SecurityProfileSection.tsx"})}),(0,i.jsx)(r.td,{children:"Security mode selector + password"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"SecurityLevelBadge"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/SecurityLevelBadge.tsx"})}),(0,i.jsx)(r.td,{children:"WPA2 / WPA3 / Open / WEP badge"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"PasswordField"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/PasswordField.tsx"})}),(0,i.jsx)(r.td,{children:"Input with show/hide toggle"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"InterfaceToggle"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/InterfaceToggle.tsx"})}),(0,i.jsx)(r.td,{children:"Enable/disable switch with mutation"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"App-level components"})," (in ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/components/"}),"):"]}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Component"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiStatusHero"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiStatusHero.tsx"})}),(0,i.jsx)(r.td,{children:"Stats grid: clients, active interfaces, signal, bands"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiInterfaceList"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiInterfaceList.tsx"})}),(0,i.jsxs)(r.td,{children:["Composed list of ",(0,i.jsx)(r.code,{children:"WirelessInterfaceCard"})," items"]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ConnectedClientsTable"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ConnectedClientsTable.tsx"})}),(0,i.jsx)(r.td,{children:"Table of clients sorted by signal strength"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiSecuritySummary"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiSecuritySummary.tsx"})}),(0,i.jsx)(r.td,{children:"Per-interface security mode summary"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiQuickActions"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiQuickActions.tsx"})}),(0,i.jsx)(r.td,{children:"Quick access buttons (scan clients, add network)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"LoadingSkeleton"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"LoadingSkeleton.tsx"})}),(0,i.jsx)(r.td,{children:"Shimmer skeleton for initial WiFi page load"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"WifiDetailPage"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"detail/WifiDetailPage.tsx"})}),(0,i.jsx)(r.td,{children:"Full per-interface detail page"})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"key-components",children:"Key Components"}),"\n",(0,i.jsx)(r.h4,{id:"wirelessinterfacecard",children:(0,i.jsx)(r.code,{children:"WirelessInterfaceCard"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/wireless/src/components/WirelessInterfaceCard.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["A clickable card implementing keyboard accessibility via ",(0,i.jsx)(r.code,{children:'role="button"'}),", ",(0,i.jsx)(r.code,{children:"tabIndex={0}"}),", and ",(0,i.jsx)(r.code,{children:"onKeyDown"})," handling for Enter and Space. Displays:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Interface name (Satoshi font, large) and SSID (monospace, smaller)"}),"\n",(0,i.jsxs)(r.li,{children:["Frequency band badge with semantic color coding: ",(0,i.jsx)(r.code,{children:"bg-info/10 text-info"})," for 2.4 GHz, ",(0,i.jsx)(r.code,{children:"bg-secondary/10 text-secondary"})," for 5 GHz, ",(0,i.jsx)(r.code,{children:"bg-primary/10 text-primary"})," for 6 GHz"]}),"\n",(0,i.jsxs)(r.li,{children:["Connected client count with a ",(0,i.jsx)(r.code,{children:"Signal"})," icon"]}),"\n",(0,i.jsxs)(r.li,{children:["Channel and mode (hidden on mobile via ",(0,i.jsx)(r.code,{children:"hidden md:flex"}),")"]}),"\n",(0,i.jsxs)(r.li,{children:["Inline ",(0,i.jsx)(r.code,{children:"InterfaceToggle"})," (click propagation stopped to avoid triggering the card's click handler)"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"<Card\n  role=\"button\"\n  tabIndex={0}\n  aria-label={`Wireless interface ${iface.name}${iface.ssid ? `, SSID ${iface.ssid}` : ''}`}\n  onClick={handleClick}\n  onKeyDown={handleKeyDown}\n>\n"})}),"\n",(0,i.jsx)(r.h4,{id:"wirelesssettingsform",children:(0,i.jsx)(r.code,{children:"WirelessSettingsForm"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/wireless/src/components/WirelessSettingsForm.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["Comprehensive form for editing a wireless interface. Uses React Hook Form with ",(0,i.jsx)(r.code,{children:"zodResolver"})," against ",(0,i.jsx)(r.code,{children:"wirelessSettingsSchema"}),". Fields are organized into four sections:"]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Basic Settings"})," \u2014 SSID (string, 1-32 chars), hidden SSID toggle"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Radio Settings"})," \u2014 Channel (dynamic options per band via ",(0,i.jsx)(r.code,{children:"getChannelsByBand"}),"), channel width (",(0,i.jsx)(r.code,{children:"getChannelWidthsByBand"}),"), TX power (from ",(0,i.jsx)(r.code,{children:"TX_POWER_OPTIONS"}),"), country code (from ",(0,i.jsx)(r.code,{children:"COUNTRY_OPTIONS"})," \u2014 200+ countries)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Security"})," \u2014 Delegated to ",(0,i.jsx)(r.code,{children:"SecurityProfileSection"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Security Profile"})," (",(0,i.jsx)(r.code,{children:"SecurityProfileSection"}),") \u2014 Security mode dropdown (Open / WPA2 / WPA3 / WPA2+WPA3), passphrase via ",(0,i.jsx)(r.code,{children:"PasswordField"})]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["The form's Zod schema (",(0,i.jsx)(r.code,{children:"wirelessSettings.schema.ts"}),") validates:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"SSID length (1-32 characters) and character restrictions"}),"\n",(0,i.jsx)(r.li,{children:"Passphrase length (8-63 for WPA2/WPA3, empty for Open)"}),"\n",(0,i.jsx)(r.li,{children:"Channel value must be valid for the selected band"}),"\n",(0,i.jsx)(r.li,{children:"Country code must be a valid ISO 3166-1 alpha-2 code"}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"interfacetoggle",children:(0,i.jsx)(r.code,{children:"InterfaceToggle"})}),"\n",(0,i.jsxs)(r.p,{children:["A ",(0,i.jsx)(r.code,{children:"Switch"})," primitive that fires a GraphQL mutation to enable or disable the wireless interface. Uses optimistic UI: the switch flips immediately, with a toast on failure that reverts the state."]}),"\n",(0,i.jsx)(r.h4,{id:"securitylevelbadge",children:(0,i.jsx)(r.code,{children:"SecurityLevelBadge"})}),"\n",(0,i.jsx)(r.p,{children:"Maps a security mode string to a colored badge:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Security Mode"}),(0,i.jsx)(r.th,{children:"Badge Color"}),(0,i.jsx)(r.th,{children:"Token"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"WPA3"}),(0,i.jsx)(r.td,{children:"Green"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'variant="success"'})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"WPA2+WPA3"}),(0,i.jsx)(r.td,{children:"Blue"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'variant="info"'})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"WPA2"}),(0,i.jsx)(r.td,{children:"Yellow"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'variant="warning"'})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"WPA"}),(0,i.jsx)(r.td,{children:"Orange"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'variant="warning"'})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Open / none"}),(0,i.jsx)(r.td,{children:"Red"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'variant="error"'})})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"wifistatushero",children:(0,i.jsx)(r.code,{children:"WifiStatusHero"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/components/WifiStatusHero.tsx"})]}),"\n",(0,i.jsx)(r.p,{children:"A 2\xd72 (mobile) / 4-column (desktop) stats grid rendering four metric cards:"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Connected Clients"})," \u2014 Total count from ",(0,i.jsx)(r.code,{children:"WirelessClient[]"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Active Interfaces"})," \u2014 Active count vs. total with a progress bar (",(0,i.jsx)(r.code,{children:'aria-role="progressbar"'}),")"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Signal Quality"})," \u2014 Average signal across all clients in dBm with color-coded quality label (Excellent / Good / Fair / Weak) based on dBm thresholds: ",(0,i.jsx)(r.code,{children:">= -50"})," excellent, ",(0,i.jsx)(r.code,{children:">= -60"})," good, ",(0,i.jsx)(r.code,{children:">= -70"})," fair"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Frequency Bands"})," \u2014 Badge pills for each band present (2.4G / 5G / 6G)"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"function getSignalQuality(signalDbm: number): { label: string; color: string; bgColor: string } {\n  if (signalDbm >= -50) return { label: 'Excellent', color: 'text-success', bgColor: 'bg-success' };\n  if (signalDbm >= -60) return { label: 'Good',      color: 'text-success', bgColor: 'bg-success' };\n  if (signalDbm >= -70) return { label: 'Fair',      color: 'text-warning', bgColor: 'bg-warning' };\n  return                       { label: 'Weak',      color: 'text-error',   bgColor: 'bg-error'   };\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:["The hero applies ",(0,i.jsx)(r.code,{children:"category-hero-wifi"})," to its root, which uses the Cyan category accent from the design token system."]}),"\n",(0,i.jsx)(r.h4,{id:"connectedclientstable",children:(0,i.jsx)(r.code,{children:"ConnectedClientsTable"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/components/ConnectedClientsTable.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["Renders clients sorted by signal strength (strongest first) using ",(0,i.jsx)(r.code,{children:"useMemo"}),". Each row shows:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"MAC address (monospace)"}),"\n",(0,i.jsx)(r.li,{children:"Hostname (if available)"}),"\n",(0,i.jsxs)(r.li,{children:["Signal strength with a ",(0,i.jsx)(r.code,{children:"SignalBars"})," sub-component (4-bar SVG indicator colored via semantic tokens)"]}),"\n",(0,i.jsx)(r.li,{children:"Connection time (formatted duration)"}),"\n",(0,i.jsxs)(r.li,{children:["TX/RX bytes (formatted by ",(0,i.jsx)(r.code,{children:"formatBytes"})," from ",(0,i.jsx)(r.code,{children:"@nasnet/core/utils"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"SignalBars"})," component maps dBm to 1-4 bars: above -50 = 4 green, above -60 = 3 green, above -70 = 2 yellow, below = 1 red."]}),"\n",(0,i.jsx)(r.h4,{id:"wifipage",children:(0,i.jsx)(r.code,{children:"WifiPage"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/WifiPage.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["The page-level orchestrator. Fetches data with React Query hooks (",(0,i.jsx)(r.code,{children:"useWirelessInterfaces"}),", ",(0,i.jsx)(r.code,{children:"useWirelessClients"})," from ",(0,i.jsx)(r.code,{children:"@nasnet/api-client/queries"}),") and composes the section components:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"<WifiStatusHero interfaces={interfaces} clients={clients} isLoading={isLoadingInterfaces} />\n<WifiInterfaceList interfaces={interfaces} routerIp={routerIp} isLoading={isLoadingInterfaces} />\n<ConnectedClientsTable clients={clients} isLoading={isLoadingClients} />\n<WifiSecuritySummary interfaces={interfaces} />\n<WifiQuickActions routerIp={routerIp} routerId={routerId} />\n"})}),"\n",(0,i.jsxs)(r.p,{children:["A global refresh button triggers a ",(0,i.jsx)(r.code,{children:"queryClient.invalidateQueries()"})," for both wireless query keys."]}),"\n",(0,i.jsx)(r.h4,{id:"wifidetailpage",children:(0,i.jsx)(r.code,{children:"WifiDetailPage"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/wifi/detail/WifiDetailPage.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:['Per-interface detail view showing all configuration fields, a client list filtered to that interface, and a signal history chart. Contains a "Configure" button that opens ',(0,i.jsx)(r.code,{children:"WirelessSettingsModal"}),"."]}),"\n",(0,i.jsxs)(r.h3,{id:"static-data-wirelessoptionsts",children:["Static Data (",(0,i.jsx)(r.code,{children:"wirelessOptions.ts"}),")"]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"data/wirelessOptions.ts"})," file provides:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"CHANNELS_2_4GHZ"})," \u2014 Valid 2.4 GHz channels (1, 2, 3, ..., 14) plus ",(0,i.jsx)(r.code,{children:"auto"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"CHANNELS_5GHZ"})," \u2014 Valid 5 GHz channels (36, 40, 44, 48, ..., 165) plus ",(0,i.jsx)(r.code,{children:"auto"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"CHANNELS_6GHZ"})," \u2014 Valid 6 GHz channels plus ",(0,i.jsx)(r.code,{children:"auto"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"CHANNEL_WIDTH_OPTIONS"})," \u2014 Per-band width options (20MHz, 40MHz, 80MHz, etc.)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"SECURITY_MODE_OPTIONS"})," \u2014 Label/value pairs for the security dropdown"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"COUNTRY_OPTIONS"})," \u2014 200+ ISO 3166-1 country codes with display names"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"TX_POWER_OPTIONS"})," \u2014 dBm values from 0 to 30 in steps of 1"]}),"\n",(0,i.jsxs)(r.li,{children:["Helper functions: ",(0,i.jsx)(r.code,{children:"getChannelsByBand(band)"}),", ",(0,i.jsx)(r.code,{children:"getChannelWidthsByBand(band)"}),", ",(0,i.jsx)(r.code,{children:"getCountryName(code)"})]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"validation-schema",children:"Validation Schema"}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/wireless/src/validation/wirelessSettings.schema.ts"})]}),"\n",(0,i.jsxs)(r.p,{children:["Exports ",(0,i.jsx)(r.code,{children:"wirelessSettingsSchema"})," (full edit form), ",(0,i.jsx)(r.code,{children:"wirelessSettingsPartialSchema"})," (partial update), and ",(0,i.jsx)(r.code,{children:"defaultWirelessSettings"})," (safe defaults for new form instances). The schema is re-exported via ",(0,i.jsx)(r.code,{children:"index.ts"})," for use in any consumer."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsxs)(r.h2,{id:"part-2-router-discovery-feature-libsfeaturesrouter-discovery",children:["Part 2: Router Discovery Feature (",(0,i.jsx)(r.code,{children:"libs/features/router-discovery"}),")"]}),"\n",(0,i.jsx)(r.h3,{id:"overview-1",children:"Overview"}),"\n",(0,i.jsxs)(r.p,{children:["The router discovery library handles the initial onboarding flow for adding a MikroTik router to NasNetConnect. It provides automated subnet scanning to find routers, a manual entry form for known IPs, credential validation, and a credential storage service. The library is composed into the router management app layer at ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/pages/router-discovery.tsx"}),"."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Library path:"})," ",(0,i.jsx)(r.code,{children:"libs/features/router-discovery/src/"})]}),"\n",(0,i.jsx)(r.h3,{id:"directory-structure-1",children:"Directory Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"libs/features/router-discovery/src/\n\u251c\u2500\u2500 index.ts                          # Public API barrel export\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 NetworkScanner.tsx            # Subnet scan UI with progress\n\u2502   \u251c\u2500\u2500 ManualRouterEntry.tsx         # Manual IP + port entry form\n\u2502   \u251c\u2500\u2500 CredentialDialog.tsx          # Username/password dialog\n\u2502   \u251c\u2500\u2500 RouterCard.tsx                # Discovered router display card\n\u2502   \u2514\u2500\u2500 RouterList.tsx                # List of discovered routers\n\u2514\u2500\u2500 services/\n    \u251c\u2500\u2500 scanService.ts                # Scan logic + ScanError class\n    \u2514\u2500\u2500 credentialService.ts          # Credential storage + validation\n"})}),"\n",(0,i.jsx)(r.h3,{id:"component-table-1",children:"Component Table"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Component"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"NetworkScanner"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/NetworkScanner.tsx"})}),(0,i.jsx)(r.td,{children:"Subnet scan input, progress, and results"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ManualRouterEntry"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/ManualRouterEntry.tsx"})}),(0,i.jsx)(r.td,{children:"Manual IP address and port entry form"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"CredentialDialog"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/CredentialDialog.tsx"})}),(0,i.jsx)(r.td,{children:"Authentication credential input dialog"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"RouterCard"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/RouterCard.tsx"})}),(0,i.jsx)(r.td,{children:"Single discovered router info card"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"RouterList"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/RouterList.tsx"})}),(0,i.jsxs)(r.td,{children:["Wrapper composing multiple ",(0,i.jsx)(r.code,{children:"RouterCard"}),"s"]})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"service-table",children:"Service Table"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Service"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Exports"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"scanService"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"services/scanService.ts"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"startNetworkScan"}),", ",(0,i.jsx)(r.code,{children:"scanResultToRouter"}),", ",(0,i.jsx)(r.code,{children:"validateSubnet"}),", ",(0,i.jsx)(r.code,{children:"getDefaultSubnet"}),", ",(0,i.jsx)(r.code,{children:"ScanError"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"credentialService"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"services/credentialService.ts"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"validateCredentials"}),", ",(0,i.jsx)(r.code,{children:"saveCredentials"}),", ",(0,i.jsx)(r.code,{children:"loadCredentials"}),", ",(0,i.jsx)(r.code,{children:"removeCredentials"}),", ",(0,i.jsx)(r.code,{children:"clearAllCredentials"}),", ",(0,i.jsx)(r.code,{children:"hasCredentials"}),", ",(0,i.jsx)(r.code,{children:"getRoutersWithCredentials"}),", ",(0,i.jsx)(r.code,{children:"DEFAULT_CREDENTIALS"}),", ",(0,i.jsx)(r.code,{children:"CredentialError"})]})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"discovery-flow",children:"Discovery Flow"}),"\n",(0,i.jsx)(r.p,{children:"The router discovery flow is a three-stage process:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"[Subnet Input] \u2192 [Scan Progress] \u2192 [Router Results] \u2192 [CredentialDialog] \u2192 [Connect]\n       \u2191 (or)\n[ManualRouterEntry] \u2192 [CredentialDialog] \u2192 [Connect]\n"})}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Scan stage"}),": User inputs a CIDR subnet (defaulting to the detected local subnet via ",(0,i.jsx)(r.code,{children:"getDefaultSubnet()"}),"). ",(0,i.jsx)(r.code,{children:"NetworkScanner"})," calls ",(0,i.jsx)(r.code,{children:"startNetworkScan(subnet, progressCallback)"})," from ",(0,i.jsx)(r.code,{children:"scanService.ts"}),". The backend scans each IP in the subnet for RouterOS API port 8728."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Progress stage"}),": A real-time progress panel shows ",(0,i.jsx)(r.code,{children:"scannedHosts / totalHosts"}),", current IP being checked, and routers found so far. Framer Motion provides animated entry/exit of the progress panel."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Results stage"}),": Discovered routers appear as clickable ",(0,i.jsx)(r.code,{children:"RouterCard"})," items. Each card shows IP, model, RouterOS version, MAC address, and response time."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Credential stage"}),": Selecting a router opens ",(0,i.jsx)(r.code,{children:"CredentialDialog"})," for username/password entry. On submit, ",(0,i.jsx)(r.code,{children:"validateCredentials(ip, credentials)"})," from ",(0,i.jsx)(r.code,{children:"credentialService.ts"})," tests authentication via the backend proxy."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"networkscanner",children:(0,i.jsx)(r.code,{children:"NetworkScanner"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/router-discovery/src/components/NetworkScanner.tsx"})]}),"\n",(0,i.jsx)(r.p,{children:"The core discovery UI component. Internal state manages scan lifecycle:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"const [subnet, setSubnet]           = useState(defaultSubnet || getDefaultSubnet());\nconst [isScanning, setIsScanning]   = useState(false);\nconst [scanProgress, setScanProgress] = useState<ScanProgress | null>(null);\nconst [scanResults, setScanResults] = useState<ScanResult[]>([]);\nconst [error, setError]             = useState<string | null>(null);\n"})}),"\n",(0,i.jsxs)(r.p,{children:["On scan start, ",(0,i.jsx)(r.code,{children:"validateSubnet(subnet)"})," checks CIDR format before calling the async scan. Progress is delivered via callback:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"const results = await startNetworkScan(subnet, (progress) => {\n  setScanProgress(progress);\n});\n"})}),"\n",(0,i.jsxs)(r.p,{children:["Error handling uses the typed ",(0,i.jsx)(r.code,{children:"ScanError"})," class with a switch on ",(0,i.jsx)(r.code,{children:"error.code"})," for user-friendly messages:"]}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Error Code"}),(0,i.jsx)(r.th,{children:"User Message"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"SCAN_START_FAILED"})}),(0,i.jsx)(r.td,{children:"Failed to start network scan"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"NETWORK_ERROR"})}),(0,i.jsx)(r.td,{children:"Network error occurred"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"TIMEOUT"})}),(0,i.jsx)(r.td,{children:"Scan timed out"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"SCAN_FAILED"})}),(0,i.jsx)(r.td,{children:"Scan failed on the backend"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:["Result items render as ",(0,i.jsx)(r.code,{children:"motion.button"})," elements from Framer Motion with ",(0,i.jsx)(r.code,{children:"whileHover={{ scale: 1.02 }}"})," micro-interactions. Each enforces the 44px touch target minimum."]}),"\n",(0,i.jsx)(r.h3,{id:"manualrouterentry",children:(0,i.jsx)(r.code,{children:"ManualRouterEntry"})}),"\n",(0,i.jsxs)(r.p,{children:["A simple form for users who know their router's IP address. Fields: IP address (IPv4 validation), port (default 8728 for API, 22 for SSH), optional label. On submit, directly opens ",(0,i.jsx)(r.code,{children:"CredentialDialog"})," with the provided address."]}),"\n",(0,i.jsx)(r.h3,{id:"credentialdialog",children:(0,i.jsx)(r.code,{children:"CredentialDialog"})}),"\n",(0,i.jsxs)(r.p,{children:["A modal dialog with username and password fields (password uses ",(0,i.jsx)(r.code,{children:'type="password"'}),' with no show/hide toggle for security). The "Connect" button triggers ',(0,i.jsx)(r.code,{children:"validateCredentials()"})," and shows a loading spinner. On success, calls the parent's ",(0,i.jsx)(r.code,{children:"onRouterSelect"})," with the validated ",(0,i.jsx)(r.code,{children:"ScanResult"}),". On failure, displays an inline error message."]}),"\n",(0,i.jsxs)(r.p,{children:["Tests: ",(0,i.jsx)(r.code,{children:"CredentialDialog.test.tsx"})," covers credential submission, error display, and dialog close behavior."]}),"\n",(0,i.jsx)(r.h3,{id:"routercard",children:(0,i.jsx)(r.code,{children:"RouterCard"})}),"\n",(0,i.jsx)(r.p,{children:"Displays a single discovered router with structured data:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"IP address in large monospace font"}),"\n",(0,i.jsx)(r.li,{children:'Model string (e.g., "RB4011iGS+5HacQ2HnD") when available'}),"\n",(0,i.jsx)(r.li,{children:"RouterOS version"}),"\n",(0,i.jsx)(r.li,{children:"MAC address (monospace)"}),"\n",(0,i.jsx)(r.li,{children:"Online status badge (success green) and response time in milliseconds"}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"credentialservice",children:(0,i.jsx)(r.code,{children:"credentialService"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/router-discovery/src/services/credentialService.ts"})]}),"\n",(0,i.jsxs)(r.p,{children:["Manages credential persistence in ",(0,i.jsx)(r.code,{children:"localStorage"})," under the key ",(0,i.jsx)(r.code,{children:"nasnet.router.credentials"}),". The storage format:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"interface StoredCredentials {\n  [routerId: string]: {\n    username: string;\n    password: string; // Plain text \u2014 encryption planned for Epic 1.4\n    savedAt: string;  // ISO date string\n  };\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"validateCredentials(ipAddress, credentials)"})," makes an HTTP call to the backend proxy to test authentication by fetching ",(0,i.jsx)(r.code,{children:"/api/system/identity"}),". Returns ",(0,i.jsx)(r.code,{children:"CredentialValidationResult"})," with ",(0,i.jsx)(r.code,{children:"isValid"}),", ",(0,i.jsx)(r.code,{children:"error"}),", and optional ",(0,i.jsx)(r.code,{children:"routerInfo"})," (identity, model, version)."]}),"\n",(0,i.jsxs)(r.p,{children:["Default credentials (",(0,i.jsx)(r.code,{children:"DEFAULT_CREDENTIALS"}),") are ",(0,i.jsx)(r.code,{children:"{ username: 'admin', password: '' }"})," \u2014 matching MikroTik factory defaults."]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"CredentialError"})," class is a typed error subclass for distinguishing credential failures from network errors."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsxs)(r.h2,{id:"part-3-configuration-import-feature-libsfeaturesconfiguration-import",children:["Part 3: Configuration Import Feature (",(0,i.jsx)(r.code,{children:"libs/features/configuration-import"}),")"]}),"\n",(0,i.jsx)(r.h3,{id:"overview-2",children:"Overview"}),"\n",(0,i.jsxs)(r.p,{children:["The configuration import library provides a 3-step wizard dialog for applying RouterOS configuration scripts to a router. It supports three connection protocols (API, SSH, Telnet), shows real-time execution progress via a batch job polling mechanism, and supports cancellation and retry. It also provides the ",(0,i.jsx)(r.code,{children:"useConfigurationCheck"})," hook for the onboarding flow that automatically prompts the user to import configuration when a newly-added router has no system note."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Library path:"})," ",(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/"})]}),"\n",(0,i.jsx)(r.h3,{id:"directory-structure-2",children:"Directory Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/\n\u251c\u2500\u2500 index.ts                          # Public API barrel export\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 index.ts                      # Component barrel\n\u2502   \u251c\u2500\u2500 ConfigurationImportWizard.tsx # 3-step wizard dialog orchestrator\n\u2502   \u251c\u2500\u2500 ConfigurationInput.tsx        # Paste / file-upload input step\n\u2502   \u251c\u2500\u2500 ProtocolSelector.tsx          # API / SSH / Telnet selection step\n\u2502   \u2514\u2500\u2500 ExecutionProgress.tsx         # Real-time batch job progress step\n\u2514\u2500\u2500 hooks/\n    \u251c\u2500\u2500 index.ts\n    \u2514\u2500\u2500 useConfigurationCheck.ts      # Onboarding: detect unconfigured routers\n"})}),"\n",(0,i.jsx)(r.h3,{id:"component-table-2",children:"Component Table"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Component"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ConfigurationImportWizard"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/ConfigurationImportWizard.tsx"})}),(0,i.jsx)(r.td,{children:"Dialog orchestrator for all 3 steps"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ConfigurationInput"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/ConfigurationInput.tsx"})}),(0,i.jsx)(r.td,{children:"Paste or upload RouterOS script"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ProtocolSelector"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/ProtocolSelector.tsx"})}),(0,i.jsx)(r.td,{children:"Select connection method (API/SSH/Telnet)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ExecutionProgress"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"components/ExecutionProgress.tsx"})}),(0,i.jsx)(r.td,{children:"Live batch job progress and status"})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"hook-table",children:"Hook Table"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Hook"}),(0,i.jsx)(r.th,{children:"File"}),(0,i.jsx)(r.th,{children:"Purpose"})]})}),(0,i.jsx)(r.tbody,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"useConfigurationCheck"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"hooks/useConfigurationCheck.ts"})}),(0,i.jsx)(r.td,{children:"Detect and surface unconfigured routers"})]})})]}),"\n",(0,i.jsx)(r.h3,{id:"import-flow",children:"Import Flow"}),"\n",(0,i.jsx)(r.p,{children:"The wizard implements a linear 3-step flow with back-navigation:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"Step 1: Configuration  \u2192  Step 2: Method  \u2192  Step 3: Apply\n   [ConfigurationInput]   [ProtocolSelector]  [ExecutionProgress]\n         \u2191 Back \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"})}),"\n",(0,i.jsx)(r.p,{children:"Wizard state is managed with four local state variables:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"type WizardStep = 'input' | 'protocol' | 'execute' | 'complete';\n\nconst [step, setStep]                     = useState<WizardStep>('input');\nconst [configuration, setConfiguration]   = useState('');\nconst [selectedProtocol, setSelectedProtocol] = useState<ExecutionProtocol | null>(null);\nconst [jobId, setJobId]                   = useState<string | null>(null);\n"})}),"\n",(0,i.jsxs)(r.p,{children:["Step transitions are animated with Framer Motion ",(0,i.jsx)(r.code,{children:"AnimatePresence"})," and ",(0,i.jsx)(r.code,{children:"motion.div"})," with ",(0,i.jsx)(r.code,{children:"initial={{ opacity: 0, x: 20 }}"})," / ",(0,i.jsx)(r.code,{children:"exit={{ opacity: 0, x: -20 }}"})," for left-to-right flow."]}),"\n",(0,i.jsxs)(r.p,{children:["A ",(0,i.jsx)(r.code,{children:"StepIndicator"})," sub-component renders numbered circles connected by lines: completed steps show a green ",(0,i.jsx)(r.code,{children:"CheckCircle"}),", the current step is highlighted with ",(0,i.jsx)(r.code,{children:"bg-primary"}),", and future steps are muted."]}),"\n",(0,i.jsx)(r.h3,{id:"configurationimportwizard",children:(0,i.jsx)(r.code,{children:"ConfigurationImportWizard"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/components/ConfigurationImportWizard.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["The dialog orchestrator. Uses these API hooks from ",(0,i.jsx)(r.code,{children:"@nasnet/api-client/queries"}),":"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"useEnabledProtocols(routerIp)"})," \u2014 returns ",(0,i.jsx)(r.code,{children:"{ api, ssh, telnet, isLoading }"})," booleans"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"useCreateBatchJob()"})," \u2014 mutation to create a batch job with rollback enabled"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"useBatchJob(jobId)"})," \u2014 polls for job status updates"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"useCancelBatchJob()"})," \u2014 mutation to cancel a running job"]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"When moving from Step 1 to Step 2, the first available protocol is automatically pre-selected:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"if (api) setSelectedProtocol('api');\nelse if (ssh) setSelectedProtocol('ssh');\nelse if (telnet) setSelectedProtocol('telnet');\n"})}),"\n",(0,i.jsx)(r.p,{children:"On Step 2 \u2192 Step 3, the wizard creates a batch job with rollback enabled:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"const result = await createJob.mutateAsync({\n  routerIp,\n  username: credentials.username,\n  password: credentials.password,\n  protocol: selectedProtocol,\n  script: configuration,\n  rollbackEnabled: true,\n});\nsetJobId(result.jobId);\n"})}),"\n",(0,i.jsxs)(r.p,{children:["Closing is blocked while a job is actively running (",(0,i.jsx)(r.code,{children:"step === 'execute' && job?.status === 'running'"}),"). On any other state, closing resets all wizard state so the dialog is clean for the next open."]}),"\n",(0,i.jsx)(r.p,{children:"Props interface:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"export interface ConfigurationImportWizardProps {\n  isOpen: boolean;\n  onClose: () => void;\n  routerIp: string;\n  credentials: { username: string; password: string };\n  onSuccess?: () => void;\n  onSkip?: () => void;\n  className?: string;\n}\n"})}),"\n",(0,i.jsx)(r.h3,{id:"configurationinput",children:(0,i.jsx)(r.code,{children:"ConfigurationInput"})}),"\n",(0,i.jsx)(r.p,{children:"Step 1 component providing two input methods:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Paste"})," \u2014 Textarea accepting RouterOS export script text"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Upload"})," \u2014 File input accepting ",(0,i.jsx)(r.code,{children:".rsc"})," files (RouterOS script extension)"]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"canProceed"})," gate in the wizard checks ",(0,i.jsx)(r.code,{children:"configuration.trim().length > 0"})," before enabling the Continue button."]}),"\n",(0,i.jsx)(r.h3,{id:"protocolselector",children:(0,i.jsx)(r.code,{children:"ProtocolSelector"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/components/ProtocolSelector.tsx"})]}),"\n",(0,i.jsx)(r.p,{children:"Renders three protocol options as interactive card buttons with icons:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Protocol"}),(0,i.jsx)(r.th,{children:"Icon"}),(0,i.jsx)(r.th,{children:"Recommended"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"RouterOS API"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Plug"})}),(0,i.jsx)(r.td,{children:"Yes (fastest)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"SSH"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Terminal"})}),(0,i.jsx)(r.td,{children:"No"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Telnet"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"MonitorDot"})}),(0,i.jsx)(r.td,{children:"No"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:["Each card uses ",(0,i.jsx)(r.code,{children:"motion.button"})," with ",(0,i.jsx)(r.code,{children:"whileHover={{ scale: 1.02 }}"})," and ",(0,i.jsx)(r.code,{children:"whileTap={{ scale: 0.98 }}"}),". Cards for unavailable protocols are grayed out (",(0,i.jsx)(r.code,{children:"opacity-50 cursor-not-allowed"}),"). A real-time availability dot (green/muted) under each card reflects the ",(0,i.jsx)(r.code,{children:"isLoading"}),' state (shows "Checking...") transitioning to "Available" or "Disabled".']}),"\n",(0,i.jsxs)(r.p,{children:["The selected card gets ",(0,i.jsx)(r.code,{children:"border-primary bg-primary/5 shadow-primary-glow"})," styling and a checkmark overlay badge."]}),"\n",(0,i.jsxs)(r.p,{children:["When no protocols are available and loading is complete, an ",(0,i.jsx)(r.code,{children:"AlertCircle"})," warning is shown:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:'{hasNoEnabledProtocols && (\n  <div className="bg-warning/10 border border-warning/30 rounded-lg p-component-md" role="alert">\n    <p>No connection methods available</p>\n    <p>Please enable API, SSH, or Telnet service on your router.</p>\n  </div>\n)}\n'})}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"recommended"})," badge (shown only on API when enabled) uses ",(0,i.jsx)(r.code,{children:"bg-secondary text-secondary-foreground"})," \u2014 Trust Blue \u2014 aligning with the design system's use of blue for reliability indicators."]}),"\n",(0,i.jsx)(r.h3,{id:"executionprogress",children:(0,i.jsx)(r.code,{children:"ExecutionProgress"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/components/ExecutionProgress.tsx"})]}),"\n",(0,i.jsxs)(r.p,{children:["Displays real-time execution state of a ",(0,i.jsx)(r.code,{children:"BatchJob"}),". Maps ",(0,i.jsx)(r.code,{children:"BatchJobStatus"})," to visual configurations:"]}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Status"}),(0,i.jsx)(r.th,{children:"Icon"}),(0,i.jsx)(r.th,{children:"Color"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"pending"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"Circle"})," (gray)"]}),(0,i.jsx)(r.td,{children:"Muted"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"running"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"Loader2"})," (spinning)"]}),(0,i.jsx)(r.td,{children:"Primary"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"completed"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"CheckCircle"})}),(0,i.jsx)(r.td,{children:"Success"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"failed"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"XCircle"})}),(0,i.jsx)(r.td,{children:"Error"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"rolled_back"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"RotateCcw"})}),(0,i.jsx)(r.td,{children:"Warning"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"cancelled"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"XCircle"})}),(0,i.jsx)(r.td,{children:"Muted"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:["Per-command progress is shown as a list where each command line toggles between pending/running/success/failure states with Framer Motion animated transitions. A Cancel button (when the job is running) calls the ",(0,i.jsx)(r.code,{children:"onCancel"})," prop. A Retry button (when the job has failed) calls ",(0,i.jsx)(r.code,{children:"onRetry"}),", which resets ",(0,i.jsx)(r.code,{children:"jobId"})," and returns to Step 2."]}),"\n",(0,i.jsx)(r.h3,{id:"useconfigurationcheck",children:(0,i.jsx)(r.code,{children:"useConfigurationCheck"})}),"\n",(0,i.jsxs)(r.p,{children:["File: ",(0,i.jsx)(r.code,{children:"libs/features/configuration-import/src/hooks/useConfigurationCheck.ts"})]}),"\n",(0,i.jsxs)(r.p,{children:["Enables an onboarding flow that automatically detects unconfigured routers and surfaces the import wizard. The detection logic uses ",(0,i.jsx)(r.code,{children:"useSystemNote(routerIp)"})," from ",(0,i.jsx)(r.code,{children:"@nasnet/api-client/queries"}),": if the system note is empty, the router is considered unconfigured."]}),"\n",(0,i.jsxs)(r.p,{children:["To avoid showing the wizard repeatedly, visited routers are tracked in the Zustand ",(0,i.jsx)(r.code,{children:"useRouterStore"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"const alreadyChecked = isConfigurationChecked(routerId);\n// Only runs the auto-trigger once per routerId per session\n"})}),"\n",(0,i.jsx)(r.p,{children:"Returned interface:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",children:"interface UseConfigurationCheckResult {\n  isLoading: boolean;\n  needsConfiguration: boolean;  // true if system note is empty\n  showWizard: boolean;           // controls wizard open state\n  openWizard: () => void;        // manual trigger\n  closeWizard: () => void;       // closes + marks as checked\n  markAsChecked: () => void;     // marks without showing wizard\n  error: Error | null;\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:"Usage in a router panel:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-tsx",children:"function RouterPanel({ routerId, routerIp }) {\n  const { showWizard, closeWizard } = useConfigurationCheck(routerId, routerIp);\n  return (\n    <>\n      <ConfigurationImportWizard\n        isOpen={showWizard}\n        onClose={closeWizard}\n        routerIp={routerIp}\n        credentials={savedCredentials}\n        onSuccess={refetchRouterData}\n      />\n      {/* rest of panel */}\n    </>\n  );\n}\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Platform presenter pattern"}),": ",(0,i.jsx)(r.code,{children:"Docs/design/PLATFORM_PRESENTER_GUIDE.md"})," \u2014 the wireless library components are primarily single-platform (no explicit Desktop/Mobile split) since they are consumed inside pages that handle the layout split"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Design tokens"}),": ",(0,i.jsx)(r.code,{children:"Docs/design/DESIGN_TOKENS.md"})," \u2014 ",(0,i.jsx)(r.code,{children:"category-hero-wifi"})," (Cyan), ",(0,i.jsx)(r.code,{children:"text-success/warning/error"})," for signal quality coloring"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Network feature"}),": ",(0,i.jsx)(r.code,{children:"libs/features/docs/feature-network.md"})," \u2014 the Interface management sub-module for wired interfaces"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"GraphQL schema"}),": Wireless types in ",(0,i.jsx)(r.code,{children:"schema/core/"}),", batch job types in ",(0,i.jsx)(r.code,{children:"schema/services/"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"API hooks"}),": Wireless hooks in ",(0,i.jsx)(r.code,{children:"libs/api-client/queries/src/wireless.ts"}),", batch job hooks in ",(0,i.jsx)(r.code,{children:"libs/api-client/queries/src/batch.ts"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Zustand stores"}),": ",(0,i.jsx)(r.code,{children:"useRouterStore"})," from ",(0,i.jsx)(r.code,{children:"libs/state/stores"})," for ",(0,i.jsx)(r.code,{children:"isConfigurationChecked"})," / ",(0,i.jsx)(r.code,{children:"markConfigurationChecked"})]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Router panel integration"}),": ",(0,i.jsx)(r.code,{children:"apps/connect/src/app/routes/router-panel/RouterPanel.tsx"})," consumes ",(0,i.jsx)(r.code,{children:"useConfigurationCheck"})," and renders ",(0,i.jsx)(r.code,{children:"ConfigurationImportWizard"})]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},71184:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>d});var s=n(14041);const i={},t=s.createContext(i);function c(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);
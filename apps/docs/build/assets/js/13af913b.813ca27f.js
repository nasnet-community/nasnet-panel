"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[53791],{40112:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"feature-modules/firewall","title":"Firewall Feature","description":"The firewall feature (libs/features/firewall/) provides comprehensive MikroTik","source":"@site/../connect/docs/feature-modules/firewall.md","sourceDirName":"feature-modules","slug":"/feature-modules/firewall","permalink":"/docs/frontend/feature-modules/firewall","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../connect/docs/feature-modules/firewall.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Diagnostics Feature Module","permalink":"/docs/frontend/feature-modules/diagnostics"},"next":{"title":"Logs Feature Module","permalink":"/docs/frontend/feature-modules/logs"}}');var i=r(31085),n=r(71184);const d={},t="Firewall Feature",c={},a=[{value:"Route Structure",id:"route-structure",level:2},{value:"Sub-Page Overview",id:"sub-page-overview",level:2},{value:"Filter Rules (main <code>FirewallTab</code>)",id:"filter-rules-main-firewalltab",level:3},{value:"NAT Rules",id:"nat-rules",level:3},{value:"Mangle Rules",id:"mangle-rules",level:3},{value:"Raw Rules",id:"raw-rules",level:3},{value:"Address Lists",id:"address-lists",level:3},{value:"Port Knocking",id:"port-knocking",level:3},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Service Ports",id:"service-ports",level:3},{value:"Templates",id:"templates",level:3},{value:"Firewall Logs",id:"firewall-logs",level:3},{value:"Rule Filtering",id:"rule-filtering",level:2},{value:"Platform-Adaptive Tables",id:"platform-adaptive-tables",level:2},{value:"Template System",id:"template-system",level:2},{value:"XState Machine",id:"xstate-machine",level:3},{value:"Template Schemas",id:"template-schemas",level:3},{value:"Custom Services and Templates",id:"custom-services-and-templates",level:2},{value:"Chain Summary",id:"chain-summary",level:2},{value:"Related",id:"related",level:2}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"firewall-feature",children:"Firewall Feature"})}),"\n",(0,i.jsxs)(s.p,{children:["The firewall feature (",(0,i.jsx)(s.code,{children:"libs/features/firewall/"}),") provides comprehensive MikroTik\nfirewall management across nine sub-pages, with platform-adaptive tables, rule\nfiltering, address list management, and a template system backed by an XState\nsafety pipeline."]}),"\n",(0,i.jsx)(s.h2,{id:"route-structure",children:"Route Structure"}),"\n",(0,i.jsxs)(s.p,{children:["All routes are nested under ",(0,i.jsx)(s.code,{children:"/router/$id/firewall/"}),". Each route lazy-loads its\npage component wrapped in ",(0,i.jsx)(s.code,{children:"LazyBoundary"})," with a skeleton fallback for optimal\nbundle size."]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Route path"}),(0,i.jsx)(s.th,{children:"Component"}),(0,i.jsx)(s.th,{children:"Source"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"/router/$id/firewall"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"LazyFirewallTab"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/address-lists"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"AddressListView"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/address-lists.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/mangle"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ManglePage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/mangle.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/raw"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"RawPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/raw.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/port-knocking"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"PortKnockingPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/port-knocking.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/rate-limiting"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"RateLimitingPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/rate-limiting.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/service-ports"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ServicePortsPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/service-ports.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/templates"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"TemplatesPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/templates.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/connections"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"ConnectionsPage"})," (inline)"]}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/connections.tsx"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:".../firewall/logs"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FirewallLogsPage"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"apps/connect/src/routes/router/$id/firewall/logs.tsx"})})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"sub-page-overview",children:"Sub-Page Overview"}),"\n",(0,i.jsxs)(s.h3,{id:"filter-rules-main-firewalltab",children:["Filter Rules (main ",(0,i.jsx)(s.code,{children:"FirewallTab"}),")"]}),"\n",(0,i.jsxs)(s.p,{children:["The primary firewall view. Rendered via ",(0,i.jsx)(s.code,{children:"LazyFirewallTab"})," \u2192 ",(0,i.jsx)(s.code,{children:"FirewallTab"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"FilterRulesTable"})," \u2014 platform wrapper that renders ",(0,i.jsx)(s.code,{children:"FilterRulesTableDesktop"}),"\n(dense virtualized table with drag-drop reordering) or ",(0,i.jsx)(s.code,{children:"FilterRulesTableMobile"}),"\n(card list with touch-friendly controls)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ChainSummaryCards"})," \u2014 summary chips for input / output / forward chains."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"FirewallStatusHero"})," \u2014 top-of-page status banner."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"FirewallQuickStats"})," \u2014 counts of enabled / disabled / matched rules."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RuleSearchFilters"})," \u2014 search + chain + action + protocol + status dropdowns."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ReadOnlyNotice"})," \u2014 shown when the connected router returns read-only mode."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"nat-rules",children:"NAT Rules"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"NATRulesPage"})," \u2014 manages source-NAT, destination-NAT, masquerade, and port-forward\nrules."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"NATRulesTable"})," \u2014 platform-adaptive table of NAT rules."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"PortForwardWizardDialog"})," \u2014 multi-step wizard for adding port-forward rules\n(protocol, external port, internal IP, internal port)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"MasqueradeQuickDialog"})," \u2014 one-click masquerade enable for a given interface."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"TrafficFlowDiagram"})," \u2014 SVG diagram visualising the NAT traffic path."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"mangle-rules",children:"Mangle Rules"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"ManglePage"})," \u2014 packet-marking rules for QoS and routing policy."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"MangleRulesTable"})," \u2014 platform wrapper."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"MangleRulesTableMobile"})," \u2014 card layout for mobile."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"raw-rules",children:"Raw Rules"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"RawPage"})," \u2014 raw/prerouting rules that run before connection tracking."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RawRulesTable"})," \u2014 platform-adaptive raw rules table."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"address-lists",children:"Address Lists"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"AddressListView"})," \u2014 manages named IP address lists used as ",(0,i.jsx)(s.code,{children:"src-address-list"})," /\n",(0,i.jsx)(s.code,{children:"dst-address-list"})," targets in firewall rules."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"AddressListEntryForm"})," \u2014 add/edit a single entry (IP, subnet, or range)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"AddressListImportDialog"})," \u2014 bulk-import from a text file or clipboard."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"AddressListExportDialog"})," \u2014 export list to CSV / plain text."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"AddToAddressListContextMenu"})," \u2014 right-click context menu on rule table rows to\ndirectly add the rule's source/destination to a list."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"IPAddressDisplay"})," \u2014 formatted display of IP / CIDR / range values."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Parsers live in ",(0,i.jsx)(s.code,{children:"utils/addressListParsers.ts"}),"; formatters in\n",(0,i.jsx)(s.code,{children:"utils/addressListFormatters.ts"}),"."]}),"\n",(0,i.jsx)(s.h3,{id:"port-knocking",children:"Port Knocking"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"PortKnockingPage"})," \u2014 configures port-knock sequences that temporarily open ports\non a successful knock sequence."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"PortKnockSequenceManager"})," \u2014 platform wrapper."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"PortKnockSequenceManagerDesktop"})," \u2014 reorderable sequence editor."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"PortKnockSequenceManagerMobile"})," \u2014 swipe-action mobile card list."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"PortKnockLogViewer"})," \u2014 real-time log of knock attempts."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"RateLimitingPage"})," \u2014 per-connection and per-address bandwidth limits."]}),"\n",(0,i.jsx)(s.h3,{id:"service-ports",children:"Service Ports"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"ServicePortsPage"})," \u2014 enable/disable and reconfigure MikroTik service ports\n(SSH, Telnet, HTTP, HTTPS, Winbox, API, API-SSL, FTP)."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ServicePortsTable"})," \u2014 platform-adaptive table."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"AddServiceDialog"})," \u2014 add a custom service port entry."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ServiceGroupDialog"})," \u2014 group multiple ports under a label."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ServicesStatus"})," \u2014 summary card showing how many services are exposed."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"templates",children:"Templates"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"TemplatesPage"})," \u2014 browse, configure, and apply pre-built firewall rule templates."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ImportTemplateDialog"})," \u2014 import a custom template from JSON / URL."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"SaveTemplateDialog"})," \u2014 export the current ruleset as a reusable template."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"TemplateApplyFlow"})," \u2014 full XState-driven apply wizard (see below)."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"firewall-logs",children:"Firewall Logs"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"FirewallLogsPage"})," \u2014 paginated, searchable firewall log viewer."]}),"\n",(0,i.jsx)(s.p,{children:"Components used:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RecentFirewallActivity"})," \u2014 last-N log entries widget."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RoutingTable"})," \u2014 routing decision log view."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"rule-filtering",children:"Rule Filtering"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useRuleFilters"})," (",(0,i.jsx)(s.code,{children:"libs/features/firewall/src/hooks/useRuleFilters.ts"}),") manages\nmulti-dimensional filter state via ",(0,i.jsx)(s.code,{children:"useReducer"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:"interface FirewallFilters {\n  search: string;         // matches comment, srcAddress, dstAddress, srcPort, dstPort\n  chain: FirewallChain | 'all';\n  action: FirewallAction | 'all';\n  protocol: FirewallProtocol | 'all';\n  status: 'enabled' | 'disabled' | 'all';\n}\n"})}),"\n",(0,i.jsxs)(s.p,{children:["All setter functions are stable ",(0,i.jsx)(s.code,{children:"useCallback"})," references. ",(0,i.jsx)(s.code,{children:"activeFilterCount"}),"\nand ",(0,i.jsx)(s.code,{children:"hasActiveFilters"})," are memoised. ",(0,i.jsx)(s.code,{children:"filterRules(rules)"})," is also memoised and\naccepts the full rule array, returning the filtered subset."]}),"\n",(0,i.jsx)(s.h2,{id:"platform-adaptive-tables",children:"Platform-Adaptive Tables"}),"\n",(0,i.jsx)(s.p,{children:"Every rules table follows the headless + presenter pattern:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-tsx",children:"// FilterRulesTable.tsx \u2014 platform detection\nconst isMobile = useMediaQuery('(max-width: 640px)');\nreturn isMobile\n  ? <FilterRulesTableMobile chain={chain} />\n  : <FilterRulesTableDesktop chain={chain} />;\n"})}),"\n",(0,i.jsx)(s.p,{children:"Desktop presenters add:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Dense data table with virtual scrolling for large rule sets."}),"\n",(0,i.jsxs)(s.li,{children:["Drag-to-reorder via ",(0,i.jsx)(s.code,{children:"@dnd-kit"})," (desktop only)."]}),"\n",(0,i.jsx)(s.li,{children:"Keyboard shortcut support (e, d for enable/disable, Del for delete)."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Mobile presenters use:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Card-based layout, one card per rule."}),"\n",(0,i.jsx)(s.li,{children:"Swipe-left for delete / swipe-right for enable toggle."}),"\n",(0,i.jsx)(s.li,{children:"44 px minimum touch targets on all interactive elements."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["See ",(0,i.jsx)(s.code,{children:"../ui-system/patterns-catalog.md"})," for the platform presenter\nimplementation guide."]}),"\n",(0,i.jsx)(s.h2,{id:"template-system",children:"Template System"}),"\n",(0,i.jsx)(s.h3,{id:"xstate-machine",children:"XState Machine"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"createTemplateApplyMachine"})," (",(0,i.jsx)(s.code,{children:"libs/features/firewall/src/machines/template-apply.machine.ts"}),")\nimplements the Safety Pipeline architectural pattern using XState v5:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"idle \u2192 configuring \u2192 previewing \u2192 reviewing \u2192 [confirming] \u2192 applying \u2192 success\n                                                                          \u2193\n                                                                    rollingBack \u2192 rolledBack\n"})}),"\n",(0,i.jsx)(s.p,{children:"State descriptions:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"State"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"idle"})}),(0,i.jsx)(s.td,{children:"Waiting for template selection"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"configuring"})}),(0,i.jsx)(s.td,{children:"User fills template variables"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"previewing"})}),(0,i.jsx)(s.td,{children:"API resolves variables, detects conflicts"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"reviewing"})}),(0,i.jsx)(s.td,{children:"User reviews resolved rules and conflicts"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"confirming"})}),(0,i.jsx)(s.td,{children:"High-risk acknowledgement dialog (triggered when >10 rules or >3 chains affected, or any conflict/warning)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"applying"})}),(0,i.jsx)(s.td,{children:"API applies template to router"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"success"})}),(0,i.jsx)(s.td,{children:"10-second undo window with rollback button"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"rollingBack"})}),(0,i.jsxs)(s.td,{children:["Executing rollback via ",(0,i.jsx)(s.code,{children:"rollbackId"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"rolledBack"})}),(0,i.jsx)(s.td,{children:"Rollback complete"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"error"})}),(0,i.jsx)(s.td,{children:"Error with retry / rollback options"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"High-risk thresholds:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"MAX_LOW_RISK_RULES = 10"})," \u2014 more than 10 new rules triggers confirmation."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"MAX_LOW_RISK_CHAINS = 3"})," \u2014 affecting more than 3 chains triggers confirmation."]}),"\n",(0,i.jsx)(s.li,{children:"Any conflict or warning in the preview also triggers confirmation."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The machine is instantiated with injectable async handlers, making it fully\ntestable without mocking the module."}),"\n",(0,i.jsx)(s.h3,{id:"template-schemas",children:"Template Schemas"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"libs/features/firewall/src/schemas/templateSchemas.ts"})," defines:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"FirewallTemplate"})," \u2014 rule set with variable placeholder syntax."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"TemplatePreviewResult"})," \u2014 resolved rules, conflicts, impact analysis."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"FirewallTemplateResult"})," \u2014 apply outcome with ",(0,i.jsx)(s.code,{children:"rollbackId"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"utils/template-validator.ts"})," validates template JSON at import time.\n",(0,i.jsx)(s.code,{children:"utils/template-export.ts"})," serialises a rule set to the template format."]}),"\n",(0,i.jsx)(s.h2,{id:"custom-services-and-templates",children:"Custom Services and Templates"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useCustomServices"})," (",(0,i.jsx)(s.code,{children:"hooks/useCustomServices.ts"}),") stores user-defined service\ngroup definitions in ",(0,i.jsx)(s.code,{children:"localStorage"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useCustomTemplates"})," (",(0,i.jsx)(s.code,{children:"hooks/useCustomTemplates.ts"}),") stores user-defined\ntemplates locally so they can be reused without re-importing."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useCounterSettingsStore"})," (",(0,i.jsx)(s.code,{children:"hooks/useCounterSettingsStore.ts"}),") persists the\nuser's preference for how rule hit counters are displayed (absolute, per-second,\nper-minute)."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"counterHistoryStorage"})," (",(0,i.jsx)(s.code,{children:"services/counterHistoryStorage.ts"}),") maintains a rolling\nwindow of counter values to derive per-second rates."]}),"\n",(0,i.jsx)(s.h2,{id:"chain-summary",children:"Chain Summary"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"useChainSummary"})," (",(0,i.jsx)(s.code,{children:"hooks/useChainSummary.ts"}),") computes per-chain statistics\n(enabled, disabled, accepting, dropping, logging) from the full rule list. Used\nby ",(0,i.jsx)(s.code,{children:"ChainSummaryCards"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"related",children:"Related"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"../data-fetching/graphql-hooks.md"})," \u2014 firewall GraphQL hooks."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"../ui-system/patterns-catalog.md"})," \u2014 shared UI patterns used in tables."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},71184:(e,s,r)=>{r.d(s,{R:()=>d,x:()=>t});var l=r(14041);const i={},n=l.createContext(i);function d(e){const s=l.useContext(n);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),l.createElement(n.Provider,{value:s},e.children)}}}]);
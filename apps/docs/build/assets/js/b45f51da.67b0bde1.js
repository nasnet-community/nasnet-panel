"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[50839],{623:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"guides/debugging","title":"Debugging Zustand & XState","description":"Essential debugging techniques for state management in development and production.","source":"@site/../../libs/state/docs/guides/debugging.md","sourceDirName":"guides","slug":"/guides/debugging","permalink":"/docs/state/guides/debugging","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/state/docs/guides/debugging.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Adding a New Zustand Store","permalink":"/docs/state/guides/adding-a-store"},"next":{"title":"Quickstart Guide: State Management in 10 Minutes","permalink":"/docs/state/guides/quickstart"}}');var r=s(31085),i=s(71184);const o={},l="Debugging Zustand & XState",c={},a=[{value:"Zustand DevTools",id:"zustand-devtools",level:2},{value:"Setup DevTools Integration",id:"setup-devtools-integration",level:3},{value:"Using Redux DevTools Extension",id:"using-redux-devtools-extension",level:3},{value:"Features",id:"features",level:3},{value:"Console Debugging",id:"console-debugging",level:3},{value:"XState Debugging",id:"xstate-debugging",level:2},{value:"Inspect Machine Transitions",id:"inspect-machine-transitions",level:3},{value:"Stately Visualizer",id:"stately-visualizer",level:3},{value:"Console Debugging",id:"console-debugging-1",level:3},{value:"localStorage Debugging",id:"localstorage-debugging",level:2},{value:"View All Persisted State",id:"view-all-persisted-state",level:3},{value:"Full localStorage Reference",id:"full-localstorage-reference",level:3},{value:"Clear Specific Store",id:"clear-specific-store",level:3},{value:"Inspect Persisted Data",id:"inspect-persisted-data",level:3},{value:"Restore Previous State",id:"restore-previous-state",level:3},{value:"Common Issues &amp; Solutions",id:"common-issues--solutions",level:2},{value:"Store Not Updating in Component",id:"store-not-updating-in-component",level:3},{value:"Stale State from getState()",id:"stale-state-from-getstate",level:3},{value:"Persistence Not Working",id:"persistence-not-working",level:3},{value:"Machine State Stuck",id:"machine-state-stuck",level:3},{value:"Auth Token Expired",id:"auth-token-expired",level:3},{value:"Memory Leaks",id:"memory-leaks",level:3},{value:"Debug Console Utilities",id:"debug-console-utilities",level:2},{value:"Create Debug Functions",id:"create-debug-functions",level:3},{value:"Browser Console Integration",id:"browser-console-integration",level:3},{value:"Performance Debugging",id:"performance-debugging",level:2},{value:"Track Re-renders",id:"track-re-renders",level:3},{value:"Monitor Store Updates",id:"monitor-store-updates",level:3},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"debugging-zustand--xstate",children:"Debugging Zustand & XState"})}),"\n",(0,r.jsx)(n.p,{children:"Essential debugging techniques for state management in development and production."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source:"})," ",(0,r.jsx)(n.code,{children:"libs/state/stores/src/"})," and ",(0,r.jsx)(n.code,{children:"libs/state/machines/src/"})]}),"\n",(0,r.jsx)(n.h2,{id:"zustand-devtools",children:"Zustand DevTools"}),"\n",(0,r.jsx)(n.h3,{id:"setup-devtools-integration",children:"Setup DevTools Integration"}),"\n",(0,r.jsx)(n.p,{children:"Zustand has built-in DevTools support:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\n\nexport const useMyStore = create<MyState>()(\n  devtools(\n    (set) => ({\n      // Implementation\n    }),\n    {\n      name: 'myStore', // Show in DevTools\n      enabled: import.meta.env.DEV, // Only in development\n    }\n  )\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:"Most stores already have DevTools integrated - it's automatic!"}),"\n",(0,r.jsx)(n.h3,{id:"using-redux-devtools-extension",children:"Using Redux DevTools Extension"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Install browser extension"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Chrome: ",(0,r.jsx)(n.a,{href:"https://chrome.google.com/webstore",children:"Redux DevTools"})]}),"\n",(0,r.jsxs)(n.li,{children:["Firefox: ",(0,r.jsx)(n.a,{href:"https://addons.mozilla.org/firefox",children:"Redux DevTools"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open DevTools in browser"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Right-click \u2192 Inspect \u2192 DevTools \u2192 Redux tab"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Watch state changes"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Every action appears as a timestamped action"}),"\n",(0,r.jsx)(n.li,{children:"Jump to any past state (time travel)"}),"\n",(0,r.jsx)(n.li,{children:"Inspect diff between states"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Action History"})}),(0,r.jsx)(n.td,{children:"See every state mutation with timestamp"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Time Travel"})}),(0,r.jsx)(n.td,{children:"Jump to any previous state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Diff View"})}),(0,r.jsx)(n.td,{children:"See what changed between states"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Export/Import"})}),(0,r.jsx)(n.td,{children:"Save and restore state snapshots"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Dispatch Test"})}),(0,r.jsx)(n.td,{children:"Send actions to test state changes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Persist"})}),(0,r.jsx)(n.td,{children:"Save state between sessions"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"console-debugging",children:"Console Debugging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Log full store state\nconsole.log(useMyStore.getState());\n\n// Watch specific field\nuseMyStore.subscribe(\n  (state) => state.searchQuery,\n  (searchQuery) => console.log('Search changed:', searchQuery)\n);\n\n// Log all actions\nuseMyStore.subscribe((state, previousState) => {\n  console.log('State changed:', {\n    previous: previousState,\n    current: state,\n    changed: Object.entries(state).filter(\n      ([key, value]) => value !== previousState[key]\n    ),\n  });\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"xstate-debugging",children:"XState Debugging"}),"\n",(0,r.jsx)(n.h3,{id:"inspect-machine-transitions",children:"Inspect Machine Transitions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { createMyMachine } from '@nasnet/state/machines';\n\nconst machine = createMyMachine();\nconst actor = machine.start();\n\n// Log every transition\nactor.subscribe((snapshot) => {\n  console.log('State:', snapshot.value);\n  console.log('Context:', snapshot.context);\n  console.log('Can transition:', {\n    NEXT: snapshot.can({ type: 'NEXT' }),\n    BACK: snapshot.can({ type: 'BACK' }),\n    SUBMIT: snapshot.can({ type: 'SUBMIT' }),\n  });\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stately-visualizer",children:"Stately Visualizer"}),"\n",(0,r.jsx)(n.p,{children:"Visualize state machine diagrams:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// 1. Go to https://stately.ai/viz\n// 2. Create new\n// 3. Paste machine definition:\n\nimport { createMyMachine } from '@nasnet/state/machines';\n\nconst machine = createMyMachine();\nconsole.log(machine.toJSON());\n"})}),"\n",(0,r.jsx)(n.p,{children:"Copy the JSON output and paste into Stately Visualizer to see:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"State diagram"}),"\n",(0,r.jsx)(n.li,{children:"Transitions"}),"\n",(0,r.jsx)(n.li,{children:"Guards"}),"\n",(0,r.jsx)(n.li,{children:"Final states"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"console-debugging-1",children:"Console Debugging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { useMyWorkflow } from '@nasnet/state/machines';\n\nfunction MyComponent() {\n  const { state, context, send } = useMyWorkflow({ userId: 'user-1' });\n\n  // Log state and context\n  useEffect(() => {\n    console.log('Machine state:', state);\n    console.log('Machine context:', context);\n  }, [state, context]);\n\n  // Log before sending event\n  const handleNext = () => {\n    console.log('Sending NEXT from', state);\n    send({ type: 'NEXT' });\n  };\n\n  return <button onClick={handleNext}>Next</button>;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"localstorage-debugging",children:"localStorage Debugging"}),"\n",(0,r.jsx)(n.h3,{id:"view-all-persisted-state",children:"View All Persisted State"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Show all localStorage entries\nObject.keys(localStorage).forEach((key) => {\n  if (key.includes('store') || key.includes('storage')) {\n    const value = JSON.parse(localStorage.getItem(key) || '{}');\n    console.log(`${key}:`, value);\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"full-localstorage-reference",children:"Full localStorage Reference"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Store"}),(0,r.jsx)(n.th,{children:"localStorage Key"}),(0,r.jsx)(n.th,{children:"Persisted Fields"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Auth"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-auth-store"})}),(0,r.jsx)(n.td,{children:"token, user, roles"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Connection"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-connection-store"})}),(0,r.jsx)(n.td,{children:"currentRouterId, preferences"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Theme"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-theme-store"})}),(0,r.jsx)(n.td,{children:"isDark, colorMode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sidebar"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-sidebar-store"})}),(0,r.jsx)(n.td,{children:"isCollapsed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"DHCP"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dhcp-ui-store"})}),(0,r.jsx)(n.td,{children:"wizardDraft, showPoolVisualization"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Service"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"service-ui-store"})}),(0,r.jsx)(n.td,{children:"wizardDraft, viewMode, showResourceMetrics"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Firewall Log"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"firewall-log-ui-store"})}),(0,r.jsx)(n.td,{children:"filters, autoRefresh, refreshInterval, sortBy, sortOrder"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Mangle"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mangle-ui-storage"})}),(0,r.jsx)(n.td,{children:"selectedChain, compactMode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"NAT"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nat-ui-storage"})}),(0,r.jsx)(n.td,{children:"selectedChain, compactMode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RAW"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"raw-ui-storage"})}),(0,r.jsx)(n.td,{children:"selectedChain, performanceSectionExpanded, compactMode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Port Knock"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"port-knock-ui-storage"})}),(0,r.jsx)(n.td,{children:"activeTab, compactMode, autoRefreshLog"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Rate Limiting"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-rate-limiting-ui"})}),(0,r.jsx)(n.td,{children:"selectedTab, showDisabledRules, actionFilter, statsPollingInterval"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Alerts"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"alert-notification-store"})}),(0,r.jsx)(n.td,{children:"settings only (notifications are memory-only)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Alert Templates"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"alert-rule-template-ui-storage"})}),(0,r.jsx)(n.td,{children:"viewMode only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Interface Stats"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nasnet-interface-stats-preferences"})}),(0,r.jsx)(n.td,{children:"pollingInterval"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"clear-specific-store",children:"Clear Specific Store"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Clear one store\nlocalStorage.removeItem('dhcp-ui-store');\n\n// Clear all stores\nObject.keys(localStorage)\n  .filter((key) => key.includes('store') || key.includes('storage'))\n  .forEach((key) => localStorage.removeItem(key));\n\n// Reload page to reset\nlocation.reload();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"inspect-persisted-data",children:"Inspect Persisted Data"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Pretty print store data\nfunction inspectStore(key) {\n  const data = JSON.parse(localStorage.getItem(key) || \'{}\');\n  console.log(`${key}:`, JSON.stringify(data, null, 2));\n}\n\n// Example\ninspectStore(\'dhcp-ui-store\');\n// Output:\n// {\n//   "state": {\n//     "wizardDraft": { ... },\n//     "showPoolVisualization": true\n//   },\n//   "version": 0\n// }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"restore-previous-state",children:"Restore Previous State"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Save current state before making changes\nconst backup = localStorage.getItem('my-store');\n\n// Make your changes...\n\n// Restore if needed\nif (backup) {\n  localStorage.setItem('my-store', backup);\n  location.reload();\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-issues--solutions",children:"Common Issues & Solutions"}),"\n",(0,r.jsx)(n.h3,{id:"store-not-updating-in-component",children:"Store Not Updating in Component"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Component doesn't re-render when store changes."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Use selector hooks, not whole store object."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u274c Won't re-render when other fields change\nconst { search, selectedIds } = useMyStore();\n\n// \u2705 Will only re-render when search changes\nconst search = useMyStore((state) => state.search);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debug:"})," Check DevTools to see if action fired."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Verify action was dispatched\nuseMyStore.subscribe((state) => {\n  console.log('Store updated:', state);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stale-state-from-getstate",children:"Stale State from getState()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," ",(0,r.jsx)(n.code,{children:"getState()"})," returns old state."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Don't cache state - call ",(0,r.jsx)(n.code,{children:"getState()"})," when needed."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u274c Wrong - captures state once\nconst initialState = useMyStore.getState();\nuseMyStore.subscribe(() => {\n  console.log(initialState); // Always the same!\n});\n\n// \u2705 Right - calls getState() each time\nuseMyStore.subscribe(() => {\n  console.log(useMyStore.getState()); // Current state\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"persistence-not-working",children:"Persistence Not Working"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," State not saved to localStorage."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Check ",(0,r.jsx)(n.code,{children:"partialize"})," function is correct."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u274c Missing partialize - nothing is persisted\nconst store = create((set) => ({ /* ... */ }));\n\n// \u2705 Correct - specifies what to persist\nconst store = create(\n  (set) => ({ /* ... */ }),\n  {\n    name: 'my-store',\n    partialize: (state) => ({\n      viewMode: state.viewMode,  // Persist only this\n    }),\n  }\n);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debug:"})," Check localStorage:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"console.log(localStorage.getItem('my-store'));\n// Should see persisted fields\n"})}),"\n",(0,r.jsx)(n.h3,{id:"machine-state-stuck",children:"Machine State Stuck"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Machine won't transition out of a state."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Check guards and conditions."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Debug machine state\nconst { state, context } = useMyWorkflow({ userId: 'user-1' });\n\n// Check what transitions are available\nif (state === 'step1') {\n  const canNext = context.step1Data?.length > 0;\n  console.log('Can go NEXT?', canNext);\n  console.log('Step 1 data:', context.step1Data);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"auth-token-expired",children:"Auth Token Expired"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Apollo requests fail with 401, but store not updated."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Error link should clear auth:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Verify error link is working\nuseAuthStore.subscribe(\n  (state) => state.isAuthenticated,\n  (isAuthenticated) => {\n    console.log('Auth status changed:', isAuthenticated);\n  }\n);\n\n// Check if 401 errors clear auth\nfetch('/api/protected')\n  .catch((error) => {\n    console.log('Auth cleared?', useAuthStore.getState().isAuthenticated);\n  });\n"})}),"\n",(0,r.jsx)(n.h3,{id:"memory-leaks",children:"Memory Leaks"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Event listeners/subscriptions accumulate."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Always unsubscribe in useEffect cleanup."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u274c Leak - no cleanup\nuseEffect(() => {\n  useMyStore.subscribe((state) => {\n    console.log('Store changed:', state);\n  });\n}, []);\n\n// \u2705 Correct - unsubscribe on cleanup\nuseEffect(() => {\n  const unsubscribe = useMyStore.subscribe((state) => {\n    console.log('Store changed:', state);\n  });\n  return () => unsubscribe();\n}, []);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debug:"})," Check if subscriptions accumulate:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Monitor store subscriber count (internal)\nlet subscriptionCount = 0;\nuseMyStore.subscribe(() => {\n  subscriptionCount++;\n  console.log('Total subscriptions:', subscriptionCount);\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"debug-console-utilities",children:"Debug Console Utilities"}),"\n",(0,r.jsx)(n.h3,{id:"create-debug-functions",children:"Create Debug Functions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Add to src/utils/debug.ts\n\nexport const storeDebug = {\n  // Show all stores\n  all: () => {\n    const stores = [\n      ['auth', useAuthStore],\n      ['connection', useConnectionStore],\n      ['dhcp', useDHCPUIStore],\n      ['service', useServiceUIStore],\n    ];\n\n    stores.forEach(([name, store]) => {\n      console.group(name);\n      console.log(store.getState());\n      console.groupEnd();\n    });\n  },\n\n  // Clear all stores\n  clear: () => {\n    Object.keys(localStorage)\n      .filter((key) => key.includes('store'))\n      .forEach((key) => localStorage.removeItem(key));\n    location.reload();\n  },\n\n  // Watch specific store\n  watch: (name, store) => {\n    store.subscribe((state) => {\n      console.log(`[${name}]`, state);\n    });\n  },\n\n  // Get store by name\n  get: (name) => {\n    const stores = {\n      auth: useAuthStore,\n      connection: useConnectionStore,\n      dhcp: useDHCPUIStore,\n    };\n    return stores[name]?.getState();\n  },\n};\n\n// Usage in console:\n// storeDebug.all()          - See all stores\n// storeDebug.get('auth')    - Get auth store\n// storeDebug.watch('dhcp', useDHCPUIStore)  - Watch changes\n// storeDebug.clear()        - Clear all\n"})}),"\n",(0,r.jsx)(n.h3,{id:"browser-console-integration",children:"Browser Console Integration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Make debug util available globally\nif (import.meta.env.DEV) {\n  (window as any).__debug = {\n    stores: {\n      auth: () => useAuthStore.getState(),\n      connection: () => useConnectionStore.getState(),\n      dhcp: () => useDHCPUIStore.getState(),\n    },\n    clearAll: () => {\n      Object.keys(localStorage)\n        .filter((k) => k.includes('store'))\n        .forEach((k) => localStorage.removeItem(k));\n      location.reload();\n    },\n  };\n}\n\n// In console:\n// __debug.stores.auth()\n// __debug.stores.connection()\n// __debug.clearAll()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-debugging",children:"Performance Debugging"}),"\n",(0,r.jsx)(n.h3,{id:"track-re-renders",children:"Track Re-renders"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Count component renders\nlet renderCount = 0;\n\nfunction MyComponent() {\n  renderCount++;\n  console.log(`MyComponent rendered ${renderCount} times`);\n\n  const { search } = useMyStore((state) => state.search);\n  return <div>{search}</div>;\n}\n\n// Check DevTools Performance tab to see if renders match state changes\n"})}),"\n",(0,r.jsx)(n.h3,{id:"monitor-store-updates",children:"Monitor Store Updates"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// See if store is updating too frequently\nuseMyStore.subscribe(\n  (state) => state.searchQuery,\n  (searchQuery) => {\n    console.log('Search updated:', searchQuery, new Date().getTime());\n  }\n);\n\n// Look for spam updates every millisecond (indicates bug)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key debugging techniques:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Redux DevTools"})," - Visual time travel debugging"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Console logs"})," - Simple debugging with ",(0,r.jsx)(n.code,{children:"getState()"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"localStorage"})," - Inspect persisted state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stately Visualizer"})," - Understand machine flows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscriptions"})," - Monitor state changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error logs"})," - Check auth/network errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dev utilities"})," - Custom debug functions"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Quick checklist when debugging:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Check Redux DevTools for action history"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Verify selector hooks (not whole store)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Inspect localStorage keys"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Log ",(0,r.jsx)(n.code,{children:"getState()"})," at problem point"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Check for unsubscribed listeners (memory leak)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Review ",(0,r.jsx)(n.code,{children:"partialize"})," for persistence"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Check guards in XState machines"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Verify error link updates stores"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.code,{children:"storeDebug.all()"})," in console to explore"]}),"\n",(0,r.jsx)(n.li,{children:"Open Redux DevTools to watch state changes"}),"\n",(0,r.jsx)(n.li,{children:"Check browser DevTools \u2192 Application \u2192 localStorage"}),"\n",(0,r.jsxs)(n.li,{children:["Refer to ",(0,r.jsx)(n.a,{href:"/docs/state/guides/quickstart",children:"Quickstart"})," for store patterns"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},71184:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var t=s(14041);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
"use strict";(globalThis.webpackChunk_nas_net_docs=globalThis.webpackChunk_nas_net_docs||[]).push([[44037],{71184:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(14041);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},72146:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"multi-package-flows","title":"Multi-Package Flows","description":"This document traces eight significant runtime flows through the libs/ui/ library system. Each","source":"@site/../../libs/ui/docs/multi-package-flows.md","sourceDirName":".","slug":"/multi-package-flows","permalink":"/docs/ui/multi-package-flows","draft":false,"unlisted":false,"editUrl":"https://github.com/nasnet-community/nasnet-panel/tree/main/../../libs/ui/docs/multi-package-flows.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"Multi-Package Flows"},"sidebar":"sidebar","previous":{"title":"Quick Start","permalink":"/docs/ui/quick-start"},"next":{"title":"Testing & Accessibility","permalink":"/docs/ui/testing-and-accessibility"}}');var r=t(31085),i=t(71184);const o={sidebar_position:10,title:"Multi-Package Flows"},a="Multi-Package Flows \u2014 End-to-End Code Traces",l={},d=[{value:"Package Abbreviations Used in Annotations",id:"package-abbreviations-used-in-annotations",level:2},{value:"Flow 1: Responsive Page with Platform-Specific Layouts",id:"flow-1-responsive-page-with-platform-specific-layouts",level:2},{value:"Stage 1 \u2014 Viewport observation",id:"stage-1--viewport-observation",level:3},{value:"Stage 2 \u2014 Shell selection",id:"stage-2--shell-selection",level:3},{value:"Stage 3 \u2014 Sidebar state (app layer wires Zustand)",id:"stage-3--sidebar-state-app-layer-wires-zustand",level:3},{value:"Stage 4 \u2014 Components inside the page auto-select presenters",id:"stage-4--components-inside-the-page-auto-select-presenters",level:3},{value:"Complete component tree (annotated)",id:"complete-component-tree-annotated",level:3},{value:"Flow 2: Configuration Apply Pipeline",id:"flow-2-configuration-apply-pipeline",level:2},{value:"Stage 1 \u2014 ValidationProgress gates the apply",id:"stage-1--validationprogress-gates-the-apply",level:3},{value:"Stage 2 \u2014 Progress bar animation",id:"stage-2--progress-bar-animation",level:3},{value:"Stage 3 \u2014 Conflict display",id:"stage-3--conflict-display",level:3},{value:"Stage 4 \u2014 Apply button with loading state",id:"stage-4--apply-button-with-loading-state",level:3},{value:"Complete data flow",id:"complete-data-flow",level:3},{value:"Flow 3: Sortable Firewall Rules",id:"flow-3-sortable-firewall-rules",level:2},{value:"Stage 1 \u2014 Entry component delegates to platform presenter",id:"stage-1--entry-component-delegates-to-platform-presenter",level:3},{value:"Stage 2 \u2014 SortableList wraps dnd-kit",id:"stage-2--sortablelist-wraps-dnd-kit",level:3},{value:"Stage 3 \u2014 useSortableList manages order state",id:"stage-3--usesortablelist-manages-order-state",level:3},{value:"Stage 4 \u2014 Animation via tokens",id:"stage-4--animation-via-tokens",level:3},{value:"Stage 5 \u2014 Accessibility announcements",id:"stage-5--accessibility-announcements",level:3},{value:"Complete component tree",id:"complete-component-tree",level:3},{value:"Flow 4: Token Build Pipeline",id:"flow-4-token-build-pipeline",level:2},{value:"Stage 1 \u2014 Source definition in tokens.json",id:"stage-1--source-definition-in-tokensjson",level:3},{value:"Stage 2 \u2014 build.js generates CSS variables",id:"stage-2--buildjs-generates-css-variables",level:3},{value:"Stage 3 \u2014 TypeScript exports (animation tokens)",id:"stage-3--typescript-exports-animation-tokens",level:3},{value:"Stage 4 \u2014 CSS variable loaded at app entry",id:"stage-4--css-variable-loaded-at-app-entry",level:3},{value:"Stage 5 \u2014 Tailwind maps CSS variables to utility classes",id:"stage-5--tailwind-maps-css-variables-to-utility-classes",level:3},{value:"Stage 6 \u2014 Component uses semantic token",id:"stage-6--component-uses-semantic-token",level:3},{value:"Complete chain for one token (primary color)",id:"complete-chain-for-one-token-primary-color",level:3},{value:"Flow 5: Animation Pipeline",id:"flow-5-animation-pipeline",level:2},{value:"Stage 1 \u2014 Token values set the timing budget",id:"stage-1--token-values-set-the-timing-budget",level:3},{value:"Stage 2 \u2014 Presets wire tokens to Framer Motion variants",id:"stage-2--presets-wire-tokens-to-framer-motion-variants",level:3},{value:"Stage 3 \u2014 AnimationProvider supplies context",id:"stage-3--animationprovider-supplies-context",level:3},{value:"Stage 4 \u2014 PageTransition wraps route content",id:"stage-4--pagetransition-wraps-route-content",level:3},{value:"Stage 5 \u2014 useReducedMotion provides accessibility opt-out",id:"stage-5--usereducedmotion-provides-accessibility-opt-out",level:3},{value:"Complete animation chain",id:"complete-animation-chain",level:3},{value:"Flow 6: CategoryAccent Contextual Theming",id:"flow-6-categoryaccent-contextual-theming",level:2},{value:"Stage 1 \u2014 Provider injects context",id:"stage-1--provider-injects-context",level:3},{value:"Stage 2 \u2014 Child component reads the accent",id:"stage-2--child-component-reads-the-accent",level:3},{value:"Stage 3 \u2014 CSS variables resolve the actual color",id:"stage-3--css-variables-resolve-the-actual-color",level:3},{value:"Stage 4 \u2014 Dynamic category switching",id:"stage-4--dynamic-category-switching",level:3},{value:"Complete accent chain",id:"complete-accent-chain",level:3},{value:"Flow 7: Help System with Simple/Technical Mode",id:"flow-7-help-system-with-simpletechnical-mode",level:2},{value:"Stage 1 \u2014 Global mode state lives in Zustand",id:"stage-1--global-mode-state-lives-in-zustand",level:3},{value:"Stage 2 \u2014 useHelpMode wraps the store for pattern components",id:"stage-2--usehelpmode-wraps-the-store-for-pattern-components",level:3},{value:"Stage 3 \u2014 useFieldHelp loads i18n content",id:"stage-3--usefieldhelp-loads-i18n-content",level:3},{value:"Stage 4 \u2014 FieldHelp selects presenter",id:"stage-4--fieldhelp-selects-presenter",level:3},{value:"Stage 5 \u2014 Platform presenters render different UI",id:"stage-5--platform-presenters-render-different-ui",level:3},{value:"Stage 6 \u2014 HelpModeToggle is placed in app header",id:"stage-6--helpmodetoggle-is-placed-in-app-header",level:3},{value:"Complete data flow",id:"complete-data-flow-1",level:3},{value:"Flow 8: Clipboard Pipeline",id:"flow-8-clipboard-pipeline",level:2},{value:"Stage 1 \u2014 useClipboard provides the primitive copy operation",id:"stage-1--useclipboard-provides-the-primitive-copy-operation",level:3},{value:"Stage 2 \u2014 useBulkCopy wraps useClipboard with format selection",id:"stage-2--usebulkcopy-wraps-useclipboard-with-format-selection",level:3},{value:"Stage 3 \u2014 Feature-layer usage with CopyButton",id:"stage-3--feature-layer-usage-with-copybutton",level:3},{value:"Stage 4 \u2014 usePasteImport handles the receiving end",id:"stage-4--usepasteimport-handles-the-receiving-end",level:3},{value:"Stage 5 \u2014 usePasteImport auto-detects format",id:"stage-5--usepasteimport-auto-detects-format",level:3},{value:"Complete clipboard pipeline",id:"complete-clipboard-pipeline",level:3},{value:"Summary Table",id:"summary-table",level:2},{value:"Dependency Direction Recap",id:"dependency-direction-recap",level:2},{value:"Further Reading",id:"further-reading",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"multi-package-flows--end-to-end-code-traces",children:"Multi-Package Flows \u2014 End-to-End Code Traces"})}),"\n",(0,r.jsxs)(n.p,{children:["This document traces eight significant runtime flows through the ",(0,r.jsx)(n.code,{children:"libs/ui/"})," library system. Each\nflow starts at the entry point a feature developer touches, crosses multiple packages, and ends at a\nrendered pixel or a side-effect. Package boundaries are annotated inline."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why this document exists:"})," The other documents in this series describe individual packages or\ncomponent catalogs. This one stitches everything together so you can read one page and understand\n",(0,r.jsx)(n.em,{children:"exactly"})," what executes when a user resizes a browser, applies a configuration, drags a firewall\nrule, or pastes an IP list."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prerequisites:"})," Read ",(0,r.jsx)(n.a,{href:"/docs/ui/intro",children:"intro.md"})," and ",(0,r.jsx)(n.a,{href:"/docs/ui/quick-start",children:"quick-start.md"})," first.\nThe three-layer dependency hierarchy is assumed knowledge throughout."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"package-abbreviations-used-in-annotations",children:"Package Abbreviations Used in Annotations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Annotation"}),(0,r.jsx)(n.th,{children:"Package"}),(0,r.jsx)(n.th,{children:"Import alias"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[layouts]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/layouts"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/ui/layouts"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[patterns]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/patterns"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/ui/patterns"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[primitives]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/primitives"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/ui/primitives"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[tokens]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/ui/tokens"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/ui/tokens"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[state]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/state/stores"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/state/stores"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[features]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"libs/features/*"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@nasnet/features/*"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[app]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"apps/connect/src"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@/"})})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-1-responsive-page-with-platform-specific-layouts",children:"Flow 1: Responsive Page with Platform-Specific Layouts"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," ",(0,r.jsx)(n.code,{children:"apps/connect/src/app/providers/index.tsx"})," mounts ",(0,r.jsx)(n.code,{children:"ResponsiveShell"}),".\n",(0,r.jsx)(n.strong,{children:"End state:"})," The correct shell (mobile or desktop) is mounted, the sidebar toggle works via\nkeyboard, and pattern components inside the page automatically choose their platform presenters."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--viewport-observation",children:"Stage 1 \u2014 Viewport observation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ResponsiveShell"})," [layouts] calls ",(0,r.jsx)(n.code,{children:"usePlatform()"})," [layouts]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/layouts/src/responsive-shell/usePlatform.ts\nimport { useMemo } from 'react';\nimport { useBreakpoint, type Breakpoint, BREAKPOINTS } from './useBreakpoint';\n\nexport type Platform = 'mobile' | 'tablet' | 'desktop';\n\nexport function usePlatform(debounceMs = 100): Platform {\n  const breakpoint = useBreakpoint(debounceMs); // [layouts] \u2014 ResizeObserver on documentElement\n  return useMemo(() => breakpointToPlatform(breakpoint), [breakpoint]);\n}\n\n// Mapping: xs\u2192mobile  sm,md\u2192tablet  lg,xl\u2192desktop\nfunction breakpointToPlatform(breakpoint: Breakpoint): Platform {\n  switch (breakpoint) {\n    case 'xs':  return 'mobile';\n    case 'sm':\n    case 'md':  return 'tablet';\n    case 'lg':\n    case 'xl':  return 'desktop';\n    default:    return 'desktop';\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useBreakpoint"})," [layouts] attaches a ",(0,r.jsx)(n.code,{children:"ResizeObserver"})," to ",(0,r.jsx)(n.code,{children:"document.documentElement"})," and returns\n",(0,r.jsx)(n.code,{children:"'xs' | 'sm' | 'md' | 'lg' | 'xl'"}),". Updates are debounced (default 100 ms). SSR defaults to\n",(0,r.jsx)(n.code,{children:"1024px"})," (desktop) so there is no server-side layout shift."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--shell-selection",children:"Stage 2 \u2014 Shell selection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ResponsiveShell"})," [layouts] branches on the platform value and delegates to different shells:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/layouts/src/responsive-shell/ResponsiveShell.tsx\nimport { AppShell }       from '../app-shell';         // [layouts]\nimport { MobileAppShell } from '../mobile-app-shell';  // [layouts]\nimport { usePlatform }    from './usePlatform';         // [layouts]\n\nexport const ResponsiveShell = React.memo(React.forwardRef<HTMLDivElement, ResponsiveShellProps>(\n  ({ children, sidebar, header, mobileHeaderProps, mobileNavigationProps,\n     sidebarCollapsed = false, onSidebarToggle, forcePlatform, className }, ref) => {\n\n    const detectedPlatform = usePlatform();          // [layouts]\n    const platform = forcePlatform ?? detectedPlatform;\n    const prefersReducedMotion = useReducedMotion(); // [layouts]\n\n    // Keyboard shortcut: Cmd+B / Ctrl+B to collapse sidebar\n    React.useEffect(() => {\n      if (platform === 'mobile' || !onSidebarToggle) return;\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if ((event.metaKey || event.ctrlKey) && event.key === 'b') {\n          event.preventDefault();\n          onSidebarToggle();  // [state] \u2014 calls useSidebarStore.toggle()\n        }\n      };\n      window.addEventListener('keydown', handleKeyDown);\n      return () => window.removeEventListener('keydown', handleKeyDown);\n    }, [platform, onSidebarToggle]);\n\n    if (platform === 'mobile') {\n      return (\n        <MobileAppShell    // [layouts] \u2014 bottom navigation + stacked layout\n          ref={ref}\n          header={mobileHeaderProps}\n          navigation={mobileNavigationProps}\n        >\n          {children}\n        </MobileAppShell>\n      );\n    }\n\n    // tablet or desktop \u2192 AppShell with collapsible sidebar\n    const effectiveCollapsed = platform === 'tablet' ? false : sidebarCollapsed;\n    return (\n      <div className=\"bg-background min-h-screen\">\n        <AppShell       // [layouts] \u2014 fixed sidebar + header layout\n          ref={ref}\n          header={header}\n          sidebar={enhancedSidebar}\n          sidebarCollapsed={effectiveCollapsed}\n          className={className}\n        >\n          {children}\n        </AppShell>\n      </div>\n    );\n  }\n));\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--sidebar-state-app-layer-wires-zustand",children:"Stage 3 \u2014 Sidebar state (app layer wires Zustand)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ResponsiveShell"})," cannot import from ",(0,r.jsx)(n.code,{children:"@nasnet/state/stores"})," (library dependency rule). The app\nlayer injects sidebar state via props:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// apps/connect/src/app/providers/index.tsx\nimport { ResponsiveShell } from '@nasnet/ui/layouts';         // [layouts]\nimport { useSidebarStore }  from '@nasnet/state/stores';       // [state]\n\nfunction AppProviders({ children }: { children: React.ReactNode }) {\n  const { desktopCollapsed, toggle } = useSidebarStore();      // [state] \u2014 Zustand store\n\n  return (\n    <ResponsiveShell                                           // [layouts]\n      sidebar={<NavigationSidebar />}\n      header={<AppHeader />}\n      sidebarCollapsed={desktopCollapsed}  // injected from [state]\n      onSidebarToggle={toggle}             // injected from [state]\n      mobileNavigationProps={{ activeId: 'home', items: NAV_ITEMS }}\n    >\n      {children}\n    </ResponsiveShell>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--components-inside-the-page-auto-select-presenters",children:"Stage 4 \u2014 Components inside the page auto-select presenters"}),"\n",(0,r.jsxs)(n.p,{children:["Any pattern component rendered as ",(0,r.jsx)(n.code,{children:"children"})," calls ",(0,r.jsx)(n.code,{children:"usePlatform()"})," independently:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// From libs/ui/patterns/src/sortable/domain/FirewallRuleList.tsx\nimport { usePlatform } from '@nasnet/ui/layouts'; // [layouts]\n\nexport const FirewallRuleList: React.FC<FirewallRuleListProps> = ({ rules, onReorder }) => {\n  const platform = usePlatform?.() ?? 'desktop';  // [layouts]\n\n  if (platform === 'desktop') {\n    return <SortableListDesktop items={rules} onReorder={onReorder} ... />;\n  }\n  return <SortableListMobile items={rules} onReorder={onReorder} ... />;\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["No prop-drilling is needed. Each component calls ",(0,r.jsx)(n.code,{children:"usePlatform"})," directly and the 100 ms debounce\nensures all components observe the same viewport width on a given frame."]}),"\n",(0,r.jsx)(n.h3,{id:"complete-component-tree-annotated",children:"Complete component tree (annotated)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"<AppProviders>                              [app]\n  \u2514\u2500\u2500 useSidebarStore()                     [state] \u2014 Zustand sidebar collapse state\n  \u2514\u2500\u2500 <ResponsiveShell                      [layouts]\n        sidebarCollapsed={...}              injected from [state]\n        onSidebarToggle={toggle}>           injected from [state]\n      \u2514\u2500\u2500 usePlatform()                     [layouts] \u2014 ResizeObserver \u2192 Breakpoint \u2192 Platform\n      \u2514\u2500\u2500 if mobile \u2192 <MobileAppShell>      [layouts]\n              \u2514\u2500\u2500 <BottomNavigation>        [layouts]\n          if desktop \u2192 <AppShell>           [layouts]\n              \u2514\u2500\u2500 <CollapsibleSidebar>      [layouts]\n      \u2514\u2500\u2500 <VPNPage>                         [features/vpn] \u2014 page content\n          \u2514\u2500\u2500 <WireGuardCard>               [patterns]\n              \u2514\u2500\u2500 usePlatform()             [layouts] \u2014 independent check\n              \u2514\u2500\u2500 if mobile \u2192 compact card view\n              \u2514\u2500\u2500 if desktop \u2192 dense table row\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"layouts"}),", ",(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"state/stores"})," (via app injection)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/layouts-and-platform",children:"layouts-and-platform.md"})," for full ",(0,r.jsx)(n.code,{children:"usePlatform"})," API,\n",(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks#platform-hooks",children:"shared-hooks.md"})," for the complete hook table."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-2-configuration-apply-pipeline",children:"Flow 2: Configuration Apply Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"}),' User clicks "Apply" on a configuration form.\n',(0,r.jsx)(n.strong,{children:"End state:"})," Changes are applied to the router, a 10-second undo window is shown, and the\nChangeSet is confirmed or rolled back."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--validationprogress-gates-the-apply",children:"Stage 1 \u2014 ValidationProgress gates the apply"}),"\n",(0,r.jsxs)(n.p,{children:["Before ",(0,r.jsx)(n.code,{children:"Apply"})," becomes clickable, ",(0,r.jsx)(n.code,{children:"ValidationProgress"})," [patterns] must reach ",(0,r.jsx)(n.code,{children:"isValid === true"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// Feature-layer usage (libs/features/*/src/components/ConfigApplyPanel.tsx)\nimport {\n  ValidationProgress,\n  useValidationProgress,\n} from '@nasnet/ui/patterns';                    // [patterns]\n\nfunction ConfigApplyPanel({ changeset }) {\n  const {\n    stages,\n    currentStageIndex,\n    isComplete,\n    isValid,\n    startStage,       // call to move a stage to 'running'\n    completeStage,    // call with ValidationStageResult to mark passed/failed\n    finish,           // call when all 7 stages are done\n    reset,\n  } = useValidationProgress();               // [patterns] \u2014 hook manages stage state\n\n  // Drive the pipeline from GraphQL subscription events\n  useEffect(() => {\n    if (!changeset) return;\n    // ...subscribe to validation events and call startStage/completeStage/finish\n  }, [changeset]);\n\n  return (\n    <ValidationProgress   // [patterns]\n      stages={stages}\n      currentStage={currentStageIndex}\n      isComplete={isComplete}\n      isValid={isValid}\n      autoExpandFailed    // auto-expands failed stages\n    />\n  );\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The seven canonical stages (defined in ",(0,r.jsx)(n.code,{children:"ValidationProgress.tsx"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/validation-progress/ValidationProgress.tsx\nconst STAGE_ORDER: ValidationStageName[] = [\n  'schema',\n  'syntax',\n  'cross-resource',\n  'dependencies',\n  'network',\n  'platform',\n  'dry-run',\n];\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Each stage emits ",(0,r.jsx)(n.code,{children:"'pending' | 'running' | 'passed' | 'failed' | 'skipped'"})," status.\n",(0,r.jsx)(n.code,{children:"useValidationProgress"})," [patterns] tracks these states locally; the caller drives state transitions\nby invoking ",(0,r.jsx)(n.code,{children:"startStage"})," and ",(0,r.jsx)(n.code,{children:"completeStage"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--progress-bar-animation",children:"Stage 2 \u2014 Progress bar animation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ValidationProgress"})," [patterns] uses Framer Motion for the animated progress bar. It consumes\ntoken values directly from ",(0,r.jsx)(n.code,{children:"@nasnet/ui/tokens"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/validation-progress/ValidationProgress.tsx\nimport { motion } from 'framer-motion';  // from @nasnet/ui/patterns/motion re-export\n\n// Animated progress bar\n<motion.div\n  className={cn(\n    'h-full rounded-full transition-colors',\n    summary.failed > 0 ? 'bg-error' :\n    isComplete        ? 'bg-success' :\n                        'bg-primary'    // Tailwind \u2192 CSS var --color-primary (Tier 2 token)\n  )}\n  initial={{ width: 0 }}\n  animate={{ width: `${((passed + failed + skipped) / stages.length) * 100}%` }}\n  transition={{ duration: 0.3, ease: 'easeOut' }}  // inline \u2014 short interactions don't need token\n/>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--conflict-display",children:"Stage 3 \u2014 Conflict display"}),"\n",(0,r.jsxs)(n.p,{children:["When ",(0,r.jsx)(n.code,{children:"cross-resource"})," stage fails, ",(0,r.jsx)(n.code,{children:"ConflictList"})," [patterns] renders the conflicts:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { ConflictList, ConflictCard } from '@nasnet/ui/patterns'; // [patterns]\nimport type { ResourceConflict }       from '@nasnet/ui/patterns'; // [patterns]\n\n// Feature-layer conflict display\n<ConflictList\n  conflicts={validationResult.conflicts}\n  onResolve={(conflict, resolution) => applyResolution(conflict, resolution)}\n/>\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ConflictCard"})," [patterns] is built on ",(0,r.jsx)(n.code,{children:"Card"})," [primitives] and uses ",(0,r.jsx)(n.code,{children:"StatusBadge"})," [patterns] to\nshow severity (",(0,r.jsx)(n.code,{children:"warning"})," / ",(0,r.jsx)(n.code,{children:"error"}),")."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--apply-button-with-loading-state",children:"Stage 4 \u2014 Apply button with loading state"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'import { Button } from \'@nasnet/ui/primitives\';   // [primitives]\n\n<Button\n  variant="default"\n  isLoading={isApplying}\n  loadingText="Applying..."\n  disabled={!isValid || isApplying}\n  onClick={handleApply}\n>\n  Apply Configuration\n</Button>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Button"})," [primitives] sets ",(0,r.jsx)(n.code,{children:'aria-busy="true"'})," and renders a ",(0,r.jsx)(n.code,{children:"Spinner"})," [primitives] during the\nloading state."]}),"\n",(0,r.jsx)(n.h3,{id:"complete-data-flow",children:"Complete data flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'useValidationProgress()           [patterns] \u2014 stage state machine\n  \u2193 startStage(\'schema\')\nValidationProgress                [patterns] \u2014 renders 7 ValidationStage rows\n  \u2514\u2500\u2500 motion.div progress bar     Framer Motion + bg-primary token (Tier 2)\n  \u2514\u2500\u2500 ValidationStage \xd7 7         [patterns] \u2014 expandable rows with error lists\n      \u2514\u2500\u2500 StatusIndicator         [patterns] \u2014 status dot per stage\nConflictList                      [patterns] \u2014 shown when cross-resource fails\n  \u2514\u2500\u2500 ConflictCard \xd7 N            [patterns] \u2014 each conflict\n      \u2514\u2500\u2500 Card                    [primitives]\n      \u2514\u2500\u2500 StatusBadge             [patterns]\nButton "Apply"                    [primitives]\n  \u2514\u2500\u2500 isLoading \u2192 Spinner         [primitives]\n      aria-busy="true"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"tokens"})," (Framer Motion transition values)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-forms-and-inputs",children:"patterns-forms-and-inputs.md"})," for\n",(0,r.jsx)(n.code,{children:"ValidationProgress"})," props, ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-status-and-data",children:"patterns-status-and-data.md"})," for\n",(0,r.jsx)(n.code,{children:"StatusBadge"})," and ",(0,r.jsx)(n.code,{children:"StatusIndicator"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-3-sortable-firewall-rules",children:"Flow 3: Sortable Firewall Rules"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," ",(0,r.jsx)(n.code,{children:"FirewallRuleList"})," [patterns] is rendered in the firewall page.\n",(0,r.jsx)(n.strong,{children:"End state:"})," User drags a rule to a new position (or uses keyboard/mobile buttons); the new order\nis persisted, an animated reorder plays, and screen readers hear an announcement."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--entry-component-delegates-to-platform-presenter",children:"Stage 1 \u2014 Entry component delegates to platform presenter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/sortable/domain/FirewallRuleList.tsx\nimport { usePlatform }        from '@nasnet/ui/layouts';   // [layouts]\nimport { cn, Badge }          from '@nasnet/ui/primitives'; // [primitives]\nimport { SortableListDesktop } from '../components/SortableListDesktop';\nimport { SortableListMobile }  from '../components/SortableListMobile';\nimport type { FirewallRule, SortableItemData, ReorderEvent } from '../types';\n\nexport const FirewallRuleList: React.FC<FirewallRuleListProps> = ({\n  rules, onReorder, onDelete, onEdit,\n}) => {\n  const platform = usePlatform?.() ?? 'desktop'; // [layouts]\n\n  if (platform === 'desktop') {\n    return (\n      <SortableListDesktop<FirewallRule>   // drag-and-drop variant\n        items={rules}\n        onReorder={onReorder}\n        renderItem={renderItem}\n        showContextMenu={true}\n        showRowNumbers={true}\n        multiSelect={true}\n        aria-label=\"Firewall rules list\"\n      />\n    );\n  }\n\n  return (\n    <SortableListMobile<FirewallRule>      // up/down button variant (no drag)\n      items={rules}\n      onReorder={onReorder}\n      renderItem={renderItem}\n      onMoveItem={handleMoveItem}\n      showMoveButtons={true}\n      aria-label=\"Firewall rules list\"\n    />\n  );\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--sortablelist-wraps-dnd-kit",children:"Stage 2 \u2014 SortableList wraps dnd-kit"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SortableList"})," [patterns] (the generic component used by ",(0,r.jsx)(n.code,{children:"SortableListDesktop"}),") wires dnd-kit:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/sortable/components/SortableList.tsx\nimport {\n  DndContext, DragOverlay, closestCenter,\n  type DragStartEvent, type DragEndEvent,\n} from '@dnd-kit/core';\nimport { restrictToVerticalAxis }  from '@dnd-kit/modifiers';\nimport {\n  SortableContext as DndSortableContext,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { motion, AnimatePresence, LayoutGroup } from 'framer-motion';\nimport { cn }   from '@nasnet/ui/primitives';  // [primitives]\nimport { useSortableList } from '../hooks/useSortableList';\n\nfunction SortableListComponent<T extends SortableItemData>({\n  items: externalItems,\n  onReorder,\n  renderItem,\n  collisionStrategy = 'closestCenter',\n  multiSelect = false,\n}: SortableListProps<T>) {\n\n  const sortable = useSortableList(externalItems, {\n    onReorder,\n    collisionStrategy,\n    multiSelect,\n    undoEnabled: true,   // undo/redo stack built in\n  });\n\n  const sensors = useSortableSensors({\n    touchEnabled: true,\n    keyboardEnabled: true,  // keyboard arrow keys for a11y\n  });\n\n  return (\n    <SortableContext.Provider value={contextValue}>\n      <DndContext\n        sensors={sensors}\n        collisionDetection={getCollisionDetection(collisionStrategy)}\n        onDragStart={_handlers.onDragStart}\n        onDragEnd={_handlers.onDragEnd}\n        modifiers={[restrictToVerticalAxis]}\n        accessibility={{ announcements }}         // screen reader announcements\n      >\n        <DndSortableContext\n          items={items.map((item) => item.id)}\n          strategy={verticalListSortingStrategy}\n        >\n          <LayoutGroup>\n            <motion.div className={cn('flex flex-col gap-2')}>\n              <AnimatePresence mode=\"popLayout\">\n                {items.map((item, index) => (\n                  <SortableItem key={item.id} id={item.id}>\n                    {renderItem(item, createRenderOptions(item, index))}\n                  </SortableItem>\n                ))}\n              </AnimatePresence>\n            </motion.div>\n          </LayoutGroup>\n        </DndSortableContext>\n\n        <DragOverlay>\n          {activeId && activeItem && (\n            <motion.div\n              initial={dragOverlayAnimation.initial}\n              animate={dragOverlayAnimation.dragging}\n            >\n              {renderItem(activeItem, createRenderOptions(activeItem, ...))}\n            </motion.div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    </SortableContext.Provider>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--usesortablelist-manages-order-state",children:"Stage 3 \u2014 useSortableList manages order state"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/sortable/hooks/useSortableList.ts\n// Key parts of the return type (from types.ts):\nexport interface UseSortableListReturn<T extends SortableItemData> {\n  items: T[];\n  activeId: UniqueIdentifier | null;\n  isDragging: boolean;\n  selectedIds: Set<UniqueIdentifier>;\n  // Multi-select helpers\n  isSelected: (id: UniqueIdentifier) => boolean;\n  toggleSelection: (id: UniqueIdentifier) => void;\n  selectRange: (fromId: UniqueIdentifier, toId: UniqueIdentifier) => void;\n  selectAll: () => void;\n  clearSelection: () => void;\n  // Keyboard movement (used by mobile and keyboard a11y)\n  moveUp: (id: UniqueIdentifier) => void;\n  moveDown: (id: UniqueIdentifier) => void;\n  moveToTop: (id: UniqueIdentifier) => void;\n  moveToBottom: (id: UniqueIdentifier) => void;\n  // Undo/redo\n  undo: () => void;\n  redo: () => void;\n  canUndo: boolean;\n  canRedo: boolean;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--animation-via-tokens",children:"Stage 4 \u2014 Animation via tokens"}),"\n",(0,r.jsxs)(n.p,{children:["Reorder animation uses token-backed Framer Motion variants from ",(0,r.jsx)(n.code,{children:"presets.ts"})," [patterns]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/motion/presets.ts\nimport { transitions } from '@nasnet/ui/tokens'; // [tokens]\n\nexport const listItem: Variants = {\n  initial: { opacity: 0, y: 10 },\n  animate: {\n    opacity: 1,\n    y: 0,\n    transition: moveTransition,  // transitions.move from [tokens]\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    transition: exitTransition,  // transitions.exit from [tokens]\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'AnimatePresence mode="popLayout"'})," in ",(0,r.jsx)(n.code,{children:"SortableList"})," triggers ",(0,r.jsx)(n.code,{children:"listItem.exit"})," on removed items and\n",(0,r.jsx)(n.code,{children:"listItem.animate"})," on new/moved items, creating the smooth reorder animation."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-5--accessibility-announcements",children:"Stage 5 \u2014 Accessibility announcements"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SortableList"})," passes a ",(0,r.jsx)(n.code,{children:"defaultAnnouncements"})," object to ",(0,r.jsx)(n.code,{children:"DndContext.accessibility.announcements"}),".\nScreen readers hear, for example: ",(0,r.jsx)(n.em,{children:'"Picked up Drop rule 3 in position 1 of 12. Rule is now in\nposition 3 of 12. Dropped rule 3."'})]}),"\n",(0,r.jsx)(n.h3,{id:"complete-component-tree",children:"Complete component tree"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'<FirewallRuleList>                    [patterns] \u2014 domain component\n  \u2514\u2500\u2500 usePlatform()                   [layouts]\n  \u2514\u2500\u2500 desktop \u2192 <SortableListDesktop> [patterns]\n      \u2514\u2500\u2500 <SortableList>              [patterns]\n          \u2514\u2500\u2500 useSortableList()       [patterns] \u2014 order state + undo/redo\n          \u2514\u2500\u2500 useSortableSensors()    [patterns] \u2014 mouse/touch/keyboard sensors\n          \u2514\u2500\u2500 <DndContext>            @dnd-kit/core\n              \u2514\u2500\u2500 <DndSortableContext>\n                  \u2514\u2500\u2500 <LayoutGroup>  framer-motion\n                      \u2514\u2500\u2500 <AnimatePresence mode="popLayout">\n                          \u2514\u2500\u2500 <SortableItem> \xd7 N   [patterns]\n                              \u2514\u2500\u2500 <DragHandle>     [patterns]\n                              \u2514\u2500\u2500 renderItem(rule) \u2192 <FirewallRuleItem>\n                                  \u2514\u2500\u2500 <Badge>      [primitives]\n          \u2514\u2500\u2500 <DragOverlay>          @dnd-kit/core \u2014 preview while dragging\n  \u2514\u2500\u2500 mobile \u2192 <SortableListMobile>  [patterns]\n      \u2514\u2500\u2500 Up/Down buttons            [primitives] Button\n      \u2514\u2500\u2500 useSortableList.moveUp/Down [patterns]\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"layouts"})," (via ",(0,r.jsx)(n.code,{children:"usePlatform"}),"), ",(0,r.jsx)(n.code,{children:"tokens"}),"\n(animation values)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks",children:"shared-hooks.md"})," for ",(0,r.jsx)(n.code,{children:"useSortableList"})," return type,\n",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"tokens-and-animation.md"})," for animation token values."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-4-token-build-pipeline",children:"Flow 4: Token Build Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," Developer defines a new token in ",(0,r.jsx)(n.code,{children:"libs/ui/tokens/src/tokens.json"}),".\n",(0,r.jsx)(n.strong,{children:"End state:"})," A Tailwind utility class ",(0,r.jsx)(n.code,{children:"bg-primary"})," on a component renders as ",(0,r.jsx)(n.code,{children:"#EFC729"})," (Golden\nAmber) in light mode and a different value in dark mode."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--source-definition-in-tokensjson",children:"Stage 1 \u2014 Source definition in tokens.json"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// libs/ui/tokens/src/tokens.json (excerpt \u2014 showing the primary chain)\n{\n  "primitive": {\n    "color": {\n      "brand": {\n        "amber": {\n          "500": { "$value": "#EFC729" }\n        }\n      }\n    }\n  },\n  "semantic": {\n    "color": {\n      "primary": {\n        "DEFAULT": "{primitive.color.brand.amber.500}",\n        "hover":   "{primitive.color.brand.amber.600}",\n        "active":  "{primitive.color.brand.amber.700}",\n        "foreground": "{primitive.color.neutral.slate.900}"\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"{...}"})," syntax is a design token reference resolved by the build script."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--buildjs-generates-css-variables",children:"Stage 2 \u2014 build.js generates CSS variables"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"libs/ui/tokens/build.js"})," runs as a Node.js script:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// libs/ui/tokens/build.js (relevant excerpt)\nconst SOURCE_PATH = resolve(__dirname, 'src/tokens.json');\n\nasync function buildTokens() {\n  const tokens = JSON.parse(readFileSync(SOURCE_PATH, 'utf-8'));\n\n  // 1. Resolve token references ({primitive.x.y} \u2192 actual values)\n  const resolveReferences = (obj, root = tokens) => {\n    // Walks the tree; when it sees a \"{...}\" string it dereferences into root\n    // ...\n  };\n\n  const lightTokens = {\n    ...resolveReferences(tokens.primitive, tokens),\n    semantic:  resolveReferences(tokens.semantic, tokens),\n    component: resolveReferences(tokens.component, tokens),\n  };\n\n  // 2. Merge dark overrides\n  const darkOverrides = resolveReferences(tokens.dark, tokens);\n  const darkTokens = {\n    ...lightTokens,\n    semantic: { ...lightTokens.semantic, color: { ...lightTokens.semantic?.color, ...darkOverrides.semantic?.color } },\n  };\n\n  // 3. Emit dist/variables.css with :root { --color-primary: #EFC729; }\n  //    and .dark { --color-primary: <dark value>; }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Output file ",(0,r.jsx)(n.code,{children:"dist/variables.css"})," contains:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-css",children:":root {\n  --color-primary: #EFC729;\n  --color-primary-hover: #d4aa1a;\n  --color-primary-foreground: #0f172a;\n  /* ... ~200 more variables */\n}\n\n.dark {\n  --color-primary: #EFC729;   /* same in this case \u2014 amber stays amber in dark mode */\n  --color-primary-foreground: #f8fafc;\n  /* ... dark overrides */\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--typescript-exports-animation-tokens",children:"Stage 3 \u2014 TypeScript exports (animation tokens)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"libs/ui/tokens/src/animation.ts"})," exports the TypeScript-side of the token system:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/tokens/src/animation.ts\nexport const durations = { fast: 100, normal: 200, slow: 300, slower: 500 } as const;\nexport const transitions = {\n  enter:     { duration: durations.normal / 1000, ease: easings.enter } as Transition,\n  pageEnter: { duration: durations.slow   / 1000, ease: easings.enter } as Transition,\n  // ...\n} as const;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["These are consumed by ",(0,r.jsx)(n.code,{children:"presets.ts"})," [patterns]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/motion/presets.ts\nimport { transitions } from '@nasnet/ui/tokens'; // [tokens]\nexport const enterTransition: Transition = transitions.enter; // 200ms ease-out\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--css-variable-loaded-at-app-entry",children:"Stage 4 \u2014 CSS variable loaded at app entry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// apps/connect/src/main.tsx\nimport '@nasnet/ui/tokens/variables.css'; // [tokens] \u2014 loads :root { --color-primary: ... }\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-5--tailwind-maps-css-variables-to-utility-classes",children:"Stage 5 \u2014 Tailwind maps CSS variables to utility classes"}),"\n",(0,r.jsx)(n.p,{children:"The Tailwind config references the CSS variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Tailwind config (generated or hand-written extension)\ntheme: {\n  extend: {\n    colors: {\n      primary: {\n        DEFAULT: 'var(--color-primary)',\n        hover:   'var(--color-primary-hover)',\n        foreground: 'var(--color-primary-foreground)',\n      },\n      // ...\n    },\n  },\n},\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-6--component-uses-semantic-token",children:"Stage 6 \u2014 Component uses semantic token"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// Any component\nimport { Button } from '@nasnet/ui/primitives'; // [primitives]\n\n<Button variant=\"default\">Apply</Button>\n\n// Button renders with class: bg-primary\n// Tailwind expands: bg-primary \u2192 background-color: var(--color-primary)\n// Browser resolves: var(--color-primary) \u2192 #EFC729\n// Dark mode (.dark ancestor): var(--color-primary) \u2192 dark override value\n"})}),"\n",(0,r.jsx)(n.h3,{id:"complete-chain-for-one-token-primary-color",children:"Complete chain for one token (primary color)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'tokens.json                  [tokens] "semantic.color.primary.DEFAULT"\n  \u2192 resolves to \u2192 "#EFC729"  via {primitive.color.brand.amber.500}\n  \u2193 build.js                 [tokens] generates CSS variable\ndist/variables.css            [tokens] :root { --color-primary: #EFC729 }\n  \u2193 main.tsx import\nBrowser CSS cascade           resolved to #EFC729 in light mode\n  \u2193 Tailwind utility\nbg-primary                   \u2192 background-color: var(--color-primary)\n  \u2193 Button component         [primitives] className="bg-primary"\n  \u2193 Browser paint            Golden Amber #EFC729\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"tokens"})," (source, build, CSS output, TypeScript exports), ",(0,r.jsx)(n.code,{children:"primitives"}),"\n(consumes CSS vars), ",(0,r.jsx)(n.code,{children:"patterns"})," (consumes TypeScript animation tokens)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"tokens-and-animation.md"})," for the full three-tier\ntoken reference."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-5-animation-pipeline",children:"Flow 5: Animation Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," User navigates to a new route; ",(0,r.jsx)(n.code,{children:"PageTransition"})," wraps the route content.\n",(0,r.jsx)(n.strong,{children:"End state:"})," The old page fades out (225 ms ease-in), the new page fades in (300 ms ease-out),\nreduced-motion users see an instant swap."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--token-values-set-the-timing-budget",children:"Stage 1 \u2014 Token values set the timing budget"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/tokens/src/animation.ts  [tokens]\nexport const durations = { slow: 300 } as const;\nexport const easings   = {\n  enter: [0, 0, 0.2, 1] as const,  // ease-out: fast start, slow end\n  exit:  [0.4, 0, 1, 1] as const,  // ease-in: slow start, fast end\n} as const;\n\nexport const transitions = {\n  pageEnter: { duration: 300 / 1000, ease: easings.enter } as Transition, // 300ms ease-out\n  pageExit:  { duration: 225 / 1000, ease: easings.exit  } as Transition, // 225ms ease-in\n} as const;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Mobile animations run 25% faster via ",(0,r.jsx)(n.code,{children:"getAnimationTokens"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export function getAnimationTokens(platform: Platform): AnimationTokens {\n  const mobileFactor = platform === 'mobile' ? 0.75 : 1;\n  return {\n    pageTransition: {\n      enter: durations.slow * mobileFactor,   // desktop: 300ms, mobile: 225ms\n      exit:  durations.slow * mobileFactor * 0.75, // desktop: 225ms, mobile: 169ms\n    },\n    // ...\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--presets-wire-tokens-to-framer-motion-variants",children:"Stage 2 \u2014 Presets wire tokens to Framer Motion variants"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/motion/presets.ts  [patterns]\nimport { transitions } from '@nasnet/ui/tokens';  // [tokens]\n\nexport const pageFade: Variants = {\n  initial: { opacity: 0 },\n  animate: { opacity: 1,  transition: transitions.pageEnter },  // 300ms ease-out\n  exit:    { opacity: 0,  transition: transitions.pageExit  },  // 225ms ease-in\n};\n\nexport const pageSlideUp: Variants = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0, transition: transitions.pageEnter },\n  exit:    { opacity: 0, y: -20, transition: transitions.pageExit },\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--animationprovider-supplies-context",children:"Stage 3 \u2014 AnimationProvider supplies context"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'// libs/ui/patterns/src/motion/AnimationProvider.tsx  [patterns]\n// Wraps the app to provide animation context and MotionConfig\nexport function AnimationProvider({ children }: AnimationProviderProps) {\n  return (\n    <AnimationContext.Provider value={contextValue}>\n      <MotionConfig reducedMotion="user"> {/* respects OS preference */}\n        {children}\n      </MotionConfig>\n    </AnimationContext.Provider>\n  );\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'MotionConfig reducedMotion="user"'})," instructs Framer Motion to honour the OS\n",(0,r.jsx)(n.code,{children:"prefers-reduced-motion"})," setting globally. Every animation inside the provider is automatically\ndisabled for users with that preference enabled."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--pagetransition-wraps-route-content",children:"Stage 4 \u2014 PageTransition wraps route content"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'// apps/connect/src/routes/__root.tsx (or per-route wrapper)\nimport {\n  PageTransition,\n  AnimatePresence,\n  pageFade,\n} from \'@nasnet/ui/patterns\';          // [patterns] \u2014 motion re-exports\n\n// In the router outlet:\n<AnimatePresence mode="wait">\n  <PageTransition key={location.pathname} variant="fade">\n    <Outlet />\n  </PageTransition>\n</AnimatePresence>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"PageTransition"})," [patterns] selects a variant (",(0,r.jsx)(n.code,{children:"pageFade"})," or ",(0,r.jsx)(n.code,{children:"pageSlideUp"}),") from the\n",(0,r.jsx)(n.code,{children:"presets.ts"})," [patterns] catalog and applies ",(0,r.jsx)(n.code,{children:"usePageTransition"})," hook logic:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/motion/PageTransition.tsx [patterns]\nimport { motion, AnimatePresence }  from 'framer-motion';\nimport { pageFade, pageSlideUp }   from './presets';   // [patterns]\nimport { useAnimation }             from './AnimationProvider';\n\nexport function PageTransition({ children, variant = 'fade', key }: PageTransitionProps) {\n  const { prefersReducedMotion } = useAnimation(); // [patterns]\n  const variants = prefersReducedMotion\n    ? reducedMotionFade   // [patterns] \u2014 opacity only, 100ms\n    : variant === 'slide' ? pageSlideUp : pageFade;  // [patterns]\n\n  return (\n    <motion.div\n      key={key}\n      variants={variants}\n      initial=\"initial\"\n      animate=\"animate\"\n      exit=\"exit\"\n    >\n      {children}\n    </motion.div>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-5--usereducedmotion-provides-accessibility-opt-out",children:"Stage 5 \u2014 useReducedMotion provides accessibility opt-out"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/layouts/src/responsive-shell/useReducedMotion.ts  [layouts]\nexport function useReducedMotion(): boolean {\n  const [prefersReduced, setPrefersReduced] = useState(\n    () => window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  );\n  // subscribes to media query changes\n  return prefersReduced;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Components can also call ",(0,r.jsx)(n.code,{children:"getReducedMotionTransition"})," [tokens] for one-off cases:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { getReducedMotionTransition, transitions } from '@nasnet/ui/tokens'; // [tokens]\nconst t = getReducedMotionTransition(transitions.pageEnter, prefersReducedMotion);\n// returns transitions.instant (duration: 0) if reducedMotion === true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"complete-animation-chain",children:"Complete animation chain"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'tokens.json                      [tokens] durations.slow = 300\n  \u2193 animation.ts\ntransitions.pageEnter            [tokens] { duration: 0.3, ease: [0,0,0.2,1] }\n  \u2193 presets.ts\npageFade.animate.transition      [patterns] references transitions.pageEnter\n  \u2193 PageTransition\nmotion.div variants={pageFade}   [patterns] Framer Motion applies keyframes\n  \u2193 AnimationProvider\nMotionConfig reducedMotion="user" [patterns] globally disables if OS setting\n  \u2193 useReducedMotion\nboolean                          [layouts] reads prefers-reduced-motion media query\n  \u2193 getReducedMotionTransition\ntransitions.instant (duration:0) [tokens] instant swap for a11y\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"tokens"})," (durations, easings, transitions, utility functions), ",(0,r.jsx)(n.code,{children:"patterns"}),"\n(presets, AnimationProvider, PageTransition), ",(0,r.jsx)(n.code,{children:"layouts"})," (useReducedMotion)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"tokens-and-animation.md"})," for complete animation token\nreference, ",(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"primitives-reference.md"})," for ",(0,r.jsx)(n.code,{children:"useReducedMotion"})," hook."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-6-categoryaccent-contextual-theming",children:"Flow 6: CategoryAccent Contextual Theming"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," A feature page wraps its content in ",(0,r.jsx)(n.code,{children:"CategoryAccentProvider"})," [primitives].\n",(0,r.jsx)(n.strong,{children:"End state:"})," Every component inside that subtree picks up an orange (",(0,r.jsx)(n.code,{children:"#F97316"}),") accent for the\nfirewall category without any explicit color prop being passed."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--provider-injects-context",children:"Stage 1 \u2014 Provider injects context"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// A feature page \u2014 libs/features/firewall/src/pages/FirewallPage.tsx\nimport {\n  CategoryAccentProvider,\n  type Category,\n} from '@nasnet/ui/primitives';                  // [primitives]\n\nexport function FirewallPage() {\n  return (\n    <CategoryAccentProvider defaultCategory=\"firewall\">\n      {/* All children inherit orange accent */}\n      <FirewallDashboard />\n    </CategoryAccentProvider>\n  );\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Inside ",(0,r.jsx)(n.code,{children:"CategoryAccentProvider"})," [primitives]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/primitives/src/category-accent/category-accent-provider.tsx\nexport function CategoryAccentProvider({ children, defaultCategory }: CategoryAccentProviderProps) {\n  const [category, setCategory] = useState<Category | null>(defaultCategory ?? null);\n\n  const meta = useMemo(() => category ? CATEGORY_META[category] : null, [category]);\n\n  return (\n    <CategoryAccentContext.Provider value={{ category, meta, setCategory, getCategoryMeta, categories: CATEGORIES }}>\n      {children}\n    </CategoryAccentContext.Provider>\n  );\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"CATEGORY_META"})," contains the CSS class names and CSS variable names for each of the 14 categories:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/primitives/src/category-accent/category-accent-provider.tsx\nexport const CATEGORY_META: Record<Category, CategoryMeta> = {\n  firewall: {\n    id: 'firewall',\n    label: 'Firewall',\n    cssVar: '--semantic-color-category-firewall',  // maps to #F97316 (orange)\n    bgClass: 'bg-category-firewall',\n    textClass: 'text-category-firewall',\n    borderClass: 'border-category-firewall',\n  },\n  // ... 13 more categories\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--child-component-reads-the-accent",children:"Stage 2 \u2014 Child component reads the accent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/features/firewall/src/components/FirewallStatusHero.tsx\nimport {\n  useCategoryAccent,\n  CategoryAccentProvider,\n} from '@nasnet/ui/primitives';               // [primitives]\nimport { cn } from '@nasnet/ui/primitives';   // [primitives]\nimport { Card } from '@nasnet/ui/primitives'; // [primitives]\n\nexport function FirewallStatusHero() {\n  const { meta } = useCategoryAccent();       // [primitives] \u2014 throws if no provider above\n\n  return (\n    <Card className={cn(\n      'border-l-4',\n      meta?.borderClass   // 'border-category-firewall' \u2192 CSS var \u2192 #F97316\n    )}>\n      <h2 className={cn(meta?.textClass)}>    // 'text-category-firewall'\n        Firewall\n      </h2>\n    </Card>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--css-variables-resolve-the-actual-color",children:"Stage 3 \u2014 CSS variables resolve the actual color"}),"\n",(0,r.jsxs)(n.p,{children:["The CSS variable ",(0,r.jsx)(n.code,{children:"--semantic-color-category-firewall"})," is defined in ",(0,r.jsx)(n.code,{children:"dist/variables.css"})," [tokens]\n(generated by ",(0,r.jsx)(n.code,{children:"build.js"})," from ",(0,r.jsx)(n.code,{children:"tokens.json"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-css",children:":root {\n  --semantic-color-category-firewall: #F97316;  /* orange */\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Tailwind class ",(0,r.jsx)(n.code,{children:"bg-category-firewall"})," expands to:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-css",children:".bg-category-firewall {\n  background-color: var(--semantic-color-category-firewall);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--dynamic-category-switching",children:"Stage 4 \u2014 Dynamic category switching"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"setCategory"})," function from context allows dynamic switching (for example, if a page hosts\nmultiple category sections):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'function MultiCategoryPage() {\n  return (\n    <CategoryAccentProvider defaultCategory="firewall">\n      <FirewallSection />    {/* orange */}\n      <CategorySwitcher to="vpn">\n        <VPNSection />       {/* green after switch */}\n      </CategorySwitcher>\n    </CategoryAccentProvider>\n  );\n}\n\nfunction CategorySwitcher({ to, children }: { to: Category; children: ReactNode }) {\n  const { setCategory } = useCategoryAccent();  // [primitives]\n  useEffect(() => { setCategory(to); }, [to]);\n  return <>{children}</>;\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"complete-accent-chain",children:"Complete accent chain"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"CategoryAccentProvider               [primitives] \u2014 React context with category + CATEGORY_META\n  \u2193 useCategoryAccent()              [primitives] \u2014 reads context\n  \u2193 meta.bgClass = 'bg-category-firewall'\n  \u2193 Tailwind\nbg-category-firewall                 \u2192 background-color: var(--semantic-color-category-firewall)\n  \u2193 CSS variable\ndist/variables.css                   [tokens] --semantic-color-category-firewall: #F97316\n  \u2193 Browser paint\nOrange accent color                  visible in sidebar icon, border, text, badge\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"primitives"})," (provider, hook, CATEGORY_META), ",(0,r.jsx)(n.code,{children:"tokens"})," (CSS variables for\ncategory colors)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"primitives-reference.md"})," for\n",(0,r.jsx)(n.code,{children:"CategoryAccentProvider"})," props, ",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"tokens-and-animation.md"})," for the\n14 category color values."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-7-help-system-with-simpletechnical-mode",children:"Flow 7: Help System with Simple/Technical Mode"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"})," ",(0,r.jsx)(n.code,{children:"FieldHelp"})," [patterns] is placed next to a form label.\n",(0,r.jsx)(n.strong,{children:"End state:"})," On desktop a popover opens showing context-sensitive help in simple or technical\nlanguage. On mobile a bottom sheet opens instead. Switching the global mode toggle updates all\n",(0,r.jsx)(n.code,{children:"FieldHelp"})," instances simultaneously."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--global-mode-state-lives-in-zustand",children:"Stage 1 \u2014 Global mode state lives in Zustand"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/state/stores \u2014 useHelpModeStore (Zustand)\n// HelpMode = 'simple' | 'technical'\n// Persisted in localStorage so preference survives refresh\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--usehelpmode-wraps-the-store-for-pattern-components",children:"Stage 2 \u2014 useHelpMode wraps the store for pattern components"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/help/use-help-mode.ts  [patterns]\nimport { useHelpModeStore, type HelpMode } from '@nasnet/state/stores'; // [state]\n\nexport function useHelpMode(): UseHelpModeReturn {\n  const mode       = useHelpModeStore((state) => state.mode);\n  const toggleMode = useHelpModeStore((state) => state.toggleMode);\n  const setMode    = useHelpModeStore((state) => state.setMode);\n\n  return {\n    mode,\n    toggleMode,\n    setMode,\n    isSimple:    mode === 'simple',\n    isTechnical: mode === 'technical',\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--usefieldhelp-loads-i18n-content",children:"Stage 3 \u2014 useFieldHelp loads i18n content"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/help/use-field-help.ts  [patterns]\nimport { useTranslation }  from '@nasnet/core/i18n';\nimport { useHelpMode }     from './use-help-mode';  // [patterns]\n\nexport function useFieldHelp(config: FieldHelpConfig): UseFieldHelpReturn {\n  const { field, mode: propMode } = config;\n  const { t, ready }             = useTranslation('network');\n  const { mode: globalMode, toggleMode } = useHelpMode();  // [patterns]\n\n  const mode: HelpMode = propMode ?? globalMode;  // prop overrides global\n\n  // Load content from i18n namespace 'network'\n  // Key structure: help.<field>.title.<mode>, help.<field>.description.<mode>\n  const content = useMemo<HelpContent>(() => {\n    if (!ready) return DEFAULT_HELP_CONTENT;\n\n    return {\n      title: t(`help.${field}.title.${mode}`, {\n        defaultValue: t(`help.${field}.title.simple`, { defaultValue: field }),\n      }),\n      description: t(`help.${field}.description.${mode}`, {\n        defaultValue: t(`help.${field}.description.simple`, { defaultValue: '' }),\n      }),\n      examples: t(`help.${field}.examples`, { returnObjects: true, defaultValue: [] }),\n      link:     t(`help.${field}.link`, { defaultValue: '' }),\n    };\n  }, [t, field, mode, ready]);\n\n  const ariaLabel = useMemo(() => `Help for ${content.title || field} field`, [content.title, field]);\n  const [isOpen, setIsOpen] = useState(false);\n  const toggle = useCallback(() => setIsOpen((prev) => !prev), []);\n\n  return { content, isOpen, setIsOpen, toggle, mode, toggleMode, ariaLabel, isReady: ready };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--fieldhelp-selects-presenter",children:"Stage 4 \u2014 FieldHelp selects presenter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/help/field-help.tsx  [patterns]\nimport { usePlatform }     from '@nasnet/ui/layouts';  // [layouts]\nimport { FieldHelpDesktop } from './field-help-desktop';\nimport { FieldHelpMobile }  from './field-help-mobile';\nimport { useFieldHelp }     from './use-field-help';   // [patterns]\n\nexport const FieldHelp = React.memo(function FieldHelp({ field, mode, placement }: FieldHelpProps) {\n  const platform  = usePlatform();                     // [layouts]\n  const helpState = useFieldHelp({ field, mode, placement }); // [patterns]\n\n  if (platform === 'mobile') {\n    return <FieldHelpMobile  field={field} helpState={helpState} />; // bottom sheet\n  }\n  return <FieldHelpDesktop   field={field} helpState={helpState} />; // popover\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-5--platform-presenters-render-different-ui",children:"Stage 5 \u2014 Platform presenters render different UI"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Desktop presenter"})," uses ",(0,r.jsx)(n.code,{children:"Popover"})," [primitives]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'// libs/ui/patterns/src/help/field-help-desktop.tsx  [patterns]\nimport { Popover, PopoverTrigger, PopoverContent } from \'@nasnet/ui/primitives\'; // [primitives]\nimport { HelpIcon }   from \'./help-icon\';   // [patterns]\nimport { HelpPopover } from \'./help-popover\'; // [patterns]\n\nexport function FieldHelpDesktop({ field, helpState }: FieldHelpDesktopProps) {\n  const { content, isOpen, setIsOpen, ariaLabel } = helpState;\n\n  return (\n    <Popover open={isOpen} onOpenChange={setIsOpen}>\n      <PopoverTrigger asChild>\n        <HelpIcon field={field} aria-label={ariaLabel} onClick={helpState.toggle} />\n      </PopoverTrigger>\n      <PopoverContent side="right" className="w-72 p-4">\n        <h4 className="font-medium text-sm">{content.title}</h4>\n        <p className="text-xs text-muted-foreground mt-1">{content.description}</p>\n        {content.examples?.length > 0 && (\n          <ul className="mt-2 space-y-1">\n            {content.examples.map((ex) => (\n              <li key={ex} className="font-mono text-xs">{ex}</li>\n            ))}\n          </ul>\n        )}\n      </PopoverContent>\n    </Popover>\n  );\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Mobile presenter"})," uses ",(0,r.jsx)(n.code,{children:"BottomSheet"})," [patterns]:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/help/field-help-mobile.tsx  [patterns]\nimport { BottomSheet, BottomSheetContent, BottomSheetHeader } from '@nasnet/ui/patterns'; // [patterns]\nimport { HelpIcon } from './help-icon';\n\nexport function FieldHelpMobile({ field, helpState }: FieldHelpMobileProps) {\n  const { content, isOpen, setIsOpen, toggle, ariaLabel } = helpState;\n\n  return (\n    <>\n      <HelpIcon field={field} aria-label={ariaLabel} onClick={toggle} />\n      <BottomSheet open={isOpen} onOpenChange={setIsOpen}>\n        <BottomSheetHeader>\n          <h3 className=\"font-semibold\">{content.title}</h3>\n        </BottomSheetHeader>\n        <BottomSheetContent>\n          <p className=\"text-sm text-muted-foreground\">{content.description}</p>\n        </BottomSheetContent>\n      </BottomSheet>\n    </>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-6--helpmodetoggle-is-placed-in-app-header",children:"Stage 6 \u2014 HelpModeToggle is placed in app header"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/ui/patterns/src/help/help-mode-toggle.tsx  [patterns]\nimport { useHelpMode } from './use-help-mode';  // [patterns]\nimport { Button }      from '@nasnet/ui/primitives'; // [primitives]\n\nexport function HelpModeToggle() {\n  const { isSimple, toggleMode } = useHelpMode(); // [patterns]\n\n  return (\n    <Button variant=\"ghost\" size=\"sm\" onClick={toggleMode}>\n      {isSimple ? 'Switch to Technical' : 'Switch to Simple'}\n    </Button>\n  );\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Clicking the toggle updates ",(0,r.jsx)(n.code,{children:"useHelpModeStore"})," [state]. All mounted ",(0,r.jsx)(n.code,{children:"FieldHelp"})," instances that\nderive from ",(0,r.jsx)(n.code,{children:"useHelpMode"})," re-render immediately because they subscribe to the same Zustand store."]}),"\n",(0,r.jsx)(n.h3,{id:"complete-data-flow-1",children:"Complete data flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HelpModeToggle                  [patterns]\n  \u2514\u2500\u2500 useHelpMode()              [patterns]\n      \u2514\u2500\u2500 useHelpModeStore()     [state] \u2014 Zustand (persisted)\n  \u2514\u2500\u2500 toggleMode() \u2192             [state] updates 'simple' | 'technical'\n\nFieldHelp                        [patterns]\n  \u2514\u2500\u2500 usePlatform()              [layouts]\n  \u2514\u2500\u2500 useFieldHelp()             [patterns]\n      \u2514\u2500\u2500 useHelpMode()          [patterns] \u2192 reads global mode\n      \u2514\u2500\u2500 useTranslation()       i18n \u2192 loads help.<field>.description.<mode>\n  \u2514\u2500\u2500 mobile \u2192 FieldHelpMobile   [patterns]\n      \u2514\u2500\u2500 HelpIcon               [patterns]\n      \u2514\u2500\u2500 BottomSheet            [patterns] \u2014 gesture-driven mobile sheet\n  \u2514\u2500\u2500 desktop \u2192 FieldHelpDesktop [patterns]\n      \u2514\u2500\u2500 HelpIcon               [patterns]\n      \u2514\u2500\u2500 Popover                [primitives] \u2014 hover/click popover\n          \u2514\u2500\u2500 PopoverContent     [primitives]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"patterns"})," (FieldHelp, useFieldHelp, useHelpMode, presenters,\nBottomSheet, HelpModeToggle), ",(0,r.jsx)(n.code,{children:"primitives"})," (Popover), ",(0,r.jsx)(n.code,{children:"layouts"})," (usePlatform), ",(0,r.jsx)(n.code,{children:"state/stores"}),"\n(useHelpModeStore)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-domain-components",children:"patterns-domain-components.md"})," for\n",(0,r.jsx)(n.code,{children:"BottomSheet"})," API, ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-forms-and-inputs",children:"patterns-forms-and-inputs.md"})," for\nintegrating ",(0,r.jsx)(n.code,{children:"FieldHelp"})," next to ",(0,r.jsx)(n.code,{children:"RHFFormField"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flow-8-clipboard-pipeline",children:"Flow 8: Clipboard Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Entry point:"}),' User selects rows in a data table and clicks "Copy as CSV".\n',(0,r.jsx)(n.strong,{children:"End state:"})," CSV data is in the system clipboard. User pastes it into a text area elsewhere.\n",(0,r.jsx)(n.code,{children:"usePasteImport"})," parses and validates the content, making the parsed items available for preview."]}),"\n",(0,r.jsx)(n.h3,{id:"stage-1--useclipboard-provides-the-primitive-copy-operation",children:"Stage 1 \u2014 useClipboard provides the primitive copy operation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/hooks/useClipboard.ts  [patterns]\nexport function useClipboard(options: UseClipboardOptions = {}): UseClipboardReturn {\n  const { timeout = 2000, onSuccess, onError } = options;\n  const [copied, setCopied] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const copy = useCallback(async (value: string): Promise<boolean> => {\n    setIsLoading(true);\n    try {\n      if (navigator.clipboard?.writeText) {\n        await navigator.clipboard.writeText(value);  // Modern Clipboard API\n      } else {\n        fallbackCopyText(value);  // execCommand fallback for older browsers\n      }\n      setCopied(true);\n      setTimeout(() => setCopied(false), timeout); // auto-reset after 2s\n      onSuccess?.(value);\n      return true;\n    } catch (err) {\n      onError?.(err instanceof Error ? err : new Error('Copy failed'));\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [timeout, onSuccess, onError]);\n\n  return { copy, copied, error, reset, isLoading };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-2--usebulkcopy-wraps-useclipboard-with-format-selection",children:"Stage 2 \u2014 useBulkCopy wraps useClipboard with format selection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/hooks/useBulkCopy.ts  [patterns]\nimport { useClipboard, CLIPBOARD_TIMEOUT_MS } from './useClipboard'; // [patterns]\n\nexport type ExportFormat = 'csv' | 'json' | 'text';\n\nexport function useBulkCopy(options: UseBulkCopyOptions = {}): UseBulkCopyReturn {\n  const { defaultFormat = 'csv', csvDelimiter = ',', includeHeader = true } = options;\n  const [format, setFormat] = useState<ExportFormat>(defaultFormat);\n  const { copy, copied, error, reset: resetClipboard, isLoading } = useClipboard();\n\n  const copyItems = useCallback(async <T extends Record<string, unknown>>(\n    items: T[],\n    columns?: (keyof T)[]\n  ): Promise<boolean> => {\n    const cols = columns ?? Object.keys(items[0]) as (keyof T)[];\n    let content: string;\n\n    switch (format) {\n      case 'csv':  content = toCSV(items, cols, csvDelimiter, includeHeader); break;\n      case 'json': content = JSON.stringify(items, null, 2); break;\n      case 'text': content = items.map(item => cols.map(c => String(item[c] ?? '')).join('\\t')).join('\\n'); break;\n    }\n\n    return copy(content);  // delegates to useClipboard [patterns]\n  }, [format, csvDelimiter, includeHeader, copy]);\n\n  return { copyItems, format, setFormat, copied, copiedCount, error, reset, isLoading, supportedFormats: SUPPORTED_FORMATS };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-3--feature-layer-usage-with-copybutton",children:"Stage 3 \u2014 Feature-layer usage with CopyButton"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/features/firewall/src/components/AddressListView.tsx  [features/firewall]\nimport { useBulkCopy, type ExportFormat } from '@nasnet/ui/patterns'; // [patterns]\nimport { Button, Select, SelectItem }     from '@nasnet/ui/primitives'; // [primitives]\nimport { Check, Copy }                    from 'lucide-react';\n\nexport function AddressListBulkActions({ selectedRows }: { selectedRows: AddressListEntry[] }) {\n  const { copyItems, format, setFormat, copied, isLoading } = useBulkCopy({\n    defaultFormat: 'csv',\n    onSuccess: (count, fmt) => console.log(`Copied ${count} rows as ${fmt}`),\n  });\n\n  const handleCopy = () => copyItems(selectedRows, ['address', 'comment', 'disabled']);\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      <Select value={format} onValueChange={(v) => setFormat(v as ExportFormat)}>\n        <SelectItem value=\"csv\">CSV</SelectItem>\n        <SelectItem value=\"json\">JSON</SelectItem>\n        <SelectItem value=\"text\">Plain Text</SelectItem>\n      </Select>\n\n      <Button\n        variant=\"outline\"\n        size=\"sm\"\n        onClick={handleCopy}\n        isLoading={isLoading}\n        aria-label=\"Copy selected rows to clipboard\"\n      >\n        {copied ? <Check className=\"h-4 w-4\" /> : <Copy className=\"h-4 w-4\" />}\n        {copied ? 'Copied!' : 'Copy'}\n      </Button>\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-4--usepasteimport-handles-the-receiving-end",children:"Stage 4 \u2014 usePasteImport handles the receiving end"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// libs/features/firewall/src/components/AddressListImportDialog.tsx  [features/firewall]\nimport { usePasteImport, type ParseResult } from '@nasnet/ui/patterns'; // [patterns]\nimport { Textarea }                          from '@nasnet/ui/primitives'; // [primitives]\n\nexport function AddressListImportDialog() {\n  const [preview, setPreview] = useState<ParseResult | null>(null);\n\n  const { handlePaste, parseResult, clearResult, isParsing } = usePasteImport({\n    type: 'auto',    // auto-detect: 'ip-list' | 'csv' | 'routeros'\n    maxItems: 1000,\n    onParsed: (result) => setPreview(result),\n    onError:  (err)    => console.error('Parse error:', err),\n  });\n\n  return (\n    <div>\n      <Textarea\n        placeholder=\"Paste IP addresses, CSV data, or RouterOS commands...\"\n        onPaste={handlePaste}   // fires usePasteImport.handlePaste\n      />\n\n      {preview && (\n        <div>\n          <p>{preview.items.length} valid items, {preview.errors.length} errors</p>\n          {preview.errors.map((err) => (\n            <p key={err.line} className=\"text-destructive text-xs\">\n              Line {err.line}: {err.message}\n            </p>\n          ))}\n          <Button onClick={() => { importItems(preview.items); clearResult(); }}>\n            Import {preview.items.length} items\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stage-5--usepasteimport-auto-detects-format",children:"Stage 5 \u2014 usePasteImport auto-detects format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// libs/ui/patterns/src/hooks/usePasteImport.ts  [patterns]\nexport type ImportType = 'ip-list' | 'csv' | 'routeros' | 'auto';\n\nfunction detectImportType(content: string): ImportType {\n  const firstLine = content.trim().split('\\n')[0] ?? '';\n\n  if (firstLine.startsWith('/') || firstLine.includes('add chain=')) return 'routeros';\n  if (firstLine.includes(',') || firstLine.includes('\\t'))            return 'csv';\n\n  const allIPs = content.split('\\n').filter(l => l.trim()).every(l => isValidIP(l.trim()));\n  if (allIPs) return 'ip-list';\n\n  return 'auto';\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"parseContent"})," function returns a ",(0,r.jsx)(n.code,{children:"ParseResult"})," with ",(0,r.jsx)(n.code,{children:"items"}),", ",(0,r.jsx)(n.code,{children:"errors"}),", ",(0,r.jsx)(n.code,{children:"type"}),", and\n",(0,r.jsx)(n.code,{children:"rawContent"}),", enabling the preview UI to show valid entries and highlight problematic lines."]}),"\n",(0,r.jsx)(n.h3,{id:"complete-clipboard-pipeline",children:"Complete clipboard pipeline"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"User selects rows\n  \u2193\nAddressListBulkActions            [features/firewall]\n  \u2514\u2500\u2500 useBulkCopy()               [patterns]\n      \u2514\u2500\u2500 setFormat('csv')        user selects CSV\n      \u2514\u2500\u2500 copyItems(rows, cols)\n          \u2514\u2500\u2500 toCSV(rows, ...)    serialise to \"address,comment\\n192.168.1.1,...\"\n          \u2514\u2500\u2500 useClipboard.copy() [patterns]\n              \u2514\u2500\u2500 navigator.clipboard.writeText(csv)  // Modern Clipboard API\n              \u2514\u2500\u2500 setCopied(true) \u2192 Button shows \"Copied!\" for 2000ms\n              \u2514\u2500\u2500 setTimeout \u2192 setCopied(false)\n\nUser pastes in AddressListImportDialog\n  \u2193\n<Textarea onPaste={handlePaste}>  [primitives]\n  \u2514\u2500\u2500 usePasteImport.handlePaste  [patterns]\n      \u2514\u2500\u2500 event.clipboardData.getData('text')\n      \u2514\u2500\u2500 detectImportType()      \u2192 'csv'\n      \u2514\u2500\u2500 parseCSV()              \u2192 { success: true, items: [...], errors: [] }\n      \u2514\u2500\u2500 setParseResult(result)\n      \u2514\u2500\u2500 onParsed(result)        \u2192 setPreview(result)\n  \u2193\nPreview UI renders items + error list\n  \u2193\nUser clicks Import\n  \u2514\u2500\u2500 importItems(items)          \u2192 GraphQL mutation\n  \u2514\u2500\u2500 clearResult()               \u2192 setParseResult(null)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Packages involved:"})," ",(0,r.jsx)(n.code,{children:"patterns"})," (useClipboard, useBulkCopy, usePasteImport), ",(0,r.jsx)(n.code,{children:"primitives"}),"\n(Button, Select, Textarea)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"See also:"})," ",(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks#clipboard-hooks",children:"shared-hooks.md"})," for the complete hook\nsignatures, ",(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"primitives-reference.md"})," for ",(0,r.jsx)(n.code,{children:"Button"})," loading state\nand ",(0,r.jsx)(n.code,{children:"Select"})," props."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary-table",children:"Summary Table"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"#"}),(0,r.jsx)(n.th,{children:"Flow"}),(0,r.jsx)(n.th,{children:"Packages Involved"}),(0,r.jsx)(n.th,{children:"Key Components"}),(0,r.jsx)(n.th,{children:"Key Hooks"}),(0,r.jsx)(n.th,{children:"Doc References"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"1"}),(0,r.jsx)(n.td,{children:"Responsive Page"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"layouts"}),", ",(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"state/stores"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ResponsiveShell"}),", ",(0,r.jsx)(n.code,{children:"MobileAppShell"}),", ",(0,r.jsx)(n.code,{children:"AppShell"}),", ",(0,r.jsx)(n.code,{children:"BottomNavigation"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"usePlatform"}),", ",(0,r.jsx)(n.code,{children:"useSidebarStore"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/layouts-and-platform",children:"03"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks",children:"08"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2"}),(0,r.jsx)(n.td,{children:"Config Apply Pipeline"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"tokens"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ValidationProgress"}),", ",(0,r.jsx)(n.code,{children:"ValidationStage"}),", ",(0,r.jsx)(n.code,{children:"ConflictList"}),", ",(0,r.jsx)(n.code,{children:"ConflictCard"}),", ",(0,r.jsx)(n.code,{children:"Button"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"useValidationProgress"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/patterns-forms-and-inputs",children:"06"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-status-and-data",children:"05"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"3"}),(0,r.jsx)(n.td,{children:"Sortable Firewall Rules"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"layouts"}),", ",(0,r.jsx)(n.code,{children:"tokens"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"FirewallRuleList"}),", ",(0,r.jsx)(n.code,{children:"SortableList"}),", ",(0,r.jsx)(n.code,{children:"SortableItem"}),", ",(0,r.jsx)(n.code,{children:"DragHandle"}),", ",(0,r.jsx)(n.code,{children:"AnimatedList"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"useSortableList"}),", ",(0,r.jsx)(n.code,{children:"useMultiSelect"}),", ",(0,r.jsx)(n.code,{children:"usePlatform"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/patterns-domain-components",children:"07"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"04"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"4"}),(0,r.jsx)(n.td,{children:"Token Build Pipeline"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"tokens"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"patterns"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Button"})," (consumer)"]}),(0,r.jsx)(n.td,{children:"\u2014 (build-time)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"04"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"5"}),(0,r.jsx)(n.td,{children:"Animation Pipeline"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"tokens"}),", ",(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"layouts"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PageTransition"}),", ",(0,r.jsx)(n.code,{children:"AnimationProvider"}),", ",(0,r.jsx)(n.code,{children:"AnimatePresence"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"useReducedMotion"}),", ",(0,r.jsx)(n.code,{children:"useAnimation"}),", ",(0,r.jsx)(n.code,{children:"getAnimationTokens"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"04"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"02"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"6"}),(0,r.jsx)(n.td,{children:"CategoryAccent Theming"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"tokens"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CategoryAccentProvider"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"useCategoryAccent"}),", ",(0,r.jsx)(n.code,{children:"getCategoryMeta"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"02"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"04"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"7"}),(0,r.jsx)(n.td,{children:"Help System"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"}),", ",(0,r.jsx)(n.code,{children:"layouts"}),", ",(0,r.jsx)(n.code,{children:"state/stores"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"FieldHelp"}),", ",(0,r.jsx)(n.code,{children:"FieldHelpDesktop"}),", ",(0,r.jsx)(n.code,{children:"FieldHelpMobile"}),", ",(0,r.jsx)(n.code,{children:"HelpModeToggle"}),", ",(0,r.jsx)(n.code,{children:"BottomSheet"}),", ",(0,r.jsx)(n.code,{children:"Popover"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"useFieldHelp"}),", ",(0,r.jsx)(n.code,{children:"useHelpMode"}),", ",(0,r.jsx)(n.code,{children:"usePlatform"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"/docs/ui/patterns-domain-components",children:"07"}),", ",(0,r.jsx)(n.a,{href:"/docs/ui/patterns-forms-and-inputs",children:"06"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"8"}),(0,r.jsx)(n.td,{children:"Clipboard Pipeline"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"patterns"}),", ",(0,r.jsx)(n.code,{children:"primitives"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Button"}),", ",(0,r.jsx)(n.code,{children:"Select"}),", ",(0,r.jsx)(n.code,{children:"Textarea"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"useClipboard"}),", ",(0,r.jsx)(n.code,{children:"useBulkCopy"}),", ",(0,r.jsx)(n.code,{children:"usePasteImport"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks",children:"08"})})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"dependency-direction-recap",children:"Dependency Direction Recap"}),"\n",(0,r.jsxs)(n.p,{children:["Every flow above respects the one-way dependency rule enforced by ESLint\n",(0,r.jsx)(n.code,{children:"@nx/enforce-module-boundaries"}),". No arrow in any diagram points upward:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"apps/ \u2192 features/ \u2192 patterns/ \u2192 primitives/ \u2192 tokens (CSS vars)\n                              \u2197\n                    layouts/ \u2500\n                              \u2198\n                    state/stores (read by patterns via hooks, injected to layouts via app)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The only apparent exception is ",(0,r.jsx)(n.code,{children:"useHelpMode"})," [patterns] importing from ",(0,r.jsx)(n.code,{children:"@nasnet/state/stores"}),".\nThis is intentional: ",(0,r.jsx)(n.code,{children:"state/stores"})," is not in the ",(0,r.jsx)(n.code,{children:"libs/ui/"})," hierarchy and is allowed to be\nimported by ",(0,r.jsx)(n.code,{children:"patterns"}),". ",(0,r.jsx)(n.code,{children:"layouts"})," cannot import from ",(0,r.jsx)(n.code,{children:"state/stores"})," (library rule) which is why\n",(0,r.jsx)(n.code,{children:"ResponsiveShell"})," receives sidebar state as props injected from the app layer."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Topic"}),(0,r.jsx)(n.th,{children:"Document"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"All 40 primitive components"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/primitives-reference",children:"primitives-reference.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Shell and page layout components"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/layouts-and-platform",children:"layouts-and-platform.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Token system and animation"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/tokens-and-animation",children:"tokens-and-animation.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Status and data display patterns"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/patterns-status-and-data",children:"patterns-status-and-data.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Form system, RHFFormField, ValidationProgress"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/patterns-forms-and-inputs",children:"patterns-forms-and-inputs.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Domain components (ServiceCard, DeviceRoutingMatrix, etc.)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/patterns-domain-components",children:"patterns-domain-components.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"All shared hooks"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/ui/shared-hooks",children:"shared-hooks.md"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Authoritative design system"}),(0,r.jsxs)(n.td,{children:["See ",(0,r.jsx)(n.code,{children:"Docs/design/README.md"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Platform presenter deep-dive"}),(0,r.jsxs)(n.td,{children:["See ",(0,r.jsx)(n.code,{children:"Docs/design/PLATFORM_PRESENTER_GUIDE.md"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Architecture patterns"}),(0,r.jsxs)(n.td,{children:["See ",(0,r.jsx)(n.code,{children:"Docs/architecture/novel-pattern-designs.md"})]})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);